{
  "hash": "14ec4a976cfd3c8b32340f4c751afc77",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: \"TIL: X·ª≠ l√Ω m·∫£ng dynamic-ragged trong Excel\"\ndescription: \"C√°c m·∫£ng\"\nauthor:\n  - name: \"Tuan Le Khac\"\n    url: https://lktuan.github.io/\ndate: 06-06-2024\nmodified-date: 06-06-2024\ncategories: [excel, lambda, til] \nimage: excel-lambda.jpg\ndraft: true \nformat: \n  html: \n    code-fold: false\n    code-summary: \"Show the code\"\n    code-line-numbers: true\ncss: html/styles.scss\nfig-cap-location: bottom\neditor: visual\n---\n\n# Problem statement\n\nTIL: H√¥m nay m√¨nh th·ª≠ gi·∫£i m·ªôt [challenge](https://www.linkedin.com/posts/owenhprice_data-analytics-sql-activity-7204129483144986624-R73I) c·ªßa b√°c [Owen Price](https://www.linkedin.com/in/owenhprice/). B√°c l√† Microsoft MVP, master ·ªü kh√≠a c·∫°nh x·ª≠ l√≠, l√†m s·∫°ch, th·∫≠m ch√≠ l√† t·ªëi ∆∞u vi·ªác x·ª≠ l√≠ ƒë√≥ trong Excel, trang blog c·ªßa b√°c l√† [FLEX YOUR DATA](https://www.flexyourdata.com/), m√¨nh h·ªçc ƒë∆∞·ª£c r·∫•t nhi·ªÅu c√°c s·ª≠ d·ª•ng formulas, ƒë·∫∑c bi·ªát l√† c√°c h√†m m·ªõi t·ª´ `LAMBDA()`, `MAP()`, `REDUCE()` cho ƒë·∫øn g·∫ßn ƒë√¢y l√† **Python in Excel**, `GROUPBY()`, `PIVOTBY`, v√† c√°c h√†m `REGEX`.\n\nN·ªôi dung challeng l√†, v·ªõi **m·ªôt ph·∫ßn** c·ªßa b·ªô d·ªØ li·ªáu [Citi Bike](https://citibikenyc.com/system-data), trong ƒë√≥ ch·ª©a hai c·ªôt `start_station_name`, `end_station_name`, m·ªói c·ªôt l·∫°i ch·ª©a th√¥ng tin c√°c \"station\" ~ tr·∫°m, li·ªát k√™ 5 tr·∫°m c≈©ng s·ªë l·∫ßn xu·∫•t hi·ªán v·ªõi s·ªë l∆∞·ª£ng l·ªõn nh·∫•t!. H√¨nh d∆∞·ªõi l√† 10 d√≤ng ƒë·∫ßu ti√™n c·ªßa d·ªØ li·ªáu.\n\n::: {layout-ncol=1}\n![10 d√≤ng ƒë·∫ßu ti√™n c·ªßa d·ªØ li·ªáu](data.png){width=100%}\n:::\n\nWell l√∫c ƒë·∫ßu m√¨nh nghƒ© n√≥ c≈©ng ƒë∆°n gi·∫£n üòÇ, th·∫≠m ch√≠ c≈©ng kh√¥ng hi·ªÉu t·∫°i sao m·ªói start ho·∫∑c end station l·∫°i c√≥ *hai station*, c√°ch nhau b·ªüi k√Ω t·ª± ` & ` (space before & after). M√¨nh l·∫≠p t·ª©c ƒë∆∞a ra l·ªùi gi·∫£i nh∆∞ sau:\n\n\n```{lua}\n=LET(\n    _d, \" & \",\n    _all_records, BYROW(\n        BYROW(\n            _tbl_CityBike[[start_station_name]:[end_station_name]],\n            LAMBDA(x, TEXTJOIN(_d, TRUE, x))\n        ),\n        LAMBDA(x, TEXTSPLIT(x, _d))\n    ),\n    _stations, UNIQUE(_all_records),\n    _cnt, BYROW(\n        - - (_stations = TRANSPOSE(_all_records)), -- \"--\" equals to \"+\" will convert the boolean TRUE/FALSE to value 1/0\n        LAMBDA(x, SUM(x))\n    ),\n    TAKE(SORTBY(HSTACK(_stations, _cnt), _cnt, -1), 5, )\n)\n```\n\n\n\n::: {layout-ncol=1}\n![Ragged or Jagged array, photo credit to [Geeks for Geeks](https://www.geeksforgeeks.org/jagged-array-in-java/)](g4g_ragged_array.png){width=80%}\n:::\n\n",
    "supporting": [
      "index_files"
    ],
    "filters": [],
    "includes": {}
  }
}