<?xml version="1.0" encoding="UTF-8"?>
<rss  xmlns:atom="http://www.w3.org/2005/Atom" 
      xmlns:media="http://search.yahoo.com/mrss/" 
      xmlns:content="http://purl.org/rss/1.0/modules/content/" 
      xmlns:dc="http://purl.org/dc/elements/1.1/" 
      version="2.0">
<channel>
<title>Le Khac Tuan</title>
<link>https://lktuan.github.io/blog.html</link>
<atom:link href="https://lktuan.github.io/blog.xml" rel="self" type="application/rss+xml"/>
<description>I am a Risk Modeler ğŸš€</description>
<generator>quarto-1.4.554</generator>
<lastBuildDate>Thu, 24 Oct 2024 17:00:00 GMT</lastBuildDate>
<item>
  <title>Keynote on: Causal Effect Estimation in Practice - lessons learned from E-commerce &amp; Banking</title>
  <dc:creator>Tuan Le Khac</dc:creator>
  <link>https://lktuan.github.io/blog/2024-10-25-CEE-in-practice/</link>
  <description><![CDATA[ 





<p>Link: <a href="https://www.youtube.com/watch?v=pz7QD2GPBlE" class="uri">https://www.youtube.com/watch?v=pz7QD2GPBlE</a></p>
<p><a href="https://github.com/Senejohnny">Danial</a> focuses on the practical challenges and solutions in implementing causal effect estimation in business settings, particularly in finance and banking. The speaker emphasizes the gap between <strong>theoretical frameworks</strong> and <strong>real-world applications</strong>, sharing lessons learned from actual implementations.</p>
<section id="intro" class="level1">
<h1>0. Intro</h1>
<p>The author aim to shed some light on the practical setting and challenges of <strong>causal inference</strong>. Causal analysis goes further than predicting an outcome, all the way to influence it.</p>
</section>
<section id="practical-use-cases" class="level1">
<h1>1. Practical Use Cases</h1>
<ul>
<li>Effect estimation:
<ul>
<li>Marketing campaign effectiveness evaluation (on client/product acquisition and retention);</li>
<li>Assessment of free financial consultation servicesâ€™ value (on revenue/NPS);</li>
</ul></li>
<li>Other applications [Out of scope]:
<ul>
<li>Root Cause Analysis: To what factor(s) the estimated effect can be attributed;</li>
<li>What if analysis: What is the result of a counterfactual scenario.</li>
</ul></li>
</ul>
<p>Eg.: the impact measurement of credit lines on customer retention. The primary challenge is moving from <strong>theoretical frameworks</strong> to <strong>practical business applications</strong>.</p>
</section>
<section id="the-gold-standard-vs.-reality" class="level1">
<h1>2. The Gold Standard vs.&nbsp;Reality</h1>
<ul>
<li>While A/B testing (randomized experiments) is considered the gold standard, itâ€™s often impractical or impossible in real business settings;</li>
</ul>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="1">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://lktuan.github.io/blog/2024-10-25-CEE-in-practice/1_ab_testing.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption>golden standard</figcaption>
</figure>
</div>
</div>
</div>
</div>
<ul>
<li>Common obstacles include:
<ul>
<li>Marketers forgetting to implement proper randomization;</li>
<li>Cost and business constraints;</li>
<li>Ethical considerations;</li>
<li>Client non-compliance;</li>
<li>Limited data availability.</li>
</ul></li>
</ul>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="1">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://lktuan.github.io/blog/2024-10-25-CEE-in-practice/2_limitations.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption>limitations</figcaption>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="practical-challenges" class="level1">
<h1>3. Practical Challenges</h1>
<ul>
<li>Non-simultaneous contact: In reality, campaigns often target different groups at different times;</li>
<li>Lack of proper control groups: When targeting specific customer segments, finding comparable control groups is difficult;</li>
<li>No randomization: Business rules often determine who receives treatment, leading to selection bias.</li>
</ul>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="1">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://lktuan.github.io/blog/2024-10-25-CEE-in-practice/3_differences.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption>differences</figcaption>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="solutions-and-approaches" class="level1">
<h1>4. Solutions and Approaches</h1>
<section id="handling-non-randomization" class="level2">
<h2 class="anchored" data-anchor-id="handling-non-randomization">4.1. Handling Non-randomization</h2>
<ul>
<li>Use propensity score modeling to mimic randomization;</li>
<li>Account for confounding variables (like age, sex) that affect both treatment assignment and outcomes;</li>
<li>Apply inverse probability weighting to correct for selection bias.</li>
</ul>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="1">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://lktuan.github.io/blog/2024-10-25-CEE-in-practice/4_sol_1.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption>minic randomization</figcaption>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="control-group-selection" class="level2">
<h2 class="anchored" data-anchor-id="control-group-selection">4.2. Control Group Selection</h2>
<ul>
<li>Use rule-based methods to create comparable control groups;</li>
<li>Apply the same filters used in campaign targeting;</li>
<li>Consider similar products within the same category;</li>
<li>Implement exclusion criteria to maintain non-interference and consistency;</li>
<li>Ensure basic criteria matching (e.g., valid email addresses, opt-in status).</li>
</ul>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="1">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://lktuan.github.io/blog/2024-10-25-CEE-in-practice/10_good_control.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption>good control</figcaption>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="kpi-consideration" class="level2">
<h2 class="anchored" data-anchor-id="kpi-consideration">4.3. KPI Consideration</h2>
<ul>
<li>Understand the propagation of effects through time:
<ul>
<li>Short-term metrics (email opens, clicks);</li>
<li>Mid-term metrics (product adoption);</li>
<li>Long-term metrics (revenue generation);</li>
</ul></li>
<li>Consider data availability and measurement timing;</li>
<li>Account for different variables affecting each level of metrics.</li>
</ul>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="1">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://lktuan.github.io/blog/2024-10-25-CEE-in-practice/9_effect_propagation_kpi.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption>KPIs consideration</figcaption>
</figure>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="theoretical-frameworks" class="level1">
<h1>5. Theoretical Frameworks</h1>
<p>The speaker discusses two main schools of thought:</p>
<section id="potential-outcomes-framework" class="level2">
<h2 class="anchored" data-anchor-id="potential-outcomes-framework">5.1. Potential Outcomes Framework</h2>
<ul>
<li>Focuses on treatment assignment mechanisms;</li>
<li>Uses propensity scoring and inverse probability weighting;</li>
<li>Simpler to implement in practice.</li>
</ul>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="1">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://lktuan.github.io/blog/2024-10-25-CEE-in-practice/5_potantial_outcome.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption>potential outcome</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="1">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://lktuan.github.io/blog/2024-10-25-CEE-in-practice/6_potential_outcome_assumption.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption>potential outcome assumptions</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="1">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://lktuan.github.io/blog/2024-10-25-CEE-in-practice/7_when_association_is_causation.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption>when association is causation?</figcaption>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="structural-causal-models" class="level2">
<h2 class="anchored" data-anchor-id="structural-causal-models">5.2. Structural Causal Models</h2>
<ul>
<li>Based on causal graphs;</li>
<li>Provides a more complete picture of relationships;</li>
<li>Requires careful consideration of mediators, confounders, and colliders.</li>
</ul>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="1">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://lktuan.github.io/blog/2024-10-25-CEE-in-practice/8_SCM.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption>structural causal models</figcaption>
</figure>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="practical-implementation-tips" class="level1">
<h1>6. Practical Implementation Tips</h1>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="1">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://lktuan.github.io/blog/2024-10-25-CEE-in-practice/11_practice_example.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption>pratical example</figcaption>
</figure>
</div>
</div>
</div>
</div>
<ul>
<li>Start with simple rule-based approaches before applying sophisticated models;</li>
<li>Validate assumptions with domain experts;</li>
<li>Consider multiple time horizons for effect measurement;</li>
<li>Use survival analysis for handling time-varying outcomes;</li>
<li>Apply multiple methods to validate results;</li>
<li>Focus on business relevance rather than theoretical perfection.</li>
</ul>
</section>
<section id="key-considerations-for-success" class="level1">
<h1>7. Key Considerations for Success</h1>
<ul>
<li>Ensure exchangeability between treatment and control groups;</li>
<li>Maintain positivity (overlap in covariate distributions);</li>
<li>Avoid interference between groups;</li>
<li>Maintain consistency in treatment application;</li>
<li>Consider both direct and indirect effects;</li>
<li>Account for time-varying effects.</li>
</ul>
</section>
<section id="evaluation-challenges" class="level1">
<h1>8. Evaluation Challenges</h1>
<ul>
<li>Unlike simulated data, real-world applications lack known true effects;</li>
<li>Recommend using multiple methods and comparing results;</li>
<li>Validate findings with domain experts;</li>
<li>Consider business context and practical significance.</li>
</ul>
</section>
<section id="outtro" class="level1">
<h1>9. Outtro</h1>
<p>The speaker emphasizes that successful causal inference in practice requires:</p>
<ul>
<li>Balance between theoretical rigor and practical constraints;</li>
<li>Understanding of business context and limitations;</li>
<li>Use of simple, interpretable methods where appropriate;</li>
<li>Careful consideration of data quality and availability;</li>
<li>Collaboration with domain experts;</li>
<li>Focus on business-relevant metrics and timeframes.</li>
</ul>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="1">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://lktuan.github.io/blog/2024-10-25-CEE-in-practice/12_take_aways.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption>take aways</figcaption>
</figure>
</div>
</div>
</div>
</div>
<p>The speech concludes by highlighting that while causal inference in practice may not always match theoretical ideals, careful application of basic principles, combined with practical business understanding, can still provide valuable insights for decision-making.</p>
<p>Summary with the help of <a href="https://claude.ai/"><strong>Claude 3.5 Sonnet</strong></a>. Happy exploring!</p>


<!-- -->

</section>

 ]]></description>
  <category>causal inference</category>
  <guid>https://lktuan.github.io/blog/2024-10-25-CEE-in-practice/</guid>
  <pubDate>Thu, 24 Oct 2024 17:00:00 GMT</pubDate>
  <media:content url="https://lktuan.github.io/blog/2024-10-25-CEE-in-practice/causal_inf.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>DAX exercises by WiseOwl Training</title>
  <dc:creator>Tuan Le Khac</dc:creator>
  <link>https://lktuan.github.io/blog/2024-09-30-DAX-practices/</link>
  <description><![CDATA[ 





<p>Link to the challenge: <a href="https://www.wiseowl.co.uk/power-bi/exercises/dax/" class="uri">https://www.wiseowl.co.uk/power-bi/exercises/dax/</a></p>
<section id="calculated-columns" class="level1">
<h1>1. <a href="https://www.wiseowl.co.uk/power-bi/exercises/dax/calculated-columns/">Calculated columns</a></h1>
<p>Including 11 exercises:</p>
<section id="operations-in-row-context" class="level4">
<h4 class="anchored" data-anchor-id="operations-in-row-context">1 <a href="https://www.wiseowl.co.uk/power-bi/exercises/dax/calculated-columns/5086/">Operations in Row context</a></h4>
<p>Itâ€™s pretty simple to calculate the <em>total floors</em>, just find the <strong>New column</strong> under <strong>Table tools</strong>, and sum the floors up:</p>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode numberSource txt number-lines code-with-copy"><code class="sourceCode default"><span id="cb1-1">Total floors = Building[Floors above ground] + Building[Floors below ground]</span></code></pre></div>
</section>
<section id="div0" class="level4">
<h4 class="anchored" data-anchor-id="div0">2 <a href="https://www.wiseowl.co.uk/power-bi/exercises/dax/calculated-columns/4409/">!DIV0</a></h4>
<p>And for <em>Average floor height</em>, we just need to use â€œ/â€, or better practice, use <code>DIVIDE()</code>:</p>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode numberSource txt number-lines code-with-copy"><code class="sourceCode default"><span id="cb2-1">Average floor height = Building[Height m] / Building[Floors above ground]</span>
<span id="cb2-2"></span>
<span id="cb2-3">-- or</span>
<span id="cb2-4"></span>
<span id="cb2-5">Average floor height = DIVIDE(Building[Height m], Building[Floors above ground])</span></code></pre></div>
<p>For each column, we have column tools to format the data.</p>
</section>
<section id="flow-control-with-if-and-switch" class="level4">
<h4 class="anchored" data-anchor-id="flow-control-with-if-and-switch">3 <a href="https://www.wiseowl.co.uk/power-bi/exercises/dax/calculated-columns/5089/">Flow control with <code>IF()</code> and <code>SWITCH()</code></a></h4>
<p>The <code>IF()</code> in DAX row context is pretty the same with Excel!</p>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode numberSource txt number-lines code-with-copy"><code class="sourceCode default"><span id="cb3-1">Has basement = IF(Building[Floors below ground] &gt; 0, "Yes", "No")</span>
<span id="cb3-2">Century = IF(Building[Year Opened] &lt; 2001, "20th Century", "21st Century")</span></code></pre></div>
<p>Do you ever use <code>SWITCH()</code> in Excel, itâ€™s the same in PBI:</p>
<div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode numberSource txt number-lines code-with-copy"><code class="sourceCode default"><span id="cb4-1">Category =</span>
<span id="cb4-2">SWITCH (</span>
<span id="cb4-3">    TRUE (),</span>
<span id="cb4-4">    Building[Height m] &lt; 400, "Tiny",</span>
<span id="cb4-5">    Building[Height m] &lt; 500, "Small",</span>
<span id="cb4-6">    Building[Height m] &lt; 600, "Medium",</span>
<span id="cb4-7">    Building[Height m] &lt; 700, "Big",</span>
<span id="cb4-8">    "Large"</span>
<span id="cb4-9">)</span></code></pre></div>
</section>
<section id="more-operations" class="level4">
<h4 class="anchored" data-anchor-id="more-operations">4 <a href="https://www.wiseowl.co.uk/power-bi/exercises/dax/calculated-columns/5088/">More operations</a></h4>
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode numberSource txt number-lines code-with-copy"><code class="sourceCode default"><span id="cb5-1"># This is simple</span>
<span id="cb5-2">Tour length = Tour[End year] - Tour[Start year] + 1</span>
<span id="cb5-3"></span>
<span id="cb5-4"># With division operation, it's recommended to use DIVIDE() function:</span>
<span id="cb5-5">Shows per year = DIVIDE(Tour[Shows], Tour[Tour length])</span>
<span id="cb5-6">Avg show revenue = DIVIDE(Tour[Actual gross], Tour[Shows])</span>
<span id="cb5-7">Avg attendance = DIVIDE(Tour[Attendance], Tour[Shows])</span>
<span id="cb5-8">Avg ticket price = DIVIDE(Tour[Actual gross], Tour[Attendance])</span></code></pre></div>
</section>
<section id="using-of-related" class="level4">
<h4 class="anchored" data-anchor-id="using-of-related">5 <a href="https://www.wiseowl.co.uk/power-bi/exercises/dax/calculated-columns/5091/">Using of <code>RELATED()</code></a></h4>
<p>We can use â€œ<strong>&amp;</strong>â€ or the <code>CONCANATE()</code> function to join texts (in row context), and use <code>RELATED()</code> to get data from other tables with a relationship set up.</p>
<div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode numberSource txt number-lines code-with-copy"><code class="sourceCode default"><span id="cb6-1">Name and location = CONCATENATE(Building[Building Name] &amp; ", ", RELATED(City[City]))</span>
<span id="cb6-2"></span>
<span id="cb6-3">-- or if we want to include the Country name</span>
<span id="cb6-4"></span>
<span id="cb6-5">Name and location =</span>
<span id="cb6-6">CONCATENATE (</span>
<span id="cb6-7">    Building[Building Name] &amp; ", ",</span>
<span id="cb6-8">    RELATED ( City[City] ) &amp; ", "</span>
<span id="cb6-9">        &amp; RELATED ( Country[Country] )</span>
<span id="cb6-10">)</span></code></pre></div>
</section>
<section id="handling-mismatch-with-related" class="level4">
<h4 class="anchored" data-anchor-id="handling-mismatch-with-related">6 <a href="https://www.wiseowl.co.uk/power-bi/exercises/dax/calculated-columns/4410/">Handling mismatch with <code>RELATED()</code></a></h4>
<p>We can use <code>RELATED()</code> and <code>ISBLANK()</code> to refer and check if there any matching record is returned.</p>
<div class="sourceCode" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode numberSource txt number-lines code-with-copy"><code class="sourceCode default"><span id="cb7-1">Quadrant =</span>
<span id="cb7-2">IF (</span>
<span id="cb7-3">    ISBLANK ( RELATED ( Quadrants[QuadrantName] ) ),</span>
<span id="cb7-4">    "No quadrant found",</span>
<span id="cb7-5">    RELATED ( Quadrants[QuadrantName] )</span>
<span id="cb7-6">)</span>
<span id="cb7-7"></span>
<span id="cb7-8">Region =</span>
<span id="cb7-9">IF (</span>
<span id="cb7-10">    ISBLANK ( RELATED ( Regions[RegionName] ) ),</span>
<span id="cb7-11">    "No region assigned",</span>
<span id="cb7-12">    RELATED ( Regions[RegionName] )</span>
<span id="cb7-13">)</span></code></pre></div>
</section>
<section id="more-on-related" class="level4">
<h4 class="anchored" data-anchor-id="more-on-related">6 <a href="https://www.wiseowl.co.uk/power-bi/exercises/dax/calculated-columns/5092/">More on <code>RELATED()</code></a></h4>
</section>
<section id="context-transition-in-calculated-column" class="level4">
<h4 class="anchored" data-anchor-id="context-transition-in-calculated-column">7 <a href="https://www.wiseowl.co.uk/power-bi/exercises/dax/calculated-columns/4417/">Context transition in calculated column</a></h4>
<p>The first one <em>Total sales</em> was calculated in <strong>Products</strong> table, simply interate all the table <strong>Purchase</strong>, multiply <em>quanity</em> by <em>price</em> to get the entire revenue:</p>
<div class="sourceCode" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode numberSource txt number-lines code-with-copy"><code class="sourceCode default"><span id="cb8-1">Total Sales = SUMX(Purchase, Purchase[Quantity] * Purchase[Price])</span></code></pre></div>
<p>The second one - <em>Sales for product</em>, we want to calculate the coresponding sales for each product at the current row, so we just <strong>wrap</strong> the <code>CALCULATE()</code> function for the <strong>context transition</strong>:</p>
<div class="sourceCode" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode numberSource txt number-lines code-with-copy"><code class="sourceCode default"><span id="cb9-1">Sales for product =</span>
<span id="cb9-2">CALCULATE (</span>
<span id="cb9-3">    SUMX ( Purchase, Purchase[Quantity] * Purchase[Price] )</span>
<span id="cb9-4">)</span></code></pre></div>
<p>And the final one:</p>
<div class="sourceCode" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode numberSource txt number-lines code-with-copy"><code class="sourceCode default"><span id="cb10-1">Product contribution = DIVIDE([Sales for product],[Total sales])</span></code></pre></div>
</section>
</section>
<section id="basic-measures" class="level1">
<h1>2. <a href="https://www.wiseowl.co.uk/power-bi/exercises/dax/basic-measures/">Basic measures</a></h1>
<p>Including 5 exercises:</p>
</section>
<section id="the-calculate-function" class="level1">
<h1>3. <a href="https://www.wiseowl.co.uk/power-bi/exercises/dax/filtering/">The <code>CALCULATE()</code> function</a></h1>
<p>Including 16 exercises</p>
</section>
<section id="the-values-function" class="level1">
<h1>4. <a href="https://www.wiseowl.co.uk/power-bi/exercises/dax/values-function/">The <code>VALUES()</code> function</a></h1>
<p>Including 7 exercises</p>
</section>
<section id="the-filter-function" class="level1">
<h1>5. <a href="https://www.wiseowl.co.uk/power-bi/exercises/dax/filter/">The <code>FILTER()</code> function</a></h1>
<p>Including 4 exercises</p>
</section>
<section id="understanding-earlier" class="level1">
<h1>6. <a href="https://www.wiseowl.co.uk/power-bi/exercises/dax/understanding-earlier/">Understanding <code>EARLIER()</code></a></h1>
<p>Including 2 exercises</p>
</section>
<section id="calendars-and-dates" class="level1">
<h1>7. <a href="https://www.wiseowl.co.uk/power-bi/exercises/dax/calendars-and-dates/">Calendars and dates</a></h1>
<p>Including 8 exercises</p>
</section>
<section id="advanced-date-functions" class="level1">
<h1>8. <a href="https://www.wiseowl.co.uk/power-bi/exercises/dax/advanced-date-functions/">Advanced date functions</a></h1>
<p>Including 1 exercise</p>
</section>
<section id="dax-queries" class="level1">
<h1>9. <a href="https://www.wiseowl.co.uk/power-bi/exercises/dax/dax-queries/">DAX queries</a></h1>
<p>Including 2 exercises</p>
</section>
<section id="variables" class="level1">
<h1>10. <a href="https://www.wiseowl.co.uk/power-bi/exercises/dax/variables/">Variables</a></h1>
<p>Including 3 exercises</p>


<!-- -->

</section>

 ]]></description>
  <category>math</category>
  <guid>https://lktuan.github.io/blog/2024-09-30-DAX-practices/</guid>
  <pubDate>Sun, 29 Sep 2024 17:00:00 GMT</pubDate>
  <media:content url="https://lktuan.github.io/blog/2024-09-30-DAX-practices/wise_owl.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>Reactive dashboard with Shiny in Python</title>
  <dc:creator>Tuan Le Khac</dc:creator>
  <link>https://lktuan.github.io/blog/2024-09-09-python-shiny/</link>
  <description><![CDATA[ 





<section id="set-up-play-with-a-template" class="level1">

</section>
<section id="build-from-the-scratch" class="level1">
<h1>Build from the scratch</h1>
<section id="simple-ui" class="level2">
<h2 class="anchored" data-anchor-id="simple-ui">Simple <code>ui</code></h2>
<div id="751de049" class="cell" data-execution_count="1">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> shiny.express <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> ui</span>
<span id="cb1-2"></span>
<span id="cb1-3">ui.h1(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"My Dashboard"</span>)</span>
<span id="cb1-4"></span>
<span id="cb1-5">ui.p(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"This is sometext"</span>)</span></code></pre></div>
</details>
</div>
</section>
<section id="lets-render-something" class="level2">
<h2 class="anchored" data-anchor-id="lets-render-something">Letâ€™s <code>render</code> something</h2>
<div id="495f4bbe" class="cell" data-execution_count="2">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb2-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> shiny.express <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> ui, render</span>
<span id="cb2-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> pathlib <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Path</span>
<span id="cb2-3"></span>
<span id="cb2-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> pandas <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> pd</span>
<span id="cb2-5"></span>
<span id="cb2-6">file_path <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Path(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">__file__</span>).parent <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"penguins.csv"</span></span>
<span id="cb2-7">df <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pd.read_csv(file_path)</span>
<span id="cb2-8"></span>
<span id="cb2-9">ui.h1(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"My Dashboard"</span>)</span>
<span id="cb2-10"></span>
<span id="cb2-11">ui.p(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"This is sometext"</span>)</span>
<span id="cb2-12"></span>
<span id="cb2-13"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">@render.data_frame</span></span>
<span id="cb2-14"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> data():    </span>
<span id="cb2-15">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> df</span></code></pre></div>
</details>
</div>
</section>
<section id="lets-create-a-filter-input" class="level2">
<h2 class="anchored" data-anchor-id="lets-create-a-filter-input">Letâ€™s create a filter, <code>input</code></h2>


<!-- -->

</section>
</section>

 ]]></description>
  <category>math</category>
  <guid>https://lktuan.github.io/blog/2024-09-09-python-shiny/</guid>
  <pubDate>Sun, 08 Sep 2024 17:00:00 GMT</pubDate>
  <media:content url="https://lktuan.github.io/blog/2024-09-09-python-shiny/python_shiny.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>Note on Mathematics as the Universal Language of Nature</title>
  <dc:creator>Tuan Le Khac</dc:creator>
  <link>https://lktuan.github.io/blog/2024-08-08-note-muln/</link>
  <description><![CDATA[ 





<p>mÃ¬nh nghe bÃ i nÃ³i chuyá»‡n â€œMathematics as the Universal Language of Natureâ€ cá»§a R. Seiringer, tá»• chá»©c táº¡i TrÆ°á»ng Äáº¡i há»c SÆ° pháº¡m Huáº¿, ngÃ y 8 thÃ¡ng 8 nÄƒm 2024. DÆ°á»›i Ä‘Ã¢y lÃ  note cá»§a mÃ¬nh.</p>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="1">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://lktuan.github.io/blog/2024-08-08-note-muln/talk_cover.png" class="img-fluid figure-img"></p>
<figcaption>talk cover</figcaption>
</figure>
</div>
</div>
</div>
</div>
<p>Robert lÃ  1 giÃ¡o sÆ° chuyÃªn, Ä‘áº§u ngÃ nh vá» ToÃ¡n vÃ  Váº­t lÃ½, tá»«ng giáº£ng dáº¡y táº¡i Princeton, hiá»‡n nay cÃ´ng tÃ¡c táº¡i Viá»‡n Ká»¹ Thuáº­t vÃ  Khoa há»c cá»§a Ão. BÃ i giáº£ng nÃ y cá»§a giÃ¡o sÆ° nháº±m nÃªu báº­t váº» Ä‘áº¹p cá»§a ToÃ¡n vÃ  Váº­t lÃ½, dÃ¹ng ToÃ¡n Ä‘á»ƒ giáº£i thÃ­ch tá»± nhiÃªn.</p>
<section id="history" class="level1">
<h1>History</h1>
<ul>
<li>Newton: calculus, motion of earth around the sun, theory of gravity;</li>
<li>Fourier: Fourier series to understand hear transfer &amp; conduction (also green house effect!);</li>
<li>Rieman: thuyáº¿t tÆ°Æ¡ng Ä‘á»‘i tá»•ng quÃ¡t, lÃ½ thuyáº¿t trÆ°á»ng lÆ°á»£ng tá»­, lÃ½ thuyáº¿t dÃ¢y.</li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
green house effect
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Jean-Baptiste Joseph Fourier, nhÃ  toÃ¡n há»c vÃ  váº­t lÃ½ há»c ngÆ°á»i PhÃ¡p, lÃ  ngÆ°á»i Ä‘áº§u tiÃªn mÃ´ táº£ hiá»‡u á»©ng nhÃ  kÃ­nh (greenhouse effect) vÃ o nÄƒm 1824. HÃ£y giáº£i thÃ­ch vá» khÃ¡i niá»‡m nÃ y:</p>
<ol type="1">
<li><p><strong>Äá»‹nh nghÄ©a:</strong> Hiá»‡u á»©ng nhÃ  kÃ­nh cá»§a Fourier Ä‘á» cáº­p Ä‘áº¿n quÃ¡ trÃ¬nh mÃ  khÃ­ quyá»ƒn cá»§a TrÃ¡i Äáº¥t giá»¯ nhiá»‡t, lÃ m cho bá» máº·t hÃ nh tinh áº¥m hÆ¡n so vá»›i trÆ°á»ng há»£p khÃ´ng cÃ³ khÃ­ quyá»ƒn.</p></li>
<li><p><strong>CÆ¡ cháº¿ cÆ¡ báº£n:</strong></p></li>
</ol>
<ol type="a">
<li><p>Bá»©c xáº¡ máº·t trá»i Ä‘i qua khÃ­ quyá»ƒn vÃ  Ä‘Æ°á»£c háº¥p thá»¥ bá»Ÿi bá» máº·t TrÃ¡i Äáº¥t.</p></li>
<li><p>TrÃ¡i Äáº¥t phÃ¡t ra bá»©c xáº¡ há»“ng ngoáº¡i (nhiá»‡t).</p></li>
<li><p>Má»™t pháº§n bá»©c xáº¡ nÃ y bá»‹ cÃ¡c khÃ­ nhÃ  kÃ­nh trong khÃ­ quyá»ƒn háº¥p thá»¥ vÃ  tÃ¡i phÃ¡t ra theo má»i hÆ°á»›ng.</p></li>
<li><p>QuÃ¡ trÃ¬nh nÃ y giá»¯ nhiá»‡t trong khÃ­ quyá»ƒn, lÃ m tÄƒng nhiá»‡t Ä‘á»™ trung bÃ¬nh cá»§a TrÃ¡i Äáº¥t.</p></li>
</ol>
<ol start="3" type="1">
<li><strong>ÄÃ³ng gÃ³p cá»§a Fourier:</strong></li>
</ol>
<ul>
<li>Fourier nháº­n ra ráº±ng khÃ­ quyá»ƒn Ä‘Ã³ng vai trÃ² nhÆ° má»™t â€œtáº¥m chÄƒnâ€, giá»¯ nhiá»‡t cho TrÃ¡i Äáº¥t.</li>
<li>Ã”ng so sÃ¡nh quÃ¡ trÃ¬nh nÃ y vá»›i cÃ¡ch hoáº¡t Ä‘á»™ng cá»§a nhÃ  kÃ­nh trá»“ng cÃ¢y.</li>
</ul>
<ol start="4" type="1">
<li><strong>Táº§m quan trá»ng:</strong></li>
</ol>
<ul>
<li>Hiá»‡u á»©ng nhÃ  kÃ­nh tá»± nhiÃªn lÃ m cho TrÃ¡i Äáº¥t cÃ³ thá»ƒ á»Ÿ Ä‘Æ°á»£c, duy trÃ¬ nhiá»‡t Ä‘á»™ trung bÃ¬nh khoáº£ng 15Â°C thay vÃ¬ -18Â°C náº¿u khÃ´ng cÃ³ nÃ³.</li>
<li>Hiá»ƒu biáº¿t nÃ y Ä‘áº·t ná»n mÃ³ng cho nghiÃªn cá»©u vá» biáº¿n Ä‘á»•i khÃ­ háº­u hiá»‡n Ä‘áº¡i.</li>
</ul>
<ol start="5" type="1">
<li><strong>PhÃ¡t triá»ƒn sau nÃ y:</strong></li>
</ol>
<ul>
<li>John Tyndall (1859) xÃ¡c Ä‘á»‹nh cÃ¡c khÃ­ cá»¥ thá»ƒ gÃ¢y ra hiá»‡u á»©ng nhÃ  kÃ­nh.</li>
<li>Svante Arrhenius (1896) tÃ­nh toÃ¡n Ä‘á»‹nh lÆ°á»£ng áº£nh hÆ°á»Ÿng cá»§a CO2 Ä‘á»‘i vá»›i nhiá»‡t Ä‘á»™ TrÃ¡i Äáº¥t.</li>
</ul>
<ol start="6" type="1">
<li><strong>KhÃ¡c biá»‡t vá»›i hiá»ƒu biáº¿t hiá»‡n Ä‘áº¡i:</strong></li>
</ol>
<ul>
<li>Fourier chÆ°a biáº¿t vá» cÃ¡c khÃ­ nhÃ  kÃ­nh cá»¥ thá»ƒ hoáº·c cÆ¡ cháº¿ phÃ¢n tá»­ cá»§a quÃ¡ trÃ¬nh nÃ y.</li>
<li>Hiá»ƒu biáº¿t hiá»‡n Ä‘áº¡i vá» hiá»‡u á»©ng nhÃ  kÃ­nh phá»©c táº¡p hÆ¡n nhiá»u, bao gá»“m cÃ¡c pháº£n há»“i vÃ  tÆ°Æ¡ng tÃ¡c khÃ­ háº­u.</li>
</ul>
<ol start="7" type="1">
<li><strong>Ã nghÄ©a lá»‹ch sá»­:</strong></li>
</ol>
<ul>
<li>CÃ´ng trÃ¬nh cá»§a Fourier Ä‘áº·t ná»n mÃ³ng cho khoa há»c khÃ­ háº­u hiá»‡n Ä‘áº¡i vÃ  hiá»ƒu biáº¿t cá»§a chÃºng ta vá» cÃ¡ch TrÃ¡i Äáº¥t duy trÃ¬ nhiá»‡t Ä‘á»™.</li>
</ul>
<p>Hiá»‡u á»©ng nhÃ  kÃ­nh cá»§a Fourier lÃ  má»™t vÃ­ dá»¥ tuyá»‡t vá»i vá» cÃ¡ch má»™t khÃ¡i niá»‡m khoa há»c cÆ¡ báº£n cÃ³ thá»ƒ dáº«n Ä‘áº¿n nhá»¯ng hiá»ƒu biáº¿t sÃ¢u sáº¯c vá» há»‡ thá»‘ng TrÃ¡i Äáº¥t vÃ  cuá»‘i cÃ¹ng áº£nh hÆ°á»Ÿng Ä‘áº¿n chÃ­nh sÃ¡ch toÃ n cáº§u vá» biáº¿n Ä‘á»•i khÃ­ háº­u.</p>
</div>
</div>
</div>
</section>
<section id="math-desc.-of-laws-of-nature" class="level1">
<h1>Math Desc. of Laws of Nature</h1>
<p>the unreasonable effectiveness of math in the natural sciences (Eugene P. Wigner), formulation of the basic laws of nature in mathematically precise terms.</p>
<p>vÃ­ dá»¥: PhÆ°Æ¡ng trÃ¬nh Schrodinger -&gt; Ã¡p dá»¥ng tá»« atomic nuclei to neutron stars.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
PhÆ°Æ¡ng TrÃ¬nh SchrÃ¶dinger: CÃ¡nh Cá»­a VÃ o Tháº¿ Giá»›i LÆ°á»£ng Tá»­
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>PhÆ°Æ¡ng trÃ¬nh SchrÃ¶dinger lÃ  má»™t phÆ°Æ¡ng trÃ¬nh vi phÃ¢n tá»«ng pháº§n cÆ¡ báº£n trong cÆ¡ há»c lÆ°á»£ng tá»­, Ä‘Æ°á»£c Ä‘áº·t tÃªn theo nhÃ  váº­t lÃ½ Erwin SchrÃ¶dinger. NÃ³ mÃ´ táº£ sá»± biáº¿n Ä‘á»•i theo thá»i gian cá»§a hÃ m sÃ³ng cá»§a má»™t há»‡ lÆ°á»£ng tá»­. HÃ m sÃ³ng nÃ y chá»©a Ä‘á»±ng táº¥t cáº£ thÃ´ng tin vá» tráº¡ng thÃ¡i cá»§a há»‡ thá»‘ng, bao gá»“m cáº£ vá»‹ trÃ­, Ä‘á»™ng lÆ°á»£ng vÃ  cÃ¡c tÃ­nh cháº¥t khÃ¡c.</p>
<p><strong>Ã nghÄ©a Váº­t lÃ½</strong></p>
<ul>
<li>MÃ´ táº£ sá»± chuyá»ƒn Ä‘á»™ng cá»§a cÃ¡c háº¡t á»Ÿ cáº¥p Ä‘á»™ lÆ°á»£ng tá»­: Náº¿u trong cÆ¡ há»c cá»• Ä‘iá»ƒn, chÃºng ta sá»­ dá»¥ng cÃ¡c phÆ°Æ¡ng trÃ¬nh Newton Ä‘á»ƒ mÃ´ táº£ chuyá»ƒn Ä‘á»™ng cá»§a cÃ¡c váº­t thá»ƒ, thÃ¬ trong cÆ¡ há»c lÆ°á»£ng tá»­, phÆ°Æ¡ng trÃ¬nh SchrÃ¶dinger Ä‘Ã³ng vai trÃ² tÆ°Æ¡ng tá»±. NÃ³ cho phÃ©p chÃºng ta tÃ­nh toÃ¡n xÃ¡c suáº¥t tÃ¬m tháº¥y má»™t háº¡t táº¡i má»™t vá»‹ trÃ­ nÃ o Ä‘Ã³ táº¡i má»™t thá»i Ä‘iá»ƒm nháº¥t Ä‘á»‹nh.</li>
<li>HÃ m sÃ³ng: HÃ m sÃ³ng khÃ´ng pháº£i lÃ  má»™t Ä‘áº¡i lÆ°á»£ng váº­t lÃ½ cÃ³ thá»ƒ Ä‘o trá»±c tiáº¿p, mÃ  lÃ  má»™t hÃ m toÃ¡n há»c phá»©c. BÃ¬nh phÆ°Æ¡ng mÃ´ Ä‘un cá»§a hÃ m sÃ³ng táº¡i má»™t Ä‘iá»ƒm trong khÃ´ng gian cho ta xÃ¡c suáº¥t tÃ¬m tháº¥y háº¡t táº¡i Ä‘iá»ƒm Ä‘Ã³.</li>
</ul>
<p><strong>á»¨ng dá»¥ng cá»§a PhÆ°Æ¡ng TrÃ¬nh SchrÃ¶dinger</strong>. PhÆ°Æ¡ng trÃ¬nh SchrÃ¶dinger cÃ³ á»©ng dá»¥ng rá»™ng rÃ£i trong nhiá»u lÄ©nh vá»±c cá»§a váº­t lÃ½, bao gá»“m:</p>
<ul>
<li>Váº­t lÃ½ nguyÃªn tá»­: DÃ¹ng Ä‘á»ƒ mÃ´ táº£ cáº¥u trÃºc cá»§a nguyÃªn tá»­, phÃ¢n tá»­ vÃ  tÃ­nh toÃ¡n cÃ¡c má»©c nÄƒng lÆ°á»£ng cá»§a chÃºng.</li>
<li>Váº­t lÃ½ háº¡t nhÃ¢n: Ãp dá»¥ng Ä‘á»ƒ nghiÃªn cá»©u cáº¥u trÃºc cá»§a háº¡t nhÃ¢n nguyÃªn tá»­ vÃ  cÃ¡c quÃ¡ trÃ¬nh tÆ°Æ¡ng tÃ¡c háº¡t nhÃ¢n.</li>
<li>Váº­t lÃ½ cháº¥t ráº¯n: ÄÆ°á»£c sá»­ dá»¥ng Ä‘á»ƒ mÃ´ táº£ cÃ¡c tÃ­nh cháº¥t Ä‘iá»‡n, tá»«, vÃ  quang há»c cá»§a váº­t liá»‡u.</li>
<li>Váº­t lÃ½ thiÃªn vÄƒn: Ãp dá»¥ng Ä‘á»ƒ nghiÃªn cá»©u cÃ¡c váº­t thá»ƒ thiÃªn vÄƒn nhÆ° sao, tinh vÃ¢n vÃ  lá»— Ä‘en.</li>
</ul>
<p><strong>Táº¡i Sao PhÆ°Æ¡ng TrÃ¬nh SchrÃ¶dinger Ãp Dá»¥ng Rá»™ng RÃ£i?</strong></p>
<ul>
<li>TÃ­nh phá»• quÃ¡t: PhÆ°Æ¡ng trÃ¬nh SchrÃ¶dinger lÃ  má»™t phÆ°Æ¡ng trÃ¬nh cÆ¡ báº£n, Ã¡p dá»¥ng cho má»i há»‡ lÆ°á»£ng tá»­, tá»« cÃ¡c háº¡t Ä‘Æ¡n láº» Ä‘áº¿n cÃ¡c há»‡ phá»©c táº¡p nhÆ° nguyÃªn tá»­, phÃ¢n tá»­ vÃ  váº­t liá»‡u ráº¯n.</li>
<li>Äá»™ chÃ­nh xÃ¡c cao: CÃ¡c káº¿t quáº£ tÃ­nh toÃ¡n dá»±a trÃªn phÆ°Æ¡ng trÃ¬nh SchrÃ¶dinger Ä‘Ã£ Ä‘Æ°á»£c kiá»ƒm nghiá»‡m thá»±c nghiá»‡m má»™t cÃ¡ch chÃ­nh xÃ¡c cao, kháº³ng Ä‘á»‹nh tÃ­nh Ä‘Ãºng Ä‘áº¯n cá»§a lÃ½ thuyáº¿t lÆ°á»£ng tá»­.</li>
<li>Kháº£ nÄƒng dá»± Ä‘oÃ¡n: PhÆ°Æ¡ng trÃ¬nh SchrÃ¶dinger cho phÃ©p chÃºng ta dá»± Ä‘oÃ¡n káº¿t quáº£ cá»§a cÃ¡c thÃ­ nghiá»‡m lÆ°á»£ng tá»­, tá»« Ä‘Ã³ má»Ÿ ra nhiá»u á»©ng dá»¥ng trong cÃ´ng nghá»‡ hiá»‡n Ä‘áº¡i.</li>
</ul>
<p><strong>Tá»« NguyÃªn Tá»­ Ä‘áº¿n Sao Neutron</strong></p>
<ul>
<li>NguyÃªn tá»­: PhÆ°Æ¡ng trÃ¬nh SchrÃ¶dinger Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ mÃ´ táº£ sá»± chuyá»ƒn Ä‘á»™ng cá»§a electron xung quanh háº¡t nhÃ¢n, tá»« Ä‘Ã³ giáº£i thÃ­ch quang phá»• nguyÃªn tá»­ vÃ  cÃ¡c tÃ­nh cháº¥t hÃ³a há»c cá»§a cÃ¡c nguyÃªn tá»‘.</li>
<li>Háº¡t nhÃ¢n: PhÆ°Æ¡ng trÃ¬nh SchrÃ¶dinger (á»Ÿ dáº¡ng tÆ°Æ¡ng Ä‘á»‘i tÃ­nh) Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ mÃ´ táº£ cáº¥u trÃºc cá»§a háº¡t nhÃ¢n nguyÃªn tá»­, cÃ¡c tÆ°Æ¡ng tÃ¡c giá»¯a cÃ¡c nucleon (proton vÃ  neutron) bÃªn trong háº¡t nhÃ¢n.</li>
<li>Sao neutron: Sao neutron lÃ  nhá»¯ng ngÃ´i sao Ä‘Ã£ cháº¿t, cá»±c ká»³ Ä‘áº·c, chá»§ yáº¿u gá»“m cÃ¡c neutron. Máº·c dÃ¹ cáº¥u trÃºc bÃªn trong cá»§a sao neutron ráº¥t phá»©c táº¡p, nhÆ°ng cÃ¡c nhÃ  váº­t lÃ½ váº«n sá»­ dá»¥ng cÃ¡c phiÃªn báº£n má»Ÿ rá»™ng cá»§a phÆ°Æ¡ng trÃ¬nh SchrÃ¶dinger Ä‘á»ƒ mÃ´ táº£ hÃ nh vi cá»§a váº­t cháº¥t trong Ä‘iá»u kiá»‡n cá»±c Ä‘oan bÃªn trong sao neutron.</li>
</ul>
<p><strong>TÃ³m láº¡i</strong>, phÆ°Æ¡ng trÃ¬nh SchrÃ¶dinger lÃ  má»™t cÃ´ng cá»¥ toÃ¡n há»c máº¡nh máº½, cho phÃ©p chÃºng ta hiá»ƒu sÃ¢u sáº¯c vá» tháº¿ giá»›i lÆ°á»£ng tá»­. Sá»± thÃ nh cÃ´ng cá»§a phÆ°Æ¡ng trÃ¬nh nÃ y trong viá»‡c giáº£i thÃ­ch cÃ¡c hiá»‡n tÆ°á»£ng tá»« cáº¥p Ä‘á»™ nguyÃªn tá»­ Ä‘áº¿n cáº¥p Ä‘á»™ vÅ© trá»¥ Ä‘Ã£ kháº³ng Ä‘á»‹nh vá»‹ trÃ­ trung tÃ¢m cá»§a nÃ³ trong ná»n táº£ng cá»§a váº­t lÃ½ hiá»‡n Ä‘áº¡i.</p>
</div>
</div>
</div>
</section>
<section id="technology-development" class="level1">
<h1>Technology Development</h1>
<p>How quantum mechanic works, itâ€™s understanding from human lies at the heart of technological advances in the past century</p>
<ul>
<li>phone</li>
<li>computer</li>
<li>satellite</li>
<li>â€¦</li>
</ul>
</section>
<section id="complexity" class="level1">
<h1>Complexity</h1>
<p>the more basic physical laws are stated, the more complex be allowed for calculating their solution.</p>
<p>eg: description of the air in this lecture room, there will me rought ly 10^30 parameters</p>
<p>eg: phase transitions -&gt; one small change in systemâ€™s params lead to a masive change of its behaviour.</p>
<p>read more: â€œMore is Different - broken symertry and the nature of hierarchical structure of scienceâ€ â€“ P. W. Anderson â€“ (<a href="https://inters.org/files/more-is-different.pdf">link</a>).</p>
</section>
<section id="aims-of-mathematical-physics" class="level1">
<h1>Aims of Mathematical Physics</h1>
<ul>
<li>dev new math tools, allowing deduction of â€¦</li>
<li>improve understanding of physical systems, dÆ°á»›i nhiá»u gÃ³c nhÃ¬n hÆ¡n.</li>
</ul>
<p>eg: <strong>fruitful interaction</strong>, ToÃ¡n lÃ  ná»n táº£ng, LÃ½ thá»ƒ hiá»‡n cÃ¡c cÃ¢u há»i má»™t cÃ¡ch tá»± nhiÃªn Ä‘á»ƒ mang láº¡i sá»± phÃ¡t triá»ƒn cho sá»± khÃ¡m phÃ¡ ToÃ¡n há»c.</p>
</section>
<section id="stability-of-atoms" class="level1">
<h1>Stability of Atoms</h1>
<p>Táº¡i sao electron khÃ´ng spiral vÃ o nguyÃªn tá»­, giáº£i phÃ³ng má»™t nÄƒng lÆ°á»£ng vÃ´ háº¡n.</p>
<ul>
<li>Heisenberg uncertainty principle</li>
<li>In math, non-commutativity impliesâ€¦</li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://lktuan.github.io/blog/2024-08-08-note-muln/stability_of_atoms.png" class="img-fluid figure-img"></p>
<figcaption>stability of atoms</figcaption>
</figure>
</div>
<p>? electromagtic radiation</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
electromagtic radiation
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Bá»©c xáº¡ Ä‘iá»‡n tá»« lÃ  má»™t dáº¡ng nÄƒng lÆ°á»£ng truyá»n Ä‘i dÆ°á»›i dáº¡ng sÃ³ng Ä‘iá»‡n tá»«. SÃ³ng Ä‘iá»‡n tá»« nÃ y bao gá»“m cáº£ trÆ°á»ng Ä‘iá»‡n tá»« vÃ  trÆ°á»ng tá»« trÆ°á»ng dao Ä‘á»™ng vuÃ´ng gÃ³c vá»›i nhau vÃ  vuÃ´ng gÃ³c vá»›i phÆ°Æ¡ng truyá»n sÃ³ng.</p>
<p><strong>Äáº·c Ä‘iá»ƒm chÃ­nh cá»§a bá»©c xáº¡ Ä‘iá»‡n tá»«:</strong></p>
<ul>
<li>Tá»‘c Ä‘á»™: Táº¥t cáº£ cÃ¡c sÃ³ng Ä‘iá»‡n tá»« Ä‘á»u truyá»n Ä‘i vá»›i tá»‘c Ä‘á»™ Ã¡nh sÃ¡ng trong chÃ¢n khÃ´ng (khoáº£ng 3 x 10^8 m/s).</li>
<li>Táº§n sá»‘ vÃ  bÆ°á»›c sÃ³ng: CÃ¡c sÃ³ng Ä‘iá»‡n tá»« khÃ¡c nhau bá»Ÿi táº§n sá»‘ (sá»‘ láº§n dao Ä‘á»™ng trong má»™t giÃ¢y) vÃ  bÆ°á»›c sÃ³ng (khoáº£ng cÃ¡ch giá»¯a hai Ä‘á»‰nh sÃ³ng liÃªn tiáº¿p).</li>
<li>Phá»• Ä‘iá»‡n tá»«: Phá»• Ä‘iá»‡n tá»« lÃ  má»™t dáº£i liÃªn tá»¥c cÃ¡c loáº¡i bá»©c xáº¡ Ä‘iá»‡n tá»«, tá»« sÃ³ng vÃ´ tuyáº¿n cÃ³ bÆ°á»›c sÃ³ng dÃ i Ä‘áº¿n tia gamma cÃ³ bÆ°á»›c sÃ³ng ngáº¯n.</li>
<li>TÃ­nh cháº¥t sÃ³ng-háº¡t lÆ°á»¡ng tÃ­nh: Bá»©c xáº¡ Ä‘iá»‡n tá»« thá»ƒ hiá»‡n cáº£ tÃ­nh cháº¥t sÃ³ng (giao thoa, nhiá»…u xáº¡) vÃ  tÃ­nh cháº¥t háº¡t (hiá»‡u á»©ng quang Ä‘iá»‡n).</li>
</ul>
<p><strong>CÃ¡c loáº¡i bá»©c xáº¡ Ä‘iá»‡n tá»« phá»• biáº¿n:</strong></p>
<ul>
<li>SÃ³ng vÃ´ tuyáº¿n: Sá»­ dá»¥ng trong truyá»n thÃ´ng, radio, truyá»n hÃ¬nh.</li>
<li>Vi sÃ³ng: Sá»­ dá»¥ng trong lÃ² vi sÃ³ng, radar.</li>
<li>Tia há»“ng ngoáº¡i: Táº¡o ra nhiá»‡t, Ä‘Æ°á»£c sá»­ dá»¥ng trong Ä‘iá»u khiá»ƒn tá»« xa, thiáº¿t bá»‹ nhÃ¬n Ä‘Ãªm.</li>
<li>Ãnh sÃ¡ng kháº£ kiáº¿n: Ãnh sÃ¡ng mÃ  máº¯t ngÆ°á»i cÃ³ thá»ƒ nhÃ¬n tháº¥y.</li>
<li>Tia tá»­ ngoáº¡i: Sá»­ dá»¥ng trong khá»­ trÃ¹ng, sáº£n xuáº¥t vitamin D.</li>
<li>Tia X: Sá»­ dá»¥ng trong y táº¿ Ä‘á»ƒ chá»¥p X-quang.</li>
<li>Tia gamma: CÃ³ nÄƒng lÆ°á»£ng ráº¥t cao, Ä‘Æ°á»£c sá»­ dá»¥ng trong Ä‘iá»u trá»‹ ung thÆ°.</li>
</ul>
<p><strong>á»¨ng dá»¥ng cá»§a bá»©c xáº¡ Ä‘iá»‡n tá»«:</strong> Bá»©c xáº¡ Ä‘iá»‡n tá»« cÃ³ ráº¥t nhiá»u á»©ng dá»¥ng trong cuá»™c sá»‘ng hÃ ng ngÃ y vÃ  trong cÃ¡c lÄ©nh vá»±c khoa há»c, cÃ´ng nghá»‡. VÃ­ dá»¥:</p>
<ul>
<li>Truyá»n thÃ´ng: Äiá»‡n thoáº¡i, truyá»n hÃ¬nh, internet.</li>
<li>Y táº¿: Chá»¥p X-quang, Ä‘iá»u trá»‹ ung thÆ°.</li>
<li>CÃ´ng nghiá»‡p: HÃ n, cáº¯t kim loáº¡i.</li>
<li>QuÃ¢n sá»±: Radar, sÃ³ng Ã¢m.</li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
TÃ­nh KhÃ´ng Giao HoÃ¡n (Non-Commutativity) trong ToÃ¡n há»c
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>TÃ­nh khÃ´ng giao hoÃ¡n lÃ  má»™t khÃ¡i niá»‡m quan trá»ng trong toÃ¡n há»c, Ä‘áº·c biá»‡t trong Ä‘áº¡i sá»‘ trá»«u tÆ°á»£ng. NÃ³ mÃ´ táº£ má»™t tÃ­nh cháº¥t cá»§a cÃ¡c phÃ©p toÃ¡n, khi mÃ  viá»‡c Ä‘á»•i chá»— cÃ¡c Ä‘á»‘i tÆ°á»£ng trong phÃ©p toÃ¡n Ä‘Ã³ láº¡i cho káº¿t quáº£ khÃ¡c nhau.</p>
<p><strong>VÃ­ dá»¥ minh há»a:</strong></p>
<ul>
<li>PhÃ©p nhÃ¢n sá»‘: PhÃ©p nhÃ¢n sá»‘ lÃ  má»™t phÃ©p toÃ¡n giao hoÃ¡n. VÃ­ dá»¥: <code>2 x 3 = 3 x 2</code>.</li>
<li>PhÃ©p trá»« sá»‘: PhÃ©p trá»« sá»‘ khÃ´ng pháº£i lÃ  phÃ©p toÃ¡n giao hoÃ¡n. VÃ­ dá»¥: <code>5 - 3 â‰  3 - 5</code>.</li>
<li>PhÃ©p nhÃ¢n ma tráº­n: PhÃ©p nhÃ¢n ma tráº­n nÃ³i chung khÃ´ng giao hoÃ¡n. Tá»©c lÃ , náº¿u A vÃ  B lÃ  hai ma tráº­n, thÃ¬ thÆ°á»ng <code>AB â‰  BA</code>.</li>
</ul>
<p><strong>á»¨ng dá»¥ng cá»§a tÃ­nh khÃ´ng giao hoÃ¡n:</strong></p>
<ul>
<li>Äáº¡i sá»‘ trá»«u tÆ°á»£ng: TÃ­nh khÃ´ng giao hoÃ¡n xuáº¥t hiá»‡n trong nhiá»u cáº¥u trÃºc Ä‘áº¡i sá»‘ nhÆ° nhÃ³m, vÃ nh, trÆ°á»ng.</li>
<li>Váº­t lÃ½ lÆ°á»£ng tá»­: Trong cÆ¡ há»c lÆ°á»£ng tá»­, cÃ¡c toÃ¡n tá»­ Ä‘áº¡i diá»‡n cho cÃ¡c Ä‘áº¡i lÆ°á»£ng váº­t lÃ½ thÆ°á»ng khÃ´ng giao hoÃ¡n. Äiá»u nÃ y dáº«n Ä‘áº¿n nguyÃªn lÃ½ báº¥t Ä‘á»‹nh Heisenberg, má»™t trong nhá»¯ng nguyÃªn lÃ½ cÆ¡ báº£n cá»§a váº­t lÃ½ lÆ°á»£ng tá»­.</li>
<li>Khoa há»c mÃ¡y tÃ­nh: TÃ­nh khÃ´ng giao hoÃ¡n xuáº¥t hiá»‡n trong cÃ¡c cáº¥u trÃºc dá»¯ liá»‡u nhÆ° hÃ ng Ä‘á»£i, ngÄƒn xáº¿p, vÃ  trong cÃ¡c ngÃ´n ngá»¯ láº­p trÃ¬nh.</li>
</ul>
<p><strong>Ã nghÄ©a cá»§a tÃ­nh khÃ´ng giao hoÃ¡n:</strong></p>
<ul>
<li>Thá»© tá»± quan trá»ng: Khi thá»±c hiá»‡n cÃ¡c phÃ©p toÃ¡n khÃ´ng giao hoÃ¡n, thá»© tá»± cÃ¡c Ä‘á»‘i tÆ°á»£ng Ä‘Ã³ng vai trÃ² quyáº¿t Ä‘á»‹nh trong viá»‡c xÃ¡c Ä‘á»‹nh káº¿t quáº£.</li>
<li>MÃ´ hÃ¬nh hÃ³a cÃ¡c há»‡ thá»‘ng phá»©c táº¡p: TÃ­nh khÃ´ng giao hoÃ¡n cho phÃ©p mÃ´ hÃ¬nh hÃ³a cÃ¡c há»‡ thá»‘ng phá»©c táº¡p trong Ä‘Ã³ cÃ¡c yáº¿u tá»‘ tÆ°Æ¡ng tÃ¡c vá»›i nhau theo má»™t cÃ¡ch khÃ´ng Ä‘á»‘i xá»©ng.</li>
</ul>
<p>VÃ­ dá»¥ cá»¥ thá»ƒ trong váº­t lÃ½ lÆ°á»£ng tá»­:</p>
<p>Trong cÆ¡ há»c lÆ°á»£ng tá»­, vá»‹ trÃ­ (x) vÃ  Ä‘á»™ng lÆ°á»£ng (p) cá»§a má»™t háº¡t lÃ  hai Ä‘áº¡i lÆ°á»£ng váº­t lÃ½ khÃ´ng giao hoÃ¡n. Quan há»‡ khÃ´ng giao hoÃ¡n nÃ y Ä‘Æ°á»£c biá»ƒu diá»…n bá»Ÿi cÃ´ng thá»©c:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Bx,%20p%5D%20=%20xp%20-%20px%20=%20i%C4%A7"></p>
<p>Trong Ä‘Ã³:</p>
<ul>
<li><img src="https://latex.codecogs.com/png.latex?x"> lÃ  toÃ¡n tá»­ vá»‹ trÃ­</li>
<li><img src="https://latex.codecogs.com/png.latex?p"> lÃ  toÃ¡n tá»­ Ä‘á»™ng lÆ°á»£ng</li>
<li><img src="https://latex.codecogs.com/png.latex?%C4%A7"> lÃ  háº±ng sá»‘ Planck rÃºt gá»n</li>
<li><img src="https://latex.codecogs.com/png.latex?i"> lÃ  Ä‘Æ¡n vá»‹ áº£o</li>
</ul>
<p>CÃ´ng thá»©c trÃªn cho tháº¥y, viá»‡c Ä‘o vá»‹ trÃ­ vÃ  Ä‘á»™ng lÆ°á»£ng cá»§a má»™t háº¡t cÃ¹ng má»™t lÃºc sáº½ cÃ³ Ä‘á»™ chÃ­nh xÃ¡c bá»‹ giá»›i háº¡n. ÄÃ¢y chÃ­nh lÃ  ná»™i dung cá»§a nguyÃªn lÃ½ báº¥t Ä‘á»‹nh Heisenberg.</p>
<p><strong>TÃ³m láº¡i</strong>, tÃ­nh khÃ´ng giao hoÃ¡n lÃ  má»™t khÃ¡i niá»‡m quan trá»ng trong toÃ¡n há»c vÃ  váº­t lÃ½, giÃºp chÃºng ta hiá»ƒu rÃµ hÆ¡n vá» sá»± tÆ°Æ¡ng tÃ¡c giá»¯a cÃ¡c Ä‘á»‘i tÆ°á»£ng vÃ  cÃ¡c há»‡ thá»‘ng phá»©c táº¡p.</p>
</div>
</div>
</div>
</section>
<section id="stability-of-matter" class="level1">
<h1>Stability of Matter</h1>
<p>náº¿u nguyÃªn tá»­ lÃ  á»•n Ä‘á»‹nh, Ä‘iá»u gÃ¬ xáº£y ra náº¿u chÃºng ta assemble chÃºng láº¡i vá»›i nhau, nhÆ° 10^30 nguyÃªn tá»­ trong 1 viÃªn gáº¡ch. viá»‡c 1 viÃªn gáº¡ch táº¡i sao lá»›n nhÆ° váº­y, chá»© khÃ´ng thá»ƒ Ä‘áº·c hÆ¡n, khÃ³ cÃ³ thá»ƒ coi lÃ  hiá»ƒn nhiÃªn, vÃ  uncertainty principle ko thá»ƒ tá»± mÃ¬nh giáº£i thÃ­ch.</p>
<p>extensitivity: electrons lÃ  fermions, thá»a Pauli exclusion principle.</p>
<p>why a brick is a brick?</p>
<p>book recommendation: â€œStability of Matter in Quantum Mechanicsâ€</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Fermions and Bosons
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>These are two fundamental types of particles in physics. They differ in their quantum properties.</p>
<ul>
<li><strong>Fermions</strong>: These particles obey the Pauli Exclusion Principle, which means that no two identical fermions can occupy the same quantum state simultaneously. Examples of fermions include electrons, protons, and neutrons. &nbsp;</li>
<li><strong>Bosons</strong>: Unlike fermions, multiple bosons can occupy the same quantum state. This property is essential for phenomena like superconductivity and laser light. Examples of bosons include photons (particles of light) and the Higgs boson.</li>
</ul>
</div>
</div>
</div>
</section>
<section id="gravitational-in-stability-of-stars" class="level1">
<h1>Gravitational (In) Stability of Stars</h1>
<p>scale up to Stars, where the gravitation becomes a major factor -&gt; can be taken in to account.</p>
<p>Chandrasekhar limit - for the maximun mass of stable white dwarf (amounts roughly 1.4 solar masses)</p>
<p>Schrodinger equation can be applied to a huge range of scalces, from atoms to stars!</p>
</section>
<section id="phase-transitions" class="level1">
<h1>Phase Transitions</h1>
<p>phÆ°Æ¡ng trÃ¬nh cÆ¡ báº£n cÃ³ dáº¡ng Ä‘Æ¡n giáº£n, nhÆ°ng lá»i giáº£i cÃ³ thá»ƒ á»Ÿ ráº¥t nhiá»u dáº¡ng do cÃ³ ráº¥t nhiá»u biáº¿n vÃ  tham sá»‘.</p>
<p>vÃ­ dá»¥ nhÆ° nÆ°á»›c, cÃ³ thá»ƒ khÃ­, lá»ng vÃ  ráº¯n - phase transitions.</p>
</section>
<section id="more-phase-transitions" class="level1">
<h1>More Phase Transitions</h1>
<ul>
<li>magnetism;</li>
<li>traffic jams: hociminh city, tiny change can make huge effect?;</li>
<li>superfluidity (siÃªu cháº£y, má»™t tráº¡ng thÃ¡i â€œká»³ láº¡â€ - exotic cá»§a váº­t cháº¥t);</li>
<li>superconductivity (siÃªu dáº«n).</li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
superfluidity
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ol type="1">
<li><p><strong>Äá»‹nh nghÄ©a siÃªu cháº£y</strong>: SiÃªu cháº£y lÃ  tráº¡ng thÃ¡i cá»§a váº­t cháº¥t, trong Ä‘Ã³ cháº¥t lá»ng cÃ³ Ä‘á»™ nhá»›t báº±ng khÃ´ng vÃ  cháº£y mÃ  khÃ´ng cÃ³ ma sÃ¡t. Äiá»u nÃ y xáº£y ra á»Ÿ nhiá»‡t Ä‘á»™ cá»±c tháº¥p, gáº§n báº±ng khÃ´ng tuyá»‡t Ä‘á»‘i.</p></li>
<li><p><strong>Äáº·c Ä‘iá»ƒm chÃ­nh</strong>:</p></li>
</ol>
<ul>
<li>KhÃ´ng cÃ³ ma sÃ¡t ná»™i: Cháº¥t lá»ng siÃªu cháº£y cÃ³ thá»ƒ cháº£y mÃ  khÃ´ng máº¥t nÄƒng lÆ°á»£ng.</li>
<li>Hiá»‡u á»©ng phun tia: CÃ³ thá»ƒ leo lÃªn thÃ nh bÃ¬nh chá»©a.</li>
<li>Dáº«n nhiá»‡t vÃ´ háº¡n: Truyá»n nhiá»‡t cá»±c ká»³ hiá»‡u quáº£.</li>
<li>XoÃ¡y lÆ°á»£ng tá»­: Táº¡o ra cÃ¡c xoÃ¡y vá»›i Ä‘á»™ng lÆ°á»£ng gÃ³c lÆ°á»£ng tá»­ hÃ³a.</li>
</ul>
<ol start="3" type="1">
<li><strong>VÃ­ dá»¥ vá» cháº¥t siÃªu cháº£y</strong>:</li>
</ol>
<ul>
<li>Helium-4 lá»ng dÆ°á»›i 2.17 K (Ä‘iá»ƒm lambda).</li>
<li>Helium-3 lá»ng dÆ°á»›i khoáº£ng 0.0025 K.</li>
</ul>
<p><strong>Táº¡i sao gá»i lÃ  â€œexoticâ€ (ká»³ láº¡):</strong></p>
<ol type="a">
<li><strong>Hiáº¿m gáº·p trong tá»± nhiÃªn</strong>:</li>
</ol>
<ul>
<li>Chá»‰ xuáº¥t hiá»‡n á»Ÿ nhiá»‡t Ä‘á»™ cá»±c tháº¥p, hiáº¿m khi gáº·p trong Ä‘iá»u kiá»‡n tá»± nhiÃªn.</li>
</ul>
<ol start="2" type="a">
<li><strong>Vi pháº¡m trá»±c giÃ¡c thÃ´ng thÆ°á»ng</strong>:</li>
</ol>
<ul>
<li>Cháº£y mÃ  khÃ´ng cÃ³ ma sÃ¡t, trÃ¡i ngÆ°á»£c vá»›i háº§u háº¿t cÃ¡c cháº¥t lá»ng thÃ´ng thÆ°á»ng.</li>
<li>CÃ³ thá»ƒ â€œleoâ€ ra khá»i bÃ¬nh chá»©a, dÆ°á»ng nhÆ° vi pháº¡m trá»ng lá»±c.</li>
</ul>
<ol start="3" type="a">
<li><strong>HÃ nh vi lÆ°á»£ng tá»­ vÄ© mÃ´</strong>:</li>
</ol>
<ul>
<li>Hiá»ƒn thá»‹ cÃ¡c hiá»‡u á»©ng lÆ°á»£ng tá»­ á»Ÿ quy mÃ´ cÃ³ thá»ƒ quan sÃ¡t Ä‘Æ°á»£c.</li>
<li>Thá»ƒ hiá»‡n tÃ­nh cháº¥t sÃ³ng-háº¡t cá»§a váº­t cháº¥t á»Ÿ má»©c Ä‘á»™ lá»›n.</li>
</ul>
<ol start="4" type="a">
<li><strong>LiÃªn quan Ä‘áº¿n váº­t lÃ½ cÆ¡ báº£n</strong>:</li>
</ol>
<ul>
<li>NghiÃªn cá»©u siÃªu cháº£y giÃºp hiá»ƒu sÃ¢u hÆ¡n vá» cÆ¡ há»c lÆ°á»£ng tá»­ vÃ  váº­t lÃ½ tráº¡ng thÃ¡i ngÆ°ng tá»¥.</li>
</ul>
<ol start="5" type="a">
<li><strong>á»¨ng dá»¥ng tiá»m nÄƒng Ä‘á»™c Ä‘Ã¡o</strong>:</li>
</ol>
<ul>
<li>CÃ³ thá»ƒ Ä‘Æ°á»£c sá»­ dá»¥ng trong cÃ¡c thiáº¿t bá»‹ lÃ m láº¡nh siÃªu dáº«n vÃ  cÃ¡c á»©ng dá»¥ng cÃ´ng nghá»‡ cao khÃ¡c.</li>
</ul>
<p>TÃ³m láº¡i, siÃªu cháº£y Ä‘Æ°á»£c coi lÃ  â€œexoticâ€ vÃ¬ nÃ³ thá»ƒ hiá»‡n cÃ¡c tÃ­nh cháº¥t ká»³ láº¡, hiáº¿m gáº·p vÃ  vi pháº¡m trá»±c giÃ¡c thÃ´ng thÆ°á»ng vá» cÃ¡ch cháº¥t lá»ng hoáº¡t Ä‘á»™ng. NÃ³ lÃ  má»™t vÃ­ dá»¥ vá» cÃ¡ch cÃ¡c hiá»‡u á»©ng lÆ°á»£ng tá»­ cÃ³ thá»ƒ biá»ƒu hiá»‡n á»Ÿ quy mÃ´ vÄ© mÃ´, lÃ m cho nÃ³ trá»Ÿ thÃ nh má»™t chá»§ Ä‘á» thÃº vá»‹ vÃ  quan trá»ng trong váº­t lÃ½ hiá»‡n Ä‘áº¡i.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-7-contents" aria-controls="callout-7" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
superconductivity
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-7" class="callout-7-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ol type="1">
<li><p><strong>Äá»‹nh nghÄ©a</strong>: SiÃªu dáº«n lÃ  tráº¡ng thÃ¡i cá»§a váº­t cháº¥t trong Ä‘Ã³ Ä‘iá»‡n trá»Ÿ suáº¥t cá»§a váº­t liá»‡u giáº£m xuá»‘ng báº±ng khÃ´ng vÃ  tá»« trÆ°á»ng bá»‹ Ä‘áº©y ra khá»i váº­t liá»‡u (hiá»‡u á»©ng Meissner) khi nhiá»‡t Ä‘á»™ giáº£m xuá»‘ng dÆ°á»›i má»™t nhiá»‡t Ä‘á»™ tá»›i háº¡n nháº¥t Ä‘á»‹nh.</p></li>
<li><p>Äáº·c Ä‘iá»ƒm chÃ­nh:</p></li>
</ol>
<ol type="a">
<li><p><strong>Äiá»‡n trá»Ÿ báº±ng khÃ´ng</strong>: DÃ²ng Ä‘iá»‡n cÃ³ thá»ƒ cháº£y mÃ  khÃ´ng máº¥t nÄƒng lÆ°á»£ng.</p></li>
<li><p><strong>Hiá»‡u á»©ng Meissner</strong>: Tá»« trÆ°á»ng bá»‹ Ä‘áº©y ra khá»i váº­t liá»‡u siÃªu dáº«n.</p></li>
<li><p><strong>Nhiá»‡t Ä‘á»™ tá»›i háº¡n (Tc)</strong>: Nhiá»‡t Ä‘á»™ mÃ  dÆ°á»›i Ä‘Ã³ váº­t liá»‡u trá»Ÿ thÃ nh siÃªu dáº«n.</p></li>
</ol>
<ol start="3" type="1">
<li><strong>Loáº¡i siÃªu dáº«n</strong>:</li>
</ol>
<ol type="a">
<li><p>SiÃªu dáº«n loáº¡i I: ThÆ°á»ng lÃ  kim loáº¡i nguyÃªn cháº¥t, chuyá»ƒn Ä‘á»™t ngá»™t sang tráº¡ng thÃ¡i siÃªu dáº«n.</p></li>
<li><p>SiÃªu dáº«n loáº¡i II: ThÆ°á»ng lÃ  há»£p kim hoáº·c há»£p cháº¥t phá»©c táº¡p, cÃ³ hai nhiá»‡t Ä‘á»™ tá»›i háº¡n vÃ  cÃ³ thá»ƒ duy trÃ¬ tráº¡ng thÃ¡i siÃªu dáº«n trong tá»« trÆ°á»ng máº¡nh hÆ¡n.</p></li>
</ol>
<ol start="4" type="1">
<li><strong>CÆ¡ cháº¿</strong>:</li>
</ol>
<ul>
<li>LÃ½ thuyáº¿t BCS (Bardeen-Cooper-Schrieffer): Giáº£i thÃ­ch siÃªu dáº«n thÃ´ng qua sá»± hÃ¬nh thÃ nh cÃ¡c cáº·p Cooper (electron ghÃ©p Ä‘Ã´i).</li>
<li>SiÃªu dáº«n nhiá»‡t Ä‘á»™ cao: CÆ¡ cháº¿ chÆ°a Ä‘Æ°á»£c hiá»ƒu Ä‘áº§y Ä‘á»§, lÃ  má»™t lÄ©nh vá»±c nghiÃªn cá»©u Ä‘ang phÃ¡t triá»ƒn.</li>
</ul>
<ol start="5" type="1">
<li><strong>á»¨ng dá»¥ng</strong>:</li>
</ol>
<ul>
<li>Nam chÃ¢m siÃªu dáº«n máº¡nh cho MRI vÃ  mÃ¡y gia tá»‘c háº¡t.</li>
<li>MÃ¡y dÃ² SQUID (Superconducting Quantum Interference Device) Ä‘á»ƒ Ä‘o tá»« trÆ°á»ng cá»±c nhá».</li>
<li>Tiá»m nÄƒng trong mÃ¡y tÃ­nh lÆ°á»£ng tá»­ vÃ  truyá»n táº£i Ä‘iá»‡n khÃ´ng tá»•n tháº¥t.</li>
</ul>
<ol start="6" type="1">
<li><strong>ThÃ¡ch thá»©c</strong>:</li>
</ol>
<ul>
<li>TÃ¬m kiáº¿m váº­t liá»‡u siÃªu dáº«n á»Ÿ nhiá»‡t Ä‘á»™ cao hÆ¡n, lÃ½ tÆ°á»Ÿng lÃ  á»Ÿ nhiá»‡t Ä‘á»™ phÃ²ng.</li>
<li>Hiá»ƒu rÃµ hÆ¡n vá» cÆ¡ cháº¿ cá»§a siÃªu dáº«n nhiá»‡t Ä‘á»™ cao.</li>
</ul>
<ol start="7" type="1">
<li><strong>Lá»‹ch sá»­ vÃ  phÃ¡t triá»ƒn</strong>:</li>
</ol>
<ul>
<li>PhÃ¡t hiá»‡n nÄƒm 1911 bá»Ÿi Heike Kamerlingh Onnes trong thá»§y ngÃ¢n á»Ÿ 4.2K.</li>
<li>LÃ½ thuyáº¿t BCS Ä‘Æ°á»£c Ä‘á» xuáº¥t nÄƒm 1957.</li>
<li>SiÃªu dáº«n nhiá»‡t Ä‘á»™ cao Ä‘Æ°á»£c phÃ¡t hiá»‡n nÄƒm 1986 bá»Ÿi Bednorz vÃ  MÃ¼ller.</li>
</ul>
<p>SiÃªu dáº«n lÃ  má»™t lÄ©nh vá»±c nghiÃªn cá»©u Ä‘ang phÃ¡t triá»ƒn máº¡nh máº½ trong váº­t lÃ½ hiá»‡n Ä‘áº¡i, vá»›i tiá»m nÄƒng á»©ng dá»¥ng rá»™ng rÃ£i trong cÃ´ng nghá»‡ vÃ  ká»¹ thuáº­t.</p>
</div>
</div>
</div>
</section>
<section id="summary" class="level1">
<h1>Summary</h1>
<ul>
<li>toÃ¡n khÃ´ng pháº£i lÃ  ngÃ´n ngá»¯ vÅ© trá»¥, nhÆ°ng ráº¥t máº¡nh máº½ Ä‘á»ƒ giáº£i thÃ­ch tá»± nhiÃªn;</li>
<li>cÃ¡c luáº­t váº­t lÃ½ cÆ¡ báº£n Ä‘Æ°á»£c diá»…n giáº£i báº±ng ngÃ´n ngá»¯ toÃ¡n, ráº¥t thÃº vÃ­ lÃ  nhiá»u Ä‘á»‹nh luáº­t váº­t lÃ½ cÆ¡ báº£n láº¡i giáº£i thÃ­ch Ä‘Æ°á»£c ráº¥t nhiá»u hiá»‡n tÆ°á»£ng khÃ¡c nhau, nhÆ° chuyá»ƒn thá»ƒ;</li>
<li>viá»‡c hiá»ƒu cÃ¡c Ä‘á»‹nh luáº­t váº­t lÃ½ táº¡o ra cÃ¡c tiáº¿n bá»™ cÃ´ng nghá»‡;</li>
<li>má»¥c tiÃªu cá»§a toÃ¡n váº­t lÃ½ lÃ  phÃ¡t triá»ƒn cÃ¡c cÃ´ng cá»¥ toÃ¡n Ä‘á»ƒ hiá»ƒu cÃ¡c há»‡ quáº£ cá»§a cÃ¡c Ä‘á»‹nh luáº­t váº­t lÃ½ cÆ¡ báº£n vÃ  khai phÃ¡ cÃ¡c cÆ¡ cháº¿ cÅ©ng nhÆ° nguyÃªn lÃ½ Ä‘áº±ng sau cÃ¡c hiá»‡n tÆ°á»£ng quan sÃ¡t Ä‘Æ°á»£c;</li>
<li>má»™t trong cÃ¡c thÃ nh tá»±u cá»§a toÃ¡n váº­t lÃ½ chÃ­nh lÃ  nghiÃªn cá»©u vá» tÃ­nh á»•n Ä‘á»‹nh cá»§a váº­t cháº¥t.</li>
</ul>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="1">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://lktuan.github.io/blog/2024-08-08-note-muln/summary.png" class="img-fluid figure-img"></p>
<figcaption>summary</figcaption>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="qa-and-outro" class="level1">
<h1>q&amp;a and outro</h1>
<ol type="1">
<li>hamiltonian mechanics;</li>
<li>non-commutativity;</li>
<li>fermions, fundamental particle, bosons, 4-dimensions space;</li>
<li>schrodinger equation, lagrangian;</li>
<li>phase transitions, is this similar to the butterfly effect (notion of chaos)? eg double pendulum;</li>
<li>when was quantum mechanics been cared;</li>
<li>in classical physics, can predict trajectory; but why in quantum mechanics, we can not. (electron does not have definite position, read more on bell inequalities);</li>
<li>given the particles moving very fast, will they exchange the energy (read more on kinetic energy);</li>
<li>standing wave.</li>
</ol>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="1">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://lktuan.github.io/blog/2024-08-08-note-muln/my_brain_is_full.png" class="img-fluid figure-img"></p>
<figcaption>bye bye</figcaption>
</figure>
</div>
</div>
</div>
</div>


<!-- -->

</section>

 ]]></description>
  <category>math</category>
  <guid>https://lktuan.github.io/blog/2024-08-08-note-muln/</guid>
  <pubDate>Wed, 07 Aug 2024 17:00:00 GMT</pubDate>
  <media:content url="https://lktuan.github.io/blog/2024-08-08-note-muln/rs_portrait.png" medium="image" type="image/png" height="101" width="144"/>
</item>
<item>
  <title>Má»™t sá»‘ khuÃ´n máº«u tÆ° duy trong Brazilian Jiu-jitsu</title>
  <dc:creator>Tuan Le Khac</dc:creator>
  <link>https://lktuan.github.io/blog/2024-08-06-bjj-mental-models/</link>
  <description><![CDATA[ 





<p><strong>lÆ°á»£c dá»‹ch</strong> vÃ /hoáº·c <strong>tÃ³m táº¯t</strong> cho khÃ³a há»c cÅ©ng â€œMechanic Models of BJJ: A Crash Courseâ€ cá»§a Steve Kwan.</p>
<section id="theory-of-alignment" class="level1">
<h1>1. <a href="https://www.bjjmentalmodels.com/theory-of-alignment/">theory of alignment</a></h1>
<p>lÃ  lÃ½ thuyáº¿t tá»‘i cao cá»§a Jiu-jitsu, bao gá»“m ba yáº¿u tá»‘:</p>
<ol type="1">
<li><strong>posture</strong> - tÆ° tháº¿: position má»™t cÃ¡ch hiá»‡u quáº£ cá»• (neck) vÃ  cá»™t sá»‘ng (spine);</li>
<li><strong>structure</strong> - cáº¥u trÃºc: position má»™t cÃ¡ch hiá»‡u quáº£ tay (arms) vÃ  chÃ¢n (legs);</li>
<li><strong>base</strong> - cá»Ÿ sá»Ÿ: kháº£ nÄƒng háº¥p thá»¥ (absorb) hoáº·c táº¡o ra lá»±c liÃªn quan Ä‘á»ƒ Ä‘áº¡t Ä‘Æ°á»£c má»¥c tiÃªu.</li>
</ol>
<p>Ä‘á»ƒ Ä‘áº¡t Ä‘Æ°á»£c alignment hiá»‡u quáº£, luÃ´n ghi nhá»› hai má»¥c tiÃªu sau:</p>
<ol type="1">
<li>maintain your alignment;</li>
<li>break your opponentâ€™s alignment;</li>
<li>do not proceed 2. if you are failing at 1.</li>
</ol>
<p>trong Ä‘Ã o táº¡o, vá»›i trá»ng sá»‘ cá»§a ba yáº¿u tá»‘ nhÆ° nhau, cÃ³ thá»ƒ â€œcháº¥m Ä‘iá»ƒmâ€ (alignment scorecard) vá»›i thang tá»« 0-3 cho má»—i ngÆ°á»i chÆ¡i. Ä‘iá»ƒm cÃ ng cao hÆ¡n sáº½ lÃ  dáº¥u hiá»‡u cho viá»‡c báº¡n cÃ³ má»™t cÆ¡ há»™i tá»‘t Ä‘á»ƒ phÃ¡ vá»¡ alignment cá»§a Ä‘á»‘i thá»§. vÃ­ dá»¥, trong closed guard, báº¡n á»Ÿ dÆ°á»›i, vÃ  khÃ´ng ai Ä‘ang khá»‘ng cháº¿ Ä‘á»‘i phÆ°Æ¡ng báº±ng má»™t hand grip:</p>
<p>báº¡n sáº½ cÃ³ 3 Ä‘iá»ƒm náº¿u:</p>
<ul>
<li><strong>posture</strong>: cá»• (neck) vÃ  cá»™t sá»‘ng (spine) á»Ÿ vá»‹ trÃ­ tá»± nhiÃªn, tháº³ng, khÃ´ng bá»‹ kiá»ƒm soÃ¡t. hÃ´ng (hip) Ä‘Æ°á»£c tá»± do di chuyá»ƒn;</li>
<li><strong>structure</strong>: tay (hands) vÃ  chÃ¢n (legs) tá»± do táº¡o ra cÃ¡c grips vÃ  khung - frames;</li>
<li><strong>base</strong>: báº¡n cÃ³ thá»ƒ táº¡o (gen) hoáº·c háº¥p thá»¥ lá»±c (absorb) nhá» vai vÃ  vá»‹ trÃ­ Ä‘áº·t chÃ¢n.</li>
</ul>
<p>Ä‘á»‘i thá»§ sáº½ cÃ³ 3 Ä‘iá»ƒm náº¿u, tÆ°Æ¡ng á»©ng:</p>
<ul>
<li>cá»• vÃ  cá»™t sá»‘ng tháº³ng, náº±m chÃ­nh diá»‡n (vertical, centre) giá»¯a cÆ¡ thá»ƒ báº¡n;</li>
<li>tay cá»§a há» khÃ´ng bá»‹ kiá»ƒm soÃ¡t má»™t cÃ¡ch chá»§ Ä‘á»™ng;</li>
<li>há» cÃ³ thá»ƒ chá»‘ng láº¡i lá»±c tá»« báº¡n vá»›i cá»™t sá»‘ng tháº³ng, vai má»Ÿ. há» cÃ³ kháº£ nÄƒng break guard khi ngá»“i - dÃ¹ng tay, hoáº·c Ä‘á»©ng lÃªn.</li>
</ul>
<p>cáº£ hai Ä‘á»u khÃ´ng cÃ³ lá»£i tháº¿ Ä‘Ã¡ng ká»ƒ vÃ  ná»— lá»±c submission sáº½ dáº«n Ä‘áº¿n escape hoáº·c reversal.</p>
</section>
<section id="core-mechanics" class="level1 page-columns page-full">
<h1>2. <a href="https://www.bjjmentalmodels.com/core-mechanics/">core mechanics</a></h1>
<p>náº¿u tiáº¿p cáº­n BJJ theo technique approach, sáº½ cÃ³ ráº¥t nhiá»u ká»¹ thuáº­t cÅ©ng cÃ¡c biáº¿n thá»ƒ (variations) mÃ  báº¡n khÃ´ng thá»ƒ khi nhá»› háº¿t. <em>may máº¯n lÃ </em>, cÃ¡c ká»¹ thuáº­t cá»§a BJJ Ä‘á»u lÃ  sá»± káº¿t há»£p cá»§a 6 cÆ¡ cháº¿ cá»‘t lÃµi (core mechanics) sau Ä‘Ã¢y:</p>
<ol type="1">
<li><strong>frame (khung)</strong>:</li>
</ol>
<ul>
<li>lÃ  concept phÃ²ng thá»§ quan trá»ng nháº¥t trong BJJ, nÃ³ táº¡o ra má»™t khung báº£o vá»‡ (shield) sá»­ dá»¥ng nhá»¯ng pháº§n cÆ¡ thá»ƒ cá»©ng (hard) hoáº·c nhiá»u xÆ°Æ¡ng (bony), thÆ°á»ng Ä‘Æ°á»£c sá»­ dá»¥ng cho ngÆ°á»i á»Ÿ vá»‹ trÃ­ dÆ°á»›i (bottom);</li>
<li>frame khÃ´ng phá»¥ thuá»™c vÃ o cÆ¡ báº¯p, mÃ  lÃ  sá»± cÄƒn chá»‰nh há»‡ xÆ°Æ¡ng. báº¡n khÃ´ng muá»‘n dÃ¹ng Ã¡p lá»±c Ä‘áº©y Ä‘á»‘i thá»§ ra xa, mÃ  lÃ  dÃ¹ng cáº¥u trÃºc xÆ°Æ¡ng Ä‘á»ƒ giá»¯ Ä‘á»‘i thá»§ táº¡i má»™t khoáº£ng cÃ¡ch nháº¥t Ä‘á»‹nh, táº¡o khÃ´ng gian Ä‘á»ƒ báº£n thÃ¢n di chuyá»ƒn. frame tá»‘t thÃ¬ pháº£i cháº¯c cháº¯n vÃ  khÃ´ng sá»­ dá»¥ng quÃ¡ nhiá»u sá»©c lá»±c ;</li>
<li>khÃ´ng nÃªn frame vá»›i cÃ¡c khá»›p (joints) dá»… bá»‹ Ä‘á»‘i phÆ°Æ¡ng khai thÃ¡c: vÃ­ dá»¥ dÃ¹ng hai tay Ä‘á»ƒ Ä‘áº©y Ä‘á»‘i thá»§, pháº§n cá»• (wrist) vÃ  khuá»·u tay yáº¿u vÃ  ráº¥t dá»… bá»‹ counter. tÆ°Æ¡ng tá»±, khi frame báº±ng chÃ¢n, báº¡n nÃªn sá»­ dá»¥ng gá»‘i (knees) vÃ  á»‘ng chÃ¢n (shins) nhá» diá»‡n tÃ­ch lá»›n, dÃ¹ng bÃ n chÃ¢n (feet) cÃ³ lá»£i tháº¿ vá» khoáº£ng cÃ¡ch táº¡o Ä‘Æ°á»£c tuy nhiÃªn ráº¥t dá»… bá»‹ khai thÃ¡c.</li>
</ul>
<div class="no-row-height column-margin column-container"><span class="margin-aside">Ä‘á»c thÃªm vá» <a href="https://bjjmentalmodels.com/solid-frames/">solid frame</a></span></div><ol start="2" type="1">
<li><strong>levers (Ä‘Ã²n báº©y)</strong>:</li>
</ol>
<ul>
<li>Ä‘Ã²n báº©y lÃ  phÃ©p bá»™i lá»±c ráº¥t hiá»‡u quáº£ Ä‘á»ƒ táº¡o sÆ¡ há»Ÿ (openings) vÃ  táº¥n cÃ´ng vÃ  kiá»ƒm soÃ¡t Ä‘á»‘i thá»§;</li>
<li>theo thá»© tá»± tá»« khá»e Ä‘áº¿n yáº¿u nháº¥t, 3 cÃ´ng cá»¥ Ä‘Ã²n báº©y trÃªn cÆ¡ thá»ƒ báº¡n chÃ­nh lÃ  <em>chÃ¢n, tay, vÃ  Ä‘áº§u</em>; </li>
<li>Ä‘áº§u (head) thÆ°á»ng Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ break tÆ° tháº¿ (posture) cá»§a Ä‘á»‘i thá»§, trong khi tay (arms) vÃ  chÃ¢n (legs) thÆ°á»ng Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ táº¥n cÃ´ng cáº¥u trÃºc (structure);</li>
<li>má»—i chi báº¡n Ä‘á»u cÃ³ 3 khá»›p (joints) chÃ­nh: vá»›i tay lÃ  vai (shoulders), khuá»·u tay (elbows), cá»• tay (wrists), vá»›i chÃ¢n lÃ  hÃ´ng (hips), Ä‘áº§u gá»‘i (knees), vÃ  cá»• chÃ¢n (ankles);</li>
<li>Ä‘á»ƒ kiá»ƒm soÃ¡t tá»‘t tay hoáº·c chÃ¢n Ä‘á»‘i phÆ°Æ¡ng báº¡n cáº§n kiá»ƒm soÃ¡t Ä‘Æ°á»£c Ã­t nháº¥t 2/3 khá»›p; trÃªn trá»¥c tay, chÃ¢n, khá»›p táº¡o ra hiá»‡u á»©ng Ä‘Ã²n báº©y tá»‘t nháº¥t lÃ  khá»›p ngoÃ i cÃ¹ng; </li>
<li>lÃºc báº¡n táº¥n cÃ´ng, Ä‘Ã²n báº©y cho phÃ©p báº¡n tiáº¿n tá»›i cÃ¡c vá»‹ trÃ­ kiá»ƒm soÃ¡t vÃ  submission, suy cho cÃ¹ng thÃ¬ trong má»i submission há»£p lá»‡, báº¡n luÃ´n pháº£i táº­n dá»¥ng, kiá»ƒm soÃ¡t Ä‘Æ°á»£c Ã­t nháº¥t má»™t Ä‘Ã²n báº©y cá»§a Ä‘á»‘i phÆ°Æ¡ng; </li>
<li>khi khÃ´ng ai cÃ³ Æ°u tháº¿, ngÆ°á»i Ä‘áº§u tiÃªn kiá»ƒm soÃ¡t Ä‘Æ°á»£c lever cá»§a Ä‘á»‘i phÆ°Æ¡ng sáº½ kiá»ƒm soÃ¡t tráº­n Ä‘áº¥u; </li>
</ul>
<div class="no-row-height column-margin column-container"><span class="margin-aside">Ä‘Ã¢y chÃ­nh lÃ  <a href="https://www.bjjmentalmodels.com/anatomic-hierarchy/">anatomic hierarchy</a></span><span class="margin-aside">Ä‘á»c thÃªm vá» <a href="https://bjjmentalmodels.com/3-joint-rule/">3-joint rule</a></span><span class="margin-aside">Ä‘á»c thÃªm vá» <a href="https://bjjmentalmodels.com/isolate-a-single-target/">isolate a single target</a></span><span class="margin-aside">Ä‘á»c thÃªm vá» <a href="https://bjjmentalmodels.com/grips-dictate-position/">grips dictate position</a></span></div><ol start="3" type="1">
<li><strong>wedges (nÃªm/chÃªm)</strong>:</li>
</ol>
<p>cÃ³ hai kiá»ƒu nÃªm:</p>
<ul>
<li>nÃªm cháº·n (blocking wedges): cá»‘ Ä‘á»‹nh má»™t pháº§n cÆ¡ thá»ƒ Ä‘á»‘i thá»§;</li>
<li>nÃªm cáº¡y (prying wedge): giÃºp má»Ÿ khung (frame) cá»§a Ä‘á»‘i thá»§.</li>
</ul>
<p>má»™t sá»‘ vÃ­ dá»¥:</p>
<ul>
<li>cho tay vÃ o hÃ´ng (hip) cá»§a Ä‘á»‘i phÆ°Æ¡ng Ä‘á»ƒ pass guard, khÃ´ng cho Ä‘á»‘i thá»§ re-guard chÃ­nh lÃ  vÃ­ dá»¥ cá»§a nÃªm cháº·n;</li>
<li>Ä‘Ã²n cáº¯t gá»‘i Ä‘á»ƒ pass guard (knee cut pass), khi báº¡n cá»‘ Ä‘Æ°a gá»‘i vÃ o má»Ÿ hai chÃ¢n Ä‘á»‘i thá»§, chÃ­nh lÃ  vÃ­ dá»¥ cá»§a nÃªm cáº¡y.</li>
</ul>
<p>nÃªm vÃ  Ä‘Ã²n báº©y thÆ°á»ng Ä‘i vá»›i nhau, báº¡n cáº§n dÃ¹ng nÃªm Ä‘á»ƒ sá»­ dá»¥ng Ä‘Ã²n báº©y hiá»‡u quáº£ hÆ¡n: <strong>nÃªm má»™t Ä‘áº§u, Ä‘Ã²n báº©y má»™t Ä‘áº§u</strong> giÃºp cá»‘ Ä‘á»‹nh tá»‘t hÆ¡n. gá»“m hai schemes:</p>
<ul>
<li>hai Ä‘Ã¡nh má»™t: two-on-one (two limbs controlling one lever);</li>
<li>bá»‘n Ä‘Ã¡nh má»™t: four-on-one (four limbs controlling one lever).</li>
</ul>
<ol start="4" type="1">
<li><strong>clamps (káº¹p)</strong>:</li>
</ol>
<div class="page-columns page-full"><p>káº¹p thÆ°á»ng Ä‘Æ°á»£c sá»­ dá»¥ng khi báº¡n Ä‘Ã£ khÃ³a (lock) Ä‘Æ°á»£c má»™t pháº§n cÆ¡ thá»ƒ cá»§a Ä‘á»‘i thá»§ trong má»™t vÃ²ng khÃ©p kÃ­n (<strong>closed circuit</strong>), siáº¿t cháº·t hai tay vÃ  hai chÃ¢n Ä‘á»ƒ táº¡o ra má»™t chuá»—i Ä‘á»™ng lá»±c há»c. </p><div class="no-row-height column-margin column-container"><span class="margin-aside">xem thÃªm <a href="https://bjjmentalmodels.com/kinetic-chains/">kinetic chains</a></span></div></div>
<p>cÆ¡ cháº¿ kiá»ƒm soÃ¡t nÃ y nhÆ° má»™t chiáº¿c neo lÃ m cháº­m Ä‘á»‘i thá»§, káº¿t dÃ­nh cÆ¡ thá»ƒ báº¡n vá»›i há».</p>
<ol start="5" type="1">
<li><strong>hooks (mÃ³c)</strong>:</li>
</ol>
<div class="page-columns page-full"><p>cÃ¡c mÃ³c Ä‘Æ°á»£c táº¡o ra tá»« pháº§n cuá»‘i má»—i chi (ND: bÃ n chÃ¢n, bÃ n tay). tuy nhiÃªn ngÆ°á»i ta thÆ°á»ng chá»‰ hook vá»›i pháº§n mu bÃ n chÃ¢n (instep ~ shoelace area), nÃ³ Ä‘Æ°á»£c gá»i lÃ  butterfly hook. mÃ³c táº¡o ra cÃ¡c chuyá»ƒn Ä‘á»™ng, lá»±c kÃ©o tá»« vá»‹ trÃ­ dÆ°á»›i, yÃªu cáº§u báº¡n pháº£i kiá»ƒm soÃ¡t Ä‘Æ°á»£c khÃ´ng gian phÃ­a trong giá»¯a báº¡n vÃ  Ä‘á»‘i thá»§. </p><div class="no-row-height column-margin column-container"><span class="margin-aside">xem thÃªm <a href="https://bjjmentalmodels.com/inside-channel-control/">inside channel</a></span></div></div>
<p>hook nhÃ¬n chung cÅ©ng yáº¿u, bá»Ÿi vÃ¬ báº¡n kiá»ƒm soÃ¡t tá»« bÃªn trong (khÃ´ng pháº£i bÃªn ngoÃ i vÃ  táº¡o má»™t vÃ²ng <strong>khÃ©p kÃ­n</strong>). nÃ³ sáº½ bá»‹ vÃ´ hiá»‡u hÃ³a náº¿u Ä‘á»‘i phÆ°Æ¡ng luá»“n tay thoÃ¡t vá»‹ trÃ­ (pummels) hoáº·c thoÃ¡t ly, gá»¡ khÃ³a (disengages) ~ thÆ°á»ng thÃ¬ há» cÅ©ng khÃ´ng máº¥t nhiá»u sá»©c vÃ  thá»i gian cho chuyá»‡n nÃ y.</p>
<ol start="6" type="1">
<li><strong>posts (trá»¥)</strong>:</li>
</ol>
<p>post (trá»¥) Ä‘Æ°á»£c dÃ¹ng Ä‘á»ƒ duy trÃ¬ base (cÆ¡ sá»Ÿ). mindset vá» giá»¯ vá»¯ng trá»¥ cho phÃ©p sá»± linh hoáº¡t vÃ  chuyá»ƒn Ä‘á»™ng hÃ´ng (hip) khi á»Ÿ vá»‹ trÃ­ dÆ°á»›i, hay chá»‘ng bá»‹ quÃ©t, láº­t (sweep) khi á»Ÿ vá»‹ trÃ­ trÃªn/Ä‘á»©ng.</p>
<div class="page-columns page-full"><p>khÃ­ sá»­ dá»¥ng post á»Ÿ vá»‹ trÃ­ dÆ°á»›i, Ä‘iá»u quan trá»ng lÃ  trá»¥ pháº£i cÃ¹ng phÆ°Æ¡ng vá»›i vector lá»±c tá»›i, náº¿u khÃ´ng post cá»§a báº¡n sáº½ support cho trá»ng lÆ°á»£ng cá»§a Ä‘á»‘i thá»§. </p><div class="no-row-height column-margin column-container"><span class="margin-aside">xem thÃªn <a href="https://www.bjjmentalmodels.com/force-vectors/">force vectors</a></span></div></div>
</section>
<section id="anatomic-hierarchy" class="level1 page-columns page-full">
<h1>3. <a href="https://bjjmentalmodels.com/anatomic-hierarchy/">anatomic hierarchy</a></h1>
<p>cÆ¡ thá»ƒ con ngÆ°á»i cÃ³ 6 cÆ¡ quan vÅ© khÃ­, trong Ä‘Ã³ core (gÃ²m <em>ngá»±c - chest, bá»¥ng - midsection, hÃ´ng - hips</em>) lÃ  pháº§n máº¡nh nháº¥t.</p>
<ol type="1">
<li>core;</li>
<li>2 legs;</li>
<li>2 arms;</li>
<li>head.</li>
</ol>
<p>vá»›i báº¡n, 6 bá»™ pháº­n nÃ y lÃ  vÅ© khÃ­ chá»‘ng láº¡i Ä‘á»‘i thá»§. á»Ÿ chiá»u ngÆ°á»£c láº¡i - vá»›i há», 6 bá»™ pháº­n nÃ y lÃ  má»¥c tiÃªu Ä‘á»ƒ há» táº¥n cÃ´ng, khá»‘ng cháº¿, vÃ  submits.</p>
<div class="page-columns page-full"><p>hÃ£y luÃ´n nhá»› ráº±ng, báº¡n pháº£i táº­n dá»¥ng tá»‘i Ä‘a pháº§n cÆ¡ thá»ƒ khá»e nháº¥t cá»§a báº¡n. vÃ¬ core lÃ  pháº§n máº¡nh nháº¥t, náº¿u khai thÃ¡c Ä‘Æ°á»£c Ä‘Ã³, xÃ¡c xuáº¥t lÃ  ráº¥t cao báº¡n sá»­ dá»¥ng Ä‘Æ°á»£c cÃ¡c ká»¹ thuáº­t má»™t cÃ¡ch hiá»‡u quáº£. má»™t sai láº§m phá»• biáº¿n cá»§a ngÆ°á»i má»›i lÃ  sá»­ dá»¥ng quÃ¡ má»©c nÄƒng lÆ°á»£ng vÃ o tay vÃ  chÃ¢n. ngoÃ i viá»‡c Æ°u tiÃªn core, báº¡n cÅ©ng cáº§n cÃ³ tÆ° duy sá»­ dá»¥ng má»i bá»™ pháº­n cÆ¡ thá»ƒ nhiá»u nháº¥t cÃ³ thá»ƒ. </p><div class="no-row-height column-margin column-container"><span class="margin-aside">xem thÃªm <a href="https://www.bjjmentalmodels.com/overwhelming-force/">overwhelming force</a></span></div></div>
<p>ngÆ°á»£c láº¡i, nÃªn háº¡n cháº¿ táº¥n cÃ´ng vÃ o core cá»§a Ä‘á»‘i thá»§. sáº½ dá»… dÃ ng hÆ¡n khi táº¥n cÃ´ng vÃ o 4 gÃ³c pháº§n tÆ° cá»§a cÆ¡ thá»ƒ (torso) há» - lÃ  4 chi (limbs) vÃ  táº¥t nhiÃªn bao gá»“m hai bÃªn hÃ´ng vÃ  hai vai. kiá»ƒm soÃ¡t levers táº¡o ra leverages, sáº½ dá»… phÃ¡ vá»¡ Ä‘Æ°á»£c alignment cá»§a Ä‘á»‘i thá»§ hÆ¡n.</p>
</section>
<section id="type-of-guards" class="level1">
<h1>4. <a href="https://bjjmentalmodels.com/types-of-guard/">type of guards</a></h1>
<p>cÃ³ hÃ ng chá»¥c, tháº­m chÃ­ lÃ  hÃ ng trÄƒm cÃ¡c loáº¡i guards, chÃºng cÅ©ng Ä‘ang Ä‘Æ°á»£c thÃªm má»›i má»—i ngÃ y. do Ä‘Ã³ ráº¥t cáº§n thiáº¿t Ä‘á»ƒ hiá»ƒu, phÃ¢n loáº¡i cÃ¡c guards dá»±a trÃªn Ä‘áº·c Ä‘iá»ƒm cÆ¡ cháº¿ (mechanical characteristics) cá»§a chÃºng. chÃºng ta sáº½ hiá»ƒu sÃ¢u hÆ¡n vÃ  dá»… dÃ ng Ã¡p dá»¥ng Ä‘Æ°á»£c hÆ¡n.</p>
<ol type="1">
<li><strong>hook-based</strong>;</li>
</ol>
<p>báº¡n theo vÃ  bÃ¡m (track and check) chuyá»ƒn Ä‘á»™ng cá»§a Ä‘á»‘i thá»§ báº±ng cÃ¡ch â€œmÃ³câ€ (hooking) sá»­ dá»¥ng tay (bÃ n tay) vÃ  chÃ¢n (mu bÃ n chÃ¢n). tuy chÃºng lá»ng láº»o (shallow), vÃ  thÆ°á»ng khÃ´ng cÃ³ tÃ¡c dá»¥ng cá»‘ Ä‘á»‹nh Ä‘á»‘i thá»§ (immobilizing), nhÆ°ng lÃ  cÃ¡ch ráº¥t tá»‘t Ä‘á»ƒ cáº£m nháº­n vá»‹ trÃ­ cÆ¡ thá»ƒ vÃ  pháº£n á»©ng láº¡i. hooks thÆ°á»ng Ä‘Æ°á»£c dÃ¹ng Ä‘á»ƒ nÃ¢ng Ä‘á»‘i thá»§ lÃªn má»™t cÃ¡ch linh hoáº¡t.</p>
<p>vÃ­ dá»¥:</p>
<ul>
<li>butterfly guard;</li>
<li>instep/shin-to-shin guard.</li>
</ul>
<ol start="2" type="1">
<li><strong>clamp-based</strong>;</li>
</ol>
<p>báº¡n sáº½ trÃ³i (tethering) cÆ¡ thá»ƒ cá»§a mÃ¬nh vÃ o cÆ¡ thá»ƒ Ä‘á»‘i thá»§, ngÄƒn cáº£n (hindering) há» chuyá»ƒn Ä‘á»™ng. nhiá»u traditional guard lÃ  dá»±a vÃ o viá»‡c káº¹p, chÃºng báº«y, lÃ m cháº­m Ä‘á»‘i thá»§ vÃ  Ä‘Æ°a há» vÃ o tÃ¬nh tháº¿ khÃ´ng thi Ä‘áº¥u, triá»ƒn khai Ä‘Æ°á»£c phÆ°Æ¡ng Ã¡n. Ä‘á»‘i vá»›i ngÆ°á»i thá»±c hiá»‡n, chÃºng cÅ©ng nguy hiá»ƒm khi cho phÃ©p Ä‘á»‘i thá»§ nÃ¢ng báº¡n lÃªn hoáº·c táº¡o Ã¡p lá»±c báº±ng trá»ng lÆ°á»£ng.</p>
<p>vÃ­ dá»¥:</p>
<ul>
<li>closed guard;</li>
<li>half guard.</li>
</ul>
<ol start="3" type="1">
<li><strong>frame-based</strong>;</li>
</ol>
<p>sá»­ dá»¥ng frame táº¡o thÃ nh tá»« cÃ¡c chi (limbs) Ä‘á»ƒ giá»¯ cho Ä‘á»‘i thá»§ á»Ÿ má»™t khoáº£ng cÃ¡ch an toÃ n. ráº¥t hiá»‡u quáº£ Ä‘á»‘i vá»›i cÃ¡c Ä‘á»‘i thá»§ aggressive hoáº·c khá»e hÆ¡n, cÅ©ng ráº¥t hiá»‡u quáº£ trong MMA vÃ  chiáº¿n Ä‘áº¥u thá»±c táº¿ khi giáº£m hiá»ƒu quáº£ cÃ¡c Ä‘Ã²n Ä‘Ã¡nh/Ä‘áº¥m cá»§a Ä‘á»‘i phÆ°Æ¡ng.</p>
<p>vÃ­ dá»¥:</p>
<ul>
<li>spider guard;</li>
<li>knee shield guard.</li>
</ul>
<ol start="4" type="1">
<li><strong>hybrid</strong>.</li>
</ol>
<p>cÃ¡c guard hiá»‡n Ä‘áº¡i thÆ°á»ng lÃ  sá»± káº¿t há»£p giá»¯a cÃ¡c thá»ƒ loáº¡i Ä‘á» cáº­p á»Ÿ trÃªn.</p>
<p>vÃ­ dá»¥:</p>
<ul>
<li>de la Riva guard vÃ  cÃ¡c biáº¿n thá»ƒ;</li>
<li>X guard vÃ  cÃ¡c biáº¿n thá»ƒ.</li>
</ul>
</section>
<section id="breaking-mechanics" class="level1 page-columns page-full">
<h1>5. <a href="https://bjjmentalmodels.com/breaking-mechanics/">breaking mechanics</a></h1>
<p>cÃ³ 4 kiá»ƒu khÃ³a gÃ£y (breaks):</p>
<ol type="1">
<li><strong>linear</strong> locks: nhÆ° kneebars hoáº·c armbars;</li>
<li><strong>rotational</strong> locks: nhÆ° heel hooks hoáº·c Kimuras;</li>
<li><strong>compression</strong> locks: nhÆ° calf slicer;</li>
<li><strong>hybrid</strong> locks: káº¿t há»£p cÃ¡c kiá»ƒu hÃ¬nh trÃªn.</li>
</ol>
<div class="page-columns page-full"><p>tÆ°Æ¡ng tá»± nhÆ° choke, nÃªn káº¿t há»£p cÃ¡c cÆ¡ cháº¿ khÃ³a gÃ£y báº±ng cÃ¡ch sá»­ dá»¥ng hybrid locks. vÃ­ dá»¥: khi thá»±c hiá»‡n kneebar ~ linear, nÃªn sá»­ dá»¥ng thÃªm rotation Ä‘á»ƒ nÃ³ thÃªm hiá»‡u quáº£. </p><div class="no-row-height column-margin column-container"><span class="margin-aside">xem thÃªm <a href="https://www.bjjmentalmodels.com/choking-mechanics/">chokes</a></span></div></div>
<p>cÃ¡c bÆ°á»›c Ä‘á»ƒ khÃ³a gÃ£y Ä‘á»‘i phÆ°Æ¡ng:</p>
<ol type="1">
<li><strong>isolate a lever</strong>: cÃ´ láº­p má»™t chi, nhÆ° chÃ¢n hoáº·c tay;</li>
<li><strong>prevent predictable defenses</strong>: dá»± Ä‘oÃ¡n cÃ¡c cÃ¡ch phÃ²ng thá»§ cá»§a Ä‘á»‘i thá»§ vÃ  Ä‘Æ°a ra biá»‡n phÃ¡p phÃ²ng ngá»«a, cÅ©ng nÃªn táº­p cáº£i thiá»‡n alignment cá»§a báº£n thÃ¢n trÆ°á»›c khi phÃ¡ vá»¡ alignment cá»§a há»;</li>
<li><strong>maximize leverage</strong>:</li>
</ol>
<ul>
<li>triá»‡t Ä‘á»ƒ cá»‘ Ä‘á»‹nh khá»›p mÃ  báº¡n cÃ³ Ã½ Ä‘á»‹nh táº¥n cÃ´ng, sá»­ dá»¥ng 1 cÃ¡i nÃªm cho khá»›p Ä‘Ã³ vÃ  khá»‘ng cháº¿ cÃ¡c khá»›p lÃ¢n cáº­n.</li>
<li>cÃ¡c khá»›p lÃ¢n cáº­n náº¿u cÃ²n cÃ³ thá»ƒ di chuyá»ƒn sáº½ giáº£m bá»›t Ã¡p lá»±c vÃ  lÃ m suy yáº¿u Ä‘Ã²n táº¥n cÃ´ng cá»§a báº¡n.<br>
</li>
<li>Ä‘áº£m báº£o lÃ  grip lÃ  cháº¯c cháº¯n vÃ  kÃ©o dÃ i â€œcÃ¡nh tay Ä‘Ã²nâ€ nháº¥t cÃ³ thá»ƒ (maximizing leverage), báº¡n pháº£i tá»« tá»« Ä‘Ã o bá»›i â€œdiggingâ€ Ä‘á»ƒ ra Ä‘Æ°á»£c vá»‹ trÃ­ Ä‘Ã³.</li>
<li>trÆ°á»›c khi siáº¿t lá»±c, hÃ£y Ä‘áº£m báº£o mÃ¬nh Ä‘ang cÃ³ vá»‹ trÃ­ tá»‘t nháº¥t. sau khi siáº¿t cáº§n háº¡n cháº¿ chuyá»ƒn Ä‘á»™ng.</li>
<li>cÃ¡c chuyá»ƒn Ä‘á»™ng cá»§a hÃ´ng nÃªn Ä‘Æ°á»£c sá»­ dá»¥ng sau cÃ¹ng;</li>
</ul>
<ol start="4" type="1">
<li><strong>apply overwhelming force</strong>.</li>
</ol>
<p>chá»‰ khi báº¡n cÃ´ láº­p Ä‘Æ°á»£c levers, ngÄƒn cháº·n cÃ¡c rá»§i ro bá»‹ phÃ²ng ngá»±, tá»‘i Æ°u cÃ¡nh tay Ä‘Ã²n báº¡n má»›i nÃªn bung sá»©c.</p>
<div class="page-columns page-full"><p>khi bung sá»©c, cáº§n sá»­ dá»¥ng cáº£ core vÃ  sá»©c máº¡nh tá»« nhiá»u chi nháº¥t cÃ³ thá»ƒ, hÃ£y nhá»› chá»‰ <strong>sau khi</strong> táº­n dá»¥ng tá»‘i Ä‘a cÃ¡c Æ°u tháº¿ kÄ© thuáº­t (technical leverages), báº¡n má»›i bung sá»©c. </p><div class="no-row-height column-margin column-container"><span class="margin-aside">xem thÃªm <a href="https://www.bjjmentalmodels.com/overwhelming-force/">overwhelming force</a></span></div></div>
</section>
<section id="choking-mechanics" class="level1 page-columns page-full">
<h1>6. <a href="https://bjjmentalmodels.com/choking-mechanics/">choking mechanics</a></h1>
<p>cÃ³ nÄƒm loáº¡i siáº¿t ngháº¹t:</p>
<ol type="1">
<li><strong>air chokes</strong>: táº¡o Ã¡p lá»±c lÃªn khÃ­ quáº£n (trachea/windpipe) Ä‘á»ƒ ngÄƒn cáº£n Ä‘á»‘i phÆ°Æ¡ng hÃ´ háº¥p, thá»Ÿ. nÃ³ cÅ©ng cÃ³ thá»ƒ Ä‘Æ°á»£c hiá»‡u chá»‰nh Ä‘á»ƒ táº¡o ra pháº£n xáº¡ háº§u / pháº£n xáº¡ há»ng (gax reflex),  táº¡o ra hiá»‡u á»©ng nhÆ° blood choke;</li>
<li><strong>blood chokes</strong>:</li>
</ol>
<div class="no-row-height column-margin column-container"><span class="margin-aside">xem thÃªm <a href="https://en.wikipedia.org/wiki/Pharyngeal_reflex">pharyngeal reflex</a></span></div><ul>
<li>táº¡o Ã¡p lá»±c lÃªn Ä‘á»™ng máº¡nh cáº£nh (carotid arteries) á»Ÿ hai bÃªn cá»•, ngáº·n cháº·n mÃ¡u lÆ°u thÃ´ng lÃªn nÃ£o vÃ  lÃ m máº¥t Ã½ thá»©c Ä‘á»‘i thá»§. vÃ¬ áº£nh hÆ°á»Ÿng ráº¥t nhanh, blood chokes thÆ°á»ng Ä‘Æ°á»£c coi lÃ  hiá»‡u quáº£ hÆ¡n air chokes, Ä‘a sá»‘ cÃ¡c Ä‘Ã²n chokes trong Jiu-jitsu thuá»™c loáº¡i nÃ y.</li>
<li>má»¥c tiÃªu cá»§a má»i blood choke Ä‘á»u lÃ  tÃ¬m cÃ¡ch siáº¿t cháº·n Ä‘á»™ng máº¡nh cáº£nh, dÃ¹ng má»™t cÃ¡i nÃªm (wedge) Ä‘á»ƒ Ä‘áº©y tá»« sau Ä‘áº§u (ND: trong trÆ°á»ng há»£p cá»§a RNC lÃ  cáº³ng tay) vÃ o choke.</li>
<li>hÃ£y hÃ¬nh dung RNC nhÆ° má»™t tam giÃ¡c bao quanh Ä‘áº§u Ä‘á»‘i thá»§ (hai khuá»·u tay vÃ  1 vai), trong Ä‘Ã³ má»™t gÃ³c tam giÃ¡c - khuá»·u tay á»Ÿ vá»‹ trÃ­ dÆ°á»›i cáº±m (chin). cÃ´ng viá»‡c cá»§a báº¡n lÃ  tÄƒng Ã¡p lá»±c lÃªn má»—i â€œcáº¡nhâ€ cá»§a tam giÃ¡c Ä‘Ã³ Ä‘á»“ng thá»i ghÃ¬m cÃ¡i gÃ³c tam giÃ¡c Ä‘Ã³ xuá»‘ng;</li>
</ul>
<ol start="3" type="1">
<li><strong>cranks</strong>: giá»¯ vÃ  táº¡o má»™t lá»±c xoáº¯n/ ngáº«u lá»±c (torque) tá»›i cá»• (neck) vÃ  cá»™t sá»‘ng (spine), vÃ­ dá»¥ Ä‘áº©y hÃ m (jaw) vÃ o phÃ­a trong sá», hoáº·c váº·n cá»• báº±ng cÃ¡ch sá»­ dá»¥ng hÃ m nhÆ° má»™t Ä‘iá»ƒm mÃ³c. báº¡n khÃ´ng nháº¥t thiáº¿t pháº£i luá»“n Ä‘Æ°á»£c tay vÃ o dÆ°á»›i cáº±m (chin) Ä‘á»ƒ thá»±c hiá»‡n neck crank. crank thÆ°á»ng táº¡o ra cÃ¡c cháº¥n thÆ°Æ¡ng nghiÃªm trá»ng vÃ  thÆ°á»ng háº¡n cháº¿ trong luyá»‡n táº­p, nÃ³ cÅ©ng bá»‹ cáº¥m trong má»™t sá»‘ giáº£i Ä‘áº¥u;</li>
<li><strong>compression chokes</strong>: Ã©p phá»•i lÃ m Ä‘á»‘i phÆ°Æ¡ng khÃ³ chá»‹u vÃ¬ khÃ´ng Ä‘Æ°a khÃ´ng khÃ­ vÃ o phá»•i Ä‘Æ°á»£c, vÃ­ dá»¥ nhÆ° body triangle hay <a href="https://www.youtube.com/watch?v=baiTE16e5xE">Bas Rutten body crush</a>. nÃ³ cÅ©ng cÃ³ thá»ƒ lÃ m gÃ£y xÆ°Æ¡ng sÆ°á»n vÃ  cÃ³ thá»ƒ khÃ´ng há»£p lá»‡ trong má»™t sá»‘ giáº£i Ä‘áº¥u;</li>
<li><strong>hybrid chokes</strong>: nÃªn káº¿t há»£p nhiá»u kÄ© thuáº­t choke khÃ¡c nhau, vÃ­ dá»¥ blook choke káº¿t há»£p vá»›i má»™t yáº¿u tá»‘ crank.</li>
</ol>
</section>
<section id="ratchet-control" class="level1">
<h1>7. <a href="https://bjjmentalmodels.com/ratchet-control/">ratchet control</a></h1>
<p>kiá»ƒm soÃ¡t Ä‘áº§u hoáº·c má»™t chi sáº½ Ä‘Æ¡n giáº£n hÆ¡n ráº¥t nhiá»u náº¿u chÃºng ta xoay trá»¥c (rotation) má»™t chÃºt, vÃ  tá»‘t nháº¥t chÃ­nh lÃ  Ä‘á»ƒ phÆ°Æ¡ng táº¡o lá»±c cá»§a chÃºng ta vuÃ´ng gÃ³c vá»›i phÆ°Æ¡ng chá»‹u lá»±c cá»§a Ä‘á»‘i thá»§ (ND: ngÆ°á»i dá»‹ch confused vá» báº£n dá»‹ch nÃ y). phÆ°Æ¡ng phÃ¡p nÃ y gá»i lÃ  kiá»ƒm soÃ¡t bÃ¡nh cÃ³c (ratchet control). cÃ³ 2 loáº¡i:</p>
<ol type="1">
<li><strong>internal ratchet control</strong>: khi báº¡n xoay má»™t chi <em>ngÆ°á»£c láº¡i vá»›i chuyá»ƒn Ä‘á»™ng tá»± nhiÃªn</em> cá»§a nÃ³. vÃ­ dá»¥ Kimuras (ngoáº·t tay Ä‘á»‘i thá»§ ra sau lÆ°ng) hay heel hooks (trá»¥c chÃ¢n bá»‹ xoay vá»›i hÆ°á»›ng gÃ³t ra ngoÃ i);</li>
<li><strong>external ratchet control</strong>: khi báº¡n xoay má»™t chi <em>theo hÆ°á»›ng chuyá»ƒn Ä‘á»™ng tá»± nhiÃªn</em> cá»§a nÃ³, cho tá»›i khi Ä‘á»‘i thá»§ khÃ´ng chá»‹u Ä‘á»±ng Ä‘Æ°á»£c. vÃ­ dá»¥ Americana hay knee flares.</li>
</ol>
<p>dÃ¹ external ratchet control ráº¥t há»¯u Ã­ch nhÆ°ng nÃ³ thÆ°á»ng mang láº¡i sá»± thoáº£i mÃ¡i cho Ä‘á»‘i thá»§ trong lÃºc báº¡n táº¥n cÃ´ng (khi chÆ°a tá»›i ngÆ°á»¡ng chá»‹u Ä‘á»±ng). nÃªn internal ratchet control thÆ°á»ng Ä‘Æ°á»£c lá»±a chá»n hÆ¡n khi báº¯t Ä‘á»‘i thá»§ pháº£i quay Ä‘i vÃ  Ä‘á»ƒ há»Ÿ lÆ°ng, vÃ­ dá»¥ Kimuras hay backside 50-50.</p>
<p>má»™t sá»‘ vÃ­ dá»¥:</p>
<ul>
<li>khi dÃ¹ng Ä‘Ã²n armbar, hÃ£y xoáº¯n (twist) tay Ä‘á»‘i phÆ°Æ¡ng song song vá»›i viá»‡c duá»—i ra (hyper-extending);</li>
<li>khi dÃ¹ng Ä‘Ã²n kneebar, hÃ£y kÃ©o gÃ³t chÃ¢n gáº§n vá» phÃ­a báº¡n Ä‘á»ƒ tÄƒng lá»±c xoay;</li>
<li>khi kÃ©o Ä‘áº§u Ä‘á»‘i phÆ°Æ¡ng xuá»‘ng, hÃ£y kÃ©o vÃ  váº·n/xoáº¯n cá»•.</li>
</ul>
<p>chÃºng ráº¥t há»¯u dá»¥ng vÃ¬ phÃ¡ Ä‘i posture vÃ  structure cá»§a Ä‘á»‘i thá»§. khi há»‡ xÆ°Æ¡ng cá»§a Ä‘á»‘i phÆ°Æ¡ng khÃ´ng cÃ²n ngay hÃ ng tháº³ng lá»‘i, sá»©c máº¡nh cÆ¡ báº¯p (musculature) cÅ©ng sáº½ bá»‹ háº¡n cháº¿ Ä‘i nhiá»u.</p>
</section>
<section id="controlled-breathing" class="level1 page-columns page-full">
<h1>8. <a href="https://bjjmentalmodels.com/controlled-breathing/">controlled breathing</a></h1>
<p>hÃ£y chÃº Ã½ Ä‘áº¿ nhá»‹p thá»Ÿ cá»§a báº¡n, hÃ£y duy trÃ­ má»™t nhá»‹p thá»Ÿ thoáº£i mÃ¡i (relaxed cadence) cÃ³ chá»§ Ã½ (deliberate).</p>
<div class="page-columns page-full"><p>chÃºng ta thÆ°á»ng nghÄ© tÃ¢m trÃ­ (mind) sáº½ dáº«n dáº¯t cÆ¡ thá»ƒ (body), tuy nhiÃªn trÃªn thá»±c táº¿ chÃºng cÃ³ má»‘i quan há»‡ cháº·t cháº½ vÃ  Ä‘Ã´i khi cÆ¡ cháº¿ lÃ  ngÆ°á»£c láº¡i.  vÃ­ dá»¥ khi báº¡n cÆ°Æ¡i, tÃ¢m lÃ½ cá»§a báº¡n sáº½ vui váº» hÆ¡n. tÆ°Æ¡ng tá»±, kiá»ƒm soÃ¡t hÆ¡i thá»Ÿ sáº½ giÃºp báº¡n thoáº£i mÃ¡i vÃ  tiáº¿t kiá»‡m (conserve) nÄƒng lÆ°á»£ng.</p><div class="no-row-height column-margin column-container"><span class="margin-aside">ref <a href="https://www.scientificamerican.com/article/smile-it-could-make-you-happier/">Smile! It Could Make You Happier</a></span></div></div>
<p>kiá»ƒm soÃ¡t hÆ¡i thá»Ÿ lÃ  ráº¥t quan trá»ng khi báº¡n Ä‘á»‘i Ä‘áº§u vá»›i nhá»¯ng ngÆ°á»i to hoáº·c nhiá»u kinh nghiá»‡m hÆ¡n. bÃªn cáº¡nh viá»‡c báº£o toÃ n Ä‘Æ°á»£c sá»©c lá»±c, nÃ³ cÃ²n giÃºp báº¡n bÃ¬nh tÄ©nh láº¡i. sá»± bÃ¬nh tÄ©nh lÃ  tá»‘i quan trá»ng Ä‘á»ƒ ngÄƒn sá»± hoÃ ng loáº¡n (panicking) khi báº¡n chá»‹u thá»­ thÃ¡ch thá»±c sá»±.</p>
<p>Ä‘á»‘i thá»§ cÃ³ kinh nghiá»‡m cÅ©ng sáº½ cáº£m nháº­n (sensing) Ä‘Æ°á»£c sá»± hoáº£ng loáº¡n náº¿u cÃ³ trong nhá»‹p thá»Ÿ cá»§a báº¡n. thá»Ÿ khÃ´ng kiá»ƒm soÃ¡t cÃ³ thá»ƒ bÃ¡o hiá»‡u sá»± hoáº£ng loáº¡n Ä‘Ã³ cho Ä‘á»‘i thá»§, khiáº¿n anh ta báº¯t Ä‘áº§u táº¥n cÃ´ng chá»›p nhoÃ¡ng (blitz attacking) hoáº·c tÄƒng nhá»‹p Ä‘á»™ (tempo).</p>
<p>nÃ³ cÅ©ng giÃºp tim phÃ¢n phá»‘i lÆ°á»£ng oxy tá»›i cÆ¡ báº¯p Ä‘á»“ng Ä‘á»u hÆ¡n, ráº¥t quan trá»ng trong viá»‡c giá»¯ nhá»‹p tim vÃ  trÃ¡nh má»‡t má»i quÃ¡ má»©c.</p>
</section>
<section id="staying-loose" class="level1 page-columns page-full">
<h1>9. <a href="https://bjjmentalmodels.com/staying-loose/">staying loose</a></h1>
<p>hÃ£y luÃ´n chÃº Ã½ má»™t cÃ¡ch cÃ³ Ã½ thá»©c (conscious attention) tá»›i viá»‡c tháº£ lá»ng cÆ¡ báº¯p (relaxed &amp; fluid), chá»‰ gá»“ng/cÄƒng (tense) chÃºng khi má»i thá»© Ä‘Ã£ sáºµn sÃ ng. nhÆ°ng khi nÃ o thÃ¬ Ä‘Æ°á»£c gá»i lÃ  â€œsáºµn sÃ ngâ€?:</p>
<ul>
<li>chiáº¿m Ä‘Æ°á»£c má»™t gÃ³c Ä‘Ã¡nh Æ°u tháº¿; </li>
<li>phÃ¡ vá»¡, giÃ¡n Ä‘oáº¡n má»™t cÃ¡ch cÃ³ hiá»‡u quáº£ vá»‹ trÃ­ cÄƒn chÃ­nh cá»§a Ä‘á»‘i phÆ°Æ¡ng; </li>
<li>hoáº·c báº¡n Ä‘Æ°a Ä‘á»‘i thá»§ vÃ o má»™t tÃ¬nh huá»‘ng tiáº¿n thoÃ¡i lÆ°á»¡ng nan. </li>
</ul>
<div class="no-row-height column-margin column-container"><span class="margin-aside">xem thÃªm <a href="https://www.bjjmentalmodels.com/dominant-angles/">dominant angles</a></span><span class="margin-aside">xem thÃªm vá» <a href="https://bjjmentalmodels.com/theory-of-alignment/">alignment</a></span><span class="margin-aside">xem thÃªm vá» <a href="https://www.bjjmentalmodels.com/dilemma/">dilema</a></span></div><p>gá»“ng cá»©ng cÆ¡ báº¯p khi khÃ´ng cáº§n thiáº¿t sáº½:</p>
<ul>
<li>lÃ m chÃºng má»‡t má»i (fatigues);</li>
<li>lÃ m lá»™ Ã½ Ä‘á»‹nh cá»§a báº¡n;</li>
<li>tay hoáº·c chÃ¢n gá»“ng quÃ¡ cá»©ng sáº½ dá»… dÃ ng cho Ä‘á»‘i phÆ°Æ¡ng kiá»ƒm soÃ¡t vÃ  khá»‘ng cháº¿.</li>
</ul>
<p>nÃ³ cÅ©ng lÃ  hiá»‡n tÆ°á»£ng dá»… hiá»ƒu khi cÆ¡ cháº¿ pháº£n á»©ng cá»§a con ngÆ°á»i thÆ°á»ng lÃ  sáº½ gá»“ng láº¡i khi cáº£m tháº¥y bá»‹ Ä‘e dá»a, Ä‘Ã³ lÃ  lÃ½ do mÃ  ngÆ°á»i má»›i táº­p thÆ°á»ng gá»“ng cá»©ng khi roll. cáº§n táº­p luyá»‡n vÃ  ká»· luáº­t Ä‘á»ƒ cÃ³ thá»ƒ tháº£ lá»ng Ä‘Æ°á»£c trÆ°á»›c Ã¡p lá»±c - calm under fire!</p>
<p>náº¿u Ä‘a sá»‘ cÃ¡c ká»¹ nÄƒng / ká»¹ thuáº­t mÃ  báº¡n táº­p trung vÃ o Ä‘á»u phá»¥ thuá»™c vÃ o sá»©c máº¡nh cÆ¡ báº¯p, vÃ  báº¡n thÆ°á»ng xuyÃªn cáº£m tháº¥y Ä‘uá»‘i, má»‡t má»i, Ä‘Ã³ chÃ­nh lÃ  dáº¥u hiá»‡u cá»§a viá»‡c báº¡n khÃ´ng thá»±c hiá»‡n Ä‘Ãºng ká»¹ nÄƒng / ká»¹ tháº­t Ä‘Ã³. cáº§n Ä‘Ã¡nh giÃ¡ vÃ  luyá»‡n táº­p láº¡i.</p>
<p>chá»‰ cÃ³ má»™t tÃ­nh huá»‘ng duy nháº¥t mÃ  báº¡n nÃªn bung sá»©c máº¡nh cÆ¡ báº¯p, Ä‘Ã³ lÃ  lÃºc báº¡n Ä‘áº£m báº£o Ä‘Æ°á»£c viá»‡c thá»±c hiá»‡n thÃ nh cÃ´ng má»™t kÄ© thuáº­t, Ä‘á»‘i phÆ°Æ¡ng khÃ´ng thá»ƒ phÃ²ng thá»§ vÃ  báº¡n Ä‘Ã£ á»Ÿ tÆ° tháº¿ hiá»‡u quáº£ nháº¥t cÃ³ thá»ƒ. lÃºc Ä‘Ã³ sá»©c máº¡nh cÆ¡ báº¯p sáº½ khuáº¿ch Ä‘áº¡i cao nháº¥t lá»£i tháº¿ báº¡n Ä‘ang cÃ³.</p>
<p>tÃ³m láº¡i: chá»‰ bung cÆ¡ báº¯p khi Ä‘Ã£ á»Ÿ trong tÃ­nh huá»‘ng hiá»‡u quáº£ nháº¥t trong má»™t Ä‘Ã²n tháº¿, cÃ²n láº¡i, <strong>Ä‘á»«ng</strong>.</p>
<blockquote class="blockquote">
<p>â€œNotice that the stiffest tree is most easily cracked, while the bamboo or willow survives by bending with the wind.â€ <strong>â€”- Bruce Lee</strong></p>
</blockquote>
</section>
<section id="limb-coiling" class="level1">
<h1>10. <a href="https://bjjmentalmodels.com/limb-coiling/">limb coiling</a></h1>
</section>
<section id="elbow-knee-connection" class="level1">
<h1>11. <a href="https://bjjmentalmodels.com/elbow-knee-connection/">elbow-knee connection</a></h1>
</section>
<section id="solid-frames" class="level1">
<h1>12. <a href="https://bjjmentalmodels.com/solid-frames/">solid frames</a></h1>
</section>
<section id="kinetic-chains" class="level1">
<h1>13. <a href="https://bjjmentalmodels.com/kinetic-chains/">kinetic chains</a></h1>
</section>
<section id="body-tethering" class="level1">
<h1>14. <a href="https://bjjmentalmodels.com/body-tethering/">body tethering</a></h1>
</section>
<section id="inside-channel-control" class="level1">
<h1>15. <a href="https://bjjmentalmodels.com/inside-channel-control/">inside channel control</a></h1>
</section>
<section id="single-vs.-double-level-control" class="level1">
<h1>16. <a href="https://bjjmentalmodels.com/single-vs-double-lever-control/">single vs.&nbsp;double level control</a></h1>
</section>
<section id="overwhelming-force" class="level1">
<h1>17. <a href="https://bjjmentalmodels.com/overwhelming-force/">overwhelming force</a></h1>
</section>
<section id="surface-area" class="level1">
<h1>18. <a href="https://bjjmentalmodels.com/surface-area/">surface area</a></h1>
</section>
<section id="joint-rule" class="level1">
<h1>19. 3-joint rule</h1>
</section>
<section id="center-of-gravity" class="level1">
<h1>20. center of gravity</h1>
</section>
<section id="critical-control-points" class="level1">
<h1>21. critical control points</h1>
</section>
<section id="direct-vs.-proxy-control" class="level1">
<h1>22. direct vs.&nbsp;proxy control</h1>
</section>
<section id="force-compression" class="level1">
<h1>23. force compression</h1>
</section>
<section id="force-vectors" class="level1">
<h1>24. force vectors</h1>
</section>
<section id="head-position" class="level1">
<h1>25. head position</h1>
</section>
<section id="inertia" class="level1">
<h1>26. inertia</h1>
</section>
<section id="leading-edges" class="level1">
<h1>27. leading edges</h1>
</section>
<section id="mirrored-stances" class="level1">
<h1>28. mirrored stances</h1>
</section>
<section id="momentum" class="level1">
<h1>29. momentum</h1>
</section>
<section id="priits-45-rule" class="level1">
<h1>30. priitâ€™s 45Â° rule</h1>
</section>
<section id="redundancies" class="level1">
<h1>31. redundancies</h1>
</section>
<section id="seated-vs.-supine-guards" class="level1">
<h1>32. seated vs.&nbsp;supine guards</h1>
</section>
<section id="stress-and-recovery" class="level1">
<h1>33. stress and recovery</h1>
<p><a href="https://www.youtube.com/watch?v=XGZ-0ZoFqKk" class="uri">https://www.youtube.com/watch?v=XGZ-0ZoFqKk</a></p>


<!-- -->

</section>

 ]]></description>
  <category>bjj</category>
  <guid>https://lktuan.github.io/blog/2024-08-06-bjj-mental-models/</guid>
  <pubDate>Mon, 05 Aug 2024 17:00:00 GMT</pubDate>
  <media:content url="https://lktuan.github.io/blog/2024-08-06-bjj-mental-models/bjj_mental_models.jpeg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>Now I know docker init is a thing</title>
  <dc:creator>Tuan Le Khac</dc:creator>
  <link>https://lktuan.github.io/blog/2024-07-30-docker-init/</link>
  <description><![CDATA[ 





<p>TIL that Docker has an <a href="https://docs.docker.com/language/python/containerize/">example</a> for containerizing Python apps. It uses a simple <a href="https://fastapi.tiangolo.com/">FastAPI</a> example for demonstration. We can download the project as below:</p>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">git</span> clone https://github.com/estebanx64/python-docker-example</span></code></pre></div>
<p>After navigating to our project, we can easily set up our project for containerization with <code>docker init</code>. This will create:</p>
<ul>
<li><code>.dockerignore</code></li>
<li><code>Dockerfile</code></li>
<li><code>compose.yaml</code></li>
<li><code>README.Docker.md</code></li>
</ul>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">docker</span> init</span>
<span id="cb2-2"></span>
<span id="cb2-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Welcome</span> to the Docker Init CLI!</span>
<span id="cb2-4"></span>
<span id="cb2-5"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">This</span> utility will walk you through creating the following files with sensible defaults for your project:</span>
<span id="cb2-6">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">-</span> .dockerignore</span>
<span id="cb2-7">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">-</span> Dockerfile</span>
<span id="cb2-8">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">-</span> compose.yaml</span>
<span id="cb2-9">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">-</span> README.Docker.md</span>
<span id="cb2-10"></span>
<span id="cb2-11"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Let</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'s get started!</span></span>
<span id="cb2-12"></span>
<span id="cb2-13"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">? What application platform does your project use? Python</span></span>
<span id="cb2-14"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">? What version of Python do you want to use? (3.11.4)</span></span>
<span id="cb2-15"></span>
<span id="cb2-16"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">? What version of Python do you want to use? 3.11.4</span></span>
<span id="cb2-17"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">? What port do you want your app to listen on? (8000)</span></span>
<span id="cb2-18"></span>
<span id="cb2-19"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">? What port do you want your app to listen on? 8000</span></span>
<span id="cb2-20"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">? What is the command you use to run your app? (uvicorn '</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">app:app</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">' --host=0.0.0.0 --port=8000)</span></span>
<span id="cb2-21"></span>
<span id="cb2-22"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">? What is the command you use to run your app? uvicorn '</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">app:app</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">' --host=0.0.0.0 --port=8000</span></span>
<span id="cb2-23"></span>
<span id="cb2-24"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">âœ” Created â†’ .dockerignore</span></span>
<span id="cb2-25"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">âœ” Created â†’ Dockerfile</span></span>
<span id="cb2-26"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">âœ” Created â†’ compose.yaml</span></span>
<span id="cb2-27"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">âœ” Created â†’ README.Docker.md</span></span>
<span id="cb2-28"></span>
<span id="cb2-29"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">â†’ Your Docker files are ready!</span></span>
<span id="cb2-30"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  Review your Docker files and tailor them to your application.</span></span>
<span id="cb2-31"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  Consult README.Docker.md for information about using the generated files.</span></span>
<span id="cb2-32"></span>
<span id="cb2-33"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">! Warning â†’ Make sure your requirements.txt contains an entry for the uvicorn package, which is required to run your application.</span></span>
<span id="cb2-34"></span>
<span id="cb2-35"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">What'</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">s</span> next<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">?</span></span>
<span id="cb2-36">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Start</span> your application by running â†’ docker compose up <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--build</span></span>
<span id="cb2-37">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Your</span> application will be available at http://localhost:8000</span></code></pre></div>
<p>I can access the application right after running <code>docker compose up --build</code>. The image buidling process was fast, and image size was only <code>203.21MB</code>.</p>
<p>Letâ€™s take a look at the <code>Dockerfile</code>. IMHO, this is not yet a optimal Dockerized Python project:</p>
<ul>
<li>Lack off a dependency management tool (for e.g, <code>pipenv</code>, <code>poetry</code> both are good, production-ready);</li>
<li>This is single-step builder. Should we split it to <code>dependencies</code> and <code>runtime</code> steps, which will limit the objects in the <code>runtime</code> image to only those needed to run the application? </li>
</ul>
<div class="no-row-height column-margin column-container"><span class="margin-aside">further reading, <a href="https://sourcery.ai/blog/python-docker/">â€œA perfect way to Dockerize your Pipenv Python applicationâ€</a></span></div><p>I do see some good practices here that we should run our apps in a non-privileged user rather than root as well as <em>mount cache and bind</em>, using Dockerâ€™s BuildKit feature, which allows more advanced mounting capabilities during build time:</p>
<ol type="1">
<li>first <code>--mount=type=cache,target=/root/.cache/pip</code> option:</li>
</ol>
<ul>
<li>This creates a cache mount for pipâ€™s cache directory;</li>
<li>It speeds up subsequent builds by reusing cached pip packages;</li>
<li>The cache persists between builds, saving time and bandwidth.</li>
</ul>
<ol start="2" type="1">
<li>second <code>--mount=type=bind,source=requirements.txt,target=requirements.txt</code> option:</li>
</ol>
<ul>
<li>This creates a bind mount for the <code>requirements.txt</code> file;</li>
<li>It allows access to the <code>requirements.txt</code> file without copying it into the image layer;</li>
<li>This is useful for keeping the image size smaller and allowing changes to <code>requirements.txt</code> without rebuilding all layers.</li>
</ul>
<p>In conclusion, benefits are:</p>
<ol type="1">
<li><strong>Faster builds</strong>: By using a cache mount for pip, subsequent builds can reuse cached packages, significantly speeding up the process.</li>
<li><strong>Smaller image size</strong>: The bind mount for <code>requirements.txt</code> means the file doesnâ€™t need to be copied into the image, keeping the image size smaller.</li>
<li><strong>Better caching</strong>: Changes to <code>requirements.txt</code> donâ€™t invalidate the entire layer cache, only the parts that have changed.</li>
<li><strong>Separation of concerns</strong>: Downloading dependencies is done as a separate step, which can be beneficial for Dockerâ€™s layer caching mechanism.</li>
</ol>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># syntax=docker/dockerfile:1</span></span>
<span id="cb3-2"></span>
<span id="cb3-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Comments are provided throughout this file to help you get started.</span></span>
<span id="cb3-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># If you need more help, visit the Dockerfile reference guide at</span></span>
<span id="cb3-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># https://docs.docker.com/go/dockerfile-reference/</span></span>
<span id="cb3-6"></span>
<span id="cb3-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Want to help us make this template better? Share your feedback here: https://forms.gle/ybq9Krt8jtBL3iCk7</span></span>
<span id="cb3-8"></span>
<span id="cb3-9"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ARG</span> PYTHON_VERSION=3.11.4</span>
<span id="cb3-10"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">FROM</span> python:<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${PYTHON_VERSION}</span>-slim as base</span>
<span id="cb3-11"></span>
<span id="cb3-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Prevents Python from writing pyc files.</span></span>
<span id="cb3-13"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ENV</span> PYTHONDONTWRITEBYTECODE=1</span>
<span id="cb3-14"></span>
<span id="cb3-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Keeps Python from buffering stdout and stderr to avoid situations where</span></span>
<span id="cb3-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># the application crashes without emitting any logs due to buffering.</span></span>
<span id="cb3-17"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ENV</span> PYTHONUNBUFFERED=1</span>
<span id="cb3-18"></span>
<span id="cb3-19"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">WORKDIR</span> /app</span>
<span id="cb3-20"></span>
<span id="cb3-21"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create a non-privileged user that the app will run under.</span></span>
<span id="cb3-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># See https://docs.docker.com/go/dockerfile-user-best-practices/</span></span>
<span id="cb3-23"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ARG</span> UID=10001</span>
<span id="cb3-24"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">RUN</span> adduser <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-25">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--disabled-password</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-26">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--gecos</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-27">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--home</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/nonexistent"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-28">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--shell</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/sbin/nologin"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-29">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--no-create-home</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-30">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--uid</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${UID}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-31">    appuser</span>
<span id="cb3-32"></span>
<span id="cb3-33"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Download dependencies as a separate step to take advantage of Docker's caching.</span></span>
<span id="cb3-34"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Leverage a cache mount to /root/.cache/pip to speed up subsequent builds.</span></span>
<span id="cb3-35"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Leverage a bind mount to requirements.txt to avoid having to copy them into</span></span>
<span id="cb3-36"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># into this layer.</span></span>
<span id="cb3-37"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">RUN</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--mount</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>type=cache,target=/root/.cache/pip <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-38">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--mount</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>type=bind,source=requirements.txt,target=requirements.txt <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-39">    python <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-m</span> pip install <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-r</span> requirements.txt</span>
<span id="cb3-40"></span>
<span id="cb3-41"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Switch to the non-privileged user to run the application.</span></span>
<span id="cb3-42"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">USER</span> appuser</span>
<span id="cb3-43"></span>
<span id="cb3-44"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Copy the source code into the container.</span></span>
<span id="cb3-45"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">COPY</span> . .</span>
<span id="cb3-46"></span>
<span id="cb3-47"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Expose the port that the application listens on.</span></span>
<span id="cb3-48"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">EXPOSE</span> 8000</span>
<span id="cb3-49"></span>
<span id="cb3-50"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Run the application.</span></span>
<span id="cb3-51"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CMD</span> uvicorn <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'app:app'</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--host</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0.0.0 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--port</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>8000</span></code></pre></div>
<p>Happy coding!</p>


<!-- -->


 ]]></description>
  <category>docker</category>
  <category>python</category>
  <guid>https://lktuan.github.io/blog/2024-07-30-docker-init/</guid>
  <pubDate>Mon, 29 Jul 2024 17:00:00 GMT</pubDate>
  <media:content url="https://lktuan.github.io/blog/2024-07-30-docker-init/python_docker.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>BJJ Beginners Guide</title>
  <dc:creator>Tuan Le Khac</dc:creator>
  <link>https://lktuan.github.io/blog/2024-07-29-bjj-beginners-guide/</link>
  <description><![CDATA[ 





<p>ÄÃ¢y lÃ  bÃ i (lÆ°á»£c) dá»‹ch tá»« beginners guide cá»§a Reddit community <code>r/bjj</code>. Link gá»‘c bÃ i viáº¿t: <a href="https://www.reddit.com/r/bjj/wiki/beginners-guide/" class="uri">https://www.reddit.com/r/bjj/wiki/beginners-guide/</a>. Má»™t sá»‘ thuáº­t ngá»¯ mÃ¬nh cÃ³ thá»ƒ sáº½ Ä‘á»ƒ nguyÃªn báº£n Tiáº¿ng Anh, hoáº·c Ä‘á»ƒ kÃ¨m trong ngoáº·c trÃ²n <code>()</code>, chÃº thÃ­ch (náº¿u cÃ³) sáº½ Ä‘Æ°á»£c Ä‘áº·t trong dáº¥u ngoáº·c trÃ²n sau â€œNDâ€.</p>
<p>Má»¥c Ä‘Ã­ch Ä‘Ã¡nh giÃ¡ láº¡i nhá»¯ng gÃ¬ mÃ¬nh Ä‘áº¡t Ä‘Æ°á»£c sau 6 thÃ¡ng theo Ä‘uá»•i BJJ.</p>
<section id="hÆ°á»›ng-dáº«n-jiu-jitsu-cho-ngÆ°á»i-má»›i-báº¯t-Ä‘áº§u" class="level1">
<h1>HÆ°á»›ng dáº«n Jiu-jitsu cho ngÆ°á»i má»›i báº¯t Ä‘áº§u</h1>
<p>ChÃ o má»«ng Ä‘áº¿n vá»›i Brazil Jiujitsu vÃ  chÃ o má»«ng Ä‘áº¿n vá»›i <code>r/bjj</code>! ÄÃ¢y lÃ  hÆ°á»›ng dáº«n tá»•ng há»£p dÃ nh cho ngÆ°á»i má»›i Ä‘á»ƒ báº¯t Ä‘áº§u hÃ nh trÃ¬nh Jiu-jitsu cá»§a báº¡n.</p>
<p>ChÃºc may máº¯n, vÃ  hÃ£y tá»­ táº¿!</p>
<p>Báº¡n cÃ³ Ä‘á» xuáº¥t, cáº£i tiáº¿n hoáº·c nháº­n xÃ©t cho bÃ i viáº¿t nÃ y? Äá»ƒ nÃ³ á»Ÿ <a href="https://docs.google.com/forms/d/e/1FAIpQLSclF8d-uXVmPVQ3EoV3K-SexnoWbefI5y6lofkSUNI68RpDCQ/viewform">Ä‘Ã¢y</a>.</p>
</section>
<section id="bjj-lÃ -gÃ¬" class="level1">
<h1>BJJ lÃ  gÃ¬?</h1>
<p>Brazilian Jiu-jitsu, Ä‘Ã´i lÃºc gá»i lÃ  Jiu-jitsu (ND: å…«å››æŸ”æœ¯ Nhu thuáº­t Brazin) lÃ  má»™t mÃ´n vÃµ káº¿ thá»«a tá»« Judo (ND: æŸ”é“ Nhu Ä‘áº¡o Nháº­t báº£n). NÃ³:</p>
<ul>
<li>Äá»‘i khÃ¡ng (contact), nghÄ©a lÃ  báº¡n cáº§n tranh giÃ nh Æ°u tháº¿, chiáº¿n tháº¯ng vá»›i ngÆ°á»i khÃ¡c;</li>
<li>Tay khÃ´ng (bare-handed), nghÄ©a lÃ  khÃ´ng vÅ© khÃ­ nÃ o Ä‘Æ°á»£c cháº¥p nháº­n;</li>
<li>Dá»±a vÃ o váº­t lá»™n (grappling-based), phÆ°Æ¡ng thá»©c chiáº¿n Ä‘áº¥u lÃ  váº­t (grappling, wrestling), Ä‘áº¥m (punching) vÃ  Ä‘Ã¡ (kicking) lÃ  khÃ´ng Ä‘Æ°á»£c phÃ©p;</li>
<li>Submission-based (ND: chÆ°a thá»ƒ dá»‹ch tá»« nÃ y), nghÄ©a lÃ  má»¥c tiÃªu cáº§n Ä‘áº¡t Ä‘Æ°á»£c lÃ  báº¯t Ä‘á»‘i thá»§ Ä‘áº§u hÃ ng (submission) thÃ´ng qua má»™t Ä‘Ã²n siáº¿t ngháº¹t (choke) hoáº·c Ä‘e dá»a tá»•n thÆ°Æ¡ng tá»›i cÃ¡c khá»›p cá»§a há», hÆ¡n lÃ  chá»‰ Ä‘Æ¡n thuáº§n lÃ  chiáº¿m vá»‹ trÃ­ Æ°u tháº¿ (positioning) hoáº·c ghim cháº·t Ä‘á»‘i thá»§ (pinning).</li>
</ul>
<p>BJJ khÃ¡c vá»›i Judo á»Ÿ chá»— nÃ³ thiÃªn vá» váº­t lá»™n / Ä‘á»‹a chiáº¿n (ground grappling), trong khi Judo nháº¥n máº¡nh vá» quÄƒng (throws) vÃ  quáº­t ngÃ£ (takedowns) tá»« vá»‹ trÃ­ Ä‘á»©ng.</p>
</section>
<section id="tÃ´i-cÃ³-thá»±c-sá»±-thÃ­ch-jiu-jitsu-khÃ´ng" class="level1">
<h1>TÃ´i cÃ³ (thá»±c sá»±) thÃ­ch Jiu-jitsu khÃ´ng?</h1>
<p>Báº¡n sáº½ thÃ­ch Jiu-jitsu náº¿u:</p>
<ul>
<li>Äang tÃ¬m kiáº¿m má»™t bÃ i thá»ƒ thao rÃ¨n luyá»‡n (workout), nhÆ°ng ghÃ©t táº­p cÃ¡c mÃ´n thá»ƒ dá»¥c nhÆ° cháº¡y bá»™, nÃ¢ng táº¡;</li>
<li>TÃ¬m kiáº¿m má»™t cá»™ng Ä‘á»“ng sÃ´i Ä‘á»™ng;</li>
<li>Cáº§n tÃ¬m cáº£m giÃ¡c cÃ³ má»¥c Ä‘Ã­ch vÃ  tiáº¿n bá»™;</li>
<li>ThÃ­ch cÃ¡c hoáº¡t Ä‘á»™ng thá»ƒ thao káº¿t há»£p thá»ƒ cháº¥t vÃ  trÃ­ nÃ£o (cerebral), nhÆ° leo nÃºi;</li>
<li>ÄÃ£ tá»«ng Ä‘Ã o táº¡o cÃ¡c mÃ´n thá»ƒ thao Ä‘á»‘i khÃ¡ng (combat) khÃ¡c;</li>
<li>Muá»‘n thá»­ gÃ¬ Ä‘Ã³ má»›i máº»?.</li>
</ul>
</section>
<section id="jiu-jitsu-cÃ³-phÃ¹-há»£p-vá»›i-tÃ´i-khÃ´ng" class="level1">
<h1>Jiu-jitsu cÃ³ phÃ¹ há»£p vá»›i tÃ´i khÃ´ng?</h1>
<p>NÃ³ phÃ¹ há»£p vá»›i táº¥t cáº£ báº¥t ká»ƒ tuá»•i, thá»ƒ tráº¡ng, giá»›i tÃ­nh, hoÃ n cáº£nh, kinh nghiá»‡m. Tuy nhiÃªn, cÃ³ thá»ƒ táº­p vÃ  khÃ´ng cáº§n coi nÃ³ lÃ  sá»Ÿ thÃ­ch cá»§a báº¡n, vÃ  báº¡n cÅ©ng khÃ´ng cáº§n xuáº¥t sáº¯c trong mÃ´n nÃ y. Má»¥c tiÃªu khÃ´ng pháº£i lÃ  hÆ¡n thua vá»›i ngÆ°á»i khÃ¡c, mÃ  lÃ  trá»Ÿ nÃªn <em>tá»‘t nháº¥t cÃ³ thá»ƒ</em>.</p>
</section>
<section id="lÃ m-sao-Ä‘á»ƒ-thá»­-vÃ -báº¯t-Ä‘áº§u" class="level1">
<h1>LÃ m sao Ä‘á»ƒ thá»­ vÃ  báº¯t Ä‘áº§u</h1>
<ol type="1">
<li>TÃ¬m má»™t phÃ²ng táº­p, nÃªn lÃ  cÃ¡c phÃ²ng cÃ³ Ä‘Ã¡nh giÃ¡ tá»‘t;</li>
<li>TÃ¬m hiá»ƒu lá»‹ch táº­p, chÃ­nh sÃ¡ch, giÃ¡ cáº£;</li>
<li>Máº·c quáº§n Ã¡o thoáº£i mÃ¡i, khÃ´ng Ä‘eo trang sá»©c, mang nÆ°á»›c, thá»i Ä‘iá»ƒm nÃ y báº¡n chÆ°a cáº§n trang bá»‹ nÃ o khÃ¡c;</li>
<li>Táº­p thá»­;</li>
<li>Lá»›p thÃ´ng thÆ°á»ng sáº½ bao gá»“m: khá»Ÿi Ä‘á»™ng (warmups), dáº¡y kÄ© thuáº­t vÃ  táº­p luyá»‡n (teaching &amp; drilling), sau Ä‘Ã³ lÃ  Ä‘á»‘i khÃ¡ng (sparring, rolling, open mat). Táº­p nháº¹ nhÃ ng vÃ  khÃ´ng nÃªn kÃ¬ vá»ng quÃ¡ nhiá»u;</li>
<li>(&amp; 7) Xin táº­p thá»­ thÃªm, hoáº·c tÃ¬m má»™t CLB khÃ¡c, hÃ£y máº¡nh dáº¡n, cho tá»›i khi Æ°ng Ã½.</li>
</ol>
</section>
<section id="lá»±a-chá»n-clbphÃ²ng-táº­p" class="level1">
<h1>Lá»±a chá»n CLB/PhÃ²ng táº­p</h1>
<p>Náº¿u tháº¥y thÃ­ch BJJ thÃ¬ báº¡n nÃªn commit tá»›i má»™t phÃ²ng táº­p. DÆ°á»›i Ä‘Ã¢y lÃ  cÃ¡c tiÃªu chÃ­:</p>
<ul>
<li>KhÃ´ng khÃ­ (Vibe): Tháº¥y há»£p khÃ´ng (jibe with the vibe), cÃ¡c thÃ nh viÃªn cÃ³ thÃ¢n thiá»‡n khÃ´ng. Trang thiáº¿t bá»‹ cÃ³ sÆ¡ sÃ i, cÃ³ mÃ¹i hay khÃ´ng?;</li>
<li>Cháº¥t lÆ°á»£ng (Quality): CÃ³ nÄƒng lá»±c tá»• chá»©c tá»‘t hay khÃ´ng? Há» focus vÃ o Jiu-jitsu hay cÃ¡c mÃ´n khÃ¡c ná»¯a? NgÆ°á»i chá»§ cÃ³ Ä‘ai Ä‘en hay khÃ´ng? Há» Ä‘Ã o táº¡o BJJ bao lÃ¢u rá»“i?;</li>
<li>Äá»‹a Ä‘iá»ƒm (Location): Thuáº­n tiá»‡n cho báº¡n hay khÃ´ng?;</li>
<li>Chi phÃ­ (Cost): CÃ³ phÃ¹ há»£p vá»›i báº¡n hay khÃ´ng?.</li>
</ul>
</section>
<section id="cÃ¡c-quy-táº¯c-lá»‹ch-sá»±" class="level1">
<h1>CÃ¡c quy táº¯c lá»‹ch sá»±</h1>
<section id="tá»•ng-quan" class="level2">
<h2 class="anchored" data-anchor-id="tá»•ng-quan">Tá»•ng quan</h2>
<p>HÃ£y lá»‹ch sá»­ vÃ  tuÃ¢n thá»§ cÃ¡c quy táº¯c. Báº¡n Ä‘ang tham gia má»™t cá»™ng Ä‘á»“ng Ä‘ang cá»‘ gáº¯ng cáº£i thiá»‡n ká»¹ nÄƒng cá»§a há», chá»© khÃ´ng pháº£i chiáº¿n Ä‘áº¥u Ä‘á»ƒ Ä‘á»©ng Ä‘áº§u theo kiá»ƒu cá»§a báº¡n.</p>
</section>
<section id="vá»‡-sinh-vÃ -sá»©c-khá»e" class="level2">
<h2 class="anchored" data-anchor-id="vá»‡-sinh-vÃ -sá»©c-khá»e">Vá»‡ sinh vÃ  sá»©c khá»e</h2>
<ul>
<li>Äá»«ng Ä‘áº¿n phÃ²ng táº­p náº¿u báº¡n á»‘m hoáº·c cÃ³ virus hoáº·c bá»‡nh truyá»n nhiá»…m khÃ¡c;</li>
<li>Mang dÃ©p hoáº·c giÃ y ngoÃ i tháº£m, Ä‘i chÃ¢n Ä‘áº¥t trÃªn tháº£m;</li>
<li>Giáº·t, vá»‡ sinh Ä‘á»“ táº­p sau má»—i buá»•i há»c;</li>
<li>Cáº¯t gá»n ngÃ³n chÃ¢n / tay Ä‘á»ƒ trÃ¡nh lÃ m bá»‹ thÆ°Æ¡ng báº¡n táº­p;</li>
<li>Sá»­ dá»¥ng xá»‹t khá»­ mÃ¹i, nÆ°á»›c sÃºc miá»‡ng náº¿u cáº§n;</li>
<li>TrÆ°á»›c buá»•i táº­p náº¿u cÃ³ má»“ hÃ´i hoáº·c mÃ¹i, hÃ£y táº¯m trÆ°á»›c;</li>
<li>Táº¯m cÃ ng sá»›m cÃ ng tá»‘t sau buá»•i táº­p Ä‘á»ƒ trÃ¡nh nhiá»…m trÃ¹ng da;</li>
<li>ChÃº Ã½ Ä‘áº¿n da, náº¿u cÃ³ váº¥n Ä‘á» hÃ£y ngá»«ng táº­p vÃ  gáº·p bÃ¡c sÄ©.</li>
</ul>
</section>
<section id="táº­p-luyá»‡n-kÄ©-thuáº­t-drilling" class="level2">
<h2 class="anchored" data-anchor-id="táº­p-luyá»‡n-kÄ©-thuáº­t-drilling">Táº­p luyá»‡n kÄ© thuáº­t (Drilling)</h2>
<ul>
<li>Chia Ä‘á»u thá»i gian cá»§a báº¡n vÃ  báº¡n táº­p;</li>
<li>Chá»‰ nÃªn Ä‘Æ°a ra lá»i khuyÃªn khi báº¡n thá»±c sá»± tá»± tin, náº¿u khÃ´ng thÃ¬ nghe coach (ND: Biáº¿t thÃ¬ thÆ°a thá»‘t, khÃ´ng biáº¿t dá»±a cá»™t mÃ  nghe);</li>
<li>Má»¥c tiÃªu lÃ  táº­p luyá»‡n cÃ¡c Ä‘á»™ng tÃ¡c trong Ä‘iá»u kiá»‡n khÃ´ng cÃ³ Ã¡p lá»±c tá»« Ä‘á»‘i thá»§. NÃªn Ä‘á»«ng táº¡o Ã¡p lá»±c quÃ¡ nhiá»u cho báº¡n táº­p, cÅ©ng khÃ´ng nÃªn quÃ¡ thoáº£i mÃ¡i nhÆ° má»™t ngÆ°á»i ná»™m;</li>
<li>Táº­p trung vÃ o cÃ¡c chuyá»‡n Ä‘á»™ng (movement) hÆ¡n lÃ  Ä‘áº¡t Ä‘Æ°á»£c káº¿t quáº£ cá»§a Ä‘á»™ng tÃ¡c.</li>
</ul>
</section>
<section id="táº­p-luyá»‡n-Ä‘á»‘i-khÃ¡ng-rolling" class="level2">
<h2 class="anchored" data-anchor-id="táº­p-luyá»‡n-Ä‘á»‘i-khÃ¡ng-rolling">Táº­p luyá»‡n Ä‘á»‘i khÃ¡ng (Rolling)</h2>
<ul>
<li>Báº¡n cÃ³ quyá»n tá»« chá»‘i viá»‡c roll vá»›i báº¥t cá»© ai, trong báº¥t cá»© thá»i Ä‘iá»ƒm nÃ o, hoáº·c báº¥t kÃ¬ lÃ­ do nÃ o. Há» cÃ³ thá»ƒ khÃ´ng thÃ­ch hoáº·c cho ráº±ng nÃ³ thiáº¿u lá»‹ch sá»±, nhÆ°ng, báº¡n cÃ³ quyá»n;</li>
<li>NgÆ°á»i ta thÆ°á»ng Ä‘áº­p vÃ  cá»¥ng ta (hand slap and dump) Ä‘á»ƒ Ä‘Ã¡nh dáº¥u cho má»™t ca roll báº¯t Ä‘áº§u;</li>
<li>Cáº£m Æ¡n báº¡n táº­p sau má»—i láº§n roll, báº¥t ká»ƒ nÃ³ káº¿t thÃºc nhÆ° tháº¿ nÃ o;</li>
<li>Má»¥c tiÃªu cá»§a roll lÃ  há»c há»i chá»© khÃ´ng pháº£i chiáº¿n tháº¯ng, Ä‘á»ƒ dÃ nh cÃ¡i ham muá»‘n Ä‘Ã³ cho cÃ¡c tráº­n Ä‘Ã¡nh thá»±c sá»±;</li>
<li>Äiá»u tá»‡ nháº¥t báº¡n cÃ³ thá»ƒ lÃ m lÃ  gÃ¢y ra cháº¥n thÆ°Æ¡ng cho báº¡n táº­p;</li>
<li>Má»™t sá»‘ tháº¿ submission cÃ³ thá»ƒ chuyá»ƒn tá»« khÃ´ng Ä‘au cho tá»›i táº¡o ra cháº¥n thÆ°Æ¡ng nghiÃªm trá»ng nháº¥t nhanh. Trong cÃ¡c trÆ°á»ng há»£p Ä‘Ã³, hÃ£y siáº¿t lá»±c cháº­m láº¡i Ä‘á»ƒ táº¡o thá»i gian cho báº¡n táº­p tap-out;</li>
<li>Khi roll vá»›i má»™t báº¡n táº­p nhá» hÆ¡n mÃ¬nh nhiá»u, Ä‘á»«ng cá»‘ gáº¯ng dÃ¹ng trá»ng lÆ°á»£ng Ä‘á»ƒ Ä‘Ã¨ há» xuá»‘ng. Má»¥c tiÃªu lÃ  há»c há»i, vÃ  5 phÃºt Ä‘Ã¨ nhÆ° váº­y vÃ  cháº£ ai há»c Ä‘Æ°á»£c gÃ¬ cáº£. HÃ£y cá»‘ linh hoáº¡t nhiá»u tÆ° tháº¿;</li>
<li>CÃ¡c va cháº¡m tÃ¬nh cá» vÃ o cÃ¡c vÃ¹ng nháº¡y cáº£m lÃ  Ä‘iá»u bÃ¬nh thÆ°á»ng trong cÃ¡c mÃ´n váº­t. Cá»© tiáº¿p tá»¥c roll hoáº·c nÃ³i â€œSorryâ€ náº¿u báº¡n muá»‘n, khÃ´ng nÃªn giáº£i thÃ­ch dÃ i dÃ²ng vÃ  nÃªn táº­p trung vÃ o táº­p luyá»‡n.</li>
</ul>
</section>
</section>
<section id="tá»•ng-quan-cÃ¡c-vá»‹-trÃ­-trong-bjj" class="level1">
<h1>Tá»•ng quan cÃ¡c vá»‹ trÃ­ trong BJJ</h1>
<p>Jiu-jitsu cÃ³ phong phÃº cÃ¡c tháº¿, tÆ° tháº¿ chiáº¿n Ä‘áº¥u (configurations and positions). Má»—i tÆ° tháº¿, Ä‘á»‘i vá»›i cáº£ báº¡n vÃ  báº¡n táº­p Ä‘á»u sáº½ cÃ³ cÃ¡c chiáº¿n lÆ°á»£c, ká»¹ thuáº­t khÃ¡c nhau.</p>
<p>Má»—i tháº¿ sáº½ tÆ°Æ¡ng Æ°ng lÃ  sá»± chiáº¿m Æ°u tháº¿ cho má»™t cÃ¡ nhÃ¢n, vÃ  sá»± tháº¥t tháº¿ cho má»™t bÃªn cÃ²n láº¡i. Äá»‘i vá»›i ngÆ°á»i chiáº¿m Æ°u tháº¿, báº¡n Ä‘ang táº¥n cÃ´ng, ngÆ°á»£c láº¡i, báº¡n Ä‘ang trong vai trÃ² phÃ²ng thá»§. (ND) Sá»± chÃªnh lá»‡ch giá»¯a Æ°u / tháº¥t tháº¿ cÅ©ng sáº½ khÃ¡c nhau cho cÃ¡c tháº¿ Ä‘Ã¡nh khÃ¡c nhau. Má»—i ngÆ°á»i Ä‘á»u sáº½ cá»‘ gáº¯ng dÃ¹ng cÃ¡c chiáº¿n lÆ°á»£c vÃ  kÄ© thuáº­t Ä‘á»ƒ táº¡o lá»£i tháº¿ cho báº£n thÃ¢n.</p>
<p>DÆ°á»›i Ä‘Ã¢y lÃ  má»™t sá»‘ tháº¿ nhÆ° váº­y, báº¡n khÃ´ng cáº§n ghi nhá»›, báº¡n sáº½ Ä‘Æ°á»£c dáº¡y theo thá»i gian:</p>
<p><em>All photos below credit to orginal post.</em></p>
<section id="closed-guard" class="level2">
<h2 class="anchored" data-anchor-id="closed-guard">Closed Guard</h2>
<p>Closed Guard lÃ  tÆ° tháº¿ phá»‘ biáº¿n nháº¥t cho ngÆ°á»i má»›i báº¯t Ä‘áº§u, hai chÃ¢n báº¡n sáº½ vÃ²ng qua hÃ´ng (waist) Ä‘á»‘i thá»§ vÃ  dÃ¹ng máº¯t cÃ¡ chÃ¢n khÃ³a (ankles) láº¡i. Lá»£i tháº¿ thuá»™c vá» ngÆ°á»i á»Ÿ trÃªn (báº¡n táº­p cá»§a báº¡n).</p>
<p>Trong Jiu-jitsu, â€œguardâ€ mang nghÄ©a tÆ°Æ¡ng tá»± nhÆ° â€œchÃ¢nâ€, tÆ° tháº¿ nÃ y Ä‘Æ°á»£c gá»i nhÆ° váº­y vÃ¬ báº¡n dÃ¹ng chÃ¢n khÃ³a kÃ­n Ä‘á»‘i thá»§.</p>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="1">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://lktuan.github.io/blog/2024-07-29-bjj-beginners-guide/closed_guard.png" class="img-fluid figure-img"></p>
<figcaption>Closed Guard</figcaption>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="open-guard" class="level2">
<h2 class="anchored" data-anchor-id="open-guard">Open Guard</h2>
<p>Khi ngÆ°á»i á»Ÿ trÃªn cÃ³ thá»ƒ thoÃ¡t, gá»¡ Ä‘Æ°á»£c mÃ³c ná»‘i giá»¯a hai máº¯t cÃ¡ chÃ¢n, sáº½ hÃ¬nh thÃ nh nÃªn tÆ° tháº¿ Open Guard. LÃºc nÃ y â€œguardâ€ Ä‘Ã£ Ä‘Æ°á»£c â€œopenâ€, tÆ° tháº¿ nÃ y ráº¥t linh Ä‘á»™ng vÃ  cÃ³ nhiá»u biáº¿n thá»ƒ / tÃªn gá»i cho tá»«ng vá»‹ trÃ­ cá»¥ thá»ƒ, nhÆ° <em>Spider Guard</em> hay <em>Lasso Guard</em>. NhÃ¬n chung tÆ° tháº¿ nÃ y khÃ´ng cÃ³ lá»£i cho cáº£ hai ngÆ°á»i.</p>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="1">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://lktuan.github.io/blog/2024-07-29-bjj-beginners-guide/open_guard.png" class="img-fluid figure-img"></p>
<figcaption>Open Guard</figcaption>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="side-control" class="level2">
<h2 class="anchored" data-anchor-id="side-control">Side Control</h2>
<p>Khi má»™t ngÆ°á»i cÃ³ thá»ƒ vÃ²ng qua chÃ¢n cá»§a ngÆ°á»i phÃ­a dÆ°á»›i vÃ  kiá»ƒm soÃ¡t thÃ¢n mÃ¬nh (torso) thÃ¬ ngÆ°á»i Ä‘Ã³ Ä‘Æ°á»£c xem lÃ  Ä‘Ã£ â€œpassed the guardâ€, Ä‘á»™ng tÃ¡c nÃ y káº¿t thÃºc báº±ng tá»« tháº¿ Side Control. Lá»£i tháº¿ thuá»™c vá» ngÆ°á»i Ä‘Ã³ - ngÆ°á»i á»Ÿ trÃªn.</p>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="1">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://lktuan.github.io/blog/2024-07-29-bjj-beginners-guide/side_control.png" class="img-fluid figure-img"></p>
<figcaption>Side Control</figcaption>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="mount" class="level2">
<h2 class="anchored" data-anchor-id="mount">Mount</h2>
<p>Náº¿u ngÆ°á»i á»Ÿ trÃªn cÃ³ thá»ƒ giÃ nh Ä‘Æ°á»£c nhiá»u quyá»n kiá»ƒm soÃ¡t hÆ¡n, há» cÃ³ thá»ƒ ngá»“i lÃªn pháº§n bá»¥ng (hips) hoáº·c ngá»±c (chest), tÆ° tháº¿ nÃ y Ä‘Æ°á»£c gá»i lÃ  Mount vÃ  nÃ³ <em>cá»±c kÃ¬</em> cÃ³ lá»£i cho ngÆ°á»i á»Ÿ trÃªn.</p>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="1">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://lktuan.github.io/blog/2024-07-29-bjj-beginners-guide/mount.png" class="img-fluid figure-img"></p>
<figcaption>Mount</figcaption>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="back" class="level2">
<h2 class="anchored" data-anchor-id="back">Back</h2>
<p>Con ngÆ°á»i giá»i chiáº¿n Ä‘áº¥u vá»›i cÃ¡c má»‘i Ä‘e dá»a Ä‘áº¿n trÆ°á»›c máº·t mÃ¬nh hÆ¡n lÃ  tá»« Ä‘áº±ng sau. VÃ¬ tháº¿ láº¥y lÆ°ng lÃ  má»™t tÆ° tháº¿ tá»‘t cho viá»‡c táº¥n cÃ´ng, vÃ  bá»‹ láº¥y lÆ°ng sáº½ táº¡o ra sá»± tháº¥t tháº¿ cá»±c lá»›n cho viá»‡c phÃ²ng ngá»±.</p>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="1">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://lktuan.github.io/blog/2024-07-29-bjj-beginners-guide/back.png" class="img-fluid figure-img"></p>
<figcaption>Back</figcaption>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="turtle" class="level2">
<h2 class="anchored" data-anchor-id="turtle">Turtle</h2>
<p>TÆ° tháº¿ con rÃ¹a mang láº¡i má»™t chÃºt lá»£i tháº¿ cho ngÆ°á»i á»Ÿ trÃªn. Gá»i lÃ  con rÃ¹a bá»Ÿi vÃ¬ tÆ° tháº¿ cá»§a ngÆ°á»i á»Ÿ dÆ°á»›i.</p>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="1">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://lktuan.github.io/blog/2024-07-29-bjj-beginners-guide/turtle.png" class="img-fluid figure-img"></p>
<figcaption>Turtle</figcaption>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="half-guard" class="level2">
<h2 class="anchored" data-anchor-id="half-guard">Half Guard</h2>
<p>Khi má»™t ngÆ°á»i cÃ³ thá»ƒ dÃ¹ng chÃ¢n khá»‘ng cháº¿ Ä‘Æ°á»£c má»™t chÃ¢n (thay vÃ¬ tá»« pháº§n hÃ´ng vÃ  hai chÃ¢n) cá»§a Ä‘á»‘i thá»§, tá»« phÃ­a dÆ°á»›i, ta gá»i Ä‘Ã³ lÃ  Half Guard. Ai cÃ³ lá»£i tháº¿ cÃ²n tÃ¹y thuá»™c vÃ o tá»«ng trÆ°á»ng há»£p cá»¥ thá»ƒ</p>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="1">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://lktuan.github.io/blog/2024-07-29-bjj-beginners-guide/half_guard.png" class="img-fluid figure-img"></p>
<figcaption>Half Guard</figcaption>
</figure>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="lÃ m-sao-Ä‘á»ƒ-tiáº¿n-bá»™" class="level1">
<h1>LÃ m sao Ä‘á»ƒ tiáº¿n bá»™</h1>
<section id="cháº¥p-nháº­n-tháº¥t-báº¡i-nháº¥t-lÃ -khi-chá»‰-má»›i-báº¯t-Ä‘áº§u" class="level2">
<h2 class="anchored" data-anchor-id="cháº¥p-nháº­n-tháº¥t-báº¡i-nháº¥t-lÃ -khi-chá»‰-má»›i-báº¯t-Ä‘áº§u">Cháº¥p nháº­n tháº¥t báº¡i, nháº¥t lÃ  khi chá»‰ má»›i báº¯t Ä‘áº§u</h2>
<ul>
<li>Ráº¥t lÃ  bÃ¬nh thÆ°á»ng náº¿u báº¡n cáº£m tháº¥y mÃ¬nh tá»‡. Báº¡n Ä‘ang Ä‘Ã o sÃ¢u vÃ o má»™t lÄ©nh vá»±c sÃ¢u vÃ  phá»©c táº¡p, ngay cáº£ Ä‘ai Ä‘en cÅ©ng cÃ³ lÃºc nháº­n tháº¥y nhiá»u thá»© há» chÆ°a thá»ƒ hiá»ƒu Ä‘Æ°á»£c;</li>
<li>Náº¿u báº¡n khÃ´ng cÃ³ kinh nghiá»‡p váº­t (grappling) trÆ°á»›c Ä‘Ã³, 12 thÃ¡ng Ä‘áº§u tiÃªn báº¡n sáº½ há»c 108 cÃ¡c phong cÃ¡ch tap-out khÃ¡c nhau. Váº­y nÃªn Ä‘á»«ng Ä‘o lÆ°á»ng má»©c Ä‘á»™ tiáº¿n bá»™ cá»§a báº¡n báº±ng cÃ¡c chiáº¿n tháº¯ng, mÃ  nÃªn lÃ  cÃ¡ch báº¡n cáº£i thiá»‡n viá»‡c phÃ²ng thá»§;</li>
<li>HÃ£y khiÃªm tá»‘n vÃ  há»c cÃ¡ch trÃ¢n trá»ng tá»«ng sá»± tiáº¿n bá»™, táº­p trung vÃ o há»c há»i thay vÃ¬ káº¿t quáº£ cuá»‘i cÃ¹ng. Táº¥t cáº£ nhá»¯ng gÃ¬ báº¡n cÃ³ thá»ƒ Ä‘áº¡t Ä‘Æ°á»£c lÃ  má»™t chÃºt tiáº¿n bá»™ má»—i ngÃ y, ai cÅ©ng tháº¿, ngay cáº£ khi báº¡n khÃ´ng chá»©ng kiáº¿n.</li>
</ul>
</section>
<section id="viá»‡c-khai-triá»ƒn-kÄ©-thuáº­t-khÃ³-hÆ¡n-ráº¥t-nhiá»u-khi-roll" class="level2">
<h2 class="anchored" data-anchor-id="viá»‡c-khai-triá»ƒn-kÄ©-thuáº­t-khÃ³-hÆ¡n-ráº¥t-nhiá»u-khi-roll">Viá»‡c khai triá»ƒn kÄ© thuáº­t khÃ³ hÆ¡n ráº¥t nhiá»u khi Roll</h2>
<ul>
<li>Báº¡n cÃ³ thá»ƒ há»c Ä‘Æ°á»£c má»™t kÄ© thuáº­t vÃ  thá»±c hÃ nh nÃ³ má»™t cÃ¡ch mÆ°á»£t mÃ  khi Ä‘á»‘i thá»§ gáº§n nhÆ° khÃ´ng khÃ¡ng cá»± khi táº­p luyá»‡n;</li>
<li>NhÆ°ng khi vÃ o live roll thÃ¬ khÃ¡c, khi Ä‘á»‘i thá»§ biáº¿t báº¡n muá»‘n lÃ m gÃ¬, báº¡n sáº½ tháº­m chÃ­ khÃ´ng tháº¿ thá»±c hiá»‡n Ä‘Æ°á»£c bÆ°á»›c Ä‘áº§u tiÃªn vÃ  má»i thá»© Ä‘á»u Ä‘i chá»‡ch khá»i hÆ°á»›ng. Hoáº·c, báº¡n cÅ©ng cáº£m tháº¥y Ä‘áº§u Ã³c báº¡n hoÃ n toÃ n trá»‘ng rá»—ng (ND: hÃ nh Ä‘á»™ng theo báº£n nÄƒng);</li>
<li>Äiá»u nÃ y lÃ  hoÃ n toÃ n bÃ¬nh thÆ°á»ng, há»c cÃ¡c bÆ°á»›c cÆ¡ báº£n lÃ  khá»Ÿi Ä‘áº§u cho hÃ nh trÃ¬nh dÃ i Ä‘á»ƒ trá»Ÿ nÃªn thÃ nh tháº¡o. HÃ£y kiÃªn nháº«n nghiÃªn cá»©u xem mÃ¬nh Ä‘Ã£ lÃ m chÆ°a Ä‘Ãºng á»Ÿ bÆ°á»›c nÃ o, vÃ  tiáº¿p tá»¥c thá»±c hÃ nh.</li>
</ul>
</section>
<section id="lÃ m-sao-tiáº¿n-bá»™-má»™t-cÃ¡ch-cÃ³-hiá»‡u-quáº£" class="level2">
<h2 class="anchored" data-anchor-id="lÃ m-sao-tiáº¿n-bá»™-má»™t-cÃ¡ch-cÃ³-hiá»‡u-quáº£">LÃ m sao tiáº¿n bá»™ má»™t cÃ¡ch cÃ³ hiá»‡u quáº£</h2>
<ul>
<li>HÃ£y Ä‘áº·t cÃ¢u há»i cho coach;</li>
<li>HÃ£y há»i cÃ¡c tiá»n bá»‘i Ä‘i trÆ°á»›c, nhá»› ráº±ng cáº§n pháº£i tÃ´n trá»ng thá»i gian cá»§a há»;</li>
<li>HÃ£y xem cÃ¡c video hÆ°á»›ng dáº«n, tÃ i nguyÃªn ráº¥t phong phÃº trÃªn Youtube. Cáº©n tháº­n vá»›i click-bait vÃ  video-brain - hÃ£y xem cÃ³ chá»n lá»c:</li>
<li>Click-bait: nhá» thuáº­t toÃ¡n cá»§a Youtube mÃ  cÃ¡c video vá»›i tiÃªu Ä‘á» â€˜learn this unstoppable sweepâ€™ hoáº·c â€˜never get submitted again everâ€™ sáº½ xuáº¥t hiá»‡n ráº¥t nhiá»u. Nhá»¯ng thá»© nÃ y khÃ´ng chÃ­nh xÃ¡c, hÃ£y há»c nhá»¯ng thá»© basic. Nhá»¯ng thá»© trÃ´ng fancy sáº½ khÃ´ng phÃ¹ há»£p vá»›i má»©c Ä‘á»™ kÄ© nÄƒng cá»§a báº¡n Ä‘Ã¢u;</li>
<li>Video-brain: ráº¥t dá»… Ä‘á»ƒ xem háº¿t hai ba chá»¥c video youtube vá» cÃ¡c ká»¹ thuáº­t submissions, escapes. NhÆ°ng nÃ£o bá»™ báº¡n sáº½ khÃ´ng thá»ƒ háº¥p thu háº¿t Ä‘Æ°á»£c chá»«ng Ä‘áº¥y cÃ¡c ká»¹ thuáº­t má»™t cÃ¡ch chi tiáº¿t. Náº¿u báº¡n muá»‘n Ã¡p dá»¥ng trong rolling, báº¡n sáº½ tháº¥y Ä‘áº§u ong ong vÃ  nhá»©c nhá»©c khi cá»‘ nhá»› vá» ká»¹ thuáº­t nÃ o Ä‘Ã³ Ä‘Ã£ xem trong video nÃ o Ä‘Ã³ trong hÃ ng chá»¥c cÃ¡i video khÃ¡c. HÃ£y Ä‘i sÃ¢u thay vÃ¬ Ä‘i rá»™ng (recommended to go deep rather than broad). Xem nhiá»u video cho cÃ¹ng má»™t kÄ© thuáº­t, hoáº·c xem má»™t video láº·p láº¡i nhiá»u láº§n vÃ  cá»‘ gáº¯ng tiáº¿p thu trÆ°á»›c khi move on.</li>
<li>YÃªu cáº§u cÃ¡c báº¡n táº­p open mat há»c má»™t kÄ© thuáº­t cá»¥ thá»ƒ hÆ¡n lÃ  rolling. Rolling mang láº¡i cho báº¡n kinh nghiá»‡m, nhÆ°ng nÃ³ sáº½ ráº¥t loÃ£ng. Náº¿u báº¡n táº­p má»™t tÆ° tháº¿ guard hoáº·c má»™t ká»¹ thuáº­t vá»›i nhiá»u báº¡n táº­p khÃ¡c nhau trong má»™t thá»i gian ngáº¯n, báº¡n sáº½ tháº¥y sá»± cáº£i thiá»‡n rÃµ rá»‡t. HÃ£y báº¯t Ä‘áº§u vá»›i tÆ° tháº¿ mÃ  báº¡n chÆ°a thÃ nh tháº¡o vÃ  reset náº¿u má»™t trong hai thoÃ¡t Ä‘Æ°á»£c khá»i Ä‘Ã³. Táº¥t nhiÃªn cÅ©ng nÃªn há»i báº¡n táº­p xem há» muá»‘n táº­p kÄ© thuáº­t nÃ o;</li>
<li>Sau má»—i buá»•i táº­p, hÃ£y nghÄ© vá» nhá»¯ng thá»© mÃ¬nh chÆ°a lÃ m Ä‘Æ°á»£c khi roll. HÃ£y chá»n 1, 2 chá»§ Ä‘á» trong Ä‘Ã³ Ä‘á»ƒ tá»± há»c qua video, buá»•i sau báº¡n cÃ³ thá»ƒ thá»±c hÃ nh cho tá»›i khi tháº¥y cÃ³ cáº£i thiá»‡n. Cá»© tháº¿ tiáº¿p tá»¥c má»™t chu trÃ¬nh nhÆ° váº­y.</li>
</ul>
</section>
</section>
<section id="trang-bá»‹-phá»¥-kiá»‡n" class="level1">
<h1>Trang bá»‹, phá»¥ kiá»‡n</h1>
<section id="gi" class="level2">
<h2 class="anchored" data-anchor-id="gi">Gi</h2>
<p>Báº¡n cÃ³ thá»ƒ mua Gi online hoáº·c á»Ÿ ngay phÃ²ng táº­p. Tuy nhiÃªn mua online sáº½ ráº» hÆ¡n. CÃ³ má»™t sá»‘ phÃ²ng táº­p sáº½ yÃªu cáº§u mua Gi hoáº·c patch.</p>
<p>HÃ£y kiá»ƒm tra kÄ© size chart, nháº¥t lÃ  nÃªn há»i nhá»¯ng <em>báº¡n táº­p cÃ³ cÃ¹ng kÃ­ch thÆ°á»›c vá»›i mÃ¬nh</em>. CÅ©ng nÃªn nhá»› ráº±ng size chart cÃ³ thá»ƒ khÃ¡c nhau cho cÃ¡c brand khÃ¡c nhau.</p>
</section>
<section id="rashguard-for-no-gi" class="level2">
<h2 class="anchored" data-anchor-id="rashguard-for-no-gi">Rashguard (for No Gi)</h2>
<p>TODO</p>
</section>
<section id="quáº§n-Ã¡o-lÃ³t-underclothes" class="level2">
<h2 class="anchored" data-anchor-id="quáº§n-Ã¡o-lÃ³t-underclothes">Quáº§n Ã¡o lÃ³t (Underclothes)</h2>
<p>Äá»‘i vá»›i Gi, báº¡n cÃ³ thá»ƒ máº·c Ä‘á»“ lÃ³t dÆ°á»›i Gi (ND: vÃ¬ Ã¡o Gi cÃ³ thá»ƒ bá»‹ kÃ©o bung trong lÃºc táº­p luyá»‡n vÃ  báº¡n khÃ´ng muá»‘n Ä‘á»ƒ ngá»±c tráº§n). Báº¡n cÃ³ thá»ƒ dá»… dÃ ng tÃ¬m cÃ¡c elastic/compression shirts vÃ  pants (spat) online. HÃ£y nhá»› ráº±ng chÃºng cÃ³ thá»ƒ bá»‹ náº¯m/kÃ©o (ND: nhÆ° lÃ  má»™t pháº§n cá»§a cÃ¡c kÄ© thuáº­t luyá»‡n táº­p vá»›i Gi), vÃ  cÃ³ thá»ƒ lÃ m báº¡n nÃ³ng ná»±c.</p>
<p>Trong thi Ä‘áº¥u, nam <em>khÃ´ng Ä‘Æ°á»£c</em> máº·c gÃ¬ dÆ°á»›i Ã¡o Gi (Gi top). CÃ²n ná»¯ thÃ¬ <em>pháº£i máº·c</em> compression shirt, gymnast top, hoáº·c one-piece swimsuit.</p>
</section>
<section id="báº£o-vá»‡-hÃ m-mounthguard" class="level2">
<h2 class="anchored" data-anchor-id="báº£o-vá»‡-hÃ m-mounthguard">Báº£o vá»‡ hÃ m (Mounthguard)</h2>
<p>Máº·c dÃ¹ khÃ´ng pháº£i lÃ  mÃ´n vá» Ä‘áº¥m / Ä‘Ã¡ (striking), sáº½ váº«n cÃ³ kháº£ nÄƒng Ä‘á»‘i thá»§, báº¡n táº­p cá»§a báº¡n Ä‘Ã¡nh trÃºng máº·t hoáº·c siáº¿t vÃ o hÃ m cá»§a báº¡n. Do Ä‘Ã³, viá»‡c Ä‘eo báº£o vá»‡ hÃ m sáº½ giÃºp háº¡n cháº¿ cÃ¡c tá»•n thÆ°Æ¡ng tá»›i hÃ m, rÄƒng, mÃ´i, lÆ°á»¡i - nhá»¯ng tá»•n thÆ°Æ¡ng ráº¥t Ä‘au vÃ  khÃ³ há»“i phá»¥c.</p>
</section>
<section id="cup" class="level2">
<h2 class="anchored" data-anchor-id="cup">â€¦ Cup</h2>
<p>Má»™t sá»‘ ngÆ°á»i dÃ¹ng cup Ä‘á»ƒ vÃ o vá»‡ hÃ¡ng / báº¹n (crotch), nhÆ°ng nÃ³ thá»±c sá»± khÃ´ng cáº§n thiáº¿t. Cup cÃ³ thá»ƒ lÃ m tá»•n thÆ°Æ¡ng báº¡n táº­p, vÃ  bá»‹ cáº¥m trong háº§u háº¿t cÃ¡c tour Ä‘áº¥u.</p>
</section>
<section id="báº£o-vá»‡-Ä‘áº§u-headgear" class="level2">
<h2 class="anchored" data-anchor-id="báº£o-vá»‡-Ä‘áº§u-headgear">Báº£o vá»‡ Ä‘áº§u (Headgear)</h2>
<p>Báº£o vá» Ä‘áº§u sáº½ giÃºp báº¡n háº¡n cháº¿ cÃ¡c tá»•n thÆ°Æ¡ng tai - thÆ°á»ng dáº«n Ä‘áº¿n â€œtai sÃºp lÆ¡â€ (cauliflower ear). Tuy nhiÃªn nÃ³ khÃ´ng phá»• biáº¿n vÃ  viá»‡c dÃ¹ng headgear bá»‹ cáº¥m trong cÃ¡c tour Ä‘áº¥u. Báº¡n chá»‰ nÃªn dÃ¹ng khi Ä‘Ã£ cÃ³ cÃ¡c cháº¥n thÆ°Æ¡ng vÃ  muá»‘n chÃºng khÃ´ng náº·ng thÃªm cho tá»›i khi lÃ nh láº¡i.</p>
</section>
</section>
<section id="cÃ¡c-tÃ i-liá»‡u-khÃ¡c" class="level1">
<h1>CÃ¡c tÃ i liá»‡u khÃ¡c</h1>
<p><a href="http://www.artemisbjj.com/FAQ/" class="uri">http://www.artemisbjj.com/FAQ/</a></p>


<!-- -->

</section>

 ]]></description>
  <category>bjj</category>
  <guid>https://lktuan.github.io/blog/2024-07-29-bjj-beginners-guide/</guid>
  <pubDate>Sun, 28 Jul 2024 17:00:00 GMT</pubDate>
  <media:content url="https://lktuan.github.io/blog/2024-07-29-bjj-beginners-guide/sloth_bjj.png" medium="image" type="image/png" height="141" width="144"/>
</item>
<item>
  <title>Another James Powellâ€™s impromptu talk, summary by Clauder 3.5 Sonnet</title>
  <dc:creator>Tuan Le Khac</dc:creator>
  <link>https://lktuan.github.io/blog/2024-07-18-claude-summary/</link>
  <description><![CDATA[ 





<p>source: <a href="https://www.youtube.com/watch?v=-z2eqLwVmzw">James Powell - Whatever I Can do to Entertain You in 30 Minutes | PyData London 2022</a></p>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="1">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://lktuan.github.io/blog/2024-07-18-claude-summary/James Powell - Whatever I Can do to Entertain You in 30 Minutes _ PyData London 2022 0-35 screenshot.png" class="img-fluid figure-img"></p>
<figcaption>Whatever I Can do to Entertain You in 30 Minutes</figcaption>
</figure>
</div>
</div>
</div>
</div>
<p>i was using this extension <a href="https://chromewebstore.google.com/detail/language-reactor/hoombieeljmmljlkjmnheibnpciblicm">Language Reactor</a> to export transcript into Excel and convert it to json. here is data in short:</p>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode numberSource json number-lines code-with-copy"><code class="sourceCode json"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">{</span>   </span>
<span id="cb1-2">    <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"5s"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"okay let me get started i'll give you the"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb1-3">    <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"7s"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"premise the premise is the issues are not av related the issues are that my"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb1-4">    <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"12s"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"laptop where i was up until 4am last night writing this talk"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb1-5">    <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"16s"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"did not boot at all and as a consequence of that my notes that i spent quite a"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb1-6">    <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"21s"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bit of time putting together are not available to you but i am still on the"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb1-7">    <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"24s"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"hook to keep you entertained for 30 minutes so we're going to see what i can"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb1-8">    <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"..."</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"..."</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb1-9">    <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"25:55"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"that makes it possible for us to write code that"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb1-10">    <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"25:58"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"put some structuring around the core computation now with that said i hope i"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb1-11">    <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"26:03"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"was able to entertain you i think we're just at the time that we have"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb1-12">    <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"26:07"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"thank you everybody i'm james powell hopefully i'll give the real talk"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb1-13"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">}</span></span></code></pre></div>
<p>and this is summary by Clauder AI:</p>
<p>James Powellâ€™s impromptu talk at PyData London 2022 covers several key points about Python programming, particularly aimed at data scientists. Here are the main points heâ€™s trying to convey:</p>
<ol type="1">
<li><strong>Python is more than just APIs and function calls</strong>: Many data scientists focus solely on memorizing APIs (like Pandas or NumPy) without truly understanding the languageâ€™s depth and richness.</li>
<li><strong>Generators are underutilized</strong>: Generators can be powerful tools, especially for simulations or non-closed form operations where each incremental step is computationally expensive.</li>
<li><strong>Lazy vs.&nbsp;Eager computation</strong>: Understanding when to use lazy or eager computation can significantly impact performance, especially in data science tasks.</li>
<li><strong>Functions should not be overused</strong>: Thereâ€™s a tendency to create functions for any repeated code, but this isnâ€™t always the best approach. Powell distinguishes between intentional and coincidental repetition.</li>
<li><strong>Avoid premature abstraction</strong>: Creating functions deep in libraries, especially for data loading, can lead to issues with testing and maintenance. Sometimes, ad-hoc behavior is preferable.</li>
<li><strong>Iteration helpers and intentionality</strong>: Tools like <code>enumerate</code>, <code>zip</code>, and custom iteration helpers can make code more expressive and reveal the programmerâ€™s intentions more clearly.</li>
<li><strong>Understanding Python conventions</strong>: Looking beyond the surface-level functionality of Pythonâ€™s standard library (e.g., <code>itertools</code>) can reveal patterns and conventions that lead to better code.</li>
<li><strong>Code should express human intention</strong>: Loops in data science code often represent human-level processes rather than low-level computations. The code structure should reflect this.</li>
<li><strong>Flexibility in code structure</strong>: Allowing code to diverge when necessary, rather than forcing premature unification, can lead to more maintainable and adaptable codebases.</li>
<li><strong>Critical thinking about basic tools</strong>: Even when using basic Python constructs, data scientists should think deeply about why theyâ€™re using them and what alternatives might exist.</li>
</ol>
<p>Overall, Powell encourages data scientists to look beyond superficial knowledge of Python and its libraries, urging them to understand the language more deeply and use its features more thoughtfully to write more intentional, maintainable, and expressive code.</p>


<!-- -->


 ]]></description>
  <category>python</category>
  <category>pydata</category>
  <guid>https://lktuan.github.io/blog/2024-07-18-claude-summary/</guid>
  <pubDate>Wed, 17 Jul 2024 17:00:00 GMT</pubDate>
  <media:content url="https://lktuan.github.io/blog/2024-07-18-claude-summary/claude.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>A Prefect Workshop</title>
  <dc:creator>Tuan Le Khac</dc:creator>
  <link>https://lktuan.github.io/blog/2024-07-17-prefect-workshop/</link>
  <description><![CDATA[ 





<p>ğŸ Video source: <a href="https://www.youtube.com/watch?v=yIDBsHwTaa8&amp;list=PLGVZCDnMOq0rrhYTNedKKuJ9716fEaAdK&amp;index=4">Dr.&nbsp;Adam Hill - Empower Your Projects with Prefectâ€™s Pipeline Magic | PyData London 2024</a></p>
<p>â› Github repo: <a href="https://github.com/Cadarn/PyData-Prefect-Workshop" class="uri">https://github.com/Cadarn/PyData-Prefect-Workshop</a></p>
<section id="goals" class="level1">
<h1>goals</h1>
<p>by end of this session you will:</p>
<ul>
<li>understand what Prefect is;</li>
<li>build and execute tasks and flows;</li>
<li>have schedules flow using deployment;</li>
<li>have a grasp what else can be done;</li>
<li>have some fun.</li>
</ul>
</section>
<section id="prefect-overview" class="level1">
<h1>prefect overview</h1>
<p>just simple as using jupyter notebook, you only need to use decorators (<code>@task</code> and <code>@flow</code>) to designate functions as <strong>task</strong> for <strong>flow</strong>. you need to breakdown your â€œnotebookâ€ into â€œcode chunksâ€ and organize to get them done.</p>
<div id="3aa32d45" class="cell" data-execution_count="1">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> prefect <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> task, flow</span>
<span id="cb1-2"></span>
<span id="cb1-3"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">@task</span></span>
<span id="cb1-4"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> my_task():</span>
<span id="cb1-5">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"hello, i am a task!"</span>)</span>
<span id="cb1-6"></span>
<span id="cb1-7"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">@flow</span></span>
<span id="cb1-8"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> my_flow():</span>
<span id="cb1-9">  my_task()</span></code></pre></div>
</details>
</div>
</section>
<section id="jump-to-the-workshop" class="level1">
<h1>jump to the workshop</h1>
<p>clone the repo, have docker compose up and running. then explore <code>http://localhost:8000/get_tweet</code>, this is shown which i have yet no idea:</p>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode numberSource json number-lines code-with-copy"><code class="sourceCode json"><span id="cb2-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb2-2">  <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"tweet_id"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">570306133677760500</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb2-3">  <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"airline_sentiment"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"neutral"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb2-4">  <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"airline_sentiment_confidence"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb2-5">  <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"airline"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Virgin America"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb2-6">  <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"name"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cairdin"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb2-7">  <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"text"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"@VirginAmerica What @dhepburn said."</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb2-8">  <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"retweet_count"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb2-9">  <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"tweet_timestamp"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"2015-02-24T11:35:52-08:00"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb2-10">  <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"tweet_coord"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">-1</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb2-11">  <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"loop"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb2-12"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">}</span></span></code></pre></div>
<p>the first thing you need to do is telling where the Prefect API is gonna live. currently it runs on free tier of the their cloud server (?) and now we config it to run in the localhost (?):</p>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">prefect</span> config set PREFECT_API_URL=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"http://127.0.0.1:4200/api"</span></span></code></pre></div>
<p>then we gonna reset the database, do some config then can start the server. please note that if you are using window, you need to add <code>Scripts</code> variable to environment variables also, the value of the path can be found when you install Prefect by <code>pip</code>:</p>
<div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb4-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">prefect</span> server database reset <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-y</span></span>
<span id="cb4-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">prefect</span> config set PREFECT_API_DATABASE_CONNECTION_URL=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"postgresql+asyncpg://postgres:password@localhost:5432/prefect_server"</span></span>
<span id="cb4-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">prefect</span> config view <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--show-sources</span></span>
<span id="cb4-4"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">prefect</span> server start</span></code></pre></div>
<p>below is my initial dashboard, there is nothing!</p>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="1">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://lktuan.github.io/blog/2024-07-17-prefect-workshop/initial_prefect_server.png" class="img-fluid figure-img"></p>
<figcaption>Prefect Dashboard</figcaption>
</figure>
</div>
</div>
</div>
</div>
<section id="e01-my-first-flow" class="level2">
<h2 class="anchored" data-anchor-id="e01-my-first-flow">e01 my first flow</h2>
<p>the basic component of prefect is <code>task</code> and <code>flow</code>. these are decorators to funtions we want to run. we can name and log easily:</p>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>e01.py</strong></pre>
</div>
<div class="sourceCode" id="cb5" data-filename="e01.py" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb5-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Example of processing some data</span></span>
<span id="cb5-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> prefect <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> task, flow</span>
<span id="cb5-3"></span>
<span id="cb5-4"></span>
<span id="cb5-5"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">@task</span>(name<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Addition operator"</span>)</span>
<span id="cb5-6"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> add(a, b):</span>
<span id="cb5-7">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> a <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> b</span>
<span id="cb5-8"></span>
<span id="cb5-9"></span>
<span id="cb5-10"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">@task</span>(name<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Squaring operator"</span>)</span>
<span id="cb5-11"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> square_num(num):</span>
<span id="cb5-12">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>:</span>
<span id="cb5-13">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">raise</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">ValueError</span></span>
<span id="cb5-14">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> num <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb5-15"></span>
<span id="cb5-16"></span>
<span id="cb5-17"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">@flow</span>(log_prints<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>, name<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"My first simple flow"</span>)</span>
<span id="cb5-18"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> add_and_square(a: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, b: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>):</span>
<span id="cb5-19">    add_result <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> add(a, b)</span>
<span id="cb5-20">    square_result <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> square_num(add_result)</span>
<span id="cb5-21">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"(</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>a<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;"> + </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>b<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">) squared = </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>square_result<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb5-22"></span>
<span id="cb5-23"></span>
<span id="cb5-24"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">__name__</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"__main__"</span>:</span>
<span id="cb5-25">    add_and_square(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>)</span></code></pre></div>
</div>
</section>
<section id="e02a-sentiment-pipeline-v1" class="level2">
<h2 class="anchored" data-anchor-id="e02a-sentiment-pipeline-v1">e02a sentiment pipeline v1</h2>
</section>
<section id="e02b-sentiment-pipeline-v2" class="level2">
<h2 class="anchored" data-anchor-id="e02b-sentiment-pipeline-v2">e02b sentiment pipeline v2</h2>
</section>
<section id="e03a-kafka-tweet-publisher" class="level2">
<h2 class="anchored" data-anchor-id="e03a-kafka-tweet-publisher">e03a kafka tweet publisher</h2>
</section>
<section id="e03b-kafka-tweet-deployment" class="level2">
<h2 class="anchored" data-anchor-id="e03b-kafka-tweet-deployment">e03b kafka tweet deployment</h2>
</section>
<section id="e04-sentiment-pipeline-v3" class="level2">
<h2 class="anchored" data-anchor-id="e04-sentiment-pipeline-v3">e04 sentiment pipeline v3</h2>
</section>
</section>
<section id="further-reading" class="level1">
<h1>further reading</h1>
<ol type="1">
<li><a href="https://www.reddit.com/r/dataengineering/comments/oqbiiu/airflow_vs_prefect/">Prefect vs Airflow on Reddit</a></li>
</ol>
<p>BÃ¬nh luáº­n bá»Ÿi <strong>u/alexisprince</strong>:</p>
<blockquote class="blockquote">
<p>TÃ´i Ä‘ang sá»­ dá»¥ng song song Airflow vÃ  Prefect (A cho scheduling, P cho execution), P Ä‘Æ°á»£c sá»­ dá»¥ng khi yÃªu cáº§u vá» hiá»‡u nÄƒng tÃ­nh toÃ¡n vÃ  pháº§n scheduler cá»§a A váº«n chÆ°a thá»ƒ bá»‹ thay tháº¿.</p>
<p>Lá»£i tháº¿ cá»§a A lÃ  Ä‘Ã£ quÃ¡ phá»• biáº¿n, dá»… tÃ¬m hÆ°á»›ng dáº«n, dá»… tuyá»ƒn ngÆ°á»i cho chuyÃªn mÃ´n. Yáº¿u Ä‘iá»ƒm lÃ  A Ä‘Ã£ quÃ¡ cÅ©, khÃ´ng cÃ²n phÃ¹ há»£p cho dynamic workflow vÃ  modern data env. HÆ¡n ná»¯a A luÃ´n best fit khi sá»­ dá»¥ng chung vá»›i Astronomer, ngoÃ i ra khÃ¡ khÃ³ dÃ¹ng.</p>
<p>P hiá»‡n Ä‘áº¡i hÆ¡n, cung cáº¥p nhiá»u modern execution models, DAG Ä‘Æ°á»£c xÃ¡c Ä‘á»‹nh táº¡i runtime do Ä‘Ã³ dynamic hÆ¡n.</p>
<p>Prefer P hÆ¡n, better modularization of code.</p>
</blockquote>
<p>BÃ¬nh luáº­n bá»Ÿi <strong>u/ChrisHC05</strong>:</p>
<blockquote class="blockquote">
<p>Tao Ä‘Ã£ Ä‘Ã¡nh giÃ¡ Airflow, Dagster, Argo vÃ  Prefect máº¥y thÃ¡ng nay.</p>
<p>Airflow thÃ¬ Ä‘Ã£ giÃ , tuy nhiÃªn tÃ i liá»‡u, hÆ°á»›ng dáº«n ráº¥t phong phÃº.</p>
<p>Dagster cÃ³ váº» gáº·p nhiá»u váº¥n Ä‘á» vá»›i Production.</p>
<p>Prefect cÃ³ cá»™ng Ä‘á»“ng phÃ¡t triá»ƒn, support, sá»­a lá»—i active.</p>
<p>Váº­y nÃªn tÃ´i chá»‰ Ä‘Ã¡nh giÃ¡ cao hai tháº±ng Argo vÃ  Prefect. Argo khÃ¡c biá»‡t má»™t cÃ¡ch máº¡nh máº½, config Ä‘Æ°á»£c viáº¿t dÆ°á»›i dáº¡ng YAML, cháº¡y trÃªn cá»¥m Kubernetes, vÃ  viá»‡c viáº¿t DAG khÃ´ng phá»¥ thuá»™c vÃ o má»™t ngÃ´n ngá»¯ láº­p trÃ¬nh nÃ o. Argo (táº¡i thá»i Ä‘iá»ƒm Ä‘Ã³) cÅ©ng Ä‘ang phÃ¡t triá»ƒn má»™t module kiá»ƒu event listening, from outside, nhÆ° Sensor cá»§a Airflow, thá»© mÃ  Prefect thiáº¿u (workaround lÃ  call Prefect GraphQL-API).</p>
<p>Náº¿u Ä‘Ã£ cÃ³ sáºµn infra lÃ  K8S, khuyáº¿n nghá»‹ Argo, khÃ´ng chá»‰ lÃ  orchestration mÃ  cÃ²n lÃ  má»™t há»‡ sinh thÃ¡i support tá»« event responding tá»›i CI/CD. NhÆ°ng learning curve thÃ¬ steep nhÃ©. NÃ³ cÃ³ nhiá»u tiá»m nÄƒng vÃ¬ giá» thÃ¬ pháº§n má»m nÃ o cÅ©ng cáº§n dockerized cáº£, tÃ­nh trá»«u tÆ°á»£ng cao hÆ¡n. â€œAnd IT in general is all about abstraction to make complicated things easier.â€</p>
<p>Váº­y nÃªn:</p>
<ul>
<li>Náº¿u cÃ³ sáºµn cá»¥m K8S: dÃ¹ng Argo</li>
<li>Náº¿u khÃ´ng: dÃ¹ng Prefect</li>
</ul>
</blockquote>
<ol start="2" type="1">
<li><a href="https://www.youtube.com/watch?v=XrZegcm1ftw">Airflow Vs. Prefect: Full Breakdown! by The Data Guy</a></li>
<li><a href="https://www.horsewithapointyhat.com/posts/being-a-data-scientist-in-a-post-truth-world/">Adam Hillâ€™s blog</a></li>
</ol>


<!-- -->

</section>

 ]]></description>
  <category>python</category>
  <category>pydata</category>
  <category>prefect</category>
  <guid>https://lktuan.github.io/blog/2024-07-17-prefect-workshop/</guid>
  <pubDate>Tue, 16 Jul 2024 17:00:00 GMT</pubDate>
  <media:content url="https://lktuan.github.io/blog/2024-07-17-prefect-workshop/adam_hill.png" medium="image" type="image/png" height="179" width="144"/>
</item>
<item>
  <title>Vim 101</title>
  <dc:creator>Tuan Le Khac</dc:creator>
  <link>https://lktuan.github.io/blog/2024-07-12-vim/</link>
  <description><![CDATA[ 





<p>source: <a href="https://www.youtube.com/watch?v=RZ4p-saaQkc">Vim tutorial for Beginners</a> by freeCodeCamp.</p>
<p>in an effort not to give Vim up from the very first day. inspired by James Powellâ€™s Vim skill in his every Python lecture.</p>
<p>after a few days of rolling with neovim i already have a somewhat calls sense of how to install, make the <code>nvim</code> config folder, do some <code>git clone</code> stuffs to download a bunch of i have no idea what they are to use vim in my damn window machine. can do <code>nvim file1</code>, <code>:qw</code>, <code>:below terminal</code>, <code>:vsplit</code>, but in general lots of actions i am not yet familiar with so actually could not stick with this editor.</p>
<p>now back to basics, i am spending Friyay night starting from scratch. Florian Dedov uses vim while i use nvim expecting both to be the same.</p>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="1">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://lktuan.github.io/blog/2024-07-12-vim/programmerhumor-io-linux_meme.jpg" class="img-fluid figure-img"></p>
<figcaption>source <a href="https://programmerhumor.io/memes/vim/">programmerhumor</a></figcaption>
</figure>
</div>
</div>
</div>
</div>
<section id="intro-why-vim" class="level1">
<h1>intro &amp; why vim?</h1>
<ul>
<li>less stick with your mouse, speed up your coding speed;</li>
<li>all settings are customizable;</li>
<li>dont need to stick with your terminal, you can use Vim keybindings in any IDE or text editor: Jupyter Notebook, VS Code, etc</li>
</ul>
</section>
<section id="installation" class="level1 page-columns page-full">
<h1>installation</h1>
<ul>
<li>i use window, i dont want to install more package manager like <code>scoop</code>, i dont like to use WSL, so just simply run <code>winget install Neovim.Neovim</code>; </li>
<li>this neovim version will not include <em>Neovim QT</em>, alright, i will use my terminal <code>pwsh</code>;</li>
</ul>
<div class="no-row-height column-margin column-container"><span class="margin-aside">neovim installation <a href="https://github.com/neovim/neovim/blob/master/INSTALL.md">page</a></span></div></section>
<section id="basics" class="level1">
<h1>basics</h1>
<ul>
<li><code>nvim file_name</code> will open a file or create a file if it did not exist (but the file will not be actually created if we dont write <code>:w</code> ~ this is just <strong>buffer</strong>);</li>
</ul>
</section>
<section id="exit" class="level1">
<h1>exit</h1>
<ul>
<li>now if we create a file (e.g.&nbsp;<code>client.py</code>), when we press <code>:q</code> in will return this message:</li>
</ul>
<pre><code>E37: No write since last change
E162: No write since last change for buffer "client.py"   </code></pre>
<ul>
<li>what you need to do is <code>:q!</code> (exclamation mark ~ saying you quite and dismiss any change youâ€™ve made);</li>
<li>notice that <code>q</code> first and <code>!</code> after. <code>:!</code> will open the terminal, so <code>:!q</code> will pass the command <code>q</code> to the terminal (window CMD), which returns â€œ<em>â€˜qâ€™ is not recognized as an internal or external command, operable program or batch file.</em>â€</li>
</ul>
</section>
<section id="insert-and-normal-modes" class="level1">
<h1>insert and normal modes</h1>
<ul>
<li>when we enter vim, we are in <strong>NORMAL</strong> mode. press the <code>i</code> or <code>I</code> will get you into the <strong>INSERT</strong> mode, press <code>esc</code> to enter the <strong>NORMAL</strong> mode;</li>
<li><strong>INSERT</strong> mode: any thing we press does not have functionality, just text;</li>
<li><strong>NORMAL</strong> mode: execute a command;</li>
<li>in normal mode, press <code>:w</code> to save/write file;</li>
<li><code>:wq</code> write and quit;</li>
<li>in <strong>INSERT</strong> mode, cursor points between 2 characters; in <strong>NORMAL</strong> mode cursor points a character;</li>
<li>from <strong>INSERT</strong> mode, press <code>esc</code> and cursor will point to the <strong>up-front</strong> character, press <code>i</code> in the cursor will point to <strong>before</strong> that character, press <code>a</code> and for cursor <strong>after</strong> character;</li>
<li><code>I = shift + i</code> will let you get into insert mode with cursor at the <strong>begin</strong> of the line;</li>
<li><code>A = shift + a</code> for the <strong>end</strong> of the line;</li>
<li>from normal mode, <code>o</code> let you create a new line below and cursor at that line;</li>
<li><code>O = shift + o</code> for creating line above.</li>
</ul>
</section>
<section id="line-numbers" class="level1">
<h1>line numbers</h1>
<ul>
<li>in normal mode, <code>:set number</code> will activate line number;</li>
<li><code>:set nonumber</code> to turn off the line number;</li>
<li>now this is important pattern: â€œan action can be repeated x timesâ€ ~ in normal mode we can move cursor up and down using up and down arrow -&gt; if we press <code>5 + down arrow</code> we will move to the 5th line below;</li>
<li><code>10 + right arrow</code> will move the cursor to 10th character to the right, in the same line (?, or in the end of the line);</li>
<li>you can also use <code>h</code>, <code>j</code>, <code>k</code>, <code>l</code> instead of the arrow keys, they stand for <code>â¬…</code>, <code>â¬‡</code>, <code>â¬†</code>, <code>â¡</code>, respectively (extremely usefull if you can type with 10 fingers);</li>
</ul>
</section>
<section id="relative-line-numbers" class="level1">
<h1>relative line numbers</h1>
<ul>
<li>certainly you can use <em>number</em> with <code>h</code>, <code>j</code>, <code>k</code>, <code>l</code>. now if you <code>:set relativenumber</code>, you can have your current line indexed as <code>0</code> and easily know the number to move up &amp; down-ward;</li>
</ul>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="1">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://lktuan.github.io/blog/2024-07-12-vim/relative_line_number.png" class="img-fluid figure-img"></p>
<figcaption>now if i type <code>14 + k</code> i will move to the 3rd line</figcaption>
</figure>
</div>
</div>
</div>
</div>
<ul>
<li>easy to know that <code>:set norelativenumber</code> will turn this option off.</li>
</ul>
</section>
<section id="various-options" class="level1 page-columns page-full">
<h1>various options</h1>
<ul>
<li><code>:set mouse=a</code> activate the mouse, you can scroll or select text;</li>
<li><code>:set mouse-=a</code> to inactivate, the pattern <code>-=</code> is to inactivate any option;</li>
<li><code>:set tabstop=4</code> set tab as 4 spaces</li>
<li><code>:set shiftwidth=4</code> set shift width as 4 spaces </li>
<li><code>:colorscheme slate</code> to set the color scheme, before type â€œstateâ€ you can tab to select the scheme too (remember the space);</li>
</ul>
<div class="no-row-height column-margin column-container"><span class="margin-aside">this is <a href="https://stackoverflow.com/questions/1878974/redefine-tab-as-4-spaces">recommended</a></span></div><div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="1">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://lktuan.github.io/blog/2024-07-12-vim/choosing_colorscheme.png" class="img-fluid figure-img"></p>
<figcaption><code>:colorscheme</code> and <code>tab</code> to select color scheme</figcaption>
</figure>
</div>
</div>
</div>
</div>
<ul>
<li>every single time you close and re-open vim, these settings is by far - all gone.</li>
</ul>
</section>
<section id="vimrc" class="level1 page-columns page-full">
<h1><code>.vimrc</code></h1>
<ul>
<li>so you need a configuration file and every time vim or nvim is opened your config will be loaded;</li>
<li>neovim will lookfor <code>init.vim</code> or <code>init.lua</code> when start; </li>
<li>in terminal (pwsn in user folder window), input:</li>
</ul>
<div class="no-row-height column-margin column-container"><span class="margin-aside">refer <a href="https://vi.stackexchange.com/questions/13505/where-do-i-put-my-vimrc-file-for-neovim-on-windows">here</a></span></div><div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode numberSource bass number-lines code-with-copy"><code class="sourceCode"><span id="cb2-1">cd %AppData%</span>
<span id="cb2-2">cd .. # to get out of Roaming folder</span>
<span id="cb2-3">cd .\Local\</span>
<span id="cb2-4">mkdir nvim</span>
<span id="cb2-5">cd nvim</span>
<span id="cb2-6">nvim init.vim</span></code></pre></div>
<ul>
<li>then i set these config in my <code>init.vim</code> file:</li>
</ul>
<div class="sourceCode" id="cb3" data-filname="init.vim" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb3-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">set</span> number</span>
<span id="cb3-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">set</span> relativenumber</span>
<span id="cb3-3"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">set</span> tabstop<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span></span>
<span id="cb3-4"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">set</span> shiftwidth<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span></span>
<span id="cb3-5"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">set</span> autoindent</span>
<span id="cb3-6"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">set</span> mouse<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>a</span>
<span id="cb3-7">colorscheme slate</span></code></pre></div>
<ul>
<li>then <code>:wq</code>. now weâ€™ve already have some handy settings when go into nvim.</li>
</ul>
</section>
<section id="keybindings" class="level1">
<h1>keybindings</h1>
<table class="table-striped table-hover table">
<caption>helpful keybindings</caption>
<colgroup>
<col style="width: 24%">
<col style="width: 75%">
</colgroup>
<thead>
<tr class="header">
<th>Keybindings</th>
<th>Actions</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>u</code></td>
<td>undid the actions, vim show â€œâ€¦ change; before #x xx seconds agoâ€</td>
</tr>
<tr class="even">
<td><code>Ctrl + R</code></td>
<td>redo</td>
</tr>
<tr class="odd">
<td><p><code>ntimes u</code></p>
<p><code>ntimes Ctrl + R</code></p></td>
<td>repeat to press <code>u</code> for multiple undo, or you can <code>3 + u</code> for 3 times undo. same for redo</td>
</tr>
<tr class="even">
<td><code>i</code>, <code>I</code>, <code>a</code>, <code>A</code>, <code>o</code>, <code>O</code></td>
<td>back to insert mode in different ways</td>
</tr>
<tr class="odd">
<td><code>v</code></td>
<td>enter VISUAL mode</td>
</tr>
<tr class="even">
<td><code>V</code></td>
<td>enter VISUAL model and select the whole line</td>
</tr>
<tr class="odd">
<td><code>d</code></td>
<td>deleting</td>
</tr>
<tr class="even">
<td><code>y</code></td>
<td>yanking ~ equivalent to copying</td>
</tr>
<tr class="odd">
<td><code>p</code></td>
<td>pasting what we yank before (<strong>after or below</strong> the cursor)</td>
</tr>
<tr class="even">
<td><code>dd</code></td>
<td>delete the whole line</td>
</tr>
<tr class="odd">
<td><code>5dd</code></td>
<td>delete the next whole 5 lines</td>
</tr>
<tr class="even">
<td><code>D</code></td>
<td>delete from the cursor to the end of line</td>
</tr>
<tr class="odd">
<td><code>yy</code></td>
<td>yank the full line in NORMAL mode, same with <code>V</code> then <code>y</code> ~ select the whole line and yank</td>
</tr>
<tr class="even">
<td><code>Y</code></td>
<td>same at <code>yy</code></td>
</tr>
<tr class="odd">
<td><code>P</code></td>
<td><p>pasting what we yank before (<strong>before or above</strong> the cursor)</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>again remember the pattern of <strong>lowercase</strong> and <strong>uppercase</strong></p>
</div>
</div></td>
</tr>
<tr class="even">
<td><code>c</code></td>
<td>delete the selection (from VISUAL mode) and enter to INSERT mode</td>
</tr>
<tr class="odd">
<td><code>cc</code></td>
<td>delete the whole text in the line (the line was kept) enter to INSERT mode</td>
</tr>
<tr class="even">
<td><code>C</code></td>
<td>delete from cursor to end of line (what <code>c</code> does is change, what <code>d</code> does is delete)</td>
</tr>
<tr class="odd">
<td><code>r</code></td>
<td><p>replacing the current cursor in NORMAL mode with 1 character press after <code>r</code></p>
<p>replacing all selection (include cursor) in VISUAL mode</p></td>
</tr>
<tr class="even">
<td><code>w</code></td>
<td>Jump to the next word (split by space or â€œ-â€)</td>
</tr>
<tr class="odd">
<td><code>W</code></td>
<td>Jump to the next word (accept only space at delimiter)</td>
</tr>
<tr class="even">
<td><code>b</code>, <code>B</code></td>
<td>The same thing for <em>backward</em></td>
</tr>
<tr class="odd">
<td><code>dw</code></td>
<td>delete a word</td>
</tr>
<tr class="even">
<td><code>2dw</code> , <code>d2w</code></td>
<td>delete 2 words (forward, current cursor and the next one)</td>
</tr>
<tr class="odd">
<td><code>2db</code>, <code>d2b</code></td>
<td>delete 2 words (backward, <strong>before</strong> the cursor)</td>
</tr>
<tr class="even">
<td><code>diw</code></td>
<td>delete in a words</td>
</tr>
<tr class="odd">
<td><code>ciw</code> , <code>cw</code>, <code>cb</code></td>
<td>change in a words, next word, previous word and go into INSERT mode</td>
</tr>
<tr class="even">
<td><code>e</code></td>
<td>Jump to the end of the word (<code>E</code> will be more strictly, only accept space as delimiter)</td>
</tr>
<tr class="odd">
<td><code>0</code>, <code>$</code></td>
<td>Jump to the begin / and the end of the line respectively</td>
</tr>
<tr class="even">
<td><code>d0</code>, <code>d$</code></td>
<td><p>delete everything from cursor to the begin / end of the line, respectively</p>
<p>-&gt; think of <code>c0</code>, and <code>c$</code> for aha</p></td>
</tr>
<tr class="odd">
<td><code>:h ...</code></td>
<td>seek help, <code>:q</code> to quite the help window</td>
</tr>
</tbody>
</table>
</section>
<section id="intermediate-stuff" class="level1">
<h1>intermediate stuff</h1>
<p><strong>go and cook your meal:</strong></p>
<ul>
<li><p><code>i</code> - <strong>before</strong> and <code>I</code> - <strong>beginning</strong>, <code>a</code> - <strong>after</strong> and <code>A</code> - <strong>ending</strong> for navigating to INSERT mode;</p></li>
<li><p><code>o</code> - <strong>below</strong>, <code>O</code> - <strong>above</strong> to insert line;</p></li>
<li><p><code>u</code> - <strong>undo</strong>, <code>Ctrl + R</code> - <strong>redo</strong>;</p></li>
<li><p><code>v</code> - <strong>individual</strong> visual, <code>V</code> - visual the <strong>whole</strong> line;</p></li>
<li><p><code>y</code> - yanking <strong>current</strong>, <code>Y</code>, <code>yy</code> - yanking <strong>whole</strong> line;</p></li>
<li><p><code>p</code> - pasting <strong>after</strong> or <strong>below</strong>, <code>P</code> - pasting <strong>before</strong> or <strong>above</strong>;</p></li>
<li><p><code>d</code> - deleting <strong>current</strong>, <code>dd</code> - deleting <strong>whole</strong> line, <code>D</code> - deleting to the <strong>end</strong> of line;</p></li>
<li><p><code>c</code> - same with <code>d</code> but for <strong>changing</strong>;</p></li>
<li><p><code>r</code> - replacing <strong>current</strong> with 1 character, <code>R</code> - enter the REPLACE mode and replace with <strong>multiple</strong> characters;</p></li>
<li><p><code>w</code>, <code>W</code> - jump word <strong>forward</strong>, <code>b</code>, <code>B</code> - jump word <strong>backward</strong>;</p></li>
<li><p><code>i</code> - <strong>inside</strong> the word, <code>e</code> - <strong>end</strong> of the word;</p></li>
<li><p><code>0</code> - <strong>begin</strong>, <code>$</code> - <strong>end</strong> of the line;</p></li>
<li><p>repeat by press key <strong>multiple</strong> times or <code>n</code> - number before command;</p></li>
<li><p><code>%</code> - jump to the <strong>closing</strong> bracket if you are on the opening one;</p></li>
<li><p><code>t</code> follow by a character will let you jump cursor to <strong>before</strong> the next nearest one;</p></li>
<li><p><code>f</code> same with <code>t</code>, but to the <strong>characterâ€™s position</strong>;</p></li>
<li><p><code>T</code> and <code>F</code> for the <strong>backward</strong>;</p></li>
<li><p><code>gg</code> - go to the <strong>begin</strong> of the line, <code>G</code> for the <strong>end</strong> of the file;</p></li>
<li><p><code>123G</code> or <code>:123</code> will bring you to the line 123; â€¦.</p></li>
</ul>
<p><strong>now:</strong></p>
<ul>
<li><p><code>ciw</code> - changing the whole word; but</p></li>
<li><p><code>cib</code> , <code>ciB</code> - changing the text inside the current set of parenthesis () or braces {}, respectively, you can also <code>ci(</code> , <code>ci{</code> , <code>ci&lt;</code> for the specific.</p></li>
<li><p><code>ci"</code> - changing the text inside double quote;</p></li>
<li><p>if you want delete <code>d</code>, or yank <code>y</code> - replace the <code>c</code>;</p></li>
<li><p><code>5dw</code> will delete 5 words, <code>5d5w</code> will delete 5 words 5 times!;</p></li>
<li><p><code>5yy</code> copying 5 lines;</p></li>
<li><p><code>dt(</code> deleting everything up till the opening bracket, <code>df(</code> will delete the bracket also; â€¦</p></li>
</ul>
<p><strong>even more advanced stuff:</strong></p>
<ul>
<li>indentation: <code>&gt;&gt;</code> to the right, <code>&lt;&lt;</code> to the left;</li>
<li><code>V</code> for Visual Line mode, which will automatically select entire lines;</li>
<li><code>Ctrl + v</code> for Block Visual mode, which will select rectangular regions of the text;</li>
<li><code>=</code> for auto indentation;</li>
<li><code>gg=G</code> will start at the begin of the file, auto indentation till the end of file (and end of at the end of file);</li>
<li><code>/</code> and word follow to search the word, then <code>n</code> to jump to the next found, <code>N</code> to jump to the previous one;</li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Re-note about the search:</p>
<ul>
<li><code>/pattern</code> - search for pattern;</li>
<li><code>?pattern</code> - search backward for pattern;</li>
<li><code>\vpattern</code> - â€˜very magicâ€™ pattern: non-alphanumeric characters are interpreted as special regex symbols (no escaping needed);</li>
<li><code>n</code> - repeat search in same direction;</li>
<li><code>N</code> - repeat search in opposite direction;</li>
<li><code>#</code> go up, <code>*</code> go down.</li>
</ul>
</div>
</div>
<ul>
<li><code>ma</code>: mark A -&gt; to explore later;</li>
<li><code>zz</code>: centre the screen;</li>
<li><code>:%s/old/new/g</code> - replace all old with new throughout file;</li>
<li><code>:%s/old/new/gc</code> - replace all old with new throughout file with confirmations (without <code>c</code> is without confirmation);</li>
<li><code>.</code> repeat the last command;</li>
<li><code>"+</code> and <code>"*</code> are the special registers, which you copied in the system</li>
</ul>
</section>
<section id="registers-and-macros" class="level1">
<h1>registers and macros</h1>
<ul>
<li><code>d</code> deleting is also copying ~ cutting, so if you <code>y</code> then <code>d</code> you will lost the current clipboard</li>
<li><code>:reg</code> to see the history of the clipboard;</li>
<li><code>"7p</code> will paste the 7th register;</li>
<li><code>"7yy</code> yanks the whole line into 7th register;</li>
<li><code>"0p</code> the last thing that i actually yanked, not <code>d</code>;</li>
<li><code>qa</code> recording macro <span class="citation" data-cites="a">@a</span>, <code>q</code> quits recording;</li>
<li>you can see the macro in <code>:reg</code>, <code>@a</code> to use the macro; â€¦</li>
</ul>
</section>
<section id="neovim-plugins" class="level1">
<h1>neovim &amp; plugins</h1>
<ul>
<li>better, have more pluggins supported;</li>
<li>config in <code>./nvim</code> using <code>init.vim</code> or <code>init.lua</code>;</li>
</ul>
</section>
<section id="vim-support" class="level1">
<h1>vim support</h1>
<ul>
<li>can use vim bindings in VS Code, Pycharm</li>
</ul>
</section>
<section id="outro" class="level1">
<h1>outro</h1>
<ul>
<li>it is recommended to use vim bindings while coding, even if you dont like the command line.</li>
</ul>
</section>
<section id="other-resources" class="level1">
<h1>other resources</h1>
<ol type="1">
<li><a href="https://vim.rtorr.com/">Vim cheat sheet</a></li>
<li><a href="https://github.com/junegunn/vim-plug">Vim plug</a></li>
</ol>


<!-- -->

</section>

 ]]></description>
  <category>python</category>
  <category>vim</category>
  <guid>https://lktuan.github.io/blog/2024-07-12-vim/</guid>
  <pubDate>Thu, 11 Jul 2024 17:00:00 GMT</pubDate>
  <media:content url="https://lktuan.github.io/blog/2024-07-12-vim/vim.png" medium="image" type="image/png" height="127" width="144"/>
</item>
<item>
  <title>Recap: So you want to be a Python expert?</title>
  <dc:creator>Tuan Le Khac</dc:creator>
  <link>https://lktuan.github.io/blog/2024-07-10-expert-in-python/</link>
  <description><![CDATA[ 





<p>ğŸ”¥ source: <a href="https://www.youtube.com/watch?v=cKPlPJyQrt4"><strong>James Powell: So you want to be a Python expert? | PyData Seattle 2017</strong></a></p>
<section id="what-is-he-gonna-present" class="level1">
<h1>what is he gonna present?</h1>
<ul>
<li>something deeply behind the Zen of Python;</li>
<li>metaphors and programming in Python;</li>
<li>python is not only scripting language, he will be introducing 4 features of Python and the way experts would think about these features;</li>
<li>a lot of fundamental details of how these feature work but very little talk about we can conceptualize these features in the broader sense of what they mean for modeling core problem. so 4 features you might have heared before and couple of the core mental models how you can think about, an how you can think about python as a whole, wrapping everything together;</li>
<li>you will see me stumble to understand that in case you dont utd or dont have docs memorized, itâ€™s alright, the target is to know what they are and what they mean;</li>
<li>the talk presumes you to have a baseline of Python, but in case you a new to Python he believes there are cores you can take away.</li>
</ul>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="1">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://lktuan.github.io/blog/2024-07-10-expert-in-python/James Powell_ So you want to be a Python expert_ _ PyData Seattle 2017 5-37 screenshot.png" class="img-fluid figure-img"></p>
<figcaption>James Powell on PyData Seattle 2017</figcaption>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="data-model-protocol-or-dunder-method" class="level1">
<h1>data model protocol (or dunder method)</h1>
<p>assume we have a data model with Polynomial object intitially do nothing, why I need 4 lines (instead of 2 lines) to create 2 Polynominals. How can I create and assign coefficients together.</p>
<div id="935bce05" class="cell" data-execution_count="1">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">class</span> Polynomial:</span>
<span id="cb1-2">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">pass</span></span>
<span id="cb1-3">p1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Polynomial()</span>
<span id="cb1-4">p2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Polynomial()</span>
<span id="cb1-5">p1.coeffs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#  x^2 + 2x + 3</span></span>
<span id="cb1-6">p2.coeffs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 3x^2 + 4x + 3</span></span></code></pre></div>
</details>
</div>
<p>the answer is using a constructor <code>__init__</code>, then we can compact our code like this:</p>
<div id="c80a8e25" class="cell" data-execution_count="2">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb2-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">class</span> Polynomial:</span>
<span id="cb2-2">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__init__</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>coeffs):</span>
<span id="cb2-3">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.coeffs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> coeffs</span>
<span id="cb2-4"></span>
<span id="cb2-5">p1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Polynomial(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span> ) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#  x^2 + 2x + 3</span></span>
<span id="cb2-6">p2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Polynomial(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span> ) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 3x^2 + 4x + 3</span></span></code></pre></div>
</details>
</div>
<p>but if we print our objects in the terminal, they look so ugly. We miss the method that actually call <code>repr(obj)</code> when we run <code>obj</code>:</p>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="1">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://lktuan.github.io/blog/2024-07-10-expert-in-python/1_repr.png" class="img-fluid figure-img"></p>
<figcaption>The need of <code>__repr__</code></figcaption>
</figure>
</div>
</div>
</div>
</div>
<p>thatâ€™s what <code>__repr__</code> for, a printable representation of the class:</p>
<div id="2f115390" class="cell" data-execution_count="3">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb3-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">class</span> Polynomial:</span>
<span id="cb3-2">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__init__</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>coeffs):</span>
<span id="cb3-3">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.coeffs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> coeffs</span>
<span id="cb3-4"></span>
<span id="cb3-5">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__repr__</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>):</span>
<span id="cb3-6">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Polynomial(*</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{!r}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">)'</span>.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">format</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.coeffs)</span>
<span id="cb3-7"></span>
<span id="cb3-8"></span>
<span id="cb3-9">p1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Polynomial(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#  x^2 + 2x + 3</span></span>
<span id="cb3-10">p2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Polynomial(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 3x^2 + 4x + 3</span></span></code></pre></div>
</details>
</div>
<p>the next thing we wanna do is to add Polinimials together <code>p1 + p2</code>.</p>
<div id="ee94fb92" class="cell" data-execution_count="4">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb4-1">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__add__</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, other):</span>
<span id="cb4-2">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> Polynomial(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>(x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> y <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> x, y <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">zip</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.coeffs, other.coeffs)))</span></code></pre></div>
</details>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>What is pattern here? I have some behaviours that I want to implement, and I write some <strong>underscore</strong> (<code>__x__</code>) funtions. We call them dunder or underscore methods.</p>
<p>Try google â€œdata modelâ€ and weâ€™ll a bunch of documents that list all method to implement the principle behaviours of our objects. There are top-level functions of top-level syntaxes that corresponding to <code>__</code>.</p>
<p>But there are smthg more fundamental here, when I want to:</p>
<ul>
<li>x + y -&gt; <code>__add__</code>;</li>
<li>initialize x -&gt; <code>__init__</code>;</li>
<li>repr(x) -&gt; <code>__repr__</code>.</li>
</ul>
<p>Then what if we want to implement the <code>len()</code> (return the length, which is popular know Python function) -&gt; naturally weâ€™ll be thinking of <code>__len__</code>.</p>
<div id="705b098f" class="cell" data-execution_count="5">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb5-1">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__len__</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>):</span>
<span id="cb5-2">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.coeffs)</span></code></pre></div>
</details>
</div>
</div>
</div>
<p>The Python data model is a means by which you can protocols. Thos protocols have abstract meaning depending on the object itself. We tight the behaviours to top-level <strong>syntaxes</strong> and <strong>functions</strong>.</p>
<p>Similarly, if we do see the object Polynomial a executable, callable thing, we can implement a <code>__call__</code> which will turn our class to function, in this case we cant imagine such thing, so pass.</p>
<p>âœ There are 3 core patterns we want to understand and remember in Python to really understand object orientation in Python:</p>
<ol type="1">
<li>The protocol view of Python;</li>
<li>The buil-in inheritance protocol;</li>
<li>Some caveats around how OOP in Python works.</li>
</ol>
<p>Which will be continue to present in this video is jumping into a very tricky metaphor a feature we may have heard of.</p>
</section>
<section id="meta-class" class="level1 page-columns page-full">
<h1>meta class</h1>
<p>imagine there are 2 groups working on some piece of software. one is core infrastructure of the group and they write <code>library</code> code, the other group is devloper group, they write <code>user</code> code. the developer use <code>library</code> code to accomplish actual business objectives. the core team less cares about business problem, they focus on technical stuffs.</p>
<p>you are in the dev team and there is no way to change to code of <code>library.py</code>. in what circumstance the code of <code>user</code> can break -&gt; there is no <code>foo</code> method! To avoid that, we could simply write a test that call <code>bar()</code>, then we could know if it fails before production environmentâ€™s runtime.</p>
<p>is there anything simpler to know the ability to fail before hit run time in production env? -&gt; use <code>assert</code> to check existence of the attribute. we will have an early warning right before the class was initiated.</p>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="1">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://lktuan.github.io/blog/2024-07-10-expert-in-python/2_assert.png" class="img-fluid figure-img"></p>
<figcaption>we can know if the core team change the function name to â€œfoodâ€</figcaption>
</figure>
</div>
</div>
</div>
</div>
<p>by this way we are enforcing constraints on the base class from the derived class.</p>
<p>now we move to a reverse situation, you are the core structure writer and have to deal with the meathead in the business unit that actually using/abusing/missusing your code ~ you have no idea what are they doing. you write the <code>Base</code> class with the assumption and some responsible developer in the BU will go and implement the <code>bar</code> method.</p>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="1">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://lktuan.github.io/blog/2024-07-10-expert-in-python/3_reverse_sit.png" class="img-fluid figure-img"></p>
<figcaption>what if you stand on the left side pane</figcaption>
</figure>
</div>
</div>
</div>
</div>
<p>you have no ability to change and even have no idea where the code on the right pane sit. we can not use <code>hasattr()</code> for this particular situation. the first method is to use <code>try ... catch ...</code>, but it only catches in runtime and we will miss catching it before it goes to production env.</p>
<div class="{callout-note}">
<p>The reason that we could call Python a <strong>protocol orientated language</strong> is not just because the Python data model the object model is protocol orientated but that the entire Python language itself has a notion of hooks and protocols and safety valves within it.</p>
<p>Python is much much simpler language, the code run linearly from top to bottom. And the class statement in Python is actually an executable code. We can write this:</p>
<div id="459c7412" class="cell" data-execution_count="6">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb6-1"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> _ <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>):</span>
<span id="cb6-2">  <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">class</span> Base: <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">pass</span></span>
<span id="cb6-3"></span>
<span id="cb6-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># or the same thing in other way</span></span>
<span id="cb6-5"></span>
<span id="cb6-6"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">class</span> Base:</span>
<span id="cb6-7">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> _ <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>):</span>
<span id="cb6-8">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> bar(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>):</span>
<span id="cb6-9">      <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'bar'</span></span></code></pre></div>
</details>
</div>
<p>Only the last one will survive. Python accepts this syntax because itâ€™s class is <strong>fundamentally executable</strong>.</p>
</div>
<p>Letâ€™s get into something more interesting! create a class inside a function and use a function in a module in standard libbrary in Python called <code>dis</code>.</p>
<div id="e9bb28e0" class="cell" data-execution_count="7">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb7-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># create a class inside a function</span></span>
<span id="cb7-2"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> _():</span>
<span id="cb7-3">  <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">class</span> Base:</span>
<span id="cb7-4">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">pass</span></span>
<span id="cb7-5"></span>
<span id="cb7-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># dis stands for disassemble</span></span>
<span id="cb7-7"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> dis <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> dis</span></code></pre></div>
</details>
</div>
<p>letâ€™s â€˜disâ€™ - stands for disassemble - to see what happen in the bytecode. there are actually things in Python bytecode call <code>LOAD_BUILD_CLASS</code>, itâ€™s actual executable runtime instruction in the Python interpreter for create a class.</p>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="1">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://lktuan.github.io/blog/2024-07-10-expert-in-python/4_dis.png" class="img-fluid figure-img"></p>
<figcaption>disassemble</figcaption>
</figure>
</div>
</div>
</div>
</div>
<p>at the first section of this lecture, we saw some <strong>correspondence</strong> between top-level syntac or function AND some underscore method that implements that syntax or function. there should be also top-level mechanism, not explicitly syntax or function, with the process of building a class. there is a build-ins function called <code>__build_class__</code>.</p>
<div id="0f955f2e" class="cell" data-execution_count="8">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb8-1">old_bc <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> __build_class__</span>
<span id="cb8-2"></span>
<span id="cb8-3"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> my_bc(func, name, base<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span>kw):</span>
<span id="cb8-4">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> base <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">is</span> Base:</span>
<span id="cb8-5">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'check if the bar method is defined'</span>)</span>
<span id="cb8-6">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> base <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">is</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">not</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>:</span>
<span id="cb8-7">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> old_bc(func, name, base, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span>kw)</span>
<span id="cb8-8">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> old_bc(func, name, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span>kw)</span>
<span id="cb8-9"></span>
<span id="cb8-10"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> builtins</span>
<span id="cb8-11">builtins.__build_class__ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> my_bc</span></code></pre></div>
</details>
</div>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="1">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://lktuan.github.io/blog/2024-07-10-expert-in-python/5_build_class.png" class="img-fluid figure-img"></p>
<figcaption><code>__build_class__</code>, we can check if the <code>bar</code> method is implemented, Python is <strong>protocal oriented language</strong>!</figcaption>
</figure>
</div>
</div>
</div>
</div>
<p>Itâ€™s actually quite a common pattern and quite a fundamental piece of Python almost everything that a Python language does in an execution context like building classes, creating functions, importing modules you can find a way to <strong>hook</strong> into that. once you can find a way to hook into that you can start doing things that you want to do like check is my user code going to break from the perspective the library author.</p>
<p>The most important thing here is <strong>understanding existence of this pattern</strong>, knowing that there are options solving such problem, and there are even better approachs.</p>
<section id="there-are-2-fundamental-ways-that-people-ussually-use-to-solve-this" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="there-are-2-fundamental-ways-that-people-ussually-use-to-solve-this">There are 2 fundamental ways that people ussually use to solve this</h2>
<section id="meta-class-1" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="meta-class-1">1. meta class</h3>
<div class="page-columns page-full"><p></p><div class="no-row-height column-margin column-container"><span class="margin-aside"><a href="https://stackoverflow.com/questions/395982/metaclass-new-cls-and-super-what-is-the-mechanism-exactly">futher discussion</a></span></div></div>
<div id="38e91bf5" class="cell" data-execution_count="9">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb9-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># meta classes are merely derived from `type`</span></span>
<span id="cb9-2"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">class</span> BaseMeta(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">type</span>):</span>
<span id="cb9-3">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__new__</span>(cls, name, bases, namespace):</span>
<span id="cb9-4">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'BaseMeta.__new__'</span>, cls, name, bases, namespace)</span>
<span id="cb9-5">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> name <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Base'</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">and</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'bar'</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">not</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> namespace:</span>
<span id="cb9-6">            <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">raise</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">TypeError</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Bad User class, 'bar' is not defined"</span>)</span>
<span id="cb9-7">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">super</span>().<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__new__</span>(cls, name, bases, namespace)</span>
<span id="cb9-8"></span>
<span id="cb9-9"></span>
<span id="cb9-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># then our Base should be derived from BaseMeta</span></span>
<span id="cb9-11"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">class</span> Base(metaclass<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>BaseMeta):</span>
<span id="cb9-12">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> foo(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>):</span>
<span id="cb9-13">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.bar()</span></code></pre></div>
</details>
</div>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="1">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://lktuan.github.io/blog/2024-07-10-expert-in-python/6_meta_class.png" class="img-fluid figure-img"></p>
<figcaption>metaclass</figcaption>
</figure>
</div>
</div>
</div>
</div>
<p>Thatâ€™s it! you can control, constraint the derived class from the base class in class hierachy.</p>
</section>
<section id="init_subclass__" class="level3">
<h3 class="anchored" data-anchor-id="init_subclass__">2. <code>__init_subclass__</code></h3>
<p>We can implement <code>Base</code> like this:</p>
<div id="090bfa24" class="cell" data-execution_count="10">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb10-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">class</span> Base():</span>
<span id="cb10-2">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> foo(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>):</span>
<span id="cb10-3">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.bar()</span>
<span id="cb10-4"></span>
<span id="cb10-5">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__init_subclass__</span>(cls, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span>kwargs):</span>
<span id="cb10-6">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"init subclass"</span>, cls.__dict__, kwargs)</span>
<span id="cb10-7">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'bar'</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">not</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> cls.__dict__:</span>
<span id="cb10-8">            <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">raise</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">TypeError</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Bad sub class"</span>)</span>
<span id="cb10-9">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">super</span>().<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__init_subclass__</span>(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span>kwargs)</span></code></pre></div>
</details>
</div>
</section>
</section>
</section>
<section id="decorator" class="level1">
<h1>decorator</h1>
<p>We would have met pattern like this, thatâ€™s is decorator:</p>
<div id="1b733668" class="cell" data-execution_count="11">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb11-1"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">@dec</span> </span>
<span id="cb11-2"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> f():</span>
<span id="cb11-3">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">pass</span></span></code></pre></div>
</details>
</div>
<p>Python is a live language, there is no separate step that turns function definitions into bags of a set bits tagged and some elf binary or some <a href="https://en.wikipedia.org/wiki/Portable_Executable">PE</a> binary somewhere. That a function definition is actually a live thing, it actually runs at runtime, thereâ€™s actually executable code associated with this def <code>f()</code>.</p>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="1">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://lktuan.github.io/blog/2024-07-10-expert-in-python/7_interact_with_object.png" class="img-fluid figure-img"></p>
<figcaption>we can interact with our object as Python is a live language, the function itself is a runtime object</figcaption>
</figure>
</div>
</div>
</div>
</div>
<p>That every Python structure that you interact with whether itâ€™s an object or a function or a generator has some <strong>runtime life</strong>, has some <strong>runtime existence</strong> you can see it in memory, you can ask it questions like what module UI were you defined in. you can even ask it very useful questions like if you use the inspect module you can say whatâ€™s your source code.</p>
<div class="sourceCode" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb12-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">î‚¶</span> decorators î‚° python <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-i</span> .<span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\d</span>eco.py</span>
<span id="cb12-2"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;&gt;</span> from <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">inspect</span> import getsource</span>
<span id="cb12-3"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;&gt;</span> getsource<span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">add</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb12-4"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'def add(a, b=10):\n    return a + b\n'</span></span>
<span id="cb12-5"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;&gt;</span> print<span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">getsource</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">add</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">))</span></span>
<span id="cb12-6"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">def</span> add<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">a,</span> b=10<span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb12-7">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">a</span> + b </span>
<span id="cb12-8"></span>
<span id="cb12-9"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;&gt;</span> </span></code></pre></div>
<p>now letâ€™s say I want to calculate how much time does it take to perform the <code>add</code>. simply we would thinking about <code>time</code>, like this:</p>
<div id="17be65b1" class="cell" data-execution_count="12">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb13-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> time <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> time</span>
<span id="cb13-2"></span>
<span id="cb13-3"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> add(a, b<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>):</span>
<span id="cb13-4">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> a <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> b</span>
<span id="cb13-5"> </span>
<span id="cb13-6">before <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> time()</span>
<span id="cb13-7"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'add(10)'</span>, add(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>))</span>
<span id="cb13-8">after <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> time()</span>
<span id="cb13-9"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'time_taken'</span>, after <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> before)</span>
<span id="cb13-10"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'add(20, 30)'</span>, add(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>))</span>
<span id="cb13-11">after <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> time()</span>
<span id="cb13-12"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'time_taken'</span>, after <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> before)</span>
<span id="cb13-13"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'add("a", "b")'</span>, add(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"a"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"b"</span>))</span>
<span id="cb13-14">after <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> time()</span>
<span id="cb13-15"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'time_taken'</span>, after <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> before)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>add(10) 20
time_taken 0.0
add(20, 30) 50
time_taken 0.0
add("a", "b") ab
time_taken 0.0</code></pre>
</div>
</div>
<p>there is something wrong here because we need to add code to everywhere we want to calculate. we see another important pattern in Python, decorator, the Python developers want you to write the simplest, stupidest, quickest thing to get the job done and get the rest of your day with your family.</p>
<p>we will see alot of scenarios where of cases where you can write the simple and stupidest thing to get the job done and when the task at hand becomes harder or more complex or the requirements change you can change your code in a very simple fashion to linearly extend its functionality without have to re-write it from scratch.</p>
<p>in Python weâ€™ll see a number of different features are orientated around how do we write the simplest thing today and then when the problem gets a little bit harder we have an avenue for making our code a little bit more complex.</p>
<p>we can modified a <code>add</code> alittle bit</p>
<div id="9ee3649c" class="cell" data-execution_count="13">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb15-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> time <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> time</span>
<span id="cb15-2"></span>
<span id="cb15-3"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> add(a, b<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>):</span>
<span id="cb15-4">    before <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> time()</span>
<span id="cb15-5">    rv <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> a <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> b</span>
<span id="cb15-6">    after <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> time()</span>
<span id="cb15-7">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'elapsed:'</span>, after <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> before)</span>
<span id="cb15-8">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> rv</span></code></pre></div>
</details>
</div>
<p>But if we have more functions, let say <code>sub</code>? We need to modify and make our code complicated. <strong>Python is live language</strong> that everything has some runtime representaion. We can create <code>timer()</code> which take <code>func</code>, <code>x</code>, and <code>y</code> as arguments (<code>x</code> and <code>y</code> will be forwarded to calculation function)</p>
<div id="3aca1fe5" class="cell" data-execution_count="14">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb16-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> time <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> time</span>
<span id="cb16-2"></span>
<span id="cb16-3"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> timer(func, x, y):</span>
<span id="cb16-4">    before <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> time()</span>
<span id="cb16-5">    rv <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> func(x,y)</span>
<span id="cb16-6">    after <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> time()</span>
<span id="cb16-7">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'elapsed:'</span>, after <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> before)</span>
<span id="cb16-8">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> rv</span>
<span id="cb16-9"></span>
<span id="cb16-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># and </span></span>
<span id="cb16-11"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'add(20, 30)'</span>, timer(add, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>))</span></code></pre></div>
</details>
</div>
<p>we can also wrapping like this, <code>timer()</code> will return a function <code>f</code>:</p>
<div id="19af8894" class="cell" data-execution_count="15">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb17-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> time <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> time</span>
<span id="cb17-2"></span>
<span id="cb17-3"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> timer(func):</span>
<span id="cb17-4">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> f(x, y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>):</span>
<span id="cb17-5">      before <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> time()</span>
<span id="cb17-6">      rv <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> func(x,y)</span>
<span id="cb17-7">      after <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> time()</span>
<span id="cb17-8">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'elapsed:'</span>, after <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> before)</span>
<span id="cb17-9">      <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> rv</span>
<span id="cb17-10">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> f</span>
<span id="cb17-11"></span>
<span id="cb17-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># and </span></span>
<span id="cb17-13">add <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> timer(add)</span>
<span id="cb17-14"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'add(20, 30)'</span>, add(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>))</span></code></pre></div>
</details>
</div>
<p>Python provides a syntax for easily implement every behaviours of <code>timer()</code> to every function:</p>
<div id="7447cf77" class="cell" data-execution_count="16">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb18-1"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">@timer</span></span>
<span id="cb18-2"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> add(a, b<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>):</span>
<span id="cb18-3">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> a <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> b</span>
<span id="cb18-4"></span>
<span id="cb18-5"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'add(20, 30)'</span>, add(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>))</span></code></pre></div>
</details>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Fundamentally itâ€™s about allowing you to take this wrapping behavior for functions and to wrap wide swathes of functions in one fashion without having to rewrite a lot of user code or having to even perform a lot of turn on your library code.</p>
</div>
</div>
<p>another example when we want a function to run n-times:</p>
<div id="827cb88c" class="cell" data-execution_count="17">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb19-1">n <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># let's say 2 times</span></span>
<span id="cb19-2"></span>
<span id="cb19-3"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> ntimes(f):</span>
<span id="cb19-4">  <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> wrapper(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>args, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span>kwargs):</span>
<span id="cb19-5">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> _ <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(n):</span>
<span id="cb19-6">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'running {.__name__}'</span>.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">format</span>(f))</span>
<span id="cb19-7">      rv <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> f(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>args, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span>kwargs)</span>
<span id="cb19-8">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> rv</span>
<span id="cb19-9">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> wrapper</span>
<span id="cb19-10">    </span>
<span id="cb19-11"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">@ntimes</span></span>
<span id="cb19-12"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> add(a, b<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>):</span>
<span id="cb19-13">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> a <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> b</span>
<span id="cb19-14"></span>
<span id="cb19-15">add(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>running add
running add</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="2">
<pre><code>30</code></pre>
</div>
</div>
<p>wrapp <code>n</code> in to the function so <code>ntimes()</code> takes <code>n</code> instead of <code>f</code> as arg:</p>
<div id="5f7c8852" class="cell" data-execution_count="18">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb22" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb22-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># high order decorators</span></span>
<span id="cb22-2"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> ntimes(n):</span>
<span id="cb22-3">  <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> inner(f):</span>
<span id="cb22-4">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> wrapper(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>args, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span>kwargs):</span>
<span id="cb22-5">      <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> _ <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(n):</span>
<span id="cb22-6">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'running {.__name__}'</span>.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">format</span>(f))</span>
<span id="cb22-7">        rv <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> f(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>args, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span>kwargs)</span>
<span id="cb22-8">      <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> rv</span>
<span id="cb22-9">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> wrapper</span>
<span id="cb22-10">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> inner</span>
<span id="cb22-11">    </span>
<span id="cb22-12"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">@ntimes</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span>
<span id="cb22-13"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> add(a, b<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>):</span>
<span id="cb22-14">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> a <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> b</span>
<span id="cb22-15"></span>
<span id="cb22-16">add(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>running add
running add
running add</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="3">
<pre><code>30</code></pre>
</div>
</div>
<p>There is a very important core concept that is hidden in here which is what you might call the <strong>closure object duality</strong>. itâ€™s not something that we have time to look at in this session.</p>
</section>
<section id="generator" class="level1 page-columns page-full">
<h1>generator</h1>
<p>recall what weâ€™ve learned in previous section:</p>
<ul>
<li>there are top-level syntax or function &lt;â€“&gt; and some underscore methods that implemented it.</li>
<li>if you have parentheses after something x() &lt;â€“&gt; implies <code>__call__</code> protocol implemented.</li>
</ul>
<p>what is different between these 2:</p>
<div id="0698ed3a" class="cell" data-execution_count="19">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb25" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb25-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> add1(x, y):</span>
<span id="cb25-2">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> y</span>
<span id="cb25-3"></span>
<span id="cb25-4"></span>
<span id="cb25-5"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">class</span> Adder:</span>
<span id="cb25-6">  <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__call__</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, x, y):</span>
<span id="cb25-7">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> y </span>
<span id="cb25-8">add2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Adder()</span>
<span id="cb25-9"></span>
<span id="cb25-10"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(add1(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>)) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 30</span></span>
<span id="cb25-11"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(add2(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>)) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 20</span></span>
<span id="cb25-12"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">type</span>(add1) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># &lt;class 'function'&gt;</span></span>
<span id="cb25-13"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">type</span>(add2) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># &lt;class '__main__.Adder'&gt;</span></span></code></pre></div>
</details>
</div>
<p>functionally there is not distinguish between <code>add1</code> and <code>add2</code>. <code>add1</code> is syntaxtically whole hell more easy to write. another diffence is if you want to add some <em>statefull behaviors</em>, we can easily modified the class:</p>
<div id="a5a98768" class="cell" data-execution_count="20">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb26" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb26-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">class</span> Adder:</span>
<span id="cb26-2">  <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__init__</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>):</span>
<span id="cb26-3">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.z <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb26-4"></span>
<span id="cb26-5">  <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__call__</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, x, y):</span>
<span id="cb26-6">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.z <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb26-7">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.z</span></code></pre></div>
</details>
</div>
<div class="page-columns page-full"><p></p><div class="no-row-height column-margin column-container"><span class="margin-aside">Äá»c thÃªm vá» <a href="https://magz.techover.io/2021/12/04/python-deep-dive-hieu-closures-decorators-va-cac-ung-dung-cua-chung-phan-1/">chuá»—i bÃ i nÃ y</a> náº¿u tháº¥y confuse</span></div></div>
<p>there is one what to do with the Adder, another way to do with the function, what he hinted at this object <strong>closure duality</strong>.</p>
<p>letâ€™s think about a function that take a lot of time to do something, like loading the data from the database. we demo by a simple function <code>compute()</code>, which sleep 0.5 sec for each loop. the function only gives us the result once it completelt complete the loop, it will give us the entire result all at once. what if we care about the first? the first 3 values?</p>
<p>this is undesirable. this is wasteful both from the perspective of time &amp; memory. letâ€™s think about it with the object model and rewrite under <code>Compute</code> class:</p>
<div id="583238e2" class="cell" data-execution_count="21">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb27" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb27-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> time <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> sleep</span>
<span id="cb27-2"></span>
<span id="cb27-3"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> compute()</span>
<span id="cb27-4">  rv <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb27-5">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>):</span>
<span id="cb27-6">    sleep(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">.5</span>)</span>
<span id="cb27-7">    rv.append(i)</span>
<span id="cb27-8">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> rv</span>
<span id="cb27-9"></span>
<span id="cb27-10"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">class</span> Compute:</span>
<span id="cb27-11">  <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__init__</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>):</span>
<span id="cb27-12">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">pass</span></span>
<span id="cb27-13"></span>
<span id="cb27-14">  <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__call__</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>):</span>
<span id="cb27-15">    rv <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb27-16">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>):</span>
<span id="cb27-17">      sleep(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">.5</span>)</span>
<span id="cb27-18">      rv.append(i)</span>
<span id="cb27-19">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> rv</span>
<span id="cb27-20">compute2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Compute()</span></code></pre></div>
</details>
</div>
<div class="page-columns page-full"><p>the 2nd method: </p><div class="no-row-height column-margin column-container"><span class="margin-aside"><a href="https://realpython.com/python-callable-instances">read more</a></span></div></div>
<ul>
<li>Retain state between calls (<strong>stateful callables</strong>)</li>
<li>Cache values that result from previous computations</li>
<li>Implement straightforward and convenient APIs</li>
</ul>
<p>if you want to access data during computaion, think of:</p>
<pre><code>for x in xs:
  pass

x1 = iter(xs)   ---&gt; __iter__
while True:
  x = next(x1)  ---&gt; __next__</code></pre>
<p>and re-write the <code>Compute</code> like this:</p>
<div id="630e83a0" class="cell" data-execution_count="22">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb29" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb29-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">class</span> Compute:</span>
<span id="cb29-2">  <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__iter__</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>):</span>
<span id="cb29-3">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.last <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb29-4">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span> </span>
<span id="cb29-5">  </span>
<span id="cb29-6">  <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__next__</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>):</span>
<span id="cb29-7">    rv <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.last</span>
<span id="cb29-8">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.last <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb29-9">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.last <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>:</span>
<span id="cb29-10">      <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">raise</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">StopIteration</span>()</span>
<span id="cb29-11">    sleep(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">.5</span>)</span>
<span id="cb29-12">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> rv</span>
<span id="cb29-13"></span>
<span id="cb29-14"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> val <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> Compute():</span>
<span id="cb29-15">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(val)</span></code></pre></div>
</details>
</div>
<p>now, it:</p>
<ul>
<li>takes 1 iteration to let you start using it;</li>
<li>takes no storage;</li>
<li>but looks ugly.</li>
</ul>
<p>and there is much simpler way to write a function that operate in such fashion, the <strong>generator</strong> syntax, it merely:</p>
<div id="8ff097c6" class="cell" data-execution_count="23">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb30" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb30-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> compute()</span>
<span id="cb30-2">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>):</span>
<span id="cb30-3">    sleep(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">.5</span>)</span>
<span id="cb30-4">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">yield</span> i</span></code></pre></div>
</details>
</div>
<p>its state is maintained internally. instead of eagerly computing the values, you give them to the user as the ask. letâ€™s look in the last example:</p>
<div id="cf92bb02" class="cell" data-execution_count="24">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb31" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb31-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">class</span> Api:</span>
<span id="cb31-2">  <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> run_this_first():</span>
<span id="cb31-3">    first()</span>
<span id="cb31-4">  <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> run_this_second():</span>
<span id="cb31-5">    second()</span>
<span id="cb31-6">  <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> run_this_last():</span>
<span id="cb31-7">    lass()</span>
<span id="cb31-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># in documentation you ask user to use those functions in order but no physically constraint you to not run like this:</span></span>
<span id="cb31-9">Api.run_this_last()</span>
<span id="cb31-10">Api.run_this_second()</span>
<span id="cb31-11">Api.run_this_first()</span></code></pre></div>
</details>
</div>
<p>the generator not only yield the result back, but also the control back to the caller. we can interleave our code with library code, controling them to run in order, that is conceptualization of how generators are built upon - co-routines.</p>
<p>we can either define execution function inside the class or use generator to control the sequence:</p>
<div id="2a98e5f2" class="cell" data-execution_count="25">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb32" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb32-1">...</span>
<span id="cb32-2">  <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> doit():</span>
<span id="cb32-3">    first()</span>
<span id="cb32-4">    second()</span>
<span id="cb32-5">    last()</span>
<span id="cb32-6">... </span>
<span id="cb32-7"></span>
<span id="cb32-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># or</span></span>
<span id="cb32-9"></span>
<span id="cb32-10"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> api()</span>
<span id="cb32-11">  first()</span>
<span id="cb32-12">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">yield</span></span>
<span id="cb32-13">  second()</span>
<span id="cb32-14">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">yield</span></span>
<span id="cb32-15">  last()</span></code></pre></div>
</details>
</div>
</section>
<section id="context-manager" class="level1">
<h1>context manager</h1>
<p>setup &amp; teardown ~ initial action and final action. we would often see pattern like:</p>
<div id="38b78af3" class="cell" data-execution_count="26">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb33" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb33-1"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">with</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">open</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ctx.py'</span>) <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> f:</span>
<span id="cb33-2">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">pass</span></span></code></pre></div>
</details>
</div>
<p>beyond the file, it can be also sqllite</p>
<div id="3576f9c0" class="cell" data-execution_count="27">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb34" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb34-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> sqlite3 <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">connect</span></span>
<span id="cb34-2"></span>
<span id="cb34-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># control the execution is executed when connection is open</span></span>
<span id="cb34-4"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">with</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">connect</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'test.db'</span>) <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> conn:</span>
<span id="cb34-5">  cur <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> conn.cursor()</span>
<span id="cb34-6">  cur.execute(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'create table points(x int, y int)'</span>)</span>
<span id="cb34-7">  cur.execute(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'insert into points(x, y) values (1, 1)'</span>)</span>
<span id="cb34-8">  cur.execute(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'insert into points(x, y) values (2, 1)'</span>)</span>
<span id="cb34-9">  cur.execute(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'insert into points(x, y) values (1, 2)'</span>)</span>
<span id="cb34-10">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> row <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> cur.execute(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'select sum(x * y) from points'</span>):</span>
<span id="cb34-11">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(row)</span>
<span id="cb34-12">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> row <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> cur.execute(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'select x, y from points'</span>):</span>
<span id="cb34-13">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(row)</span>
<span id="cb34-14">  cur.execute(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'drop table points'</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>(5,)
(1, 1)
(2, 1)
(1, 2)</code></pre>
</div>
</div>
<p>now we already control if connection is live to do something, weâ€™ve not yet controlled inside the connection, the entry point and the exit point. now behind the scence</p>
<pre><code>with ctx() as x:
  pass</code></pre>
<p>will look like the following:</p>
<pre><code>x = ctx().__enter__
try
  pass
finally:
  x.__exit__</code></pre>
<p>weâ€™ll try to emplement this to our connection, weâ€™ll wrap it to a <strong>temporary table behaviour</strong>:</p>
<div id="2b7f6312" class="cell" data-execution_count="28">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb38" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb38-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> sqlite3 <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">connect</span></span>
<span id="cb38-2"></span>
<span id="cb38-3"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">class</span> Temporarytable:</span>
<span id="cb38-4">  <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__init__</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, cur):</span>
<span id="cb38-5">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.cur <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> cur</span>
<span id="cb38-6">  <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__enter__</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>):</span>
<span id="cb38-7">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'__enter__'</span>)</span>
<span id="cb38-8">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.cur.execute(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'create table points(x int, y int)'</span>)</span>
<span id="cb38-9">  <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__exit__</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>arg): <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># why need *arg</span></span>
<span id="cb38-10">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'__exit__'</span>)</span>
<span id="cb38-11">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.cur.execute(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'drop table points'</span>)</span>
<span id="cb38-12"></span>
<span id="cb38-13"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">with</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">connect</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'test.db'</span>) <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> conn:</span>
<span id="cb38-14">  cur <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> conn.cursor()</span>
<span id="cb38-15">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">with</span> Temporarytable(cur<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>cur):</span>
<span id="cb38-16">    cur.execute(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'insert into points(x, y) values (1, 1)'</span>)</span>
<span id="cb38-17">    cur.execute(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'insert into points(x, y) values (2, 1)'</span>)</span>
<span id="cb38-18">    cur.execute(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'insert into points(x, y) values (1, 2)'</span>)</span>
<span id="cb38-19">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> row <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> cur.execute(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'select sum(x * y) from points'</span>):</span>
<span id="cb38-20">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(row)</span>
<span id="cb38-21">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> row <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> cur.execute(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'select x, y from points'</span>):</span>
<span id="cb38-22">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(row)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>__enter__
(5,)
(1, 1)
(2, 1)
(1, 2)
__exit__</code></pre>
</div>
</div>
<p>now can the exit run before the enter, no! they need to be run sequencely. it remind us about the <strong>generator</strong> to improve this:</p>
<div id="749b00d4" class="cell" data-execution_count="29">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb40" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb40-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> sqlite3 <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">connect</span></span>
<span id="cb40-2"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> temporarytable(cur):</span>
<span id="cb40-3">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'created table'</span>)</span>
<span id="cb40-4">  cur.execute(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'create table points(x int, y int)'</span>)</span>
<span id="cb40-5">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">yield</span></span>
<span id="cb40-6">  cur.execute(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'drop table points'</span>)</span>
<span id="cb40-7">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'dropped table'</span>)</span>
<span id="cb40-8"></span>
<span id="cb40-9"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">class</span> Temporarytable:</span>
<span id="cb40-10">  <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__init__</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, cur):</span>
<span id="cb40-11">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.cur <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> cur</span>
<span id="cb40-12">  <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__enter__</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>):</span>
<span id="cb40-13">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.gen <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> temporarytable(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.cur)</span>
<span id="cb40-14">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">next</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.gen)</span>
<span id="cb40-15">  <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__exit__</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>arg):</span>
<span id="cb40-16">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">next</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.gen, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>)</span>
<span id="cb40-17"></span>
<span id="cb40-18"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">with</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">connect</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'test.db'</span>) <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> conn:</span>
<span id="cb40-19">  cur <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> conn.cursor()</span>
<span id="cb40-20">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">with</span> Temporarytable(cur<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>cur):</span>
<span id="cb40-21">    cur.execute(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'insert into points(x, y) values (1, 1)'</span>)</span>
<span id="cb40-22">    cur.execute(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'insert into points(x, y) values (2, 1)'</span>)</span>
<span id="cb40-23">    cur.execute(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'insert into points(x, y) values (1, 2)'</span>)</span>
<span id="cb40-24">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> row <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> cur.execute(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'select sum(x * y) from points'</span>):</span>
<span id="cb40-25">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(row)</span>
<span id="cb40-26">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> row <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> cur.execute(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'select x, y from points'</span>):</span>
<span id="cb40-27">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(row)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>created table
(5,)
(1, 1)
(2, 1)
(1, 2)
dropped table</code></pre>
</div>
</div>
<p>enter and exit are already implemented in function <code>temporarytable</code> and cursor is implemented in the <code>connect()</code> call. now i would rewrite like this</p>
<div id="3007e670" class="cell" data-execution_count="30">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb42" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb42-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> sqlite3 <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">connect</span></span>
<span id="cb42-2"></span>
<span id="cb42-3"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">class</span> Temporarytable:</span>
<span id="cb42-4">  <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__init__</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, gen):</span>
<span id="cb42-5">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.gen <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> gen</span>
<span id="cb42-6">  <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__call__</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>args, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span>kwargs):</span>
<span id="cb42-7">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.args, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.kwargs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> args, kwargs</span>
<span id="cb42-8">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span></span>
<span id="cb42-9">  <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__enter__</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>):</span>
<span id="cb42-10">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.gen_instance <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.gen(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.args, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.kwargs)</span>
<span id="cb42-11">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">next</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.gen_instance)</span>
<span id="cb42-12">  <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__exit__</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>arg):</span>
<span id="cb42-13">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">next</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.gen_instance, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>)</span>
<span id="cb42-14"></span>
<span id="cb42-15"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">@Temporarytable</span></span>
<span id="cb42-16"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> temporarytable(cur):</span>
<span id="cb42-17">  cur.execute(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'create table points(x int, y int)'</span>)</span>
<span id="cb42-18">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">yield</span></span>
<span id="cb42-19">  cur.execute(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'drop table points'</span>)</span>
<span id="cb42-20"></span>
<span id="cb42-21"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># temporarytable = Temporarytable(temporarytable)</span></span>
<span id="cb42-22"></span>
<span id="cb42-23"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">with</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">connect</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'test.db'</span>) <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> conn:</span>
<span id="cb42-24">  cur <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> conn.cursor()</span>
<span id="cb42-25">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">with</span> temporarytable(cur):</span>
<span id="cb42-26">    cur.execute(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'insert into points(x, y) values (1, 1)'</span>)</span>
<span id="cb42-27">    cur.execute(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'insert into points(x, y) values (2, 1)'</span>)</span>
<span id="cb42-28">    cur.execute(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'insert into points(x, y) values (1, 2)'</span>)</span>
<span id="cb42-29">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> row <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> cur.execute(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'select sum(x * y) from points'</span>):</span>
<span id="cb42-30">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(row)</span>
<span id="cb42-31">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> row <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> cur.execute(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'select x, y from points'</span>):</span>
<span id="cb42-32">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(row)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>(5,)
(1, 1)
(2, 1)
(1, 2)</code></pre>
</div>
</div>
<p>all the stuff context manager above we do not need to write:</p>
<div id="f0ded331" class="cell" data-execution_count="31">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb44" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb44-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> sqlite3 <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">connect</span></span>
<span id="cb44-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> contextlib <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> contextmanager</span>
<span id="cb44-3"></span>
<span id="cb44-4"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">@contextmanager</span></span>
<span id="cb44-5"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> temporarytable(cur):</span>
<span id="cb44-6">  cur.execute(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'create table points(x int, y int)'</span>)</span>
<span id="cb44-7">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">try</span>:</span>
<span id="cb44-8">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">yield</span></span>
<span id="cb44-9">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">finally</span>:</span>
<span id="cb44-10">    cur.execute(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'drop table points'</span>)</span>
<span id="cb44-11"></span>
<span id="cb44-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># temporarytable = Temporarytable(temporarytable)</span></span>
<span id="cb44-13"></span>
<span id="cb44-14"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">with</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">connect</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'test.db'</span>) <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> conn:</span>
<span id="cb44-15">  cur <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> conn.cursor()</span>
<span id="cb44-16">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">with</span> temporarytable(cur):</span>
<span id="cb44-17">    cur.execute(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'insert into points(x, y) values (1, 1)'</span>)</span>
<span id="cb44-18">    cur.execute(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'insert into points(x, y) values (2, 1)'</span>)</span>
<span id="cb44-19">    cur.execute(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'insert into points(x, y) values (1, 2)'</span>)</span>
<span id="cb44-20">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> row <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> cur.execute(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'select sum(x * y) from points'</span>):</span>
<span id="cb44-21">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(row)</span>
<span id="cb44-22">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> row <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> cur.execute(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'select x, y from points'</span>):</span>
<span id="cb44-23">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(row)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>(5,)
(1, 1)
(2, 1)
(1, 2)</code></pre>
</div>
</div>
</section>
<section id="summary" class="level1">
<h1>summary</h1>
<p>all combination of what weâ€™ve learned in the last example:</p>
<ul>
<li>a <strong>context manager</strong> is merely some piece of code that pairs set up actions and teardown actions. teardown occurs only if set up occurs</li>
<li>a <strong>generator</strong> is merely some form of syntax that allows us to do things like enforce sequencing and interleaving notice the</li>
</ul>
<p>finally we need something to adapt the generator to this data model that we looked at at the very beginning. we have these underscore methods and we have to find some way to take how the generator works and fit it into those underscore methods. one of the things we need to do in order to do that is we need to take this generator object to wrap it in some fashion that wrapping is part of the core of how Python works itâ€™s easy to dynamics and construct functions</p>
<ul>
<li>there does happen to be a feature called <strong>decorators</strong> that allows us a nice convenient syntax for doing that exactly.</li>
</ul>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>criteria of Python expert code:</p>
<ul>
<li>expert level code is not code that uses every single feature;</li>
<li>itâ€™s in fact not code that even uses that many features of Python;</li>
<li>itâ€™s code that has a certain clarity to where and when a feature should be used;</li>
<li>itâ€™s code that doesnâ€™t waste the time of the person whoâ€™s writing it because they say to themselves I have this pattern Python has this mechanism I fit them together and everything just seamlessly and and very smoothly works;</li>
<li>itâ€™s code that doesnâ€™t have a lot of additional mechanisms associated with it it doesnâ€™t have people creating their own protocols it doesnâ€™t have people creating their own frameworks where the language itself provides the core pieces that you need and you merely have to understand what those core pieces are what they need and how to assemble them.</li>
</ul>
</div>
</div>
</section>
<section id="futher-reading" class="level1">
<h1>futher reading</h1>
<ol type="1">
<li><a href="https://docs.python.org/3/reference/datamodel.html">Python data model</a></li>
<li><a href="https://www.geeksforgeeks.org/python-metaclass-__new__-method/">Python metaclass <code>__new__</code></a></li>
</ol>


<!-- -->

</section>

 ]]></description>
  <category>python</category>
  <category>pydata</category>
  <guid>https://lktuan.github.io/blog/2024-07-10-expert-in-python/</guid>
  <pubDate>Tue, 09 Jul 2024 17:00:00 GMT</pubDate>
  <media:content url="https://lktuan.github.io/blog/2024-07-10-expert-in-python/pydata-logo-final.png" medium="image" type="image/png" height="60" width="144"/>
</item>
<item>
  <title>A lesson of advanced python from Juan RodrÃ­guez</title>
  <dc:creator>Tuan Le Khac</dc:creator>
  <link>https://lktuan.github.io/blog/2024-07-08-advanced-python/</link>
  <description><![CDATA[ 





<p>This <a href="https://github.com/astrojuanlu/ie-mbd-advanced-python/tree/main">lesson</a> was found on <a href="https://github.com/astrojuanlu">Juan Luis Cano RodrÃ­guezâ€™s</a> github profile when I came across his talk <a href="https://www.youtube.com/watch?v=ffDHdtz_vKc">â€œBuilding the composable Python data stack with Kedro &amp; Ibisâ€</a> (bookmarked for learning later) in <a href="https://www.youtube.com/playlist?list=PLGVZCDnMOq0rrhYTNedKKuJ9716fEaAdK">Pydata London 2024</a>.</p>
<p>This is my notes:</p>
<section id="intro" class="level1">
<h1>00 <a href="https://github.com/astrojuanlu/ie-mbd-advanced-python/blob/main/sessions/00_intro.ipynb">intro</a></h1>
<section id="learning-objectives" class="level2">
<h2 class="anchored" data-anchor-id="learning-objectives">learning objectives</h2>
<ul>
<li>Learn modern software engineering practices using Python</li>
<li>Understand the value of automation in the software engineering process</li>
<li>Gain insight into how Data Science projects are put in production</li>
<li>Learn better techniques to collaborate in software projects</li>
</ul>
<p>The instructor used Linux / Conda, err I just have Window here so there is no other way but right I will try to make stuffs work in Window. Letâ€™s get started!</p>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="1">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://raw.githubusercontent.com/astrojuanlu/ie-mbd-advanced-python/e2224276f91529280ebfcd42ddc7dc22cf0d2010/img/quote-talk-is-cheap-show-me-the-code-linus-torvalds-273528.jpg" class="img-fluid figure-img"></p>
<figcaption>stolen from the lecture</figcaption>
</figure>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="git" class="level1">
<h1>01 <a href="https://github.com/astrojuanlu/ie-mbd-advanced-python/blob/main/sessions/01_git.ipynb">git</a></h1>
<section id="glossary" class="level2">
<h2 class="anchored" data-anchor-id="glossary">glossary</h2>
<ul>
<li><strong>Repository</strong>: Directory tracked by git, contains a <code>.git</code> folder and itâ€™s created by <code>$ git init</code>;</li>
<li><strong>Commit</strong>: State or snapshot of the repository, they are created by <code>$ git commit</code>;</li>
<li><strong>Branch</strong>: A parallel or separate line of development, the default one is master and they are created by <code>$ git branch</code> or <code>$ git checkout -b</code>.</li>
</ul>
</section>
<section id="git-uses-a-linux-like-cli-so-now-linux-cli-101-and-how-to-do-the-same-on-window-pwsh" class="level2">
<h2 class="anchored" data-anchor-id="git-uses-a-linux-like-cli-so-now-linux-cli-101-and-how-to-do-the-same-on-window-pwsh">git uses a Linux-like cli so now Linux cli 101 (and how to do the same on Window pwsh)</h2>
<ul>
<li><code>whoami</code>: who am i</li>
<li><code>pwd</code>: print working directory</li>
<li><code>ls</code>: list all file in the dir, <code>.</code> for current folder, <code>..</code> for parent one (seems there is no <code>--color</code> or <code>-a</code> in pwsh)</li>
<li><code>cd</code>: change dir</li>
<li><code>touch</code>: create empty file (in pwsh we use <code>echo "" &gt;&gt; file_name</code>)</li>
<li><code>cat</code>: concatenate, print file contents</li>
<li><code>nano</code>: edit a file from the command line (there is a <a href="https://www.hanselman.com/blog/developers-can-run-bash-shell-and-usermode-ubuntu-linux-binaries-on-windows-10">way</a> that allows us to do the same in win10, but ya, nope)</li>
</ul>
</section>
<section id="workflow" class="level2">
<h2 class="anchored" data-anchor-id="workflow">workflow</h2>
<p>I did these in pwsh:</p>
<ol type="1">
<li>Create a directory <code>mkdir test_project</code> and navigate there <code>cd test_project</code>;</li>
<li>Init a git repository <code>git init</code>;</li>
<li>Check status <code>git status</code> (â€œon branch master, no commits yet, nothing to commitâ€);</li>
<li>Create some files <code>echo "#Hello, world!" &gt;&gt; readme.md</code>;</li>
<li>Stage the files <code>git add readme.md</code>;</li>
<li>Commit the changes <code>git commit -m "initial commit"</code>;</li>
</ol>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>Do not run <code>git init</code> on your home directory, as it can lead to confusion and potential data loss. If <code>git status</code> gives a lot of untracked files unrelated to your project, you might want to <code>rm -rf .git</code> and start in another directory. Notice that this command removes all git history.</p>
</div>
</div>
</section>
<section id="branching" class="level2">
<h2 class="anchored" data-anchor-id="branching">branching</h2>
<ol type="1">
<li>Create and checkout to new branch <code>git switch -c branch1</code> (<code>-c</code> stands for create);</li>
<li>Commit there (see above);</li>
<li>Go back to main branch <code>git switch master</code>;</li>
<li>Merge changes <code>git merge branch1</code>;</li>
<li>Delete branch <code>git branch -d branch1</code> (<code>-d</code> stands for delete, donâ€™t forget this step!).</li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Normally, the <code>git merge</code> step happens online using <em>pull requests</em> or <em>merge requests</em>, which are <strong>not</strong> git concepts, but GitHub/GitLab concepts.</li>
<li>If <code>git switch</code> does not work for you, you might have an older version of Git. Consider upgrading, or alternatively replace all <code>git switch -c</code> with <code>git checkout -b</code>.</li>
</ul>
</div>
</div>
<blockquote class="blockquote">
<p>Pull requests (PR) let you tell others about changes youâ€™ve pushed to a branch in a repository on GitHub. Once a pull request is opened, you can discuss and review the potential changes with collaborators and add follow-up commits before your changes are merged into the base branch. â€“ GitHub</p>
</blockquote>
<blockquote class="blockquote">
<p>A merge request (MR) is a proposal to incorporate changes from a source branch to a target branch. â€“ GitLab</p>
</blockquote>
<blockquote class="blockquote">
<p>Remember to <strong>never commit to master</strong>. â€“ Git Workflow</p>
</blockquote>
</section>
<section id="merging" class="level2">
<h2 class="anchored" data-anchor-id="merging">merging</h2>
<p>2 types of merging:</p>
<ul>
<li><strong>Fast-forward merge</strong>: There is no diverging history, and git just â€œadvances the pointerâ€ of the current branch. <code>git merge new-branch --ff-only</code> will fail if a fast-forward merge is not possible;</li>
<li><strong>Non fast-forward merge</strong>: The history diverged, and git will create a merge commit (hence ask for a commit message) with two parents that combines the two branches. <code>git merge new-branch --no-ff</code> always creates a merge commit even if a fast-forward merge is possible.</li>
</ul>
<p>GitHub use <code>--no--ff</code> option for pull requests, see <a href="https://docs.github.com/en/pull-requests/collaborating-with-pull-requests/incorporating-changes-from-a-pull-request/merging-a-pull-request">here</a>, and this old-but-gold <a href="https://stackoverflow.com/questions/9069061/what-effect-does-the-no-ff-flag-have-for-git-merge">discussion</a>.</p>
<ul>
<li>Non fast-forward merges can end up in conflicts. In that case, git will halt the merge operation and leave traces in the affected files;</li>
<li>To abort a merge <code>git merge --abort</code> (useful if we are scared and donâ€™t know what to do);</li>
<li>To merge overriding everything with the upcoming branch <code>git merge new-branch --strategy-option theirs</code>;</li>
<li>To merge overriding everything with the current branch <code>git merge new-branch --strategy-option ours</code>.</li>
</ul>
<p><strong>Be careful</strong> while editing files that are in conflict.</p>
</section>
<section id="other" class="level2">
<h2 class="anchored" data-anchor-id="other">other</h2>
<ul>
<li>Ignoring files <code>.gitignore</code>;</li>
<li>Amend the last commit: <code>git commit --amend</code>;</li>
<li>Show pretty history: <code>git log --graph --oneline --decorate --all</code>;</li>
<li>Configuring git aliases: <code>git config --global alias.lg "log --graph --oneline --decorate"</code> (and now you have <code>git lg</code>!).</li>
</ul>
<p>This excellent chart will help you in git workflow decision making.</p>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="1">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://lktuan.github.io/blog/2024-07-08-advanced-python/git_pretty.png" class="img-fluid figure-img"></p>
<figcaption>git flowchart, photo credit to this SO <a href="https://stackoverflow.com/questions/14096721/how-to-add-file-to-a-previous-commit">thread</a></figcaption>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="triangular-workflows-in-git" class="level2">
<h2 class="anchored" data-anchor-id="triangular-workflows-in-git">triangular workflows in git</h2>
<p>When collaborating with a project hosted online on GitHub or GitLab, the most common setup is having a central repository, one remote fork per user, and local clones/checkouts:</p>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="1">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://github.blog/wp-content/uploads/2015/07/5dcdcae4-354a-11e5-9f82-915914fad4f7.png?resize=2000%2C951" class="img-fluid figure-img"></p>
<figcaption>triangular workflows in git, <a href="https://github.blog/2015-07-29-git-2-5-including-multiple-worktrees-and-triangular-workflows/">source</a></figcaption>
</figure>
</div>
</div>
</div>
</div>
<p>Notice the different naming conventions between this website and the first image:</p>
<ul>
<li>Convention 1: upstream/origin/local</li>
<li>Convention 2: origin/<username>/local</username></li>
</ul>
<p>We will be consistent with the Aaron Meurer guide and therefore use Convention 2 all the time.</p>
</section>
<section id="after-creating-a-pr" class="level2">
<h2 class="anchored" data-anchor-id="after-creating-a-pr">after creating a PR</h2>
<p>After your pull request has been merged to <code>master</code>, your local <code>master</code> and <code>&lt;username&gt;/master</code> will be outdated with respect to <code>origin/master</code>. On the other hand, you should <strong>avoid working on this branch anymore in the future</strong>: remember branches should be ephemeral and short-lived.</p>
<p>To put yourself in a clean state again, you have to:</p>
<ol type="1">
<li>Click â€œremove branchâ€ in the pull request (donâ€™t click â€œremove forkâ€!);</li>
<li><code>git checkout master</code> (go back to master);</li>
<li><code>git fetch origin</code> (<strong>never, ever</strong> use <code>git pull</code> unless you know exactly what youâ€™re doing)</li>
<li><code>git merge --ff-only origin master</code> (update your local master with origin/master, and fail if you accidentally made any commit in master)</li>
<li><code>git fetch -p &lt;username&gt;</code> (âœ¨ acknowledge the removal of the remote branch âœ¨)</li>
<li><code>git branch -d old-branch</code> (remove the old branch)</li>
<li><code>git push &lt;username&gt; master</code> (update your fork with respect to origin)</li>
<li><code>git checkout -b new-branch</code> (start working in the new feature!)</li>
</ol>
<p>This process has to be repeated <strong>after every pull request</strong>.</p>
<p>Some organizations where all the members are trusted do not use forks, and everybody pushes their branches to the same repository instead. While this simplifies some parts of the workflow, it also requires proper checks in place to prevent bad code to be merged - for example, by <a href="https://docs.github.com/en/repositories/configuring-branches-and-merges-in-your-repository/managing-protected-branches/managing-a-branch-protection-rule">requiring a minimum number of reviews</a> or some <a href="https://docs.github.com/en/repositories/configuring-branches-and-merges-in-your-repository/managing-protected-branches/about-protected-branches">automated status checks</a>.</p>
</section>
</section>
<section id="pythonpath" class="level1">
<h1>02 <a href="https://github.com/astrojuanlu/ie-mbd-advanced-python/blob/main/sessions/02_pythonpath.ipynb">pythonpath</a></h1>
<section id="how-does-import-work" class="level2">
<h2 class="anchored" data-anchor-id="how-does-import-work">how does <code>import</code> work?</h2>
<p>How do <code>import os, pandas</code> work? If <code>pandas</code> was not installed, what happen?</p>
</section>
<section id="how-can-i-import-my-code" class="level2">
<h2 class="anchored" data-anchor-id="how-can-i-import-my-code">how can I <code>import</code> my code?</h2>
<p>There are three ways to import our own code:</p>
<ul>
<li><strong>Being on the same directory</strong>: This is the quickest, however it scales quite poorly (imagine having all of pandas and scikit-learn in a single directory to do any data analysis project!)</li>
<li><strong>Appending our code location to PYTHONPATH</strong>: This is effective, but we will try to avoid it because it can bring problems in the future.</li>
<li><strong>Making our code installable</strong>: Since any code thatâ€™s installed can be imported, this shifts the question to â€œhow to make our code installableâ€.</li>
</ul>
</section>
<section id="my-first-python-lib" class="level2">
<h2 class="anchored" data-anchor-id="my-first-python-lib">my first python lib</h2>
<p>We will create a new Python library, â€œIE Titanic utilsâ€, to analyze the <a href="https://www.kaggle.com/c/titanic/data">Titanic dataset</a>. I will create a project <code>ie-titanic-utils</code>, add <code>readme.md</code> and <code>.gitignore</code> files.</p>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mkdir</span> it-titanic-utils</span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">git</span> init</span>
<span id="cb1-3"></span>
<span id="cb1-4"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# This is utility to help analyze Titanic dataset"</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span> readme.md</span>
<span id="cb1-5"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Invoke-WebRequest</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-Uri</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://www.toptal.com/developers/gitignore/api/python,jupyternotebooks"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Select-Object</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-ExpandProperty</span> Content <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Out-File</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-FilePath</span> .gitignore <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-Encoding</span> utf8</span>
<span id="cb1-6"></span>
<span id="cb1-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">git</span> add readme.md .gitignore</span>
<span id="cb1-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">git</span> commit <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-m</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"initial commit"</span></span></code></pre></div>
<p>Now I will create <code>str_utils.py</code> file (using VS code for convenience), with a function called <code>tokenize</code> that takes a str sentence and splits it into a list of words.</p>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>str_utils.py</strong></pre>
</div>
<div class="sourceCode" id="cb2" data-filename="str_utils.py" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb2-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> tokenize(sentence: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">list</span>[<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>]:</span>
<span id="cb2-2">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> sentence.split()</span></code></pre></div>
</div>
<p>In pwsh, I can import and use this function</p>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">python</span></span>
<span id="cb3-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Python</span> 3.11.4 <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">tags/v3.11.4:d2340ef,</span> Jun  7 2023, 05:45:37<span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[MSC</span> v.1934 64 bit <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">AMD64</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">)</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">]</span> on win32</span>
<span id="cb3-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Type</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"help"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"copyright"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"credits"</span> or <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"license"</span> for more information.</span>
<span id="cb3-4"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;&gt;</span> from <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">str_utils</span> import tokenize</span>
<span id="cb3-5"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;&gt;</span> tokenize<span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Toi la Le Khac Tuan"</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb3-6"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Toi'</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">,</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'la'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Le'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Khac'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Tuan'</span>]</span>
<span id="cb3-7"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;&gt;</span></span></code></pre></div>
</section>
<section id="the-pythonpath" class="level2">
<h2 class="anchored" data-anchor-id="the-pythonpath">the <code>PYTHONPATH</code></h2>
<p>We saw above that we could easily import our <code>tokenize</code> function. However, this only works if we are in the same directory. Why? Python looks in some predefined locations to know where to find what we want to import, called the â€œPATHâ€.</p>
<div id="e4b08fa3" class="cell" data-execution_count="1">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb4-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> sys</span>
<span id="cb4-2">sys.path <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># i will not execute this code</span></span></code></pre></div>
</details>
</div>
<p>Therefore, there are two ways of making our code <strong>globally importable</strong>:</p>
<ol type="1">
<li>Modify the â€œPATHâ€</li>
<li>Put our code inside a location predefined in the â€œPATHâ€</li>
</ol>
<p>The first option can be achieved like this:</p>
<div id="d729e316" class="cell" data-execution_count="2">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb5-1"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;&gt;</span> sys.path.insert(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/home/username/ie-titanic-utils"</span>)</span>
<span id="cb5-2"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;&gt;</span> <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> str_utils  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Works!</span></span></code></pre></div>
</details>
</div>
<p>Or, alternatively, from outside of the interpreter: <code>export PYTHONPATH=/home/username/ie-titanic-utils</code>.</p>
<p>However, both are <strong>bad practices and should be avoided</strong>.</p>
</section>
<section id="what-does-import-do" class="level2">
<h2 class="anchored" data-anchor-id="what-does-import-do">what does <code>import</code> do?</h2>
<p>Python code is normally written in <code>.py</code> scripts. These scripts can be imported in the same way that any model or package from the standard library can:</p>
<div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb6-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> python3</span>
<span id="cb6-2"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;&gt;</span> import <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">math</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Works, because it's in stdlib</span></span>
<span id="cb6-3"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;&gt;</span> import <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">numpy</span> as np  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Works if you ran `pip install numpy` in advance</span></span>
<span id="cb6-4"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;&gt;</span> import <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">str_utils</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Works if you are in the same directory</span></span>
<span id="cb6-5"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Hello,'</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">,</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'world!'</span>]</span>
<span id="cb6-6"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;&gt;</span> </span></code></pre></div>
<p>When the user imports a script, <strong>Python runs the script</strong>. Thatâ€™s the way all the possible functions and classes inside it are available.</p>
</section>
<section id="how-to-separate-running-code-from-reusable-pieces" class="level2">
<h2 class="anchored" data-anchor-id="how-to-separate-running-code-from-reusable-pieces">how to separate â€œrunning codeâ€ from reusable pieces</h2>
<p>A Python module (any <code>.py</code> script) might contain code that we want to run, as well as code that we only want to import. To separate these, we use this trick:</p>
<div class="sourceCode" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb7-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">î‚¶</span> ie-titanic-utils î‚° get-content <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-Tail</span> 2 .str_utils.py</span>
<span id="cb7-2"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">__name__</span> == <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"__main__"</span>:</span>
<span id="cb7-3">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">print</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">tokenize</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"hello, world!"</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">))</span></span>
<span id="cb7-4"></span>
<span id="cb7-5"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">î‚¶</span> ie-titanic-utils î‚° python .str_utils.py <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># The `print` runs</span></span>
<span id="cb7-6"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'hello,'</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">,</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'world!'</span>]</span>
<span id="cb7-7"></span>
<span id="cb7-8"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">î‚¶</span> ie-titanic-utils î‚° python</span>
<span id="cb7-9"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;&gt;</span> from <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">str_utils</span> import tokenize</span>
<span id="cb7-10"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;&gt;</span> tokenize<span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Hi, world!"</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb7-11"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Hi,'</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">,</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'world!'</span>] <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># The `print` doesn't run!</span></span>
<span id="cb7-12"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;&gt;</span></span></code></pre></div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>Here is what Claude sonnet 3.5 gave me:</p>
<p>To separate code that we want to run directly from code that we only want to import, we should use the if <code>__name__ == "__main__"</code>: idiom in Python. This is a common pattern that allows a Python script to be both importable and executable. Hereâ€™s an explanation:</p>
<ol type="1">
<li>When a Python file is run directly, Python sets the special <code>__name__</code> variable to â€œ<code>__main__</code>â€.</li>
<li>When a Python file is imported as a module,<code>__name__</code>is set to the name of the module.</li>
</ol>
<p>By using this idiom, we can control which code runs when the script is executed directly versus when itâ€™s imported as a module.</p>
</div>
</div>
</section>
</section>
<section id="pip-vs.-conda" class="level1">
<h1>03&amp;04 <a href="https://github.com/astrojuanlu/ie-mbd-advanced-python/blob/main/sessions/03-04_pip-vs-conda.ipynb">pip vs.&nbsp;conda</a></h1>
<section id="managing-python-environments" class="level2">
<h2 class="anchored" data-anchor-id="managing-python-environments">managing python environments</h2>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="1">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://raw.githubusercontent.com/astrojuanlu/ie-mbd-advanced-python/e2224276f91529280ebfcd42ddc7dc22cf0d2010/img/python_comrades.png" class="img-fluid figure-img"></p>
<figcaption>stolen from the lecture</figcaption>
</figure>
</div>
</div>
</div>
</div>
<blockquote class="blockquote">
<p>Simple is better than complex.</p>
<p>Complex is better than complicated.</p>
</blockquote>
<p>How do people install and upgrade Python? -&gt; Most of people choose Python.org, the same for me!</p>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Caution
</div>
</div>
<div class="callout-body-container callout-body">
<p>This way ships a tool to create development environments (<code>venv</code>). However, <code>venv</code> cannot create environments with different Python versions (youâ€™re tied to the one you downloaded) and certain packages will require extra steps to be installed. Therefore, it <strong>is not</strong> for everyone.</p>
</div>
</div>
<p>Juan chose to use <code>conda</code>. As I am learning Docker, I choose Docker for this tutorial.</p>
<p>How do people create isolated development environments? -&gt; The most popular is <code>Virtualenv</code>. But normally when doing an analysis task, I use <code>venv</code> which is built-in python lib. Recently I followed my dev team to use <code>pipenv</code>, I do also see <code>poetry</code> is worth-learning approach.</p>
<blockquote class="blockquote">
<p>â€œMore than a half of the users of Jupyter Notebook and JupyterLab choose Condaâ€</p>
</blockquote>
<p>As I think a model which is not deployed yet is useless model, I choose VS Code and Docker - more deployment-oriented.</p>
</section>
<section id="summary" class="level2">
<h2 class="anchored" data-anchor-id="summary">summary</h2>
<blockquote class="blockquote">
<p>For the user, the most salient distinction is probably this: pip installs python packages within any environment; conda installs any package within conda environments.</p>
<p>â€”Jake Vanderplas</p>
</blockquote>
<p>However, I will be using <code>pipenv</code> to achieve what Juan done in upcoming sections. I will specify version of each package I used.</p>
</section>
<section id="pip-and-pypi" class="level2">
<h2 class="anchored" data-anchor-id="pip-and-pypi"><code>pip</code> and <code>PyPI</code></h2>
<p><code>pip</code> is the default Python installer. By default, it fetches packages from <a href="https://pypi.org/" class="uri">https://pypi.org/</a>, which is the community repository for Python packages.</p>
</section>
</section>
<section id="layout" class="level1">
<h1>05 layout</h1>
<p>here is my projectâ€™s layout:</p>
<div class="sourceCode" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb8-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ie-titanic-utils</span></span>
<span id="cb8-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">â”œâ”€</span> src</span>
<span id="cb8-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">â”‚</span>  â””â”€ ie_titanic_utils</span>
<span id="cb8-4"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">â”‚</span>     â”œâ”€ __init__.py</span>
<span id="cb8-5"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">â”‚</span>     â””â”€ ...</span>
<span id="cb8-6"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">â”œâ”€</span> tests</span>
<span id="cb8-7"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">â”‚</span>  â””â”€ ...</span>
<span id="cb8-8"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">â”œâ”€</span> .gitignore</span>
<span id="cb8-9"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">â”œâ”€</span> README.md</span>
<span id="cb8-10"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">â””â”€</span> pyproject.toml</span></code></pre></div>
<ul>
<li>The <code>src/package_name</code> contains the source code of the library. <code>package_name</code> must be Python identifier. It should contain a <code>__init__.py</code> that can be empty;</li>
<li>The <code>tests</code> directory contains the tests. It must not contain any <code>__init__.py</code> because itâ€™s not meant to be imported as a package. In very specific cases itâ€™s included inside <code>src/package_name</code>;</li>
<li>Every project contains a <code>README.md</code> that at least explains what the project is;</li>
<li><code>pyproject.toml</code> contains the metadata of the project. The absolutely required fields are <code>module</code>, <code>author</code>, and some extra information that tells Python how to install the package.</li>
</ul>
<section id="creating-a-package" class="level2">
<h2 class="anchored" data-anchor-id="creating-a-package">creating a package</h2>
<ol type="1">
<li>run <code>flit init</code> to create the metadata</li>
</ol>
<div class="sourceCode" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb9-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">î‚¶</span> ie-titanic-utils î‚° flit init</span>
<span id="cb9-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">pyproject.toml</span> exists <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> overwrite it<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">?</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">y/N</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>: y</span>
<span id="cb9-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Module</span> name <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">ie_titanic_utils</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>: ie_utils</span>
<span id="cb9-4"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Author:</span> Tuan Le Khac</span>
<span id="cb9-5"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Author</span> email: tuan.lekhac0905@gmail.com</span>
<span id="cb9-6"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Home</span> page: </span>
<span id="cb9-7"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Choose</span> a license <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">see</span> http://choosealicense.com/ for more info<span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb9-8"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1.</span> MIT <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> simple and permissive</span>
<span id="cb9-9"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2.</span> Apache <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> explicitly grants patent rights</span>
<span id="cb9-10"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">3.</span> GPL <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> ensures that code based on this is shared with the same terms</span>
<span id="cb9-11"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">4.</span> Skip <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> choose a license later</span>
<span id="cb9-12"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Enter</span> 1-4: 4</span>
<span id="cb9-13"></span>
<span id="cb9-14"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Written</span> pyproject.toml<span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">;</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">edit</span> that file to add optional extra info.</span></code></pre></div>
<ol start="2" type="1">
<li>place some code under the source directory. In <code>__init__.py</code> there must be a docstring giving a description of the project and a <code>__version__</code> variable indicating the version:</li>
</ol>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>__init__.py</strong></pre>
</div>
<div class="sourceCode" id="cb10" data-filename="__init__.py" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb10-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""IE utils (test package)."""</span></span>
<span id="cb10-2"></span>
<span id="cb10-3">__version__ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"0.1.0"</span></span></code></pre></div>
</div>
<ol start="3" type="1">
<li>Install the code using <code>pip install</code>! (this did not work for me currently. edit: the project name should match the <code>src/package_name</code> omg)</li>
</ol>
<div class="sourceCode" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb11-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">î‚¶</span> ie-titanic-utils î‚° pip install .</span>
<span id="cb11-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Processing</span> .ie-titanic-utils</span>
<span id="cb11-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">...</span></span>
<span id="cb11-4"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Successfully</span> installed ie_titanic_utils-0.1.0</span>
<span id="cb11-5"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">î‚¶</span> ie-titanic-utils î‚° python</span>
<span id="cb11-6"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Python</span> 3.11.4 <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">tags/v3.11.4:d2340ef,</span> Jun  7 2023, 05:45:37<span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[MSC</span> v.1934 64 bit <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">AMD64</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">)</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">]</span> on win32</span>
<span id="cb11-7"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Type</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"help"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"copyright"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"credits"</span> or <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"license"</span> for more information.</span>
<span id="cb11-8"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;&gt;</span> import <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ie_titanic_utils</span></span>
<span id="cb11-9"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;&gt;</span> ie_titanic_utils.__version__</span>
<span id="cb11-10"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'0.1.0'</span></span>
<span id="cb11-11"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;&gt;</span>    </span></code></pre></div>
<ol start="4" type="1">
<li><code>readme.md</code> and a <code>.gitignore</code> files were created.</li>
<li>commit the change</li>
</ol>
<div class="sourceCode" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb12-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">git</span> checkout <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-b</span> first_module <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># i should be using switch (-c) haha, checkout is old syntax</span></span>
<span id="cb12-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">git</span> status</span>
<span id="cb12-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">git</span> add .</span>
<span id="cb12-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">git</span> commit <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-m</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"initial very first module"</span></span>
<span id="cb12-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">git</span> checkout master</span>
<span id="cb12-6"></span>
<span id="cb12-7"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">î‚¶</span> ie-titanic-utils î‚° git merge <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--no-ff</span> first_module</span>
<span id="cb12-8"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Merge</span> made by the <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ort'</span> strategy.</span>
<span id="cb12-9"> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">pyproject.toml</span>                    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">30</span> ++++++++++++++++++++++++++++++</span>
<span id="cb12-10"> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">src/ie_titanic_utils/__init__.py</span>  <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">|</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">6</span> ++++++</span>
<span id="cb12-11"> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">src/ie_titanic_utils/str_utils.py</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">|</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">6</span> ++++++</span>
<span id="cb12-12"> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">3</span> files changed, 42 insertions<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">+</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb12-13"> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">create</span> mode 100644 pyproject.toml</span>
<span id="cb12-14"> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">create</span> mode 100644 src/ie_titanic_utils/__init__.py</span>
<span id="cb12-15"> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">create</span> mode 100644 src/ie_titanic_utils/str_utils.py</span>
<span id="cb12-16"></span>
<span id="cb12-17"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">git</span> branch <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-d</span> first_module</span>
<span id="cb12-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># git push origin master</span></span>
<span id="cb12-19"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># as I will not upload this code to GitHub</span></span>
<span id="cb12-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># https://stackoverflow.com/questions/32238616/git-push-fatal-origin-does-not-appear-to-be-a-git-repository-fatal-could-n</span></span></code></pre></div>
<p>Now if I log the git, I will see this:</p>
<div class="sourceCode" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb13-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">î‚¶</span> ie-titanic-utils î‚° git log <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--graph</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--oneline</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--decorate</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--all</span></span>
<span id="cb13-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">*</span>   39105c7 <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">HEAD</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> master<span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Merge</span> branch <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'first_module'</span></span>
<span id="cb13-3"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">|</span></span>
<span id="cb13-4"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">*</span> 7a33844 initial very first module</span>
<span id="cb13-5"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">/</span></span>
<span id="cb13-6"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">*</span> 793bd67 initial commit</span></code></pre></div>
<p>Yeah til now I can create a â€œpackageâ€ in my computer and install so I can use it <strong>globally</strong>. But I have not use any env management yet.</p>
</section>
<section id="intermezzo-version-numbers" class="level2">
<h2 class="anchored" data-anchor-id="intermezzo-version-numbers">intermezzo: version numbers</h2>
<ul>
<li>Version numbers for Python packages are explained in <a href="https://www.python.org/dev/peps/pep-0440/">PEP 440</a></li>
<li>For libraries, the most widely used convention is <a href="https://semver.org/">semantic versioning</a>: X.Y.Z
<ul>
<li>Z <strong>must</strong> be incremented if only backwards compatible bug fixes are introduced (a bug fix is defined as an internal change that fixes incorrect behavior)</li>
<li>Y <strong>must</strong> be incremented every time there is new, backwards-compatible functionality</li>
<li>X <strong>must</strong> be incremented every time there are backwards-incompatible changes</li>
</ul></li>
<li>Between releases, the version should have the <code>.dev0</code> suffix</li>
<li>Recommendation: start with 0.1.dev0 (development version), then make a <code>0.1.0</code> release, then progress to <code>0.1.1</code> for quick fixes and <code>0.2.0</code> for new functionality, and when you want to make a promise of relative stability jump to <code>1.0.0</code>.</li>
<li>For applications, other conventions are more appropriate, like <a href="https://calver.org/">calendar versioning</a>: <code>[YY]YY.MM.??</code></li>
</ul>
</section>
<section id="project-requirements" class="level2">
<h2 class="anchored" data-anchor-id="project-requirements">project requirements</h2>
<p>Sometimes our project will depend on third-party libraries (pandas, scikit-learn). To make pip install those dependencies automatically, we can add them to our <code>pyproject.toml</code> under the <code>[tool.flit.metadata]</code> section, using the <code>requires</code> option:</p>
<div class="sourceCode" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode numberSource md number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb14-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">build-system</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb14-2">requires = <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">"flit_core&gt;=3.4"</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb14-3">build-backend = "flit_core.buildapi"</span>
<span id="cb14-4"></span>
<span id="cb14-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">project</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb14-6">name = "ie_titanic_utils"</span>
<span id="cb14-7">authors = <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">{name = "Tuan Le Khac", email = "tuan.lekhac0905@gmail.com"}</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb14-8">readme = "readme.md"</span>
<span id="cb14-9">requires-python = "&gt;=3.11"</span>
<span id="cb14-10">dynamic = <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">"version", "description"</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb14-11">classifiers = [</span>
<span id="cb14-12">    "Programming Language :: Python :: 3",</span>
<span id="cb14-13">    "License :: OSI Approved :: MIT License",</span>
<span id="cb14-14">    "Operating System :: OS Independent",</span>
<span id="cb14-15">]</span>
<span id="cb14-16">requires = [</span>
<span id="cb14-17">    "pandas",</span>
<span id="cb14-18">    "matplotlib&gt;=2",</span>
<span id="cb14-19">]</span></code></pre></div>
<p>We might want to specify <em>optional</em> dependencies that should only be installed upon request, or for some specific purposes. A typical example will be development dependencies: we will need things like <code>pytest</code> and <code>black</code>, but we donâ€™t want the user to install them as part as our library. To do that, we can specify <em>groups</em> of optional dependencies under the <code>tool.flit.metadata.requires-extra</code> section:</p>
<div class="sourceCode" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode numberSource md number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb15-1">In my case, I use <span class="in" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">`project.optional-dependencies`</span>: flit_core.config.ConfigError: Use <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">project</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span> table for metadata or <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">tool.flit.metadata</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span>, not both.</span>
<span id="cb15-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">project.optional-dependencies</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb15-3">dev = [</span>
<span id="cb15-4">    "pytest&gt;=6.0",</span>
<span id="cb15-5">    "black&gt;=20.8b1",</span>
<span id="cb15-6">]</span></code></pre></div>
<p>That way, they will only get installed when <code>[dev]</code> is added after the name of our library:</p>
<div class="sourceCode" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb16-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">î‚¶</span> ie-titanic-utils î‚° pip install .<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dev</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb16-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Successfully installed black-24.4.2 ie_titanic_utils-0.1.0 iniconfig-2.0.0 pytest-8.2.2</span></span></code></pre></div>
</section>
</section>
<section id="unit-test" class="level1">
<h1>06 <a href="https://github.com/astrojuanlu/ie-mbd-advanced-python/blob/main/sessions/06_unit-tests.ipynb">unit test</a></h1>
<blockquote class="blockquote">
<p>If you use software that lacks automated tests, you are the tests.</p>
<p>â€” Jenny Bryan (<span class="citation" data-cites="JennyBryan">@JennyBryan</span>) <a href="https://x.com/JennyBryan/status/1043307291909316609?ref_src=twsrc%5Etfw">September 22, 2018</a></p>
</blockquote>
<p>Testing is <strong>essential</strong>. Computers excel at doing repetitive tasks: they basically never make mistakes (the mistake might be in what we told the computer to do). Humans, on the other hand, fail more often, especially under pressure, or on Friday afternoons and Monday mornings. Therefore, instead of letting the humans be the tests, we will use the computer to <strong>frequently verify that our software works as specified</strong>.</p>
<p>I will be using <code>pytest</code> to achieve this.</p>
<section id="test-driven-development" class="level2">
<h2 class="anchored" data-anchor-id="test-driven-development">test-driven development</h2>
<p>The â€œtest-driven development mantraâ€ is <span style="color:red;font-weight:bold;">Red</span> - <span style="color:green;font-weight:bold;">Green</span> - <span style="color:grey;font-weight:bold;">Refactor</span>:</p>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="1">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://raw.githubusercontent.com/astrojuanlu/ie-mbd-advanced-python/e2224276f91529280ebfcd42ddc7dc22cf0d2010/img/red-green-refactor.png" class="img-fluid figure-img"></p>
<figcaption>Make it work. Make it right. Make it fast.</figcaption>
</figure>
</div>
</div>
</div>
</div>
<ol type="1">
<li>Write a test. <span style="color:red;font-weight:bold;">Watch it fail</span>.</li>
<li>Write just enough code to <span style="color:green;font-weight:bold;">pass the test</span>.</li>
<li>Improve the code without breaking the test.</li>
</ol>
<p>Repeat.</p>
</section>
<section id="testing-in-python" class="level2">
<h2 class="anchored" data-anchor-id="testing-in-python">testing in Python</h2>
<p>Summary: use <code>pytest</code>. Everybody does. It rocks.</p>
<p><a href="https://docs.pytest.org/en/8.2.x/">pytest</a> is a testing framework for Python that makes writing tests extremely easy. It is much more powerful than the standard library equivalent, <code>unittest</code>. We can use by install it first <code>pip install pytest</code>.</p>
<p>We can write a function that test the <code>tokenize</code> funtion:</p>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>tests/test_tokenize.py</strong></pre>
</div>
<div class="sourceCode" id="cb17" data-filename="tests/test_tokenize.py" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb17-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> ie_titanic_utils <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> tokenize  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># This will fail right away!</span></span>
<span id="cb17-2"></span>
<span id="cb17-3"></span>
<span id="cb17-4"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> test_tokenize_returns_expected_list():</span>
<span id="cb17-5">    sentence <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"This is a sentence"</span></span>
<span id="cb17-6">    expected_tokens <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"This"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"is"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"a"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sentence"</span>]</span>
<span id="cb17-7"></span>
<span id="cb17-8">    tokens <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> tokenize(sentence)</span>
<span id="cb17-9"></span>
<span id="cb17-10">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">assert</span> tokens <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> expected_tokens</span></code></pre></div>
</div>
<p>and we run it from the command line:</p>
<div class="sourceCode" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb18-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">î‚¶</span> ie-titanic-utils î‚° pytest</span>
<span id="cb18-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">============================================================================================</span> test session starts ============================================================================================</span>
<span id="cb18-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">platform</span> win32 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--</span> Python 3.11.4, pytest-8.2.2, pluggy-1.5.0</span>
<span id="cb18-4"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">rootdir:</span> .ie-titanic-utils</span>
<span id="cb18-5"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">configfile:</span> pyproject.toml</span>
<span id="cb18-6"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">plugins:</span> anyio-3.7.1, time-machine-2.14.0</span>
<span id="cb18-7"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">collected</span> 1 item</span>
<span id="cb18-8"></span>
<span id="cb18-9"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">teststest_tokenize.py</span> .                                                                                                                                                                               <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">100%</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> </span>
<span id="cb18-10"></span>
<span id="cb18-11"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">=============================================================================================</span> 1 passed in 0.02s ============================================================================================= </span></code></pre></div>
<p>The test successed after I fixed the <code>__init__.py</code>:</p>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>src/./__init__.py</strong></pre>
</div>
<div class="sourceCode" id="cb19" data-filename="src/./__init__.py" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb19-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> ie_titanic_utils.str_utils <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> tokenize</span>
<span id="cb19-2">__all__ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tokenize"</span>]</span></code></pre></div>
</div>
</section>
</section>
<section id="oop" class="level1 page-columns page-full">
<h1>07&amp;08 <a href="https://github.com/astrojuanlu/ie-mbd-advanced-python/blob/main/sessions/07-08_object-oriented-programming.ipynb">oop</a></h1>
<section id="what-are-objects-anyway" class="level2">
<h2 class="anchored" data-anchor-id="what-are-objects-anyway">what are â€œobjectsâ€ anyway?</h2>
<p>like pandasâ€™s <code>DataFrame</code> or matplotlibâ€™s <code>Figure</code>, an <em>object</em> is sthg that has:</p>
<ul>
<li>object-bound variables: call <strong>properties</strong>;</li>
<li>object-bound functions: call <strong>methods</strong>.</li>
</ul>
<p>if the objectâ€™s properties can change, we say they have <strong>states</strong>, in that case they are <strong>mutable</strong>. otherwise, they are <strong>stateless</strong> and <strong>immutable</strong>. a typical example is list (mutable) and tuple (immutable).</p>
<div id="420bf50e" class="cell" data-execution_count="3">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb20" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb20-1">my_list <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>]</span>
<span id="cb20-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(my_list)</span>
<span id="cb20-3">my_list.append(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>)</span>
<span id="cb20-4"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(my_list)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1, 2, 3]
[1, 2, 3, 4]</code></pre>
</div>
</div>
<div id="3893a277" class="cell" data-execution_count="4">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb22" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb22-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># The operator that creates tuples is not parentheses:</span></span>
<span id="cb22-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># is the comma!</span></span>
<span id="cb22-3">my_tuple <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Notice that I don't need parentheses!</span></span>
<span id="cb22-4">my_tuple</span></code></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="2">
<pre><code>(1, 2, 3)</code></pre>
</div>
</div>
<div id="62ffbdb1" class="cell" data-execution_count="5">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb24" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb24-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dir</span>(my_tuple))  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Nothing that allows us to change the state of the tuple</span></span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>['__add__', '__class__', '__class_getitem__', '__contains__', '__delattr__', '__dir__', '__doc__', '__eq__', '__format__', '__ge__', '__getattribute__', '__getitem__', '__getnewargs__', '__getstate__', '__gt__', '__hash__', '__init__', '__init_subclass__', '__iter__', '__le__', '__len__', '__lt__', '__mul__', '__ne__', '__new__', '__reduce__', '__reduce_ex__', '__repr__', '__rmul__', '__setattr__', '__sizeof__', '__str__', '__subclasshook__', 'count', 'index']</code></pre>
</div>
</div>
<div id="38108e09" class="cell" data-execution_count="6">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb26" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb26-1">my_tuple[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">99</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># This wont work, "TypeError: 'tuple' object does not support item assignment"</span></span></code></pre></div>
</details>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Immutable objects have the advantage that they can be <strong>hashed</strong>, that is: they can be transformed, using some cryptographical function, into something that uniquely represents that object. Mutable objects canâ€™t, because the hash would have to change every time the state of the object changed. <strong>Dictionary keys have to be hashable objects</strong>.</p>
</div>
</div>
<div id="12fa6316" class="cell" data-execution_count="7">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb27" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb27-1">{</span>
<span id="cb27-2">    my_tuple: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"my_tuple"</span></span>
<span id="cb27-3">}</span></code></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="4">
<pre><code>{(1, 2, 3): 'my_tuple'}</code></pre>
</div>
</div>
<div id="249e2363" class="cell" data-execution_count="8">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb29" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb29-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">hash</span>(my_tuple)</span></code></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="5">
<pre><code>529344067295497451</code></pre>
</div>
</div>
<div id="5ef6beee" class="cell" data-execution_count="9">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb31" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb31-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># this wont work: "TypeError: unhashable type: 'list'"</span></span>
<span id="cb31-2">{</span>
<span id="cb31-3">    my_list: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"my_list"</span></span>
<span id="cb31-4">}</span></code></pre></div>
</details>
</div>
<div id="0096641b" class="cell" data-execution_count="10">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb32" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb32-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># this wont work: "TypeError: unhashable type: 'list'"</span></span>
<span id="cb32-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">hash</span>(my_list)</span></code></pre></div>
</details>
</div>
</section>
<section id="classes-and-instances" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="classes-and-instances">classes and instances</h2>
<p>objects are defined by <strong>instantiating a class</strong>. a class is a <strong>template</strong> for objects, where we define itâ€™s behaviours, an <strong>instance</strong> is a particular realization of that class.</p>
<section id="example" class="level3">
<h3 class="anchored" data-anchor-id="example">Example</h3>
<p>we want model the <code>User</code> of our companyâ€™s product, to later study their behaviours:</p>
<div id="4d14860f" class="cell" data-execution_count="11">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb33" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb33-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">class</span> User:</span>
<span id="cb33-2">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">pass</span></span>
<span id="cb33-3"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">type</span>(User)</span></code></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="6">
<pre><code>type</code></pre>
</div>
</div>
<p><code>User</code> class is of type <code>type</code>, which means that is can be used to created new objects. Letâ€™s create 2 instances:</p>
<div id="30996245" class="cell" data-execution_count="12">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb35" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb35-1">user1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> User()</span>
<span id="cb35-2">user2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> User()</span>
<span id="cb35-3"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(user1)</span>
<span id="cb35-4"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(user2)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;__main__.User object at 0x000001B1AD8D4F90&gt;
&lt;__main__.User object at 0x000001B1AD8D4D90&gt;</code></pre>
</div>
</div>
<p>with a slight abuse of notation, we would say we have 2 <code>User</code> objects, or just 2 <code>User</code>s.</p>
</section>
<section id="using-the-instance-self" class="level3">
<h3 class="anchored" data-anchor-id="using-the-instance-self">Using the instance: <code>self</code></h3>
<p>letâ€™s add a very simple <strong>method</strong> to demonstrate <em>explicit</em> <code>self</code>, a very important concept. a method is like a function bounded to the object, an can use itâ€™s properties:</p>
<div id="ba8a0d18" class="cell" data-execution_count="13">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb37" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb37-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">class</span> User:</span>
<span id="cb37-2">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> whoami(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>):</span>
<span id="cb37-3">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'This is : </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span>)</span></code></pre></div>
</details>
</div>
<div id="2441e1cb" class="cell" data-execution_count="14">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb38" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb38-1">user1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> User()</span>
<span id="cb38-2">user1.whoami()</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>This is : &lt;__main__.User object at 0x000001B1AD8D4590&gt;</code></pre>
</div>
</div>
<p>why are methods (instead of plain functions) interesting? Because of <strong>duck typing</strong>:</p>
<blockquote class="blockquote">
<p>â€œIf it walks like a duck and it quacks like a duck, then it must be a duckâ€ â€“ <a href="https://en.wikipedia.org/wiki/Duck_typing" class="uri">https://en.wikipedia.org/wiki/Duck_typing</a></p>
</blockquote>
<p>if something has a method that I need, I donâ€™t care about its type.</p>
<div id="5032dcea" class="cell" data-execution_count="15">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb40" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb40-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> do_stuff(obj):</span>
<span id="cb40-2">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> obj.mean()</span></code></pre></div>
</details>
</div>
<div id="e0da8b5a" class="cell" data-execution_count="16">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb41" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb41-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> numpy <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> np</span>
<span id="cb41-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> pandas <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> pd</span>
<span id="cb41-3"></span>
<span id="cb41-4"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(do_stuff(np.arange(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>)))</span>
<span id="cb41-5"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(do_stuff(pd.Series([<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>])))</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>2.0
2.0</code></pre>
</div>
</div>
<p>notice how we called <code>user1.test()</code> <strong>without passing an extra argument</strong>? This is because Python is automatically passing the instance. Itâ€™s the equivalent of doing this (<strong>never do this</strong>):</p>
<div id="8b163d53" class="cell" data-execution_count="17">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb43" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb43-1">User.whoami(user1)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>This is : &lt;__main__.User object at 0x000001B1AD8D4590&gt;</code></pre>
</div>
</div>
<p>in fact, if we define a method without a first parameter, it will fail when we call it:</p>
<div id="5bf4beeb" class="cell" data-execution_count="18">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb45" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb45-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">class</span> TestClass:</span>
<span id="cb45-2">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> test():</span>
<span id="cb45-3">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">pass</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Don't do anything</span></span>
<span id="cb45-4"></span>
<span id="cb45-5">t <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> TestClass()</span>
<span id="cb45-6">t.test()  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Fails: "TypeError: test() takes 0 positional arguments but 1 was given"</span></span></code></pre></div>
</details>
</div>
<p>this first parameter can be called anything, but <strong>everybody uses <code>self</code></strong>. Remember, conventions are important to minimize surprise and enhance collaboration!</p>
</section>
<section id="intermezzo-f-strings" class="level3">
<h3 class="anchored" data-anchor-id="intermezzo-f-strings">intermezzo: f-strings</h3>
<div id="669cec83" class="cell" data-execution_count="19">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb46" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb46-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"This is </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>user1<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Python &gt;= 3.6</span></span>
<span id="cb46-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"This is </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">format</span>(user1))  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Python &lt; 3.6, equivalent</span></span>
<span id="cb46-3"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(User.whoami(user1))  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># DON'T use! (Although it's equivalent)   </span></span>
<span id="cb46-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># %timeit User.whoami(user1)  # They have about the same performance </span></span>
<span id="cb46-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># %timeit user1.whoami()</span></span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>This is &lt;__main__.User object at 0x000001B1AD8D4590&gt;
This is &lt;__main__.User object at 0x000001B1AD8D4590&gt;
This is : &lt;__main__.User object at 0x000001B1AD8D4590&gt;
None</code></pre>
</div>
</div>
</section>
<section id="initializing-our-instances" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="initializing-our-instances">initializing our instances</h3>
<p>The ellipsis (<code>...</code>) is a built-in constant in Python. Itâ€™s an instance of the <code>ellipsis</code> (dáº¥u cháº¥m lá»­ng) class.</p>
<div id="dd7c9d48" class="cell" data-execution_count="20">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb48" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb48-1">...</span></code></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="14">
<pre><code>Ellipsis</code></pre>
</div>
</div>
<p>common uses of ellipsis:</p>
<ul>
<li>as a placeholder in function definitions or class bodies</li>
<li>in type hinting (especially for variable-length tuples)</li>
<li>in slicing operations (especially for multidimensional arrays in libraries like NumPy)</li>
</ul>
<div id="9042a8b1" class="cell" data-execution_count="21">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb50" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb50-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># As a placeholder</span></span>
<span id="cb50-2"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> function_to_be_implemented_later():</span>
<span id="cb50-3">    ...</span>
<span id="cb50-4"></span>
<span id="cb50-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># In type hinting</span></span>
<span id="cb50-6"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> typing <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Tuple</span>
<span id="cb50-7"></span>
<span id="cb50-8"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> process_points(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>points: Tuple[<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span>, ...]) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>:</span>
<span id="cb50-9">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> point <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> points:</span>
<span id="cb50-10">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Processing point: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>point<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb50-11"></span>
<span id="cb50-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Usage</span></span>
<span id="cb50-13">process_points((<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>), (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>), (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>,))</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Processing point: (1, 2)
Processing point: (3, 4, 5)
Processing point: (6,)</code></pre>
</div>
</div>
<div id="82041adf" class="cell" data-execution_count="22">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb52" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb52-1">user1.this_property <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ...  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># "99", whatever</span></span>
<span id="cb52-2">user1.this_property</span></code></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="16">
<pre><code>Ellipsis</code></pre>
</div>
</div>
<p>however, this is considered a bad practice, and can confuse editors and static analysis tools. These properties should be specified on creation, in a way that I cannot have a user without <code>name</code> and <code>signup_date</code>. Python provides us a special method, <code>__init__</code> (this should not be confused with file <code>__init__.py</code> we put to project to tell Python our code is a package), that <strong>initializes</strong><sup>1</sup> the object:</p>
<div class="no-row-height column-margin column-container"><div id="fn1"><p><sup>1</sup>&nbsp;This philosophy used to be summarized by the sentence â€œwe are all consenting adults hereâ€, which is nowadays being less used.</p></div></div><div id="ab86dd9f" class="cell" data-execution_count="23">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb54" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb54-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">class</span> User:</span>
<span id="cb54-2">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># "dunder init" = double underscore init</span></span>
<span id="cb54-3">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__init__</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, name, signup_date):</span>
<span id="cb54-4">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.name <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> name</span>
<span id="cb54-5">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.signup_date <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> signup_date</span></code></pre></div>
</details>
</div>
<div id="9423fb8d" class="cell" data-execution_count="24">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb55" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb55-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> datetime <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> dt</span>
<span id="cb55-2">user1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> User(name<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"John Doe"</span>, signup_date<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>dt.datetime.now())</span>
<span id="cb55-3"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(user1.name, user1.signup_date, sep<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>John Doe
2024-08-01 23:07:08.587740</code></pre>
</div>
</div>
<p>thatâ€™s something! However, there are several things we can improve:</p>
<ul>
<li>it can be cumbersome to specify the date every time, and it would be nice to have some default.</li>
<li>the default representation of the instances contains some hexadecimal memory address and nothing else. It would be nice to at least see the user name and the signup date</li>
<li>nothing stops me from changing the name and signup_date of a existing user:</li>
</ul>
</section>
<section id="exercise" class="level3">
<h3 class="anchored" data-anchor-id="exercise">exercise</h3>
<ul>
<li>make <code>signup_date</code> optional by providing a default value;</li>
<li>make the <code>__repr__</code> method return a string containing the <code>name</code> and <code>signup_date</code>, which will override the default.</li>
</ul>
<div id="fd72f5b4" class="cell" data-execution_count="25">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb57" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb57-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">class</span> User:</span>
<span id="cb57-2">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__init__</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, name, signup_date<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>):</span>
<span id="cb57-3">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> signup_date <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">is</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>:</span>
<span id="cb57-4">            signup_date <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> dt.datetime.now() <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Watch out with default parameters! They are created when the function is defined.</span></span>
<span id="cb57-5"></span>
<span id="cb57-6">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.name <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> name</span>
<span id="cb57-7">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.signup_date <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> signup_date</span>
<span id="cb57-8"></span>
<span id="cb57-9">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__repr__</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>):</span>
<span id="cb57-10">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"User(name='</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>name<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">', signup_date=</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">repr</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.signup_date)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">)"</span></span></code></pre></div>
</details>
</div>
<div id="bd10d931" class="cell" data-execution_count="26">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb58" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb58-1">user1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> User(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"John Doe"</span>)</span>
<span id="cb58-2">user1</span></code></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="20">
<pre><code>User(name='John Doe', signup_date=datetime.datetime(2024, 8, 1, 23, 7, 8, 618751))</code></pre>
</div>
</div>
</section>
<section id="extra-date-formatting" class="level3">
<h3 class="anchored" data-anchor-id="extra-date-formatting">extra: date formatting</h3>
<div id="fc4b84ad" class="cell" data-execution_count="27">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb60" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb60-1">dt.datetime.now().isoformat()  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ISO 8601</span></span>
<span id="cb60-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># If you don't like it, there's http://strftime.org/</span></span></code></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="21">
<pre><code>'2024-08-01T23:07:08.625045'</code></pre>
</div>
</div>
<div id="b23b8c74" class="cell" data-execution_count="28">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb62" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb62-1">user1.signup_date.strftime(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"%Y ::: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%d</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="22">
<pre><code>'2024 ::: 01'</code></pre>
</div>
</div>
</section>
<section id="protecting-properties" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="protecting-properties">protecting properties</h3>
<p>in Python, there are <em>no private attributes</em> (neither properties nor methods), and in fact everything can be accessed <sup>2</sup>. However, we can â€œhideâ€ them by default in autocomplete and other environments by using a leading underscore <code>_</code>: this is usually called <strong>protected variables</strong>.</p>
<div class="no-row-height column-margin column-container"><div id="fn2"><p><sup>2</sup>&nbsp;This philosophy used to be summarized by the sentence â€œwe are all consenting adults hereâ€, which is nowadays being less used.</p></div></div><p>there is a common pattern in which, if I want to make some property read-only, we can:</p>
<ul>
<li>make it protected</li>
<li>create a â€œgetterâ€ using the <span class="citation" data-cites="property">@property</span> decorator, which gets the value of the protected property with a public name</li>
</ul>
<div id="b008d693" class="cell" data-execution_count="29">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb64" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb64-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">class</span> User:</span>
<span id="cb64-2">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__init__</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, name, signup_date<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>):</span>
<span id="cb64-3">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> signup_date <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">is</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>:</span>
<span id="cb64-4">            signup_date <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> dt.datetime.now()</span>
<span id="cb64-5"></span>
<span id="cb64-6">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>._name <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> name</span>
<span id="cb64-7">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>._signup_date <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> signup_date</span>
<span id="cb64-8"></span>
<span id="cb64-9">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">@property</span></span>
<span id="cb64-10">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> name(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>):</span>
<span id="cb64-11">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>._name</span>
<span id="cb64-12"></span>
<span id="cb64-13">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">@property</span></span>
<span id="cb64-14">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> signup_date(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>):</span>
<span id="cb64-15">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>._signup_date</span>
<span id="cb64-16"></span>
<span id="cb64-17">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__repr__</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>):</span>
<span id="cb64-18">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"User(name='</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>name<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">', signup_date='</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>signup_date<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">')"</span></span></code></pre></div>
</details>
</div>
<div id="e9a3b5f8" class="cell" data-execution_count="30">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb65" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb65-1">user1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> User(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Tuan Le"</span>)</span>
<span id="cb65-2">user1.name</span></code></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="24">
<pre><code>'Tuan Le'</code></pre>
</div>
</div>
<div id="9fb2282d" class="cell" data-execution_count="31">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb67" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb67-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># this wont work: "AttributeError: can't set attribute"</span></span>
<span id="cb67-2">user1.name <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Tan Le"</span></span></code></pre></div>
</details>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>If you see tutorials mentioning â€œtrue private variablesâ€, they are wrong!</p>
</div>
</div>
<div id="88ed0501" class="cell" data-execution_count="32">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb68" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb68-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">class</span> Test:</span>
<span id="cb68-2">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__init__</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, name):</span>
<span id="cb68-3">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.__name <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> name  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Not what you think!</span></span>
<span id="cb68-4">t1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Test(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"This name"</span>)</span></code></pre></div>
</details>
</div>
<div id="e79d62f4" class="cell" data-execution_count="33">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb69" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb69-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># this wont work</span></span>
<span id="cb69-2">t1.__name</span></code></pre></div>
</details>
</div>
<div id="ed82f250" class="cell" data-execution_count="34">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb70" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb70-1">t1._Test__name  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># These are *NOT* "private" properties</span></span></code></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="26">
<pre><code>'This name'</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The behavior youâ€™re experiencing is due to a feature in Python called â€œname manglingâ€ for private attributes. Letâ€™s break down whatâ€™s happening:</p>
<p>Double underscore prefix:</p>
<ul>
<li>When you define an attribute with a double underscore prefix (__) in a class, Python automatically mangles the name to avoid naming conflicts in inherited classes.</li>
<li>Name mangling process: Python changes the name from __name to _ClassName__name. In your case, it becomes _Test__name.</li>
<li>Accessing the attribute: Because of this name mangling, you canâ€™t access t1.__name directly. Instead, you would need to use the mangled name.</li>
</ul>
<div id="950c80df" class="cell" data-execution_count="35">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb72" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb72-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">class</span> Test:</span>
<span id="cb72-2">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__init__</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, name):</span>
<span id="cb72-3">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.__name <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> name  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># This gets mangled</span></span>
<span id="cb72-4"></span>
<span id="cb72-5">t1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Test(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"This name"</span>)</span>
<span id="cb72-6"></span>
<span id="cb72-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># This will raise an AttributeError</span></span>
<span id="cb72-8"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">try</span>:</span>
<span id="cb72-9">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(t1.__name)</span>
<span id="cb72-10"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">except</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">AttributeError</span> <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> e:</span>
<span id="cb72-11">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"AttributeError: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>e<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb72-12"></span>
<span id="cb72-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># This will work</span></span>
<span id="cb72-14"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(t1._Test__name)</span>
<span id="cb72-15"></span>
<span id="cb72-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># You can see all attributes, including mangled ones</span></span>
<span id="cb72-17"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dir</span>(t1))</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>AttributeError: 'Test' object has no attribute '__name'
This name
['_Test__name', '__class__', '__delattr__', '__dict__', '__dir__', '__doc__', '__eq__', '__format__', '__ge__', '__getattribute__', '__getstate__', '__gt__', '__hash__', '__init__', '__init_subclass__', '__le__', '__lt__', '__module__', '__ne__', '__new__', '__reduce__', '__reduce_ex__', '__repr__', '__setattr__', '__sizeof__', '__str__', '__subclasshook__', '__weakref__']</code></pre>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="inheritance" class="level2">
<h2 class="anchored" data-anchor-id="inheritance">inheritance</h2>
<div id="d54bc550" class="cell" data-execution_count="36">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb74" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb74-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">class</span> SpecialUser(User):</span>
<span id="cb74-2">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__init__</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, name, age, signup_date<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>):</span>
<span id="cb74-3">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Initializes self._name and self._signup_date</span></span>
<span id="cb74-4">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">super</span>().<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__init__</span>(name, signup_date)</span>
<span id="cb74-5"></span>
<span id="cb74-6">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>._age <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> age</span>
<span id="cb74-7"></span>
<span id="cb74-8">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">@property</span></span>
<span id="cb74-9">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> age(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>):</span>
<span id="cb74-10">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>._age</span>
<span id="cb74-11"></span>
<span id="cb74-12">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> greet(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>):</span>
<span id="cb74-13">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Hi! I'm </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>name<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
</details>
</div>
<div id="dd17b672" class="cell" data-execution_count="37">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb75" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb75-1">s_user1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> SpecialUser(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"John Doe"</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">27</span>)</span>
<span id="cb75-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#s_user1</span></span></code></pre></div>
</details>
</div>
<div id="bb9e12fb" class="cell" data-execution_count="38">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb76" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb76-1">s_user1.name</span></code></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="30">
<pre><code>'John Doe'</code></pre>
</div>
</div>
<div id="7742acf4" class="cell" data-execution_count="39">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb78" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb78-1">s_user1.greet()</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Hi! I'm John Doe</code></pre>
</div>
</div>
<ul>
<li>the diamond problem: <a href="https://www.wikiwand.com/en/Multiple_inheritance#/The_diamond_problem" class="uri">https://www.wikiwand.com/en/Multiple_inheritance#/The_diamond_problem</a></li>
<li>???: <a href="https://softwareengineering.stackexchange.com/questions/238176/why-would-square-inheriting-from-rectangle-be-problematic-if-we-override-the-set/238184#238184" class="uri">https://softwareengineering.stackexchange.com/questions/238176/why-would-square-inheriting-from-rectangle-be-problematic-if-we-override-the-set/238184#238184</a></li>
<li>liskov substitution principle: <a href="https://www.wikiwand.com/en/Liskov_substitution_principle" class="uri">https://www.wikiwand.com/en/Liskov_substitution_principle</a></li>
<li>composition and inheritance: <a href="https://www.thedigitalcatonline.com/blog/2014/08/20/python-3-oop-part-3-delegation-composition-and-inheritance/" class="uri">https://www.thedigitalcatonline.com/blog/2014/08/20/python-3-oop-part-3-delegation-composition-and-inheritance/</a></li>
</ul>
<section id="more-special-methods" class="level3">
<h3 class="anchored" data-anchor-id="more-special-methods">more special methods</h3>
<p>go search for python data model</p>
</section>
</section>
</section>
<section id="flask" class="level1">
<h1>09&amp;10 <a href="https://github.com/astrojuanlu/ie-mbd-advanced-python/blob/main/sessions/09-10_flask.ipynb">flask</a></h1>
<ul>
<li>flask is a â€œlightweight frameworkâ€ or a â€œmicroframeworkâ€. â€œIt is designed to make getting started quick and easy, with the ability to scale up to complex applicationsâ€, and therefore requires less context to get started with;</li>
<li>django is a â€œbatteries includedâ€ framework that is more focused on good practices and encouraging a â€œclean, pragmatic designâ€. Itâ€™s more complex and requires more experience to master.</li>
</ul>
</section>
<section id="conclusion" class="level1">
<h1><a href="https://github.com/astrojuanlu/ie-mbd-advanced-python/blob/main/sessions/99_conclusion.ipynb">conclusion</a></h1>
<section id="where-do-we-go-from-here" class="level2">
<h2 class="anchored" data-anchor-id="where-do-we-go-from-here">where do we go from here</h2>
<ul>
<li>Keep improving the art of Python packaging</li>
<li>Explore other options for high performance Python</li>
<li>Help â€œbridging the gapâ€</li>
<li>Engage with the (open source) Python community</li>
</ul>
</section>
<section id="keep-improving-the-art-of-python-packaging" class="level2">
<h2 class="anchored" data-anchor-id="keep-improving-the-art-of-python-packaging">keep improving the art of python packaging</h2>
<ul>
<li>recommend: <code>pip-tools</code> + <code>requirements.in</code> = <code>requirements.txt</code></li>
<li>Poetry, Pipenvâ€¦ Yes, they work, but they are way more complex and have â€œlock-inâ€</li>
<li>All companies I worked for struggle sooner or later with their code deployment practices. Now, you know better</li>
</ul>
</section>
<section id="explore-other-options-for-high-performance-python" class="level2">
<h2 class="anchored" data-anchor-id="explore-other-options-for-high-performance-python">explore other options for high performance python</h2>
<ul>
<li>Juan mentioned: Numba, Modin, Vaex, Dask, Spark, Coiled, Prefect</li>
<li>Now we have more: polar, pandas 2.0, aiflow, dagster, dbt, etc</li>
</ul>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="1">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://lktuan.github.io/blog/2024-07-08-advanced-python/setup_py_br.png" class="img-fluid figure-img"></p>
<figcaption>stolen from the lecture</figcaption>
</figure>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="other-resources" class="level1">
<h1>other resources</h1>
<ol type="1">
<li><a href="https://nbviewer.org/github/astrojuanlu/ie-mbd-advanced-python/tree/main/">NBViewer</a> for this lecture;</li>
<li><a href="https://pydata.org/">PyData</a>, a community for developers and users of open source data tools;</li>
<li><a href="https://git-scm.com/book/en/v2/">Pro Git</a>, <code>--distributed-is-the-new-centralized</code>;</li>
<li><a href="https://docs.github.com/en/pull-requests/collaborating-with-pull-requests/proposing-changes-to-your-work-with-pull-requests/about-pull-requests">Pull Requests</a>;</li>
<li><a href="https://docs.gitlab.com/ee/user/project/merge_requests/index.html">Merge Requests</a>;</li>
<li><a href="https://www.asmeurer.com/git-workflow/">Git Workflow</a>, the git workflow for contributing to open source repositories;</li>
<li><a href="https://www.toptal.com/developers/gitignore">Git Ignore</a> builder;</li>
<li><a href="https://www.atlassian.com/git/tutorials/rewriting-history">Git commit â€“amend</a>, rewriting history;</li>
<li><a href="https://packaging.python.org/en/latest/tutorials/packaging-projects/">The right way to distribute Python code</a></li>
<li><a href="https://docs.python.org/3/tutorial/modules.html#packages">Python packaging</a></li>
<li><a href="https://docs.pytest.org/en/8.2.x/">Pytest</a>.</li>
</ol>


<!-- -->

</section>


 ]]></description>
  <category>python</category>
  <category>pydata</category>
  <guid>https://lktuan.github.io/blog/2024-07-08-advanced-python/</guid>
  <pubDate>Sun, 07 Jul 2024 17:00:00 GMT</pubDate>
  <media:content url="https://lktuan.github.io/blog/2024-07-08-advanced-python/juan_r.png" medium="image" type="image/png" height="193" width="144"/>
</item>
<item>
  <title>Random youtube video: How are memories stored in neural networks?</title>
  <dc:creator>Tuan Le Khac</dc:creator>
  <link>https://lktuan.github.io/blog/2024-06-26-hopfield-network/</link>
  <description><![CDATA[ 





<p>This video came across in my youtube recommendation, the title is <a href="https://www.youtube.com/watch?v=piF6D6CQxUw">â€œHow are memories stored in neural networks? | The Hopfield Network #SoME2â€</a> by <a href="https://www.youtube.com/@layerwiselectures"><strong>Layerwise Lectures</strong></a>.</p>
<p>This channel is interestingly has only 1 video, bio:</p>
<blockquote class="blockquote">
<p>Reality comes in layers - layers of abstraction. This channels tries to uncover them to gain insights on neuroscience and machine learning.</p>
</blockquote>
<p>Youâ€™ll find how it interesting, below is my notes.</p>
<section id="where-is-your-memory" class="level1">
<h1>Where is your memory?</h1>
<ul>
<li>The Random Access Memory (RAM) of a nowaday typical computer is 8-32GB. Thatâ€™s the part directly interact with CPU.</li>
<li>Aside from that, you may have hard disk with terabyte or so memory.</li>
<li>How about you ~ or your brain? Can we mearsure in bytes?</li>
<li>But the question should be asked in the first place is: Where is it?</li>
<li>Because memory in computer have <strong>physical</strong> location, to access a piece of data in RAM you have to know the the binary address associated with that location.</li>
<li>For the CPU, the matter comes down to just turning on the right wires to retreive the bits in desired location.</li>
</ul>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="1">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://lktuan.github.io/blog/2024-06-26-hopfield-network/Where_is_your_memory.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption>Where is our memory?</figcaption>
</figure>
</div>
</div>
</div>
</div>
<ul>
<li>Imagine another kind of memory. Instead of specifying <strong>where</strong> of a memory, itâ€™s a <em>binary address</em>, how about we could specify <strong>what</strong>, itâ€™s <em>content</em>.</li>
<li>Our memory, if we provide a incomplete version of memory, itâ€™s just sort of autocompletes. With the right software, computer can also do this, but itâ€™s not how computer memory work on the basic level.</li>
<li>The point of this video is to convince you that autocompleting memories, also know as <strong>associative memory</strong>, is kind of natural behaviour of networks of neurons.</li>
<li>Itâ€™ll become clear that it doesnâ€™t really make sense to measure memory capacity in networks of neurons in the same way we measure computer memory.</li>
</ul>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="1">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://lktuan.github.io/blog/2024-06-26-hopfield-network/Associative_networks.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption>Associative Networks</figcaption>
</figure>
</div>
</div>
</div>
</div>
<p>The biggest difference might be: computer memory have fixed location, but as weâ€™ll see, the memories in an associative networks rather have - <strong>a time</strong>.</p>
</section>
<section id="computer-memory-in-a-nutshell" class="level1">
<h1>Computer memory in a nutshell</h1>
<ul>
<li>Computer memory is measured in bits, binary switches of ones and zeros. A string of eight such bits can represent anything from letters to integers.</li>
<li>How do I get to a memory once itâ€™s saved, say in RAM? Because on its own it doesnâ€™t do much.</li>
<li>Broadly speaking, and glossing over tons of technical detail here, every piece of data in RAM is matched to a binary address.</li>
</ul>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="1">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://lktuan.github.io/blog/2024-06-26-hopfield-network/computer_memory.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption>Memories are matched to addresses and thatâ€™s ultimately the only way to retrieve them</figcaption>
</figure>
</div>
</div>
</div>
</div>
<ul>
<li>Each piece of data is in a different physical location and can only be retrieved by knowing its address. How the reading and writing of memories is accomplished, is really the meat of programming and is another story.</li>
</ul>
</section>
<section id="modeling-neural-networks" class="level1">
<h1>Modeling neural networks</h1>
<ul>
<li>The aim of the video is to introduce how humain brain memory work, by introducing Hopefield Network.</li>
<li>More generally this lecture aim to be a modelling itself, a kind of the art of essential.</li>
</ul>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="1">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://lktuan.github.io/blog/2024-06-26-hopfield-network/hopfield_networks.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption>Hopfield Network</figcaption>
</figure>
</div>
</div>
</div>
</div>
<ul>
<li>This is a picture depicted neuron,</li>
<li>it integrates electrical signals from other neurons to determine its own activity and then,</li>
<li>it broadcasts that activity back to the network.</li>
</ul>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="1">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://lktuan.github.io/blog/2024-06-26-hopfield-network/a_neuron.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption>A Neuron</figcaption>
</figure>
</div>
</div>
</div>
</div>
<ul>
<li>Mathematically the story goes something like this:</li>
<li>thereâ€™s electrical signals coming in from other neurons, which we will say are just some numbers.</li>
<li>then the synapses act as multipliers on these signals - another set of numbers,</li>
<li>and then the activity of the neuron is based on the sum of the weighted inputs, and by â€œbased onâ€ I mean that itâ€™s fine to apply some function after computing the sum.</li>
</ul>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="1">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://lktuan.github.io/blog/2024-06-26-hopfield-network/mathematical_expression_of_neuron.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption>Mathematical expression of Neuron</figcaption>
</figure>
</div>
</div>
</div>
</div>
<ul>
<li>It gets interesting once we turn this into a network, connecting the outputs of neurons to the inputs of other neurons.</li>
<li>This is a special type of neural network. Itâ€™s a <strong>recurrent network</strong>, meaning that there are <em>back and forth</em> connections between the neurons.</li>
</ul>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="1">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://lktuan.github.io/blog/2024-06-26-hopfield-network/recurrent_network.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption>Recurrent Network</figcaption>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="memories-in-dynamical-systems" class="level1">
<h1>Memories in dynamical systems</h1>
<ul>
<li>What does this have to do with memory? Well it needs to be somewhere in here doesnâ€™t it? Where?</li>
<li>Remember the idea of an associative memory, which is the ability of a system to sort of â€œpattern-autocompleteâ€.</li>
<li>Letâ€™s try a definition of memory thatâ€™s slightly wider than maybe what weâ€™re used to.</li>
</ul>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="1">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://lktuan.github.io/blog/2024-06-26-hopfield-network/a_state_of_memory.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption>A State in memory</figcaption>
</figure>
</div>
</div>
</div>
</div>
<ul>
<li>Let a memory system be a system that, after having been in a certain state, a configuration, it has the ability to return to that state later on.</li>
<li>The responsibility for this return in our computer is CPU.</li>
<li>Our network seems different though. So letâ€™s get creative. Thereâ€™s other things in our everyday lives that fall under our definition of memory.</li>
<li>For example, if below bottleâ€™s crushed, in other words its configuration changed, it can sometimes return to its earlier state, which in that sense could be said to have been memorized.</li>
</ul>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="1">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://lktuan.github.io/blog/2024-06-26-hopfield-network/a_plastic_bottle_in_our_memory.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption>A plastic bottle in our memory</figcaption>
</figure>
</div>
</div>
</div>
</div>
<ul>
<li>A neural network is a system with a pattern of activity that dynamically evolves. If, somehow, we could construct our network such that it would have some <strong>preferred</strong> state and would return to that state over time if it was <strong>perturbed</strong>, then that could reasonably be qualified as a memory.</li>
</ul>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="1">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://lktuan.github.io/blog/2024-06-26-hopfield-network/perturbed_states.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption>Perturbed states</figcaption>
</figure>
</div>
</div>
</div>
</div>
<ul>
<li>Letâ€™s take a simple example of 8x8 neurons network. The way our system work is to decribe <strong>how the network change over time</strong> # Learning</li>
</ul>
</section>
<section id="memory-capacity-and-conclusion" class="level1">
<h1>Memory capacity and conclusion</h1>
</section>
<section id="resources" class="level1">
<h1>Resources</h1>
<p>This was the submission to the Summer of Math Exposition 2022 (#SoME2). All credit to <a href="https://www.youtube.com/@layerwiselectures">Layerwise Lectures</a>.</p>
<ol type="1">
<li>Orginal paper: Hopfield, J. J. (1982). Neural networks and physical systems with emergent collective computational abilities. Proceedings of the national academy of sciences, 79(8), 2554-2558.</li>
<li>Image: Neuron image by Santiago RamÃ³n y Cajal, The pyramidal neuron of the cerebral cortex, 1904 Ink and pencil on paper, 8 5/8 x 6 7/8 in.</li>
</ol>


<!-- -->

</section>

 ]]></description>
  <category>neural networks</category>
  <guid>https://lktuan.github.io/blog/2024-06-26-hopfield-network/</guid>
  <pubDate>Tue, 25 Jun 2024 17:00:00 GMT</pubDate>
  <media:content url="https://lktuan.github.io/blog/2024-06-26-hopfield-network/neuron.png" medium="image" type="image/png" height="81" width="144"/>
</item>
<item>
  <title>Hi Docker ğŸ³</title>
  <dc:creator>Tuan Le Khac</dc:creator>
  <link>https://lktuan.github.io/blog/2024-06-24-docker/</link>
  <description><![CDATA[ 





<p>Edit: an other great source for Docker - <a href="https://levelup.gitconnected.com/working-with-docker-and-docker-compose-9773295b4d51" class="uri">https://levelup.gitconnected.com/working-with-docker-and-docker-compose-9773295b4d51</a></p>
<div class="columns">
<div class="column" style="width:40%;">
<p>Xuáº¥t phÃ¡t lÃ  dÃ¢n Kinh táº¿ vÃ  hiá»‡n táº¡i Ä‘i theo hÆ°á»›ng DS, mÃ¬nh khÃ´ng giá»i lÃ m viá»‡c vá»›i cÃ¡c cÃ´ng cá»¥ phÃ¡t triá»ƒn pháº§n má»m, Docker lÃ  má»™t trong sá»‘ Ä‘Ã³. Tuy nhiÃªn trong má»™t dá»± Ã¡n Data cá»§a team, mÃ¬nh cáº§n sá»­ dá»¥ng cÃ¡c cÃ´ng vá»¥ nhÆ° Airflow, Airbyte hay DBT. Háº§u háº¿t cÃ¡c setup Ä‘á»u cáº§n Docker. Do Ä‘Ã³ thÃ¬, pháº£i há»c thÃ´i!</p>
<p>MÃ¬nh há»c táº­p theo video <a href="https://www.youtube.com/watch?v=Gh1Sgknc6Fg&amp;t=358s">â€œHÆ°á»›ng dáº«n tá»« A-Z tá»± xÃ¢y dá»±ng á»©ng dá»¥ng vá»›i Dockerâ€</a> cá»§a anh <a href="https://www.youtube.com/@vietnh1009"><strong>Viá»‡t Nguyá»…n AI</strong></a>.</p>
</div><div class="column" style="width:10%;">
<!-- empty column to create gap -->
</div><div class="column" style="width:50%;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://lktuan.github.io/blog/2024-06-24-docker/vs_cot_song.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption>VS Code-song ğŸ˜ª, áº£nh nháº·t tá»« J2Team community</figcaption>
</figure>
</div>
</div>
</div>
<section id="introduction-docker-desktop-docker-image-vs-docker-container" class="level1">
<h1>Introduction / Docker Desktop / Docker Image vs Docker Container</h1>
<ul>
<li>CÃ¡ch cÃ i Ä‘áº·t: trÃªn trang get started, phiÃªn báº£n Window (ráº¥t dá»… Ä‘á»ƒ mÃ¬nh follow do mÃ¬nh cÅ©ng xÃ i Win).</li>
<li>Nháº¯c láº¡i vá» Docker Image vÃ  Docker Container: giá»‘ng nhÆ° Class vÃ  Object trong OOP, Image chá»‰ cho chÃºng ta biáº¿t má»™t cÃ¡ch lÃ½ thuyáº¿t vá» thá»±c thá»ƒ Ä‘Ã³, khi dá»±a vÃ o lÃ½ thuyáº¿t Ä‘Ã³ táº¡o ra má»™t Container thÃ¬ chÅ©ng ta má»›i cÃ³ má»™t thá»±c thá»ƒ dá»± vÃ o lÃ½ thuyáº¿t Ä‘Ã³.</li>
<li>TrÆ°á»›c Docker Image, cÃ²n cÃ³ Dockerfile (giá»‘ng nhÆ° cÃ´ng thá»©c náº¥u Äƒn) giÃºp Ä‘á»‹nh nghÄ©a má»™t sá»‘ phÆ°Æ¡ng thá»©c táº¡o ra Image.</li>
</ul>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="1">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://lktuan.github.io/blog/2024-06-24-docker/class_vs_object.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption>Image vs Container ~ Class vs Object</figcaption>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="docker-tutorial" class="level1">
<h1>Docker tutorial</h1>
<p>Thá»±c hÃ nh theo tutorial trÃªn Docker Desktop: â€œHow do I run a container?â€</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>Xem ná»™i dung cá»§a má»™t file thÃ´ng qua powershell:</p>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span> file_name</span></code></pre></div>
<p>Trong trÆ°á»ng há»£p thá»±c hÃ nh cá»§a mÃ¬nh lÃ </p>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> welcome-to-docker</span>
<span id="cb2-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span> .<span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\D</span>ockerfile</span></code></pre></div>
</div>
</div>
<p>Ná»™i dung Dockerfile:</p>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode numberSource md number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"># Start your image with a node base image</span></span>
<span id="cb3-2">FROM node:18-alpine </span>
<span id="cb3-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"># Má»—i custome docker image Ä‘á»u dá»±a vÃ o má»™t base image, nhÆ° má»™t class con káº¿ thá»«a má»™t class cha. NÆ¡i tÃ¬m Docker Image: Docker Hub.</span></span>
<span id="cb3-4"></span>
<span id="cb3-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"># The /app directory should act as the main application directory</span></span>
<span id="cb3-6">WORKDIR /app</span>
<span id="cb3-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"># ChÃºng ta lÃ m viá»‡c á»Ÿ bÃªn trong thÆ° má»¥c nÃ o (náº¿u khÃ´ng Ä‘á» cáº­p thÃ¬ sáº½ táº¡o trong má»™t thÆ° má»¥c máº·c Ä‘á»‹nh)</span></span>
<span id="cb3-8"></span>
<span id="cb3-9"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"># Copy the app package and package-lock.json file</span></span>
<span id="cb3-10">COPY package*.json ./</span>
<span id="cb3-11"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"># Copy cÃ¡c file trong mÃ¡y vÃ o bÃªn trong Docker Image - file nÃ y cháº¯c lÃ  file cáº¥u hÃ¬nh</span></span>
<span id="cb3-12"></span>
<span id="cb3-13"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"># Copy local directories to the current local directory of our docker image (/app)</span></span>
<span id="cb3-14">COPY ./src ./src</span>
<span id="cb3-15">COPY ./public ./public</span>
<span id="cb3-16"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"># Copy cÃ¡c thÆ° má»¥c source</span></span>
<span id="cb3-17"></span>
<span id="cb3-18"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"># Install node packages, install serve, build the app, and remove dependencies at the end</span></span>
<span id="cb3-19">RUN npm install \</span>
<span id="cb3-20">    &amp;&amp; npm install -g serve \</span>
<span id="cb3-21">    &amp;&amp; npm run build \</span>
<span id="cb3-22">    &amp;&amp; rm -fr node_modules</span>
<span id="cb3-23"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"># Run, cÃ i Ä‘áº·t cÃ¡c thÆ° viá»‡n, package</span></span>
<span id="cb3-24"></span>
<span id="cb3-25">EXPOSE 3000</span>
<span id="cb3-26"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"># Má»Ÿ má»™t cá»•ng á»Ÿ trong Docker container, sau nÃ y chÃºng ta sáº½ káº¿t ná»‘i cá»•ng nÃ y vá»›i má»™t cá»•ng trong mÃ¡y cá»§a chÃºng ta.</span></span>
<span id="cb3-27"></span>
<span id="cb3-28"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"># Start the app using serve command</span></span>
<span id="cb3-29">CMD <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;"> "serve", "-s", "build" </span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb3-30"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"># ChÃºng ta muá»‘n cháº¡y lá»‡nh gÃ¬ trong CMD, chá»‰ má»™t lá»‡nh CMD (lá»‡nh cuá»‘i cÃ¹ng) sáº½ Ä‘Æ°á»£c sá»­ dá»¥ng trong má»™t Dockerfile.</span></span></code></pre></div>
<p>Build fist image:</p>
<div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb4-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">docker</span> build <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-t</span> welcome-to-docker .</span></code></pre></div>
<p>Breaking down this command:</p>
<blockquote class="blockquote">
<p>The -t flag tags your image with a name. (welcome-to-docker in this case). And the . lets Docker know where it can find the Dockerfile.</p>
</blockquote>
</section>
<section id="tá»±-xÃ¢y-dá»±ng-docker-image-Ä‘á»ƒ-huáº¥n-luyá»‡n-mÃ´-hÃ¬nh-ai" class="level1">
<h1>Tá»± xÃ¢y dá»±ng Docker Image Ä‘á»ƒ huáº¥n luyá»‡n mÃ´ hÃ¬nh AI</h1>
<section id="giá»›i-thiá»‡u-vá»-script-python" class="level2">
<h2 class="anchored" data-anchor-id="giá»›i-thiá»‡u-vá»-script-python">Giá»›i thiá»‡u vá» script Python</h2>
<p>MÃ¬nh cÃ³ má»™t file python Ä‘Æ¡n giáº£n, huáº¥n luyá»‡n má»™t mÃ´ hÃ¬nh <code>ml_project</code> Random forest Ä‘á»ƒ nháº­n diá»‡n hoa diá»…n vÄ© tá»« bá»™ <code>iris</code> dataset vá»›i thÆ° viá»‡n <code>sklearn</code> nhÆ° sau:</p>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>iris_classification.py</strong></pre>
</div>
<div class="sourceCode" id="cb5" data-filename="iris_classification.py" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb5-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#| eval: false</span></span>
<span id="cb5-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># importing required libraries</span></span>
<span id="cb5-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># importing Scikit-learn library and datasets package</span></span>
<span id="cb5-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> sklearn <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> datasets</span>
<span id="cb5-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Splitting arrays or matrices into random train and test subsets</span></span>
<span id="cb5-6"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> sklearn.model_selection <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> train_test_split</span>
<span id="cb5-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># importing random forest classifier from assemble module</span></span>
<span id="cb5-8"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> sklearn.ensemble <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> RandomForestClassifier</span>
<span id="cb5-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># importing scaler</span></span>
<span id="cb5-10"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> sklearn.preprocessing <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> StandardScaler</span>
<span id="cb5-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># metrics are used to find accuracy or error</span></span>
<span id="cb5-12"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> sklearn.metrics <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> accuracy_score </span>
<span id="cb5-13"></span>
<span id="cb5-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Loading the iris plants dataset (classification)</span></span>
<span id="cb5-15">iris <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> datasets.load_iris()</span>
<span id="cb5-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># dividing the datasets into two parts i.e. training datasets and test datasets</span></span>
<span id="cb5-17">X <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> iris.data[:, [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>]]</span>
<span id="cb5-18">y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> iris.target</span>
<span id="cb5-19"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># i.e. 70 % training dataset and 30 % test datasets</span></span>
<span id="cb5-20">X_train, X_test, y_train, y_test <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> train_test_split(X, y, test_size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.20</span>, random_state<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb5-21"></span>
<span id="cb5-22"></span>
<span id="cb5-23">scaler <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> StandardScaler()</span>
<span id="cb5-24">x_train <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> scaler.fit_transform(X_train)</span>
<span id="cb5-25">x_test <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> scaler.transform(X_test)</span>
<span id="cb5-26"></span>
<span id="cb5-27">model <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> RandomForestClassifier()</span>
<span id="cb5-28">model.fit(x_train, y_train)</span>
<span id="cb5-29">y_pred <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> model.predict(x_test)</span>
<span id="cb5-30"></span>
<span id="cb5-31"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> pred, label <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">zip</span>(y_pred, y_test):</span>
<span id="cb5-32">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Prediction: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">. Label: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">format</span>(pred, label))</span>
<span id="cb5-33"></span>
<span id="cb5-34"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Accuracy: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%.2f</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span> accuracy_score(y_test, y_pred))</span></code></pre></div>
</div>
</section>
<section id="tÃ¬m-base-image-trÃªn-docker-hub" class="level2">
<h2 class="anchored" data-anchor-id="tÃ¬m-base-image-trÃªn-docker-hub">TÃ¬m Base Image trÃªn Docker Hub</h2>
<p>ChÃºng ta cÃ³ thá»ƒ tÃ¬m cÃ¡c class cha ~ base image trÃªn <code>hub.docker.com</code>, chÃºng ta muá»‘n app ml nÃ y cháº¡y trÃªn <code>ubuntu</code>, do Ä‘Ã³ cÃ³ thá»ƒ start tá»« image <code>ubuntu</code>.</p>
<p>MÃ¬nh xÃ¢y dá»±ng <code>Dockerfile</code> má»™t cÃ¡ch Ä‘Æ¡n giáº£n nhÆ° sau:</p>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Dockerfile</strong></pre>
</div>
<div class="sourceCode" id="cb6" data-filename="Dockerfile" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb6-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">FROM</span> ubuntu</span></code></pre></div>
</div>
<p>Tá»« Dockerfile nÃ y mÃ¬nh cÃ³ thá»ƒ build image thÃ´ng qua command sau:</p>
<div class="sourceCode" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb7-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">docker</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-t</span> ml_project .</span></code></pre></div>
<p>Run má»™t docker container (container vá»«a run sáº½ láº­p tá»©c exit):</p>
<div class="sourceCode" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb8-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">docker</span> run image_name container_name</span></code></pre></div>
<p>Náº¿u muá»‘n â€œchuiâ€ vÃ o bÃªn trong container:</p>
<div class="sourceCode" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb9-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">docker</span> run <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-it</span> image_name container_name bash</span></code></pre></div>
<p><code>-it</code> nghÄ©a lÃ  chÃºng ta cháº¡y container dÆ°á»›i <strong>interactive</strong> mode, <code>bash</code> nghÄ©a lÃ  cháº¡y trong <strong>bash</strong> mode, chÃºng ta cÃ³ thá»ƒ thá»±c hiá»‡n cÃ¡c cÃ¢u lá»‡nh bash tá»« Ä‘Ã¢y.</p>
</section>
<section id="cÃ i-Ä‘áº·t-cÃ¡c-thÆ°-viá»‡n-trong-docker-image" class="level2">
<h2 class="anchored" data-anchor-id="cÃ i-Ä‘áº·t-cÃ¡c-thÆ°-viá»‡n-trong-docker-image">CÃ i Ä‘áº·t cÃ¡c thÆ° viá»‡n trong Docker Image</h2>
<p>BÃ¢y giá» ta má»›i chá»‰ cÃ³ duy nháº¥t há»‡ Ä‘iá»u hÃ nh ubuntu trong container, chÆ°a cÃ³ python Ä‘á»ƒ cháº¡y á»©ng dá»¥ng. Trong ubuntu, ta dÃ¹ng <code>apt-get</code> Ä‘á»ƒ cÃ i Ä‘áº·t python. ChÃºng ta sáº½ thá»±c hiá»‡n cÃ¡c lá»‡nh trÃªn bash á»Ÿ container hiá»‡n táº¡i trÆ°á»›c, sau Ä‘Ã³ má»›i Ä‘Æ°a vÃ o Dockerfile vá»›i lá»‡nh <code>RUN</code>. DÆ°á»›i Ä‘Ã¢y lÃ  Dockerfile cáº­p nháº­t:</p>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Dockerfile</strong></pre>
</div>
<div class="sourceCode" id="cb10" data-filename="Dockerfile" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb10-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">FROM</span> ubuntu</span>
<span id="cb10-2"></span>
<span id="cb10-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">RUN</span> apt-get update</span>
<span id="cb10-4"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">RUN</span> apt-get <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-y</span> install python3</span>
<span id="cb10-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># -y tá»± Ä‘á»™ng Ä‘iá»n yes khi cÃ³ cÃ¡c cÃ¢u há»i Y/N</span></span></code></pre></div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>Sá»­ dá»¥ng exit() hoáº·c Ctrl-D Ä‘á»ƒ thoÃ¡t Python mode hoáº·c Container trong Powershell.</p>
</div>
</div>
<p>ChÃºng láº¡i truy cáº­p bash cá»§a container Ä‘ang cháº¡y tá»« Docker desktop hoáº·c Powershell:</p>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="1">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://lktuan.github.io/blog/2024-06-24-docker/bash_inside_container.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption>Bash inside container</figcaption>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="copy-dá»¯-liá»‡u-tá»«-host-vÃ o-docker-image" class="level2">
<h2 class="anchored" data-anchor-id="copy-dá»¯-liá»‡u-tá»«-host-vÃ o-docker-image">Copy dá»¯ liá»‡u tá»« host vÃ o Docker Image</h2>
<p>BÃ¢y giá» chÃºng ta muá»‘n ráº±ng sau khi vÃ o container, chÃºng ta khÃ´ng á»Ÿ thÆ° má»¥c <code>root</code> ná»¯a mÃ  á»Ÿ <code>src</code> ~ á»©ng chÃºng cá»§a chÃºng ta, vá»›i má»¥c Ä‘Ã­ch dá»… lÃ m viá»‡c hÆ¡n. ChÃºng ta thÃªm cÃº phÃ¡p <code>WORKDIR /src</code>. Äá»“ng thá»i cÅ©ng cáº§n cÃ i Ä‘áº·t <code>sklearn</code> Ä‘á»ƒ á»©ng dá»¥ng cÃ³ thá»ƒ cháº¡y. Äá»“ng thá»i, sau khi táº¥t cáº£ Ä‘Æ°á»£c cÃ i Ä‘áº·t, mÃ¬nh cÅ©ng muá»‘n cháº¡y luÃ´n á»©ng dá»¥ng, sá»­ dá»¥ng <code>CMD</code>.</p>
<p>Cáº­p nháº­t Dockerfile nhÆ° sau:</p>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Dockerfile</strong></pre>
</div>
<div class="sourceCode" id="cb11" data-filename="Dockerfile" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb11-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">FROM</span> ubuntu</span>
<span id="cb11-2"></span>
<span id="cb11-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">WORKDIR</span> /src</span>
<span id="cb11-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Khi á»Ÿ trong docker container, máº·c Ä‘á»‹nh chÃºng ta sáº½ á»Ÿ root, giá» ta muá»‘n khi vÃ o container, chÃºng ta sáº½ vÃ o /src</span></span>
<span id="cb11-5"></span>
<span id="cb11-6"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">RUN</span> apt-get update</span>
<span id="cb11-7"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">RUN</span> apt-get <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-y</span> install python3</span>
<span id="cb11-8"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">RUN</span> apt-get <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-y</span> install python3-sklearn</span>
<span id="cb11-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># -y tá»± Ä‘á»™ng Ä‘iá»n yes khi cÃ³ cÃ¡c cÃ¢u há»i Y/N</span></span>
<span id="cb11-10"></span>
<span id="cb11-11"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">COPY</span> iris_classification.py ./iris_classification.py </span>
<span id="cb11-12"></span>
<span id="cb11-13"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CMD</span> [ <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"python3"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"iris_classification.py"</span> ]</span></code></pre></div>
</div>
</section>
</section>
<section id="end" class="level1">
<h1>End</h1>
<p>Sau khi hoÃ n thiá»‡n, mÃ¬nh khÃ´ng cáº§n cháº¡y containter á»Ÿ interactive mode vÃ  tÆ°Æ¡ng tÃ¡c báº±ng bash ná»¯a. Lá»‡nh run cÃ³ thá»ƒ viáº¿t gá»n nhÆ° sau:</p>
<div class="sourceCode" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb12-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">docker</span> run ml_project</span></code></pre></div>
<p>BÃ i thá»±c hÃ nh Ä‘áº¿n Ä‘Ã¢y káº¿t thÃºc ğŸ‰.</p>


<!-- -->

</section>

 ]]></description>
  <category>Docker</category>
  <category>Python</category>
  <guid>https://lktuan.github.io/blog/2024-06-24-docker/</guid>
  <pubDate>Sun, 23 Jun 2024 17:00:00 GMT</pubDate>
  <media:content url="https://lktuan.github.io/blog/2024-06-24-docker/docker.png" medium="image" type="image/png" height="76" width="144"/>
</item>
<item>
  <title>Observable Framework try-out</title>
  <dc:creator>Tuan Le Khac</dc:creator>
  <link>https://lktuan.github.io/blog/2024-06-19-observable/</link>
  <description><![CDATA[ 





<p>Iâ€™ve heard that Observable released their Framework as open source in April 2024, and Quarto also supported Observable natively since version 1.4 (?), thus decided to give it a try. Could not agree more with their slogan:</p>
<blockquote class="blockquote">
<p>The best dashboards are built with <code>code</code>.</p>
</blockquote>
<p>This is my <a href="https://github.com/lktuan/first-observable-project">repo</a> for the practice.</p>
<p>ğŸš€ <strong>Observable Framwork</strong> <a href="https://observablehq.com/framework/">documentation</a>.</p>
<blockquote class="blockquote">
<p>Observable Framework â€” or â€œFrameworkâ€ for short â€” is an open-source static-site generator for data apps. By data app we mean an application that is primarily a display of data. Data apps help you derive insights (to understand) and evaluate potential decisions (to take action).</p>
</blockquote>
<p>It can be a set of coordinated <strong>interactive visualizations</strong> for â€œself-serviceâ€ analysis, a <strong>live dashboard</strong>, or a <strong>point-in-time report</strong> that combines graphics and prose to present in-depth analysis.</p>
<p>Why use Framework for your data app?</p>
<ul>
<li>The power of code: Empowered by D3 and Observable Plot library, thereâ€™s no limit to what you can create.</li>
<li>Polyglot meets the web: Framework is <em>polyglot</em> ~ it brings multiple languages together.</li>
<li>Static-site architecture: Frameworkâ€™s data architecture practically forces your app to be fast because data is precomputed at build time. Furthermore, data snapshots can be highly-optimized (and aggregated and anonymized), minimizing what you send to the client.</li>
<li>Automatic reactivity: Instead of wrangling hooks or signals, you can write declarative code in vanilla JavaScript that automatically re-runs whenever variables change, like a spreadsheet.</li>
<li>An end-to-end solution: Well-designed tools let developers focus on high-value, creative work and build better apps.</li>
</ul>
<p>Letâ€™s start!</p>
<section id="inititate-a-new-project" class="level1">
<h1>Inititate a new Project</h1>
<p>ğŸš€ <strong>Observable Framwork</strong> <a href="">getting started</a></p>
<p>The prerequisite is we must have <a href="https://docs.npmjs.com/downloading-and-installing-node-js-and-npm"><code>npm</code></a> installed on our machine. Running <code>npm -v</code>, I know that I have version <code>10.5.0</code> installed.</p>
<p>We first create a folder and navigate to it:</p>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#| eval: false</span></span>
<span id="cb1-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#| echo: true</span></span>
<span id="cb1-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mkdir</span> first-observable-project</span>
<span id="cb1-4"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> first-observable-project</span></code></pre></div>
<p>Then simply run this command to initiate the project:</p>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#| eval: false</span></span>
<span id="cb2-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#| echo: true</span></span>
<span id="cb2-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">npm</span> init <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"@observablehq"</span></span></code></pre></div>
<p>We gotta fill some basic params:</p>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#| eval: false</span></span>
<span id="cb3-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#| echo: true</span></span>
<span id="cb3-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">â”Œ</span>   observable create  v1.5.1</span>
<span id="cb3-4"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">â”‚</span></span>
<span id="cb3-5"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">â—‡</span>  Where to create your project<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">?</span></span>
<span id="cb3-6"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">â”‚</span>  hi-observable</span>
<span id="cb3-7"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">â”‚</span></span>
<span id="cb3-8"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">â—‡</span>  What to title your project<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">?</span></span>
<span id="cb3-9"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">â”‚</span>  Hi Observable</span>
<span id="cb3-10"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">â”‚</span></span>
<span id="cb3-11"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">â—‡</span>  Include sample files to help you get started<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">?</span></span>
<span id="cb3-12"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">â”‚</span>  No</span>
<span id="cb3-13"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">â”‚</span></span>
<span id="cb3-14"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">â—‡</span>  Install dependencies<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">?</span></span>
<span id="cb3-15"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">â”‚</span>  Yes, via npm</span>
<span id="cb3-16"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">â”‚</span></span>
<span id="cb3-17"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">â—‡</span>  Initialize git repository<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">?</span></span>
<span id="cb3-18"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">â”‚</span>  No</span>
<span id="cb3-19"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">â”‚</span></span>
<span id="cb3-20"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">â—‡</span>  Installed! ğŸ‰</span>
<span id="cb3-21"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">â”‚</span></span>
<span id="cb3-22"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">â—‡</span>  Next stepsâ€¦ â”€â”€â”€â”€â”€â”€â•®</span>
<span id="cb3-23"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">â”‚</span>                    â”‚</span>
<span id="cb3-24"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">â”‚</span>  cd hi-observable  â”‚</span>
<span id="cb3-25"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">â”‚</span>  npm run dev       â”‚</span>
<span id="cb3-26"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">â”‚</span>                    â”‚</span>
<span id="cb3-27"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯</span></span>
<span id="cb3-28"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">â”‚</span></span>
<span id="cb3-29"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">â””</span>  Problems<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">?</span> https://observablehq.com/framework/getting-started</span></code></pre></div>
<p>We can now easilly preview the app with <code>npm run dev</code>, and access out dashboard via <code>http://127.0.0.1:3000/</code>. Letâ€™s play a little bit, we can modify the <code>h1</code> tags in <code>docs\index.md</code>, then the dashboard will be updated once we save the file, instantly. Cool!</p>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="1">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://lktuan.github.io/blog/2024-06-19-observable/ojs_fig_1.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption>Home page layout</figcaption>
</figure>
</div>
</div>
</div>
</div>
<p>Here is the structure of my project (after adding those Data Loader, SQL, etc steps below):</p>
<div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode numberSource ini number-lines code-with-copy"><code class="sourceCode ini"></code></pre></div>
<section id="self-hosting" class="level2">
<h2 class="anchored" data-anchor-id="self-hosting">Self hosting</h2>
<p>We donâ€™t have to deploy to Observable â€” Framework projects are simply static sites, so we can host them anywhere. With <code>npm</code>, we can run <code>npm run build</code>, which will generates the <code>dist</code> directory. We can then copy this directory to your static site server or preferred hosting service, like <a href="https://github.com/http-party/http-server"><code>http-server</code></a>, with command <code>npx http-server dist</code>.</p>
<p>For deployment, see the final section at the bottom of this article.</p>
</section>
</section>
<section id="write-first-data-loader" class="level1">
<h1>Write first Data Loader</h1>
<p>In Observable project we can write Data Loader in JavaScript, Python, R or any other languages. Data Loader helps you to (1) minimize file sizes and (2) reduce client side processing.</p>
<p>A data loader file has the name like: <code>dataloader.data_extension.engine_extension</code>. For example, with the American weather forecast API we can have 2 kinds of Data Loader as below:</p>
<p><strong>Javascript ğŸŸ¨</strong>:</p>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>forecast.json.js</strong></pre>
</div>
<div class="sourceCode" id="cb5" data-filename="forecast.json.js" style="background: #f1f3f5;"><pre class="sourceCode numberSource julia number-lines code-with-copy"><code class="sourceCode julia"><span id="cb5-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">const</span> longitude <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">122.47</span>;</span>
<span id="cb5-2"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">const</span> latitude <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">37.8</span>;</span>
<span id="cb5-3"></span>
<span id="cb5-4">async <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">json</span>(url) {</span>
<span id="cb5-5">  <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">const</span> response <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> await <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fetch</span>(url, {headers<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"User-Agent"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"(observablehq.com, support@observablehq.com)"</span>}});</span>
<span id="cb5-6">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> (!response.ok) throw <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">new</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Error</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">`fetch failed: ${response.status}`</span>);</span>
<span id="cb5-7">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> await response.<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">json</span>();</span>
<span id="cb5-8">}</span>
<span id="cb5-9"></span>
<span id="cb5-10"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">const</span> station <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> await <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">json</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">`https://api.weather.gov/points/${latitude},${longitude}`</span>);</span>
<span id="cb5-11"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">const</span> forecast <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> await <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">json</span>(station.properties.forecastHourly);</span>
<span id="cb5-12"></span>
<span id="cb5-13">process.<span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">stdout</span>.<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">write</span>(JSON.<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">stringify</span>(forecast));</span></code></pre></div>
</div>
<p><strong>Python ğŸ</strong>:</p>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>forecast.json.py</strong></pre>
</div>
<div class="sourceCode" id="cb6" data-filename="forecast.json.py" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb6-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> json</span>
<span id="cb6-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> requests</span>
<span id="cb6-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> sys</span>
<span id="cb6-4"></span>
<span id="cb6-5">longitude <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">122.47</span></span>
<span id="cb6-6">latitude <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">37.80</span></span>
<span id="cb6-7"></span>
<span id="cb6-8">station <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> requests.get(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"https://api.weather.gov/points/</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>latitude<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">,</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>longitude<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>).json()</span>
<span id="cb6-9">forecast <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> requests.get(station[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"properties"</span>][<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"forecastHourly"</span>]).json()</span>
<span id="cb6-10"></span>
<span id="cb6-11">json.dump(forecast, sys.stdout)</span></code></pre></div>
</div>
<p>Run the data loader, testing if it work:</p>
<div class="sourceCode" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb7-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#| eval: false</span></span>
<span id="cb7-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#| echo: true</span></span>
<span id="cb7-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">node</span> hi-observable<span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\d</span>ocs<span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\d</span>ata<span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\f</span>orecast.json.js</span>
<span id="cb7-4"></span>
<span id="cb7-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># or</span></span>
<span id="cb7-6"></span>
<span id="cb7-7"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">python</span> hi-observable<span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\d</span>ocs<span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\d</span>ata<span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\f</span>orecast.json.py</span></code></pre></div>
<p>Now if we refresh the dashboard page, the weather forecasting tab should be there. My first run was failed as I miss a comma in JS file ğŸ˜‚. If we change the data loader, the dashboard will change concurrently.</p>
</section>
<section id="sql-in-observable-framework" class="level1">
<h1>SQL in Observable Framework</h1>
</section>
<section id="grids-cards-and-themes" class="level1">
<h1>Grids, Cards, and Themes</h1>
<p>The <code>Grid</code> class allow us to organize multiple vizualization in a denser format, like a dashboard. The <code>Grid</code> class declares a grid container.</p>
</section>
<section id="deployment-a-project" class="level1">
<h1>Deployment a Project</h1>
</section>
<section id="imports-from-npm-local-files-remote-urls-and-lazy-loading" class="level1">
<h1>Imports: from npm, local files, remote URLs, and lazy loading</h1>


<!-- -->

</section>

 ]]></description>
  <category>Dashboard</category>
  <category>Observable</category>
  <category>til</category>
  <guid>https://lktuan.github.io/blog/2024-06-19-observable/</guid>
  <pubDate>Tue, 18 Jun 2024 17:00:00 GMT</pubDate>
  <media:content url="https://lktuan.github.io/blog/2024-06-19-observable/ojs_forum.png" medium="image" type="image/png"/>
</item>
<item>
  <title>NN-Z2H Lesson 1: The spelled-out intro to neural networks and backpropagation - building micrograd</title>
  <dc:creator>Tuan Le Khac</dc:creator>
  <link>https://lktuan.github.io/blog/2024-06-17-nn-z2h-p1/</link>
  <description><![CDATA[ 





<p><strong>Upfront-note</strong>: There are also greate resources in Vietnamese for learning Backpropagation, for e.g.:</p>
<ol type="1">
<li>Blog <a href="https://machinelearningcoban.com/2017/02/24/mlp/">machinelearningcoban</a></li>
<li>Blog <a href="https://dominhhai.github.io/vi/2018/04/nn-bp/">dominhhai</a></li>
</ol>
<section id="micrograd-from-scratch-yayy" class="level1 page-columns page-full">
<h1>MicroGrad from scratch Yayy!</h1>
<p><a href="https://github.com/karpathy/micrograd"><strong>ğŸš€ MicroGrad repo</strong></a> <a href="https://www.youtube.com/watch?v=VMj-3S1tku0&amp;list=PLAqhIrjkxbuWI23v9cThsA9GvCAUhRvKZ"><strong>ğŸ”¥ Video Lecture</strong></a></p>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="1">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://media.geeksforgeeks.org/wp-content/uploads/20240217152156/Frame-13.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption>Backpropagation in Neural Networks, photo credit to <a href="https://www.geeksforgeeks.org/backpropagation-in-neural-network/">GeekforGeek</a></figcaption>
</figure>
</div>
</div>
</div>
</div>
<section id="intro-micrograd-overview---what-does-your-neural-network-training-look-like-under-the-hood" class="level2">
<h2 class="anchored" data-anchor-id="intro-micrograd-overview---what-does-your-neural-network-training-look-like-under-the-hood">intro &amp; micrograd overview - what does your neural network training look like under the hood?</h2>
<p>What is MicroGrad â“: a tiny <strong>auto-grad</strong> (automatic gradient) engine, implement of <strong>backpropagation</strong> ~ itertively tune the weight of that nn to minimize the loss function -&gt; improve the accuracy of the neural network. Backpropagation will be the mathematical core of any modern deep neutral network like, say <code>pytorch</code>, or <code>jaxx</code>.</p>
<p>Installation: <code>pip install micrograd</code></p>
<p>Example:</p>
<div id="b9df0d96" class="cell" data-execution_count="1">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="annotated-cell-1" style="background: #f1f3f5;"><pre class="sourceCode numberSource python code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode python"><span id="annotated-cell-1-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> micrograd.engine <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Value</span>
<span id="annotated-cell-1-2"></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-1" data-target-annotation="1">1</button><span id="annotated-cell-1-3" class="code-annotation-target">a <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Value(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">4.0</span>)</span>
<span id="annotated-cell-1-4">b <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Value(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.0</span>)</span>
<span id="annotated-cell-1-5">c <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> a <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> b</span>
<span id="annotated-cell-1-6">d <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> a <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> b <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> b<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span></span>
<span id="annotated-cell-1-7">c <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> c <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="annotated-cell-1-8">c <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> c <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>a)</span>
<span id="annotated-cell-1-9">d <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> d <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (b <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> a).relu()</span>
<span id="annotated-cell-1-10">d <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> d <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (b <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> a).relu()</span>
<span id="annotated-cell-1-11">e <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> c <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> d</span>
<span id="annotated-cell-1-12">f <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> e<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="annotated-cell-1-13">g <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> f <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.0</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-1" data-target-annotation="2">2</button><span id="annotated-cell-1-14" class="code-annotation-target">g <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">10.0</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> f</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-1" data-target-annotation="3">3</button><span id="annotated-cell-1-15" class="code-annotation-target"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>g<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.4f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span>) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># prints 24.7041, the outcome of this forward pass</span></span>
<span id="annotated-cell-1-16">g.backward()</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-1" data-target-annotation="4">4</button><span id="annotated-cell-1-17" class="code-annotation-target"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>a<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>grad<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.4f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span>) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># prints 138.8338, i.e. the numerical value of dg/da</span></span>
<span id="annotated-cell-1-18"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>b<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>grad<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.4f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span>) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># prints 645.5773, i.e. the numerical value of dg/db</span></span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code></pre></div>
</details>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-1" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-1" data-code-lines="3" data-code-annotation="1">Micrograd allows you to build mathematical expressions, in this case <code>a</code> and <code>b</code> are inputs, wrapped in <code>Value</code> object with value equal to <code>-4.0</code> and <code>2.0</code>, respectively.</span>
</dd>
<dt data-target-cell="annotated-cell-1" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-1" data-code-lines="14" data-code-annotation="2"><code>a</code> and <code>b</code> are transformed to <code>c</code>, <code>d</code>, <code>e</code> and eventually <code>f</code>, <code>g</code>. Mathematical operators are implemented, like <code>+</code>, <code>*</code>, <code>**</code>, even <code>relu()</code>.</span>
</dd>
<dt data-target-cell="annotated-cell-1" data-target-annotation="3">3</dt>
<dd>
<span data-code-cell="annotated-cell-1" data-code-lines="15" data-code-annotation="3"><code>Value</code> object contains <code>data</code>, and <code>grad</code>.</span>
</dd>
<dt data-target-cell="annotated-cell-1" data-target-annotation="4">4</dt>
<dd>
<span data-code-cell="annotated-cell-1" data-code-lines="17" data-code-annotation="4">Call <code>backpropagation()</code> process.</span>
</dd>
</dl>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>24.7041
138.8338
645.5773</code></pre>
</div>
</div>
</section>
<section id="derivative-of-a-simple-function-with-one-input" class="level2">
<h2 class="anchored" data-anchor-id="derivative-of-a-simple-function-with-one-input">derivative of a simple function with one input</h2>
<p>â“What exactly is derivativeâ“</p>
<div id="f5593771" class="cell" data-execution_count="2">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb2-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> math</span>
<span id="cb2-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> numpy <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> np</span>
<span id="cb2-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> matplotlib.pyplot <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> plt</span>
<span id="cb2-4"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>matplotlib inline</span></code></pre></div>
</details>
</div>
<p>A simple quadratic function:</p>
<div id="bad2c0f5" class="cell" data-execution_count="3">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb3-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> f(x):</span>
<span id="cb3-2">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span></span></code></pre></div>
</details>
</div>
<div id="86db4db7" class="cell" data-execution_count="4">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb4-1">f(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.0</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="4">
<pre><code>20.0</code></pre>
</div>
</div>
<p>Input also can be an array, we can plot it for visibility.</p>
<div id="09716b95" class="cell" data-execution_count="5">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb6-1">xs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.arange(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.25</span>)</span>
<span id="cb6-2">ys <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> f(xs)</span>
<span id="cb6-3">plt.plot(xs, ys)</span></code></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://lktuan.github.io/blog/2024-06-17-nn-z2h-p1/index_files/figure-html/cell-6-output-1.png" width="575" height="411" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>If we bump up a litle value <code>h</code> of <code>x</code>, how <code>f(x)</code> will response?</p>
<div id="47f820a3" class="cell" data-execution_count="6">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="annotated-cell-6" style="background: #f1f3f5;"><pre class="sourceCode numberSource python code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode python"><button class="code-annotation-anchor" data-target-cell="annotated-cell-6" data-target-annotation="1">1</button><span id="annotated-cell-6-1" class="code-annotation-target">h <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.000000000001</span></span>
<span id="annotated-cell-6-2">x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.0</span></span>
<span id="annotated-cell-6-3">( f(x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>h) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> f(x) ) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> h</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code></pre></div>
</details>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-6" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-6" data-code-lines="1" data-code-annotation="1">Change the value of <code>h</code> from <code>0.0001</code> to be <code>0.00000...0001</code> -&gt; the slope value comes to <code>14</code> (at the value of <code>3.0</code> of <code>x</code>).</span>
</dd>
</dl>
</div>
<div class="cell-output cell-output-display" data-execution_count="6">
<pre><code>14.001244608152774</code></pre>
</div>
</div>
<p>Try for <code>x = -3.0</code>, <code>x = 5.0</code>, we get different values of the slope, for <code>x = 2/3</code>, the slope is zero. Letâ€™s get more complex.</p>
</section>
<section id="derivative-of-a-function-with-multiple-inputs" class="level2">
<h2 class="anchored" data-anchor-id="derivative-of-a-function-with-multiple-inputs">derivative of a function with multiple inputs</h2>
<div id="0d2be48a" class="cell" data-execution_count="7">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb8-1">a <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.0</span></span>
<span id="cb8-2">b <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.0</span></span>
<span id="cb8-3">c <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">10.0</span></span>
<span id="cb8-4">d <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> a<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>b <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> c</span>
<span id="cb8-5"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(d)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>4.0</code></pre>
</div>
</div>
<p>Put our bump-up element to this multi-variables function:</p>
<div id="c8b804a2" class="cell" data-execution_count="8">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="annotated-cell-8" style="background: #f1f3f5;"><pre class="sourceCode numberSource python code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode python"><span id="annotated-cell-8-1">h <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.001</span></span>
<span id="annotated-cell-8-2"></span>
<span id="annotated-cell-8-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># input</span></span>
<span id="annotated-cell-8-4">a <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.0</span></span>
<span id="annotated-cell-8-5">b <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.0</span></span>
<span id="annotated-cell-8-6">c <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">10.0</span></span>
<span id="annotated-cell-8-7"></span>
<span id="annotated-cell-8-8">d1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> a<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>b <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> c</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-8" data-target-annotation="1">1</button><span id="annotated-cell-8-9" class="code-annotation-target">a <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> h</span>
<span id="annotated-cell-8-10">d2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> a<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>b <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> c</span>
<span id="annotated-cell-8-11"></span>
<span id="annotated-cell-8-12"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'d1: '</span>, d1)</span>
<span id="annotated-cell-8-13"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'d2: '</span>, d2)</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-8" data-target-annotation="2">2</button><span id="annotated-cell-8-14" class="code-annotation-target"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'slope: '</span>, (d2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> d1)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>h)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code></pre></div>
</details>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-8" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-8" data-code-lines="9" data-code-annotation="1">Do the same for <code>b</code>, <code>c</code>, weâ€™ll get different slopes.</span>
</dd>
<dt data-target-cell="annotated-cell-8" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-8" data-code-lines="14" data-code-annotation="2">We say given <code>b = -3.0</code> and <code>c = 10.0</code> are constants, the derivative of <code>d</code> at <code>a = 2.0</code> is <code>-3.0</code>. The rate of which <code>d</code> will increase if we scale <code>a</code>!</span>
</dd>
</dl>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>d1:  4.0
d2:  3.997
slope:  -3.0000000000001137</code></pre>
</div>
</div>
</section>
<section id="starting-the-core-value-object-of-micrograd-and-its-visualization" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="starting-the-core-value-object-of-micrograd-and-its-visualization">starting the core <code>Value</code> object of micrograd and its visualization</h2>
<p>So we now have some intuitive sense of what is derivative is telling you about the function. We now move to the Neural Networks, which would be massive mathematical expressions. We need some data structures that maintain these expressions, we first declare an object <code>Value</code> that holds data.</p>
<div id="b333c6c5" class="cell" data-execution_count="9">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="annotated-cell-9" style="background: #f1f3f5;"><pre class="sourceCode numberSource python code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode python"><span id="annotated-cell-9-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">class</span> Value:</span>
<span id="annotated-cell-9-2">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__init__</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, data, </span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-9" data-target-annotation="3">3</button><span id="annotated-cell-9-3" class="code-annotation-target">                        _children<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(),</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-9" data-target-annotation="5">5</button><span id="annotated-cell-9-4" class="code-annotation-target">                        _op <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">''</span>,</span>
<span id="annotated-cell-9-5">                        label <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">''</span></span>
<span id="annotated-cell-9-6">                        ): </span>
<span id="annotated-cell-9-7">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.data <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> data</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-9" data-target-annotation="6">6</button><span id="annotated-cell-9-8" class="code-annotation-target">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.grad <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.0</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-9" data-target-annotation="7">7</button><span id="annotated-cell-9-9" class="code-annotation-target">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>._backward <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">lambda</span>: <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span></span>
<span id="annotated-cell-9-10">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>._prev <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">set</span>(_children)</span>
<span id="annotated-cell-9-11">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>._op <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> _op</span>
<span id="annotated-cell-9-12">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.label <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>  label</span>
<span id="annotated-cell-9-13"></span>
<span id="annotated-cell-9-14">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__repr__</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>: <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># a nicer looking for class attributes</span></span>
<span id="annotated-cell-9-15">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Value(data=</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">)"</span></span>
<span id="annotated-cell-9-16">    </span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-9" data-target-annotation="4">4</button><span id="annotated-cell-9-17" class="code-annotation-target">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__add__</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, other):</span>
<span id="annotated-cell-9-18">        other <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> other <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">isinstance</span>(other, Value) <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span> Value(other) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># turn other to Value object before calculation</span></span>
<span id="annotated-cell-9-19">        out <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Value(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.data <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> other.data, (<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, other), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'+'</span>)</span>
<span id="annotated-cell-9-20"></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-9" data-target-annotation="8">8</button><span id="annotated-cell-9-21" class="code-annotation-target">        <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> _backward():</span>
<span id="annotated-cell-9-22">            <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.grad <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> out.grad</span>
<span id="annotated-cell-9-23">            other.grad <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> out.grad</span>
<span id="annotated-cell-9-24">        out._backward <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> _backward</span>
<span id="annotated-cell-9-25"></span>
<span id="annotated-cell-9-26">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> out</span>
<span id="annotated-cell-9-27"></span>
<span id="annotated-cell-9-28">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__mul__</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, other):</span>
<span id="annotated-cell-9-29">        other <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> other <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">isinstance</span>(other, Value) <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span> Value(other) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># turn other to Value object before calculation</span></span>
<span id="annotated-cell-9-30">        out <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Value(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.data <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> other.data, (<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, other), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'*'</span>)</span>
<span id="annotated-cell-9-31"></span>
<span id="annotated-cell-9-32">        <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> _backward():</span>
<span id="annotated-cell-9-33">            <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.grad <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> other.data <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> out.grad</span>
<span id="annotated-cell-9-34">            other.grad <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.data <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> out.grad</span>
<span id="annotated-cell-9-35">        out._backward <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> _backward</span>
<span id="annotated-cell-9-36"></span>
<span id="annotated-cell-9-37">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> out</span>
<span id="annotated-cell-9-38"></span>
<span id="annotated-cell-9-39">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> tanh(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>):</span>
<span id="annotated-cell-9-40">        x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.data</span>
<span id="annotated-cell-9-41">        t <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (math.exp(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>x) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (math.exp(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>x) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="annotated-cell-9-42">        out <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Value(t, (<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, ), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'tanh'</span>)</span>
<span id="annotated-cell-9-43"></span>
<span id="annotated-cell-9-44">        <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> _backward():</span>
<span id="annotated-cell-9-45">            <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.grad <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> t<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> out.grad</span>
<span id="annotated-cell-9-46">        out._backward <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> _backward</span>
<span id="annotated-cell-9-47">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> out</span>
<span id="annotated-cell-9-48"></span>
<span id="annotated-cell-9-49">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> backward(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>):</span>
<span id="annotated-cell-9-50">        </span>
<span id="annotated-cell-9-51">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># topo order for all children in the graph</span></span>
<span id="annotated-cell-9-52">        topo <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="annotated-cell-9-53">        visited <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">set</span>()</span>
<span id="annotated-cell-9-54">        <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> build_topo(v):</span>
<span id="annotated-cell-9-55">            <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> v <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">not</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> visited:</span>
<span id="annotated-cell-9-56">                visited.add(v)</span>
<span id="annotated-cell-9-57">                <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> child <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> v._prev:</span>
<span id="annotated-cell-9-58">                    build_topo(child) </span>
<span id="annotated-cell-9-59">                topo.append(v)</span>
<span id="annotated-cell-9-60">        build_topo(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>)</span>
<span id="annotated-cell-9-61"></span>
<span id="annotated-cell-9-62">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># sequentially apply the chain rules</span></span>
<span id="annotated-cell-9-63">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.grad <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span></span>
<span id="annotated-cell-9-64">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> node <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">reversed</span>(topo):</span>
<span id="annotated-cell-9-65">            node._backward()</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code></pre></div>
</details>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-9" data-target-annotation="3">3</dt>
<dd>
<span data-code-cell="annotated-cell-9" data-code-lines="3" data-code-annotation="3">the connective tissue of this expression. We want to keep these expression graphs, so we need to know and keep pointers about what values produce what other values. <code>_children</code> is by default a empty tuple.</span>
</dd>
<dt data-target-cell="annotated-cell-9" data-target-annotation="4">4</dt>
<dd>
<span data-code-cell="annotated-cell-9" data-code-lines="17" data-code-annotation="4">as we added <code>_children</code>, we also need to point out the father - children relationship in method <code>__add__</code> and <code>__mul__</code> as well.</span>
</dd>
<dt data-target-cell="annotated-cell-9" data-target-annotation="5">5</dt>
<dd>
<span data-code-cell="annotated-cell-9" data-code-lines="4" data-code-annotation="5">we want to know the <strong>operation</strong> between father and child, <code>_op</code> is empty string by default, the value <code>+</code> and <code>-</code> will be added to the operator method respectively.</span>
</dd>
<dt data-target-cell="annotated-cell-9" data-target-annotation="6">6</dt>
<dd>
<span data-code-cell="annotated-cell-9" data-code-lines="8" data-code-annotation="6">initially assume that node has no impact to the output.</span>
</dd>
<dt data-target-cell="annotated-cell-9" data-target-annotation="7">7</dt>
<dd>
<span data-code-cell="annotated-cell-9" data-code-lines="9" data-code-annotation="7">this backward function basically do nothing at the initial.</span>
</dd>
<dt data-target-cell="annotated-cell-9" data-target-annotation="8">8</dt>
<dd>
<span data-code-cell="annotated-cell-9" data-code-lines="21" data-code-annotation="8">implement of backward pass for plus node, <code>+=</code> represent the accumulate action (rather than overwrite it), assigne the gradient behaviour for each type of operation, call the <code>_backward</code> concurrently with function.</span>
</dd>
</dl>
</div>
</div>
<p>Setting input and expression:</p>
<div id="dbbfa0d2" class="cell" data-execution_count="10">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="annotated-cell-10" style="background: #f1f3f5;"><pre class="sourceCode numberSource python code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode python"><span id="annotated-cell-10-1">a <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Value(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.0</span>, label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'a'</span>)</span>
<span id="annotated-cell-10-2">b <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Value(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.0</span>, label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'b'</span>)</span>
<span id="annotated-cell-10-3">c <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Value(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">10.0</span>, label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'c'</span>)</span>
<span id="annotated-cell-10-4"></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-10" data-target-annotation="1">1</button><span id="annotated-cell-10-5" class="code-annotation-target">a <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> b</span>
<span id="annotated-cell-10-6"></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-10" data-target-annotation="2">2</button><span id="annotated-cell-10-7" class="code-annotation-target">a<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>b <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> c</span>
<span id="annotated-cell-10-8"></span>
<span id="annotated-cell-10-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># d = a*b + c rewrite the expression</span></span>
<span id="annotated-cell-10-10">e <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> a<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>b<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> e.label <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'e'</span></span>
<span id="annotated-cell-10-11">d <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> e <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> c<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> d.label <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'d'</span></span>
<span id="annotated-cell-10-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># d</span></span>
<span id="annotated-cell-10-13">f <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Value(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.0</span>, label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'f'</span>)</span>
<span id="annotated-cell-10-14">L <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> d <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> f<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> L.label <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'L'</span></span>
<span id="annotated-cell-10-15">L</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code></pre></div>
</details>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-10" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-10" data-code-lines="5" data-code-annotation="1">which will internally call <code>a.__add__(b)</code></span>
</dd>
<dt data-target-cell="annotated-cell-10" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-10" data-code-lines="7" data-code-annotation="2">which will internally call <code>(a.__mul__(b)).__add__(c)</code></span>
</dd>
</dl>
</div>
<div class="cell-output cell-output-display" data-execution_count="10">
<pre><code>Value(data=-8.0)</code></pre>
</div>
</div>
<p>So that we can know the children:</p>
<div id="d5fc2d85" class="cell" data-execution_count="11">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb12-1">d._prev</span></code></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="11">
<pre><code>{Value(data=-6.0), Value(data=10.0)}</code></pre>
</div>
</div>
<p>We can know the operations:</p>
<div id="8e746d76" class="cell" data-execution_count="12">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb14-1">d._op</span></code></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="12">
<pre><code>'+'</code></pre>
</div>
</div>
<p>Now we know exactly how each value came to be by <strong>word</strong> expression and from what other values. These will be quite abit larger, so we need a way to nicely visualize these expressions that weâ€™re building out. Below are a-little-scary codes.</p>
<div id="1b6e7a49" class="cell" data-execution_count="13">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="annotated-cell-13" style="background: #f1f3f5;"><pre class="sourceCode numberSource python code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode python"><span id="annotated-cell-13-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> os</span>
<span id="annotated-cell-13-2"></span>
<span id="annotated-cell-13-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Assuming the Graphviz bin directory path is 'C:/Program Files (x86)/Graphviz2.xx/bin'</span></span>
<span id="annotated-cell-13-4">os.environ[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"PATH"</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> os.pathsep <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'C:/Program Files (x86)/Graphviz/bin'</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># add with the code, Gemini instructed me this ğŸ˜ª</span></span>
<span id="annotated-cell-13-5"></span>
<span id="annotated-cell-13-6"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> graphviz <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Digraph</span>
<span id="annotated-cell-13-7"></span>
<span id="annotated-cell-13-8"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> trace(root):</span>
<span id="annotated-cell-13-9">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># build a set of all nodes and edges in a graph</span></span>
<span id="annotated-cell-13-10">    nodes, edges <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">set</span>(), <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">set</span>()</span>
<span id="annotated-cell-13-11">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> build(v):</span>
<span id="annotated-cell-13-12">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> v <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">not</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> nodes:</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-13" data-target-annotation="1">1</button><span id="annotated-cell-13-13" class="code-annotation-target">            nodes.add(v)</span>
<span id="annotated-cell-13-14">            <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> child <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> v._prev:</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-13" data-target-annotation="2">2</button><span id="annotated-cell-13-15" class="code-annotation-target">                edges.add((child, v))</span>
<span id="annotated-cell-13-16">                build(child)</span>
<span id="annotated-cell-13-17">    build(root)</span>
<span id="annotated-cell-13-18"></span>
<span id="annotated-cell-13-19">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> nodes, edges</span>
<span id="annotated-cell-13-20"></span>
<span id="annotated-cell-13-21"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> draw_dot(root):</span>
<span id="annotated-cell-13-22">    dot <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Digraph(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">format</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'svg'</span>, graph_attr<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>{<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'rankdir'</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'LR'</span>}) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># LR = from left to right</span></span>
<span id="annotated-cell-13-23">    nodes, edges <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> trace(root)</span>
<span id="annotated-cell-13-24">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> n <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> nodes:</span>
<span id="annotated-cell-13-25">        uid <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">id</span>(n))</span>
<span id="annotated-cell-13-26">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># for any value in the graph, create a rectangular ('record') node for it</span></span>
<span id="annotated-cell-13-27">        dot.node(name<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>uid, label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"{ </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%s</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> | data </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%.4f</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> | grad </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%.4f</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">}"</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span> (n.label, n.data, n.grad), shape<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'record'</span>) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># why is (n.data, ), but not (n.data) ???</span></span>
<span id="annotated-cell-13-28">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> n._op:</span>
<span id="annotated-cell-13-29">            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># if this value is a result of some operations, create an op node for it</span></span>
<span id="annotated-cell-13-30">            dot.node(name <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> uid <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> n._op, label <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> n._op)</span>
<span id="annotated-cell-13-31">            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># and connect the node to it</span></span>
<span id="annotated-cell-13-32">            dot.edge(uid <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> n._op, uid)</span>
<span id="annotated-cell-13-33"></span>
<span id="annotated-cell-13-34">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> n1, n2 <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> edges:</span>
<span id="annotated-cell-13-35">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># connect n1 to the op node of n2</span></span>
<span id="annotated-cell-13-36">        dot.edge(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">id</span>(n1)), <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">id</span>(n2)) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> n2._op)</span>
<span id="annotated-cell-13-37"></span>
<span id="annotated-cell-13-38">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> dot</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code></pre></div>
</details>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-13" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-13" data-code-lines="13" data-code-annotation="1">This will collect all nodes to the <code>nodes</code>.</span>
</dd>
<dt data-target-cell="annotated-cell-13" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-13" data-code-lines="15" data-code-annotation="2">This will iteratively recursively collect all nodes to the <code>nodes</code>, add child and node ralationship information to <code>edges</code>.</span>
</dd>
</dl>
</div>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<p>Remember to let <a href="https://graphviz.org/download/">graphviz</a> installed on your machine, not only Python package, I also run this:</p>
<div id="0ead0492" class="cell" data-execution_count="14">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb16-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> os</span>
<span id="cb16-2">os.environ[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"PATH"</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> os.pathsep <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'C:\Program Files (x86)\Graphviz</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\b</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">in\dot.exe'</span></span></code></pre></div>
</details>
</div>
</div></div><p>Now we can draw ğŸš€.</p>
<div id="2df941fe" class="cell" data-execution_count="15">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb17-1">draw_dot(d)</span></code></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="14">
<div>
<figure class="figure">
<p><img src="https://lktuan.github.io/blog/2024-06-17-nn-z2h-p1/index_files/figure-html/cell-16-output-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>So far weâ€™ve build out mathematical expressions using only plus <code>+</code> and times <code>*</code>, all <code>Value</code>s are only scalar.</p>
<p>Back to the <code>Value</code> object, we will create 1 more attribute call <code>label</code>, make the expression more complicated by adding intermediate value <code>f</code>, <code>d</code>, out final node will be capital <code>L</code>.</p>
</section>
</section>
<section id="backpropagation" class="level1 page-columns page-full">
<h1>Backpropagation</h1>
<p>In backpropagation, we start at the end and are going to reverse and calculate the gradients along all the intermediate values. What we are actually computing for evert single node here is derivative of that node with respect to <code>L</code>.</p>
<p>In neural nets, <code>L</code> represent to a Loss function. And you will be very interested in the derivative of bassically loss function <code>L</code> with respect to the <strong>weights</strong> of the neural networks.</p>
<p>We need to know how are those <strong>leaf nodes</strong> <code>a</code>, <code>b</code>, <code>c</code>, <code>f</code> are impacting to the loss function. We call it <code>grad</code> and add this attribute to the <code>Value</code> object.</p>
<section id="manual-backpropagation-example-1-simple-expression" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="manual-backpropagation-example-1-simple-expression">manual backpropagation example #1: simple expression</h2>
<div class="page-columns page-full">
<div id="e64e9aae" class="cell page-columns page-full" data-execution_count="16">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb18-1">draw_dot(L)</span></code></pre></div>
</details>
<div class="cell-output cell-output-display page-columns page-full" data-execution_count="15">
<div class="page-columns page-full">
<figure class="figure page-columns page-full">
<p class="page-columns page-full"><img src="https://lktuan.github.io/blog/2024-06-17-nn-z2h-p1/index_files/figure-html/cell-17-output-1.svg" class="img-fluid figure-img column-page"></p>
</figure>
</div>
</div>
</div>
</div>
<p>Letâ€™s do the backpropagation <strong>manually</strong>:</p>
<ol type="1">
<li>First we need to calculate the <code>dL/dL</code>, how <code>L</code> will response if we change <code>L</code> a tiny value <code>h</code>. The response simply is <code>1</code> so <code>L.grad = 1.0</code>.</li>
<li><code>F = d * f</code>, so <code>dL/dd</code> -&gt; <code>(f((x+h)) - f(x))/h = ((d+h)*f - d*f)/h = h*f/h = f = -2.0</code>. Quite straighforward, so <code>d.grad = -2.0</code>.</li>
<li>Similarly, <code>f.grad = d = 4</code>.<br>
</li>
<li>Next, for <code>dL/dc</code>. We first concern <code>dd/dc</code>, we know <code>d = c + e</code>. Same with (2) we will soon know <code>dd/dc = 1.0</code>, by symmetry <code>dd/de = 1.0</code>. Following the <strong>Chain Rules</strong> <img src="https://latex.codecogs.com/png.latex?h'(x)%20=%20f'(g(x))g'(x)">, we have <code>dL/dc = dL/dd * dd/dc = -2.0 * 1 = -2.0</code>. </li>
<li>By symmetry, <code>dL/de = -2.0</code>.</li>
<li><code>dL/da = dL/de * de/da = -2.0 * b = -2.0 * -3.0 = 6.0</code>.</li>
<li><code>dl/db = dL/de * de/db = -2.0 * a = -2.0 * 2.0 = -4.0</code>.</li>
</ol>
<div class="no-row-height column-margin column-container"><span class="margin-aside"><a href="https://en.wikipedia.org/wiki/Chain_rule">Chain Rules Wiki</a></span></div><p>We can also create a function for playing around / gradient check, and not messing up the global scope.</p>
<div id="b0ddb825" class="cell" data-execution_count="17">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb19-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> lol():</span>
<span id="cb19-2"></span>
<span id="cb19-3">    h <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.0001</span></span>
<span id="cb19-4"></span>
<span id="cb19-5">    a <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Value(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.0</span>, label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'a'</span>)</span>
<span id="cb19-6">    b <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Value(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.0</span>, label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'b'</span>)</span>
<span id="cb19-7">    c <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Value(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">10.0</span>, label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'c'</span>)</span>
<span id="cb19-8">    e <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> a<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>b<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> e.label <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'e'</span></span>
<span id="cb19-9">    d <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> e <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> c<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> d.label <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'d'</span></span>
<span id="cb19-10">    f <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Value(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.0</span>, label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'f'</span>)</span>
<span id="cb19-11">    L <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> d <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> f<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> L.label <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'L'</span></span>
<span id="cb19-12">    L1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> L.data</span>
<span id="cb19-13"></span>
<span id="cb19-14">    a <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Value(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.0</span>, label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'a'</span>)</span>
<span id="cb19-15">    b <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Value(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.0</span>, label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'b'</span>)</span>
<span id="cb19-16">    c <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Value(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">10.0</span>, label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'c'</span>)</span>
<span id="cb19-17">    c.data <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> h <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># dL/dc = -2.0</span></span>
<span id="cb19-18">    e <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> a<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>b<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> e.label <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'e'</span></span>
<span id="cb19-19">    d <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> e <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> c<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> d.label <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'d'</span></span>
<span id="cb19-20">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># d.data += h # dL/dd = -2.0</span></span>
<span id="cb19-21">    f <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Value(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.0</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># + h # dL/df = 4.0</span></span>
<span id="cb19-22">                , label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'f'</span>) </span>
<span id="cb19-23">    L <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> d <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> f<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> L.label <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'L'</span></span>
<span id="cb19-24">    L2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> L.data <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># + h # dL/dL = 1.0</span></span>
<span id="cb19-25"></span>
<span id="cb19-26">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>((L2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> L1) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> h)</span>
<span id="cb19-27"></span>
<span id="cb19-28">lol()</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>-1.9999999999953388</code></pre>
</div>
</div>
<p>So that is backpropagation ~ just recursively applying the Chain Rules, multiplying local derivatives.</p>
</section>
<section id="preview-of-a-single-optimization-step" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="preview-of-a-single-optimization-step">preview of a single optimization step</h2>
<p>We can change the input that we can control <code>a, b, c, f</code> to see 1 step of the optimization of process.</p>
<div id="61c0f1aa" class="cell" data-execution_count="18">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb21" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb21-1">a.grad <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6.0</span></span>
<span id="cb21-2">b.grad <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">4.0</span></span>
<span id="cb21-3">c.grad <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.0</span></span>
<span id="cb21-4">f.grad <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">4.0</span></span>
<span id="cb21-5"></span>
<span id="cb21-6">a.data <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.01</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> a.grad</span>
<span id="cb21-7">b.data <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.01</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> b.grad</span>
<span id="cb21-8">c.data <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.01</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> c.grad</span>
<span id="cb21-9">f.data <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.01</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> f.grad</span>
<span id="cb21-10"></span>
<span id="cb21-11">e <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> a <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> b<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> e.grad <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> e.label <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'e'</span></span>
<span id="cb21-12">d <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> e <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> c<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> d.grad <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> d.label <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'d'</span></span>
<span id="cb21-13">L <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> d <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> f</span>
<span id="cb21-14"></span>
<span id="cb21-15"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(L.data)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>-7.286496</code></pre>
</div>
</div>
<p>We can see the changes, <code>L</code> increased a little bit as expected.</p>
<div class="page-columns page-full">
<div id="5117ec3b" class="cell page-columns page-full" data-execution_count="19">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb23" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb23-1">draw_dot(L)</span></code></pre></div>
</details>
<div class="cell-output cell-output-display page-columns page-full" data-execution_count="18">
<div class="page-columns page-full">
<figure class="figure page-columns page-full">
<p class="page-columns page-full"><img src="https://lktuan.github.io/blog/2024-06-17-nn-z2h-p1/index_files/figure-html/cell-20-output-1.svg" class="img-fluid figure-img column-page"></p>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="manual-backpropagation-example-2-a-neuron" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="manual-backpropagation-example-2-a-neuron">manual backpropagation example #2: a neuron</h2>
<p>Anatomy of neurons, we have:</p>
<ul>
<li><code>axon</code> as input <img src="https://latex.codecogs.com/png.latex?x_0">;</li>
<li><code>synapse</code> string as weight <img src="https://latex.codecogs.com/png.latex?w_0">;</li>
<li>information flows into the cell body will be <img src="https://latex.codecogs.com/png.latex?x_0w_0">;</li>
<li>there are multiple inputs <img src="https://latex.codecogs.com/png.latex?x_iw_i"> flow into the cell body;</li>
<li>the cell body has some <em>bias</em> itself <img src="https://latex.codecogs.com/png.latex?b">;</li>
<li>the cell body processes all information, the output will flow through an <em>activation</em> function ~ which is some kind of a squashing function, like <code>sigmoid</code>, <code>tanh</code> or something like that;</li>
</ul>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="1">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.researchgate.net/publication/364814302/figure/fig5/AS:11431281092677232@1666928276027/Neural-net-Structure-with-an-Activation-Function-Source-CS231n-Stanford-2017.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption>Neural net Structure with an Activation Function, CS231n Stanford 2017</figcaption>
</figure>
</div>
</div>
</div>
</div>
<p>ğŸš€How does the <code>tanh</code> look like? this hyperbolic function will squash the output to the edge values: <code>-1.0</code> or <code>1.0</code>.</p>
<div id="1435c01a" class="cell" data-execution_count="20">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb24" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb24-1">plt.plot(np.arange(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>), np.tanh(np.arange(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>)))<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> plt.grid()</span></code></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://lktuan.github.io/blog/2024-06-17-nn-z2h-p1/index_files/figure-html/cell-21-output-1.png" width="590" height="411" class="figure-img"></p>
</figure>
</div>
</div>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<p>We first implement <a href="https://en.wikipedia.org/wiki/Hyperbolic_functions"><code>tanh</code></a> function to our class <code>Value</code>.</p>
<div id="c999efd4" class="cell" data-execution_count="21">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb25" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb25-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> tanh(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>):</span>
<span id="cb25-2">    x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.data</span>
<span id="cb25-3">    t <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (math.exp(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>x) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (math.exp(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>x) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb25-4">    out <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Value(t, (<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, ), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'tanh'</span>)</span>
<span id="cb25-5">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> out</span>
<span id="cb25-6"></span>
<span id="cb25-7">Value.tanh <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> tanh</span></code></pre></div>
</details>
</div>
</div></div><p>Letâ€™s take a simple example of 2-dimensional neuron with 2 inputs <code>x1</code> and <code>x2</code>:</p>
<div id="adf855ae" class="cell" data-execution_count="22">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb26" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb26-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># input x1, x2</span></span>
<span id="cb26-2">x1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Value(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.0</span>, label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'x1'</span>)</span>
<span id="cb26-3">x2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Value(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.0</span>, label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'x2'</span>)</span>
<span id="cb26-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># weights w1,w2</span></span>
<span id="cb26-5">w1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Value(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.0</span>, label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'w1'</span>)</span>
<span id="cb26-6">w2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Value(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span>, label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'w2'</span>)</span>
<span id="cb26-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># bias of neuron b</span></span>
<span id="cb26-8">b <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Value(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6.88137358</span>, label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'b'</span>)</span>
<span id="cb26-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># x1*w1 + x2*w2 + b</span></span>
<span id="cb26-10">x1w1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> x1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>w1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> x1w1.label <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'x1w1'</span></span>
<span id="cb26-11">x2w2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> x2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>w2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> x2w2.label <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'x2w2'</span></span>
<span id="cb26-12">x1w1x2w2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> x1w1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> x2w2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> x1w1x2w2.label <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'x1w1 + x2w2'</span></span>
<span id="cb26-13">n <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> x1w1x2w2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> b<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> n.label <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'n'</span></span>
<span id="cb26-14"></span>
<span id="cb26-15">o <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> n.tanh()<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> o.label <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'o'</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># not define yet</span></span></code></pre></div>
</details>
</div>
<div class="page-columns page-full">
<div id="b5fc4c81" class="cell page-columns page-full" data-execution_count="23">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb27" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb27-1">draw_dot(o)</span></code></pre></div>
</details>
<div class="cell-output cell-output-display page-columns page-full" data-execution_count="21">
<div class="page-columns page-full">
<figure class="figure page-columns page-full">
<p class="page-columns page-full"><img src="https://lktuan.github.io/blog/2024-06-17-nn-z2h-p1/index_files/figure-html/cell-24-output-1.svg" class="img-fluid figure-img column-page"></p>
</figure>
</div>
</div>
</div>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<div id="050f50a4" class="cell" data-execution_count="24">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb28" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb28-1">o.grad <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span></span>
<span id="cb28-2">n.grad <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> o.data <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb28-3">b.grad <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> n.grad</span>
<span id="cb28-4">x1w1x2w2.grad <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> n.grad</span>
<span id="cb28-5">x1w1.grad <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> x1w1x2w2.grad</span>
<span id="cb28-6">x2w2.grad <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> x1w1x2w2.grad</span>
<span id="cb28-7">x1.grad <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> w1.data <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> x1w1.grad</span>
<span id="cb28-8">w1.grad <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> x1.data <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> x1w1.grad</span>
<span id="cb28-9">x2.grad <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> w2.data <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> x2w2.grad</span>
<span id="cb28-10">w2.grad <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> x2.data <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> x2w2.grad</span></code></pre></div>
</details>
</div>
</div></div><p>From here we will manually calculate the gradient again:</p>
<ol type="1">
<li><code>do/do = 1</code>, thatâ€™s the base case, so <code>o.grad = 1.0</code>.</li>
<li><code>o = tanh(n)</code>, follow that Wiki link (and of course can be easily proof) we have <code>do/dn = 1 - tanh(x)^2 = 1 - o^2</code>.</li>
<li><code>n = x1w1x2w2 + b</code>, this is plus node, which gradient will flow to children equally, <code>do/db = do/dn * dn/db = do/dn * 1</code>.</li>
<li>By symmertry, <code>do/dx1w1x2w2 = do/db</code>.</li>
<li><code>do/dx1w1 = do/dx1w1x2w2</code>.</li>
<li><code>do/dx2w2 = do/dx1w1x2w2</code>.</li>
<li><code>do/dx1 = w1 * do/dx1w1</code>.</li>
<li><code>do/dw1 = x1 * do/dx1w1</code>.</li>
<li><code>do/dx2 = w2 * do/dx2w2</code>.</li>
<li><code>do/dw2 = x2 * do/dx2w2</code>.</li>
</ol>
<div class="page-columns page-full">
<div id="b2a5685c" class="cell page-columns page-full" data-execution_count="25">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb29" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb29-1">draw_dot(o)</span></code></pre></div>
</details>
<div class="cell-output cell-output-display page-columns page-full" data-execution_count="23">
<div class="page-columns page-full">
<figure class="figure page-columns page-full">
<p class="page-columns page-full"><img src="https://lktuan.github.io/blog/2024-06-17-nn-z2h-p1/index_files/figure-html/cell-26-output-1.svg" class="img-fluid figure-img column-page"></p>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="implementing-the-backward-function-for-each-operation" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="implementing-the-backward-function-for-each-operation">implementing the backward function for each operation</h2>
<p>Doing the backpropagation manually is obviously ridiculous and we are now to put an end to this suffering. We will see how we can implement backward pass a bit more automatically.</p>
<p>We create <code>_backward</code> operation for each operator, implement the Chain Rules. Activate the <code>_backward</code> call along with funtion execution.</p>
<div id="724b9351" class="cell" data-execution_count="26">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb30" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb30-1">o.grad <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span></span>
<span id="cb30-2"></span>
<span id="cb30-3">o._backward()</span>
<span id="cb30-4">n._backward()</span>
<span id="cb30-5">b._backward()</span>
<span id="cb30-6">x1w1x2w2._backward()</span>
<span id="cb30-7">x1w1._backward()</span>
<span id="cb30-8">x2w2._backward()</span></code></pre></div>
</details>
</div>
<div class="page-columns page-full">
<div id="7b8ca278" class="cell page-columns page-full" data-execution_count="27">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb31" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb31-1">draw_dot(o)</span></code></pre></div>
</details>
<div class="cell-output cell-output-display page-columns page-full" data-execution_count="25">
<div class="page-columns page-full">
<figure class="figure page-columns page-full">
<p class="page-columns page-full"><img src="https://lktuan.github.io/blog/2024-06-17-nn-z2h-p1/index_files/figure-html/cell-28-output-1.svg" class="img-fluid figure-img column-page"></p>
</figure>
</div>
</div>
</div>
</div>
<p>We still need to call the <code>_backward</code> node by node. Now we move to the next step, to implement backward function to whole expression graph.</p>
</section>
<section id="implementing-the-backward-function-for-a-whole-expression-graph" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="implementing-the-backward-function-for-a-whole-expression-graph">implementing the backward function for a whole expression graph</h2>
<p>In short, we need to do everything after each node before we call the backward function itself. For every node, all dependencies, everything that it depends on has to propagate to it before we can continue backpropagation.</p>
<p>This ordering of graph can be archived using something like <a href="https://en.wikipedia.org/wiki/Topological_sorting">topological sort</a>.</p>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="1">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://miro.medium.com/v2/resize:fit:720/format:webp/1*0jRSNI2zo30sENk2qlqEvw.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption>Topological Sort, photo credit to <a href="https://yuminlee2.medium.com/topological-sort-cf9f8e43af6a">Claire Lee</a></figcaption>
</figure>
</div>
</div>
</div>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<div id="8e1cf168" class="cell" data-execution_count="28">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb32" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb32-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># we first reset the Values</span></span>
<span id="cb32-2">x1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Value(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.0</span>, label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'x1'</span>)</span>
<span id="cb32-3">x2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Value(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.0</span>, label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'x2'</span>)</span>
<span id="cb32-4">w1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Value(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.0</span>, label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'w1'</span>)</span>
<span id="cb32-5">w2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Value(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span>, label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'w2'</span>)</span>
<span id="cb32-6">b <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Value(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6.88137358</span>, label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'b'</span>)</span>
<span id="cb32-7">x1w1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> x1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>w1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> x1w1.label <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'x1w1'</span></span>
<span id="cb32-8">x2w2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> x2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>w2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> x2w2.label <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'x2w2'</span></span>
<span id="cb32-9">x1w1x2w2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> x1w1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> x2w2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> x1w1x2w2.label <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'x1w1 + x2w2'</span></span>
<span id="cb32-10">n <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> x1w1x2w2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> b<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> n.label <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'n'</span></span>
<span id="cb32-11">o <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> n.tanh()<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> o.label <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'o'</span></span></code></pre></div>
</details>
</div>
</div></div><p>Below is the code:</p>
<div id="701c37a6" class="cell" data-execution_count="29">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb33" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb33-1">topo <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb33-2">visited <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">set</span>()</span>
<span id="cb33-3"></span>
<span id="cb33-4"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> build_topo(v):</span>
<span id="cb33-5">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> v <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">not</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> visited:</span>
<span id="cb33-6">        visited.add(v)</span>
<span id="cb33-7">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> child <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> v._prev:</span>
<span id="cb33-8">            build_topo(child) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># recursively look up all children for v</span></span>
<span id="cb33-9">        topo.append(v)</span>
<span id="cb33-10"></span>
<span id="cb33-11">build_topo(o)</span>
<span id="cb33-12">topo</span></code></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="27">
<pre><code>[Value(data=6.88137358),
 Value(data=2.0),
 Value(data=-3.0),
 Value(data=-6.0),
 Value(data=0.0),
 Value(data=1.0),
 Value(data=0.0),
 Value(data=-6.0),
 Value(data=0.88137358),
 Value(data=0.707106777676776)]</code></pre>
</div>
</div>
<p>We implement the topological sort to <code>backward()</code> (without underscore) function. Now we can trigger the whole process:</p>
<div id="23bc7fa2" class="cell" data-execution_count="30">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb35" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb35-1">o.backward()</span></code></pre></div>
</details>
</div>
<div class="page-columns page-full">
<div id="ffb0088c" class="cell page-columns page-full" data-execution_count="31">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb36" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb36-1">draw_dot(o)</span></code></pre></div>
</details>
<div class="cell-output cell-output-display page-columns page-full" data-execution_count="29">
<div class="page-columns page-full">
<figure class="figure page-columns page-full">
<p class="page-columns page-full"><img src="https://lktuan.github.io/blog/2024-06-17-nn-z2h-p1/index_files/figure-html/cell-32-output-1.svg" class="img-fluid figure-img column-page"></p>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="fixing-a-backprop-bug-when-one-node-is-used-multiple-times" class="level2">
<h2 class="anchored" data-anchor-id="fixing-a-backprop-bug-when-one-node-is-used-multiple-times">fixing a backprop bug when one node is used multiple times â›”</h2>
<p>This <code>a.grad</code> should be <code>2.0</code>.</p>
<div id="6eaa6894" class="cell" data-execution_count="32">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb37" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb37-1">a <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Value(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.0</span>, label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'a'</span>)</span>
<span id="cb37-2">b <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> a <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> a<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> b.label <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'b'</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># this case self and other are both a, we should not overwrite the gradient, we should accumulate it.</span></span>
<span id="cb37-3">b.backward()</span>
<span id="cb37-4">draw_dot(b)</span></code></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="30">
<div>
<figure class="figure">
<p><img src="https://lktuan.github.io/blog/2024-06-17-nn-z2h-p1/index_files/figure-html/cell-33-output-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="breaking-up-a-tanh-exercising-with-more-operations" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="breaking-up-a-tanh-exercising-with-more-operations">breaking up a <code>tanh</code>, exercising with more operations</h2>
<p>Sometime we do operations between <code>Value</code> and other, like <code>int</code>. We can not do this unless we add below code to <code>__add__</code> and <code>__mul__</code> operations. Now we can <code>Value(1.0) + 1.0</code>, or <code>Value(2.0) * 2</code>.</p>
<div id="e91741ed" class="cell" data-execution_count="33">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb38" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb38-1">other <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> other <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">isinstance</span>(other, Value) <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span> Value(other)</span></code></pre></div>
</details>
</div>
<p>But for <code>2 * Value(2.0)</code>, which will internally call <code>2.__mul__(Value(2.0))</code>, will not work. We add <code>__rmul__</code>:</p>
<div id="80439bef" class="cell" data-execution_count="34">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb39" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb39-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__rmul__</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, other): <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># other * self</span></span>
<span id="cb39-2">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> other</span>
<span id="cb39-3"></span>
<span id="cb39-4">Value.<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__rmul__</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__rmul__</span></span></code></pre></div>
</details>
</div>
<p>For exponential, we add <code>epx</code>:</p>
<div id="13022508" class="cell" data-execution_count="35">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb40" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb40-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> exp(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>):</span>
<span id="cb40-2">    x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.data</span>
<span id="cb40-3">    out <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Value(math.exp(x), (<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, ), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'exp'</span>)</span>
<span id="cb40-4"></span>
<span id="cb40-5">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> _backward():</span>
<span id="cb40-6">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.grad <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> out.data <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> out.grad</span>
<span id="cb40-7">    out._backward <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> _backward</span>
<span id="cb40-8"></span>
<span id="cb40-9">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> out</span>
<span id="cb40-10"></span>
<span id="cb40-11">Value.exp <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> exp</span></code></pre></div>
</details>
</div>
<p>For division, we add <code>__truediv__</code>:</p>
<div id="b4ac6bfa" class="cell" data-execution_count="36">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb41" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb41-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__truediv__</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, other): <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># self / other</span></span>
<span id="cb41-2">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> other<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span>(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb41-3"></span>
<span id="cb41-4">Value.<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__truediv__</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__truediv__</span></span></code></pre></div>
</details>
</div>
<p>For power, we add <code>__pow__</code>:</p>
<div id="b5e05d88" class="cell" data-execution_count="37">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb42" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb42-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__pow__</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, other): <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># self ** other</span></span>
<span id="cb42-2">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">assert</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">isinstance</span>(other, (<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span>, <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">float</span>)), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"TypeError: only supporting int/float power for now"</span></span>
<span id="cb42-3">    out <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Value(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.data<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span>other, (<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, ), <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'**</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>other<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span>)</span>
<span id="cb42-4"></span>
<span id="cb42-5">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> _backward():</span>
<span id="cb42-6">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.grad <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> other <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> ( <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.data <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span> (other <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> out.grad</span>
<span id="cb42-7">    out._backward <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> _backward</span>
<span id="cb42-8"></span>
<span id="cb42-9">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> out</span>
<span id="cb42-10"></span>
<span id="cb42-11">Value.<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__pow__</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__pow__</span> </span></code></pre></div>
</details>
</div>
<p>For subtract, we add <code>__neg__</code> and <code>__sub__</code>:</p>
<div id="46cb1ab6" class="cell" data-execution_count="38">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb43" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb43-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__neg__</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>): <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># - self</span></span>
<span id="cb43-2">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span></span>
<span id="cb43-3"></span>
<span id="cb43-4">Value.<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__neg__</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__neg__</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># self - other</span></span>
<span id="cb43-5"></span>
<span id="cb43-6"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__sub__</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, other):</span>
<span id="cb43-7">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>other)</span>
<span id="cb43-8"></span>
<span id="cb43-9">Value.<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__sub__</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__sub__</span></span></code></pre></div>
</details>
</div>
<p>Now we are ready to try <code>tanh</code> in a different way:</p>
<div id="6164cb90" class="cell" data-execution_count="39">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb44" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb44-1">x1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Value(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.0</span>, label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'x1'</span>)</span>
<span id="cb44-2">x2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Value(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.0</span>, label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'x2'</span>)</span>
<span id="cb44-3">w1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Value(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.0</span>, label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'w1'</span>)</span>
<span id="cb44-4">w2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Value(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span>, label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'w2'</span>)</span>
<span id="cb44-5">b <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Value(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6.88137358</span>, label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'b'</span>)</span>
<span id="cb44-6">x1w1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> x1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>w1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> x1w1.label <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'x1w1'</span></span>
<span id="cb44-7">x2w2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> x2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>w2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> x2w2.label <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'x2w2'</span></span>
<span id="cb44-8">x1w1x2w2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> x1w1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> x2w2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> x1w1x2w2.label <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'x1w1 + x2w2'</span></span>
<span id="cb44-9">n <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> x1w1x2w2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> b<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> n.label <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'n'</span></span>
<span id="cb44-10"></span>
<span id="cb44-11">e <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>n).exp()<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> e.label <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'e'</span></span>
<span id="cb44-12">o <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (e <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>(e <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb44-13">o.label <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'o'</span></span>
<span id="cb44-14">o.backward()</span></code></pre></div>
</details>
</div>
<div class="page-columns page-full">
<div id="548cf0cd" class="cell page-columns page-full" data-execution_count="40">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb45" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb45-1">draw_dot(o)</span></code></pre></div>
</details>
<div class="cell-output cell-output-display page-columns page-full" data-execution_count="37">
<div class="page-columns page-full">
<figure class="figure page-columns page-full">
<p class="page-columns page-full"><img src="https://lktuan.github.io/blog/2024-06-17-nn-z2h-p1/index_files/figure-html/cell-41-output-1.svg" class="img-fluid figure-img column-screen"></p>
</figure>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="pytorch-comparison" class="level1">
<h1>PyTorch comparison</h1>
<section id="doing-the-same-thing-but-in-pytorch-comparison" class="level2">
<h2 class="anchored" data-anchor-id="doing-the-same-thing-but-in-pytorch-comparison">doing the same thing but in PyTorch: comparison</h2>
<div id="188c2133" class="cell" data-execution_count="41">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb46" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb46-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> torch</span>
<span id="cb46-2"></span>
<span id="cb46-3">x1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.tensor([<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.0</span>]).double()<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> x1.requires_grad <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span></span>
<span id="cb46-4">x2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.tensor([<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.0</span>]).double()<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> x2.requires_grad <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span></span>
<span id="cb46-5">w1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.tensor([<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.0</span>]).double()<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> w1.requires_grad <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span></span>
<span id="cb46-6">w2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.tensor([<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span>]).double()<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> w2.requires_grad <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span></span>
<span id="cb46-7">b <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.tensor([<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6.8813735870195432</span>]).double()<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> b.requires_grad <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span></span>
<span id="cb46-8"></span>
<span id="cb46-9">n <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> x1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>w1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> x2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>w2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> b</span>
<span id="cb46-10">o <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.tanh(n)</span>
<span id="cb46-11"></span>
<span id="cb46-12"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(o.data.item())</span>
<span id="cb46-13">o.backward()</span>
<span id="cb46-14"></span>
<span id="cb46-15"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'------------------'</span>)</span>
<span id="cb46-16"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'x1'</span>, x1.grad.item())</span>
<span id="cb46-17"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'w1'</span>, w1.grad.item())</span>
<span id="cb46-18"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'x2'</span>, x2.grad.item())</span>
<span id="cb46-19"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'w2'</span>, w2.grad.item())</span>
<span id="cb46-20"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'------------------'</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>0.7071066904050358
------------------
x1 -1.5000003851533106
w1 1.0000002567688737
x2 0.5000001283844369
w2 0.0
------------------</code></pre>
</div>
</div>
</section>
</section>
<section id="building-the-library" class="level1 page-columns page-full">
<h1>Building the library</h1>
<section id="building-out-a-neural-net-library-multi-layer-perceptron-in-micrograd" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="building-out-a-neural-net-library-multi-layer-perceptron-in-micrograd">building out a neural net library (multi-layer perceptron) in micrograd</h2>
<p>We are going to build out a two-layer perceptron.</p>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="1">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://cs231n.github.io/assets/nn1/neural_net2.jpeg" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption>A 3-layer neural network with three inputs, two hidden layers of 4 neurons each and one output layer. Notice that in both cases there are connections (synapses) between neurons across layers, but not within a layer, photo credit to <a href="https://cs231n.github.io/neural-networks-1/">cs231n</a></figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="e0a044d7" class="cell" data-execution_count="42">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="annotated-cell-31" style="background: #f1f3f5;"><pre class="sourceCode numberSource python code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode python"><span id="annotated-cell-31-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">class</span> Neuron:</span>
<span id="annotated-cell-31-2"></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-31" data-target-annotation="1">1</button><span id="annotated-cell-31-3" class="code-annotation-target">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__init__</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, nin):</span>
<span id="annotated-cell-31-4">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.w <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [Value(np.random.uniform(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> _ <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(nin)]</span>
<span id="annotated-cell-31-5">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.b <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Value(np.random.uniform(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>))</span>
<span id="annotated-cell-31-6">    </span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-31" data-target-annotation="2">2</button><span id="annotated-cell-31-7" class="code-annotation-target">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__call__</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, x):</span>
<span id="annotated-cell-31-8">        activation <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sum</span>((wi<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>xi <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> wi, xi <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">zip</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.w, x)), <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.b)</span>
<span id="annotated-cell-31-9">        out <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> activation.tanh()</span>
<span id="annotated-cell-31-10">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> out</span>
<span id="annotated-cell-31-11"></span>
<span id="annotated-cell-31-12">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> parameters(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>):</span>
<span id="annotated-cell-31-13">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.w <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> [<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.b] <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># list plus list gives you a list</span></span>
<span id="annotated-cell-31-14"></span>
<span id="annotated-cell-31-15"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">class</span> Layer:</span>
<span id="annotated-cell-31-16"></span>
<span id="annotated-cell-31-17">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__init__</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, nin, nout):</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-31" data-target-annotation="3">3</button><span id="annotated-cell-31-18" class="code-annotation-target">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.neurons <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [Neuron(nin) <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> _ <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(nout)]</span>
<span id="annotated-cell-31-19"></span>
<span id="annotated-cell-31-20">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__call__</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, x):</span>
<span id="annotated-cell-31-21">        outs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [n(x) <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> n <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.neurons]</span>
<span id="annotated-cell-31-22">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> outs[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(outs) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span> outs</span>
<span id="annotated-cell-31-23"></span>
<span id="annotated-cell-31-24">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> parameters(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>):</span>
<span id="annotated-cell-31-25">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> [p <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> neuron <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.neurons <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> p <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> neuron.parameters()] <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># list comprehension</span></span>
<span id="annotated-cell-31-26">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># params = []</span></span>
<span id="annotated-cell-31-27">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># for neuron in self.neurons:</span></span>
<span id="annotated-cell-31-28">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#     ps = neuron.parameters()</span></span>
<span id="annotated-cell-31-29">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#     params.extend(ps)</span></span>
<span id="annotated-cell-31-30">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># return params</span></span>
<span id="annotated-cell-31-31"></span>
<span id="annotated-cell-31-32"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">class</span> MLP:</span>
<span id="annotated-cell-31-33"></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-31" data-target-annotation="4">4</button><span id="annotated-cell-31-34" class="code-annotation-target">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__init__</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, nin, nouts):</span>
<span id="annotated-cell-31-35">        sz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [nin] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> nouts</span>
<span id="annotated-cell-31-36">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.layers <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [Layer(sz[i], sz[i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]) <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(nouts))]</span>
<span id="annotated-cell-31-37"></span>
<span id="annotated-cell-31-38">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__call__</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, x):</span>
<span id="annotated-cell-31-39">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> layer <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.layers:</span>
<span id="annotated-cell-31-40">            x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> layer(x)</span>
<span id="annotated-cell-31-41">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> x</span>
<span id="annotated-cell-31-42"></span>
<span id="annotated-cell-31-43">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> parameters(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>):</span>
<span id="annotated-cell-31-44">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> [p <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> layer <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.layers <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> p <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> layer.parameters()] <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># for neuron in layer.neurons for neuron.parameters()]</span></span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code></pre></div>
</details>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-31" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-31" data-code-lines="3" data-code-annotation="1">Number of <code>input</code> for the Neuron. <code>w</code> is randomly generated for each input, same for <code>b</code> which is the bias that controll â€œthe happinessâ€.</span>
</dd>
<dt data-target-cell="annotated-cell-31" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-31" data-code-lines="7" data-code-annotation="2">Object as a function: define the forward pass of the Neuron <img src="https://latex.codecogs.com/png.latex?%5Csum%5Climits_%7Bi=1%7D%5E%7Bnin%7D%20w_ix_i+b">, then squash the output using <code>tanh</code>.</span>
</dd>
<dt data-target-cell="annotated-cell-31" data-target-annotation="3">3</dt>
<dd>
<span data-code-cell="annotated-cell-31" data-code-lines="18" data-code-annotation="3">A Layer is a list of Neurons, <code>nout</code> specifies how many Neurons in the Layer. Each neuron has <code>nin</code> inputs ~ nin-D. We just initialize completely independent neurons with this given dimensionality.</span>
</dd>
<dt data-target-cell="annotated-cell-31" data-target-annotation="4">4</dt>
<dd>
<span data-code-cell="annotated-cell-31" data-code-lines="34" data-code-annotation="4">A MLP is a sequence of Layers, picture above depicts a 3-layers MLP containing 1 input layer and 3 output layers, we say the size is 4. We sequentially create connection from the input layer to the 1st output layer, 1st output layer to 2nd output layer,â€¦</span>
</dd>
</dl>
</div>
</div>
<div id="ff8ca4dd" class="cell" data-execution_count="43">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb48" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb48-1">nin <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span></span>
<span id="cb48-2">nouts <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.0</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.0</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span>]</span>
<span id="cb48-3">[nin] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> nouts</span></code></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="40">
<pre><code>[3, 2.0, 3.0, -1.0]</code></pre>
</div>
</div>
<div id="04dc941c" class="cell" data-execution_count="44">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb50" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb50-1">x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.0</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.0</span>]</span>
<span id="cb50-2">n <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Neuron(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb50-3">l <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Layer(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span>
<span id="cb50-4">n(x)</span>
<span id="cb50-5">l(x)</span></code></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="41">
<pre><code>[Value(data=0.6482171154461839),
 Value(data=-0.9819100896618514),
 Value(data=0.42012274248341236)]</code></pre>
</div>
</div>
<div id="8cf5d3a3" class="cell" data-execution_count="45">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb52" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb52-1">x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.0</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.0</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span>]</span>
<span id="cb52-2">m <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> MLP(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># a MLP with 3-D input, 3 output layers contains 4, 4, 1 neurons in each layer respectively</span></span>
<span id="cb52-3">m(x)</span></code></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="42">
<pre><code>Value(data=-0.4705965544324498)</code></pre>
</div>
</div>
<div class="page-columns page-full">
<div id="237a863d" class="cell page-columns page-full" data-execution_count="46">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb54" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb54-1">draw_dot(m(x))</span></code></pre></div>
</details>
<div class="cell-output cell-output-display page-columns page-full" data-execution_count="43">
<div class="page-columns page-full">
<figure class="figure page-columns page-full">
<p class="page-columns page-full"><img src="https://lktuan.github.io/blog/2024-06-17-nn-z2h-p1/index_files/figure-html/cell-47-output-1.svg" class="img-fluid figure-img column-screen"></p>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="creating-a-tiny-dataset-writing-the-loss-function" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="creating-a-tiny-dataset-writing-the-loss-function">creating a tiny dataset, writing the loss function</h2>
<p>A simple data set, <code>m()</code> is the MLP we defined above.</p>
<div id="20ba7355" class="cell" data-execution_count="47">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb55" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb55-1">xs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [</span>
<span id="cb55-2">    [<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.0</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.0</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span>],</span>
<span id="cb55-3">    [<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.0</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>],</span>
<span id="cb55-4">    [<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span>],</span>
<span id="cb55-5">    [<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span>]</span>
<span id="cb55-6">]</span>
<span id="cb55-7">ys <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span>] <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># designed targets</span></span></code></pre></div>
</details>
</div>
<div class="page-columns page-full"><p>Writing the loss function. </p><div class="no-row-height column-margin column-container"><span class="margin-aside">I was unable to sum a list of Value, found the solution <a href="https://stackoverflow.com/questions/54153552/unsupported-operand-type-error-when-adding-objects-within-list-using-sum-functio">here</a>; Edit: I used Numpy random instead of random</span></div></div>
<div id="bad2b0d7" class="cell" data-execution_count="48">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb56" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb56-1">ypred <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [m(x) <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> x <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> xs]</span>
<span id="cb56-2">loss <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.array([(yout <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> ygt)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> ygt, yout <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">zip</span>(ys, ypred)]).<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sum</span>()</span>
<span id="cb56-3"></span>
<span id="cb56-4">loss</span></code></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="45">
<pre><code>Value(data=3.7846173239470486)</code></pre>
</div>
</div>
<p>Backpropagation the <code>loss</code>, some magical here:</p>
<div id="88f8a81a" class="cell" data-execution_count="49">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb58" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb58-1">loss.backward()</span></code></pre></div>
</details>
</div>
<p>We can look into the gradient of weight of the first neuron of the first layer (input layer)</p>
<div id="6bfcc38c" class="cell" data-execution_count="50">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb59" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb59-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'value of 1st neuron in 1st layer: '</span>,m.layers[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].neurons[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].w[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].data)</span>
<span id="cb59-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'grad of 1st neuron in 1st layer: '</span>,m.layers[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].neurons[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].w[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].grad)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>value of 1st neuron in 1st layer:  -0.6357735432605731
grad of 1st neuron in 1st layer:  -4.1814374695537895</code></pre>
</div>
</div>
<div class="page-columns page-full">
<div id="2c9861ac" class="cell page-columns page-full" data-execution_count="51">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb61" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb61-1">draw_dot(loss)</span></code></pre></div>
</details>
<div class="cell-output cell-output-display page-columns page-full" data-execution_count="48">
<div class="page-columns page-full">
<figure class="figure page-columns page-full">
<p class="page-columns page-full"><img src="https://lktuan.github.io/blog/2024-06-17-nn-z2h-p1/index_files/figure-html/cell-52-output-1.svg" class="img-fluid figure-img column-screen"></p>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="collecting-all-of-the-parameters-of-the-neural-net" class="level2">
<h2 class="anchored" data-anchor-id="collecting-all-of-the-parameters-of-the-neural-net">collecting all of the parameters of the neural net</h2>
<p>We aim to produce the fitness <code>ypred</code>. <code>xs</code> is the data, the input of problem, we can not change it. <code>ys</code> is the ground true, can not changes as well. What we can change is the â€œparamtersâ€ of each neuron, which is weight <code>w</code> and bias <code>b</code>.</p>
<p>We add in to each class a <code>parameters()</code> function to collect those. Finally we can get all the paramters of the MLP:</p>
<div id="d4c227bc" class="cell" data-execution_count="52">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb62" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb62-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(m.parameters())</span></code></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="49">
<pre><code>41</code></pre>
</div>
</div>
</section>
<section id="doing-gradient-descent-optimization-manually-training-the-network" class="level2">
<h2 class="anchored" data-anchor-id="doing-gradient-descent-optimization-manually-training-the-network">doing gradient descent optimization manually, training the network</h2>
<p>Now we will try to change the paramters to minimize the loss, which means our prediction will be more close to the ground true.</p>
<p><strong>Forward pass</strong>, calculate the loss:</p>
<div id="6a39b17e" class="cell" data-execution_count="53">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb64" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb64-1">ypred <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [m(x) <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> x <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> xs]</span>
<span id="cb64-2">loss <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.array([(yout <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> ygt)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> ygt, yout <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">zip</span>(ys, ypred)]).<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sum</span>()</span>
<span id="cb64-3">loss</span></code></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="50">
<pre><code>Value(data=3.7846173239470486)</code></pre>
</div>
</div>
<p><strong>Backward pass</strong>, calculate the parameters:</p>
<div id="799752ef" class="cell" data-execution_count="54">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb66" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb66-1">loss.backward()</span></code></pre></div>
</details>
</div>
<p><strong>Update the parameters</strong>, change the parameters following opposite direction to reduce the loss:</p>
<div id="d46206a7" class="cell" data-execution_count="55">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb67" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb67-1"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> p <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> m.parameters():</span>
<span id="cb67-2">    p.data <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.01</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> p.grad <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># we want the p.data go on opposite direction of the loss</span></span></code></pre></div>
</details>
</div>
<p><code>0.01</code> is the learning rate!</p>
<p><strong>New loss</strong></p>
<div id="5fb4eec1" class="cell" data-execution_count="56">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb68" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb68-1">ypred <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [m(x) <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> x <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> xs]</span>
<span id="cb68-2">loss <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.array([(yout <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> ygt)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> ygt, yout <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">zip</span>(ys, ypred)]).<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sum</span>()</span>
<span id="cb68-3">loss</span></code></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="53">
<pre><code>Value(data=0.885210729994525)</code></pre>
</div>
</div>
<p>Yeah the loss decreased. In short, the process is:</p>
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">%%{init: {'theme':'dark'}}%%
flowchart LR

P1(Updated parameters) -- Forward Pass --&gt; L(Loss)
L(Loss) -- Backward Pass --&gt; P2(Parameters to update) 
P2(Parameters to update)  -- Update Pamameters --&gt; P1(Updated parameters)
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
<p><strong>Automate the training loop</strong>:</p>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>For each process, there remained a subtle bug above that we didnâ€™t flush the grads before backpropagation. Because we did not overwrite the gradients (remember the <code>+=</code>), they kept accumulated. The next action of backward and changing parameters using learning rate and grad (which produce a massive step size) become wrong! We must set the grad to zero before backward pass.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://lktuan.github.io/blog/2024-06-17-nn-z2h-p1/guilty.png" class="img-fluid figure-img"></p>
<figcaption>Common guilties when training the NN</figcaption>
</figure>
</div>
</div>
</div>
<div id="e6a7c5f1" class="cell" data-execution_count="57">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb70" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb70-1"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> k <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>):</span>
<span id="cb70-2">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># forward pass:</span></span>
<span id="cb70-3">    ypred <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [m(x) <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> x <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> xs]</span>
<span id="cb70-4">    loss <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.array([(yout <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> ygt)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> ygt, yout <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">zip</span>(ys, ypred)]).<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sum</span>()</span>
<span id="cb70-5"></span>
<span id="cb70-6">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># backward pass:</span></span>
<span id="cb70-7">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> p <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> m.parameters():</span>
<span id="cb70-8">        p.grad <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.0</span></span>
<span id="cb70-9">    loss.backward()</span>
<span id="cb70-10"></span>
<span id="cb70-11">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># update params:</span></span>
<span id="cb70-12">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> p <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> m.parameters():</span>
<span id="cb70-13">        p.data <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.01</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> p.grad</span>
<span id="cb70-14"></span>
<span id="cb70-15">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(k, loss.data)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>0 0.885210729994525
1 0.7272070306002337
2 0.6335880961402813
3 0.5694033268577418
4 0.5210728602755308
5 0.48234433619750416
6 0.4499798770914163
7 0.4221446577843293
8 0.3977190488833604
9 0.3759751713337349
10 0.3564130670665513
11 0.33867257920988014
12 0.32248348490480044
13 0.30763598643104695
14 0.29396252735650596
15 0.28132615850080067
16 0.2696128276033427
17 0.25872609733197516
18 0.2485834130081963
19 0.23911338866893608</code></pre>
</div>
</div>
<div id="69ae0b38" class="cell" data-execution_count="58">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb72" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb72-1">ypred</span></code></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="55">
<pre><code>[Value(data=0.7723855044989809),
 Value(data=-0.7666895995000865),
 Value(data=-0.7316139699290238),
 Value(data=0.7533418844066474)]</code></pre>
</div>
</div>
</section>
</section>
<section id="summary" class="level1">
<h1>Summary</h1>
<section id="summary-of-what-we-learned-how-to-go-towards-modern-neural-nets" class="level2">
<h2 class="anchored" data-anchor-id="summary-of-what-we-learned-how-to-go-towards-modern-neural-nets">summary of what we learned, how to go towards modern neural nets</h2>
<ol type="1">
<li>What are Neural Nets: they are mathematical expressions, in case of MLP it takes: (1) data as the input, and (2) weights and biases as parameters to build out expression for the forward pass followed by the loss function.</li>
<li>The loss function is kind of measure for the accuracy of predictions. The low loss implies that predicted values are matching our targets and the networks are behaving well.</li>
<li>The process of Gradient Descent is for each step, we calculate the loss (output of the nets), backwarding it to get paramters, then updating data (which we can change - weights and biases) follow the opposite side of the loss (negative grad * learning rate). Weâ€™ll get a lower loss, and backwarding again and again. This process will find the local minimum of the loss.</li>
</ol>
</section>
<section id="walkthrough-of-the-full-code-of-micrograd-on-github" class="level2">
<h2 class="anchored" data-anchor-id="walkthrough-of-the-full-code-of-micrograd-on-github">walkthrough of the full code of micrograd on github</h2>
<p>Same with which we built today:</p>
<ul>
<li>engine: Value</li>
<li>nn: Neuron, Layer, MLP, and modulize the zero grad process to class Module</li>
<li>test: sanity check - compare the backward with <code>torch</code>, also for the forward pass</li>
<li>demo: a bit complicated example with <code>sklearn</code> dataset, using batch processing when the dataset come large, the loss is slightly different - SVM max-margin loss and using of auto L2 regularization</li>
<li>learning rate decay: is a scaled as a function of number of iterations, high at begin and low at the end</li>
</ul>
</section>
<section id="real-stuff-diving-into-pytorch-finding-their-backward-pass-for-tanh" class="level2">
<h2 class="anchored" data-anchor-id="real-stuff-diving-into-pytorch-finding-their-backward-pass-for-tanh">real stuff: diving into PyTorch, finding their backward pass for <code>tanh</code></h2>
<p>These libraries unfortunately grow in size and <strong>entropy</strong>, if you just search for <code>tanh</code> itâ€™ll give you thousands of results.</p>
</section>
<section id="conclusion" class="level2">
<h2 class="anchored" data-anchor-id="conclusion">conclusion</h2>
<p>There will be follow up session yeah haha.</p>
</section>
<section id="outtakes" class="level2">
<h2 class="anchored" data-anchor-id="outtakes">outtakes :)</h2>
<p>Pytorch self-defined autograd.</p>
<p>ğŸ¤™ğŸš€ğŸ”¥</p>


<!-- -->

</section>
</section>

 ]]></description>
  <category>til</category>
  <category>python</category>
  <category>andrej karpathy</category>
  <category>nn-z2h</category>
  <category>backpropagation</category>
  <category>neural networks</category>
  <guid>https://lktuan.github.io/blog/2024-06-17-nn-z2h-p1/</guid>
  <pubDate>Sat, 15 Jun 2024 17:00:00 GMT</pubDate>
  <media:content url="https://lktuan.github.io/blog/2024-06-17-nn-z2h-p1/puppy.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>Bitcoin tour in Python</title>
  <dc:creator>Tuan Le Khac</dc:creator>
  <link>https://lktuan.github.io/blog/2024-06-10-python-bitcoin/</link>
  <description><![CDATA[ 





<p>A from-scratch implementation of Bitcoin in Python under tuturial from Andrej Karpathy.</p>
<section id="motivation" class="level1 page-columns page-full">
<h1>Motivation</h1>
<p>ÄÃ¢y lÃ  bÃ i thá»±c hÃ nh implement Bitcoin sá»­ dá»¥ng Python mÃ  tÃ´i há»c Ä‘Æ°á»£c trÃªn trang blog cá»§a Andrej Karpathy, nhÃ  Khoa há»c mÃ¡y tÃ­nh, cá»±u Director máº£ng AI cá»§a Open AI.</p>
<p><a href="https://karpathy.ai/">Andrej Karpathy</a> cho ráº±ng blockchain Ä‘ang giÃºp ná»›i rá»™ng tráº¡ng thÃ¡i cá»§a ngÃ nh cÃ´ng nghiá»‡p phÃ¡t triá»ƒn pháº§n má»m, tá»« open source thÃ nh open source plus. NghÄ©a lÃ  chÃºng ta Ä‘ang khÃ´ng chá»‰ chia sáº», cÃ´ng khai mÃ£ nguá»“n, mÃ  cÃ²n cáº£ tÃ i nguyÃªn (run time, computing machine). VÃ  vá»›i tinh tháº§n:</p>
<blockquote class="blockquote page-columns page-full">
<div class="page-columns page-full"><p>â€œwhat I cannot create I do not understandâ€ </p><div class="no-row-height column-margin column-container"><span class="margin-aside">Edit: cÃ¢u nÃ y lÃ  cá»§a <a href="https://www.quora.com/What-did-Richard-Feynman-mean-when-he-said-What-I-cannot-create-I-do-not-understand">Richard Feynman</a></span></div></div>
</blockquote>
<p>, cÃ¡ch tá»‘t nháº¥t Ä‘á»ƒ há»c nÃ³ lÃ  thá»±c hiá»‡n nÃ³. TÃ´i cÅ©ng cho lÃ  tháº¿!</p>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="1">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://lktuan.github.io/blog/2024-06-10-python-bitcoin/karpathy-podcast.jpg" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption>Andrej Karpathy trong podcast vá»›i Lex Fridman</figcaption>
</figure>
</div>
</div>
</div>
</div>
<p>Pháº¡m vi bÃ i thá»±c hÃ nh nÃ y lÃ  <strong>táº¡o, kÃ½ sá»‘, phÃ¡t hÃ nh cÃ¡c giao dá»‹ch Bitcoin thuáº§n Python, tá»« con sá»‘ 0, khÃ´ng thÆ° viá»‡n phá»¥ thuá»™c</strong>.</p>
<p>ÄÃ¢y lÃ  mÃ´i trÆ°á»ng Python cá»§a mÃ¬nh:</p>
<div id="bf86a4c0" class="cell" data-execution_count="1">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> sys</span>
<span id="cb1-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(sys.version)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>3.11.4 (tags/v3.11.4:d2340ef, Jun  7 2023, 05:45:37) [MSC v.1934 64 bit (AMD64)]</code></pre>
</div>
</div>
</section>
<section id="step-1-generating-a-crypto-identity" class="level1 page-columns page-full">
<h1>Step 1: generating a crypto identity</h1>
<p>Má»™t trong nhá»¯ng Ä‘áº·c tÃ­nh quan trá»ng nháº¥t cá»§a Bitcoin nÃ³i riÃªng vÃ  Blockchain (chuá»—i khá»‘i) nÃ³i chung lÃ  tÃ­nh báº£o máº­t. Blockchain sá»­ dá»¥ng cÃ¡c phÆ°Æ¡ng thá»©c báº£o máº­t nhÆ°: <strong>ECC</strong>, <strong>ECDH</strong> hoáº·c <strong>ECDSA</strong>, trong Ä‘Ã³ <code>EC</code> chÃ­nh lÃ  viáº¿t táº¯t cá»§a Elliptic Curve. KhÃ´ng chá»‰ trong lÄ©nh vá»±c blockchain, <code>EC</code> cÃ²n Ä‘Æ°á»£c sá»­ dá»¥ng rá»™ng rÃ£i trong báº£o máº­t <a href="https://datatracker.ietf.org/doc/html/rfc4492"><code>TLS</code></a>, <a href="https://datatracker.ietf.org/doc/html/rfc6637"><code>PGP</code></a>, <a href="https://datatracker.ietf.org/doc/html/rfc5656"><code>SSH</code></a>.</p>
<p>KhÃ¡c vá»›i cÃ¡c báº£o máº­t <strong>Ä‘á»‘i xá»©ng</strong> thÃ´ng thÆ°á»ng, ta cÃ³ má»™t key duy nháº¥t Ä‘á»ƒ mÃ£ hÃ³a vÃ  giáº£i mÃ£ ~ cÃ³ key lÃ  cÃ³ táº¥t cáº£, khÃ´ng cÃ³ key lÃ  khÃ´ng cÃ³ gÃ¬, cÃ¡c thuáº­t toÃ¡n mÃ£ hÃ³a EC lÃ  <strong>Báº¥t Ä‘á»‘i xá»©ng</strong>. Trong Ä‘Ã³, ta cÃ³ má»™t cáº·p <code>private key</code>/<code>public key</code> (khÃ³a bÃ­ máº­t vÃ  khÃ³a cÃ´ng khai). KhÃ³a bÃ­ máº­t chá»‰ lÃ  má»™t con sá»‘ ngáº«u nhiÃªn, cáº§n Ä‘Æ°á»£c chá»§ nhÃ¢n cá»§a nÃ³ <strong>giá»¯ bÃ­ máº­t hoÃ n toÃ n</strong>, vÃ­ nÃ³ lÃ  thá»© duy nháº¥t táº¡o ra Ä‘Æ°á»£c <strong>chá»¯ kÃ­</strong> cho há». KhÃ¡c vá»›i khÃ³a bÃ­ máº­t, khÃ³a cÃ´ng khai Ä‘Æ°á»£c cÃ´ng khai cho táº¥t cáº£ má»i ngÆ°á»i. <code>public key</code> Ä‘Æ°á»£c táº¡o ra bá»Ÿi <strong>phÃ©p nhÃ¢n</strong> vá»›i <code>private key</code> trong <strong>Ä‘Æ°á»ng cong Elliptic</strong>. PhÃ©p nhÃ¢n Ä‘Æ°á»ng cong Elliptic lÃ  má»™t phÃ©p toÃ¡n <strong>trap door</strong> (cá»­a láº­t), cÃ³ nghÄ©a lÃ  nÃ³ dá»… tÃ­nh theo <strong>má»™t chiá»u</strong> (phÃ©p nhÃ¢n) vÃ  khÃ´ng thá»ƒ tÃ­nh Ä‘Æ°á»£c theo chiá»u ngÆ°á»£c láº¡i (phÃ©p chia) ~ Ä‘Ã³ lÃ  lÃ½ do ta gá»i nÃ³ lÃ  mÃ£ hÃ³a báº¥t Ä‘á»‘i xá»©ng.</p>
<div class="page-columns page-full"><p>Bitcoin sá»­ dá»¥ng Há»‡ máº­t trÃªn Ä‘Æ°á»ng cong Elliptic (ECC) Ä‘á»ƒ báº£o máº­t giao dá»‹ch .</p><div class="no-row-height column-margin column-container"><span class="margin-aside">Xem thÃªm: 1. <a href="https://viblo.asia/p/gioi-thieu-ve-he-mat-tren-duong-cong-elliptic-ecc-XL6lA2PR5ek">Viblo</a>, 2. <a href="https://en.wikipedia.org/wiki/Elliptic-curve_cryptography">Wiki</a>, 3. <a href="https://mathworld.wolfram.com/EllipticCurve.html">Wolfram</a>, quÃ¡ khÃ³ cho tÃ´i táº¡i thá»i Ä‘iá»ƒm bÃ¢y giá» - nÃªn tÃ´i sáº½ táº¡m bá» qua, dÃ¹ gÃ¬ cÅ©ng cáº§n phÃ¡c tháº£o má»™t khung tranh â€œmá» má»â€ trÆ°á»›c, viá»‡c váº½ chi tiáº¿t Ä‘á»ƒ sau.</span></div></div>
<p>ÄÆ°á»ng cong <img src="https://latex.codecogs.com/png.latex?E:%20y%5E2%20=%20x%5E3%20+%20ax%20+%20b%20%5C:(mod%5C:p)"> trÃªn trÆ°á»ng há»¯u háº¡n <img src="https://latex.codecogs.com/png.latex?Z_p"> (cÅ©ng cÃ³ ngÆ°á»i gá»i lÃ  <img src="https://latex.codecogs.com/png.latex?Z/p">,<img src="https://latex.codecogs.com/png.latex?GF_(p)">,hoáº·c <img src="https://latex.codecogs.com/png.latex?F_p">, vá»›i p lÃ  sá»‘ nguyÃªn tá»‘) Ä‘Æ°á»£c xÃ¡c Ä‘á»‹nh bá»Ÿi 6 tham sá»‘ <img src="https://latex.codecogs.com/png.latex?T%20=%20(p,a,b,G,n,h)"> sau:</p>
<ul>
<li><p><img src="https://latex.codecogs.com/png.latex?p%20=%20FFFFFFFF%20FFFFFFFF%20FFFFFFFF%20FFFFFFFF%20FFFFFFFF%20FFFFFFFF%20FFFFFFFE%20FFFFFC2F"></p>
<p><img src="https://latex.codecogs.com/png.latex?=%202%5E%7B256%7D%20-%202%5E%7B32%7D%20-%202%5E9%20-%202%5E8%20-%202%5E7%20-%202%5E6%20-%202%5E4%20-%201"></p>
<p><img src="https://latex.codecogs.com/png.latex?=%202%5E%7B256%7D%20-%202%5E%7B32%7D%20-%20977"></p></li>
<li><p><img src="https://latex.codecogs.com/png.latex?a%20=%2000000000%2000000000%2000000000%2000000000%2000000000%2000000000%2000000000%2000000000"></p></li>
<li><p><img src="https://latex.codecogs.com/png.latex?b%20=%2000000000%2000000000%2000000000%2000000000%2000000000%2000000000%2000000000%2000000007"></p></li>
</ul>
<p>VÃ¬ Ä‘Æ°á»£c xÃ¡c Ä‘á»‹nh trÃªn <img src="https://latex.codecogs.com/png.latex?Z_p">, nÃªn trÃªn thá»±c táº¿ nÃ³ lÃ  má»™t Ä‘Æ°á»ng khÃ´ng liÃªn lá»¥c, vÃ  trÃ´ng sáº½ nhÆ° cÃ¡c Ä‘iá»ƒm ngáº«u nhiÃªn trÃªn má»™t biá»ƒu Ä‘á»“ phÃ¢n tÃ¡n. Äá»ƒ dá»… tÆ°á»Ÿng tÆ°á»£ng vÃ  min há»a, khi xÃ¡c Ä‘á»‹nh trÃªn trÆ°á»ng sá»‘ thá»±c, EC sáº½ trÃ´ng nhÆ° tháº¿ nÃ y:</p>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="1">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://lktuan.github.io/blog/2024-06-10-python-bitcoin/what_does_ec_look_like.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption><a href="https://bitcoin.stackexchange.com/questions/21907/what-does-the-curve-used-in-bitcoin-secp256k1-look-like">What does the curve used in Bitcoin, secp256k1, look like?</a></figcaption>
</figure>
</div>
</div>
</div>
</div>
<p>ÄÃ¢y lÃ  tÃ i liá»‡u mÃ  Andrej gá»£i Ã½ cho chÃºng ta Ä‘á»c vá» ECC: <a href="https://andrea.corbellini.name/2015/05/17/elliptic-curve-cryptography-a-gentle-introduction/">blog post</a> cá»§a Andrea Corbellini. BÃ i viáº¿t Ä‘áº§u tiÃªn cá»§a Ã´ng giá»›i thiá»‡u EC trÃªn <strong>trÆ°á»ng sá»‘ thá»±c vÃ  luáº­t nhÃ³m</strong>. Theo Ä‘Ã³, vá»›i EC Ä‘Æ°á»£c xÃ¡c Ä‘á»‹nh báº±ng <img src="https://latex.codecogs.com/png.latex?%5C%7B(x,y)%5Cin%20R%5E2%20%7C%20y%5E2%20=%20x%5E3%20+%20ax%20+%20b,%204a%5E3%20+%2027b%5E2%20%5Cneq%200%5C%7D%20%5Ccup%20%5C%7B0%5C%7D">, trong Ä‘Ã³ (<img src="https://latex.codecogs.com/png.latex?4a%5E3%20+%2027b%5E2%20%5Cneq%200"> lÃ  Ä‘á»ƒ trÃ¡nh Ä‘iá»ƒm ká»³ dá»‹ singular), cÃ¹ng vá»›i cÃ¡c tiÃªn Ä‘á» vá» phÃ©p toÃ¡n cá»™ng (<img src="https://latex.codecogs.com/png.latex?+">) Ä‘Æ°á»£c trang bá»‹ gá»“m:</p>
<ol type="1">
<li>TÃ­nh Ä‘Ã³ng (closure): náº¿u <img src="https://latex.codecogs.com/png.latex?a"> vÃ  <img src="https://latex.codecogs.com/png.latex?b"> thuá»™c <img src="https://latex.codecogs.com/png.latex?G">, thÃ¬ <img src="https://latex.codecogs.com/png.latex?a+b"> cÅ©ng thuá»™c <img src="https://latex.codecogs.com/png.latex?G">;</li>
<li>TÃ­nh káº¿t há»£p (associativity): <img src="https://latex.codecogs.com/png.latex?(a+b)+c%20=%20a%20+%20(b+c)">;</li>
<li>Sá»± tá»“n táº¡i cá»§a pháº§n tá»­ Ä‘Æ¡n vá»‹ (identity element 0): <img src="https://latex.codecogs.com/png.latex?a+0=0+a=a">;</li>
<li>TÃ­nh kháº£ nghá»‹ch (commutativity): vá»›i má»i <img src="https://latex.codecogs.com/png.latex?a">, tá»“n táº¡i <img src="https://latex.codecogs.com/png.latex?b"> sao cho <img src="https://latex.codecogs.com/png.latex?a+b=0">;</li>
</ol>
<p>Náº¿u chÃºng ta cÃ³ thÃªm tÃ­nh cháº¥t thá»© 5 sau:</p>
<ol start="5" type="1">
<li>TÃ­nh giao hoÃ¡n (commutativity): <img src="https://latex.codecogs.com/png.latex?a+b%20=%20b+a">.</li>
</ol>
<p>ThÃ¬ nhÃ³m Ä‘Ã³ Ä‘Æ°á»£c xem lÃ  má»™t nhÃ³m Abel (VÃ­ dá»¥: táº­p há»£p cÃ¡c sá»‘ nguyÃªn <img src="https://latex.codecogs.com/png.latex?Z"> lÃ  má»™t nhÃ³m - Abel).</p>
<p>Táº­p há»£p cÃ¡c Ä‘iá»ƒm trÃªn EC lÃ  má»™t nhÃ³m Abel, do Ä‘Ã³ nÃ³ cÅ©ng cÃ³ tÃ­nh cháº¥t trÃªn: cÃ³ sá»± tá»“n táº¡i cá»§a <strong>pháº§n tá»­ Ä‘Æ¡n vá»‹</strong> 0 (cÅ©ng lÃ  vÃ´ háº¡n); pháº§n tá»­ <strong>nghá»‹ch Ä‘áº£o</strong> cá»§a <img src="https://latex.codecogs.com/png.latex?P">, kÃ½ hiá»‡u <img src="https://latex.codecogs.com/png.latex?-P">, lÃ  Ä‘iá»ƒm Ä‘á»‘i xá»©ng cá»§a P qua trá»¥c hoÃ nh; <strong>phÃ©p cá»™ng</strong> Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a nhÆ° sau: vá»›i ba Ä‘iá»ƒm <img src="https://latex.codecogs.com/png.latex?P">, <img src="https://latex.codecogs.com/png.latex?Q">, <img src="https://latex.codecogs.com/png.latex?R"> khÃ¡c 0 vÃ  tháº³ng hÃ ng trÃªn EC, thÃ¬ <img src="https://latex.codecogs.com/png.latex?P%20+%20Q%20+%20R%20=%200">, báº¥t ká»ƒ thá»© tá»± cá»§a cÃ¡c Ä‘iá»ƒm - ta tháº¥y nÃ³ thá»a mÃ£n cÃ¡c tÃ­nh cháº¥t káº¿t há»£p vÃ  giao hoÃ¡n cá»§a má»™t nhÃ³m Abel!.</p>
<p><strong>PhÃ©p cá»™ng hÃ¬nh há»c vÃ  Ä‘áº¡i sá»‘</strong> vÃ  <strong>phÃ©p nhÃ¢n vÃ´ hÆ°á»›ng</strong> sáº½ Ä‘Æ°á»£c trÃ¬nh bÃ y á»Ÿ phÃ­a sau - trá»±c tiáº¿p trong khÃ´ng gian há»¯u háº¡n. Hiá»‡n táº¡i Ã¬nh chá»‰ cá»‘ gáº¯ng <strong>hÃ¬nh dung</strong> cÃ¡c tÃ­nh cháº¥t cá»§a EC thÃ´ng qua viá»‡c xem xÃ©t nÃ³ trÃªn <strong>trÆ°á»ng sá»‘ thá»±c</strong>.</p>
<p>Block code dÆ°á»›i Ä‘Ã¢y Ä‘á»‹nh nghÄ©a Ä‘Æ°á»ng cong EC. Bitcoin (hay Ethereum) sá»­ dá»¥ng má»™t Ä‘Æ°á»ng cong theo tiÃªu chuáº©n <a href="https://en.bitcoin.it/wiki/Secp256k1">secp256k1</a> do <em>Viá»‡n TiÃªu Chuáº©n vÃ  Ká»¹ Thuáº­t Quá»‘c Gia Má»¹ (NIST)</em> Ä‘áº·t ra. Vá»›i <img src="https://latex.codecogs.com/png.latex?a=0">, <img src="https://latex.codecogs.com/png.latex?b=7">, Ä‘á»‹nh nghÄ©a Ä‘Æ°á»ng cong trÃªn trÆ°á»ng <img src="https://latex.codecogs.com/png.latex?Z_p"> giá» sáº½ lÃ :</p>
<p><img src="https://latex.codecogs.com/png.latex?%5C%7B(x,y)%5Cin%20(Z_p)%5E2%20%7C%5C:%20y%5E2%20%5Cequiv%20x%5E3%20+%207%20%5C:%20(mod%20%5C:%20p)%5C%7D%20%5Ccup%20%5C%7B0%5C%7D"></p>
<div id="31b730f8" class="cell" data-execution_count="2">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># from __future__ import annotations # PEP 563: Postponed evaluation of annotations</span></span>
<span id="cb3-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># since my python version is 3.11.4 so no need to use future annotation feature </span></span>
<span id="cb3-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># which redefined since python 3.5</span></span>
<span id="cb3-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> dataclasses <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> dataclass <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># replace constructor __init__, </span></span>
<span id="cb3-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># help us to easily declare class attributes.</span></span>
<span id="cb3-6"></span>
<span id="cb3-7"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">@dataclass</span></span>
<span id="cb3-8"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">class</span> Curve:</span>
<span id="cb3-9">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""</span></span>
<span id="cb3-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    Elliptic Curve over the field of integers modulo a prime.</span></span>
<span id="cb3-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    Points on the curve satisfy y^2 = x^3 + a*x + b (mod p).</span></span>
<span id="cb3-12"></span>
<span id="cb3-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    Z_p lÃ  má»™t Táº¬P Há»¢P, khi p lÃ  sá»‘ nguyÃªn tá»‘ thÃ¬ cÃ³ thá»ƒ coi nÃ³ lÃ  má»™t TRÆ¯á»œNG </span></span>
<span id="cb3-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    https://forum.mathscope.org/archive/index.php/t-11835.html</span></span>
<span id="cb3-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    """</span></span>
<span id="cb3-16">    p: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ta nÃ³i secp256k1 cÃ³ Ä‘áº·c trÆ°ng p, Ä‘Æ°á»£c Ä‘á»‹nh trong trÆ°á»ng Z_p</span></span>
<span id="cb3-17">    a: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span></span>
<span id="cb3-18">    b: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span></span>
<span id="cb3-19"></span>
<span id="cb3-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># secp256k1 uses a = 0, b = 7, so we're dealing with the curve y^2 = x^3 + 7 (mod p)</span></span>
<span id="cb3-21">bitcoin_curve <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Curve(</span>
<span id="cb3-22">    p <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bn" style="color: #AD0000;
background-color: null;
font-style: inherit;">0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFC2F</span>,</span>
<span id="cb3-23">    a <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bn" style="color: #AD0000;
background-color: null;
font-style: inherit;">0x0000000000000000000000000000000000000000000000000000000000000000</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># a = 0</span></span>
<span id="cb3-24">    b <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bn" style="color: #AD0000;
background-color: null;
font-style: inherit;">0x0000000000000000000000000000000000000000000000000000000000000007</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># b = 7</span></span>
<span id="cb3-25">)</span></code></pre></div>
</details>
</div>
<p>ChÃºng ta chÆ°a tháº¥y phÆ°Æ¡ng trÃ¬nh cá»§a EC Ä‘Æ°á»£c thá»ƒ hiá»‡n trong class <code>Curve</code>, chÃºng ta implement nÃ³ báº±ng cÃ¡ch táº¡o má»™t class <code>Point</code>. Sau khi xÃ¡c Ä‘á»‹nh curve, ta xÃ¡c Ä‘á»‹nh generator - Ä‘iá»ƒm sinh G (lÃ  má»™t Ä‘iá»ƒm dÃ¹ng Ä‘á»ƒ khá»Ÿi táº¡o quÃ¡ trÃ¬nh â€œwalkâ€ trÃªn Ä‘Æ°á»ng cong)</p>
<div id="e9c90434" class="cell" data-execution_count="3">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb4-1"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">@dataclass</span></span>
<span id="cb4-2"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">class</span> Point:</span>
<span id="cb4-3">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">""" Sá»‘ nguyÃªn tá»a Ä‘á»™ (x,y) trÃªn Ä‘Æ°á»ng cong """</span></span>
<span id="cb4-4">    curve: Curve</span>
<span id="cb4-5">    x: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span></span>
<span id="cb4-6">    y: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span></span>
<span id="cb4-7"></span>
<span id="cb4-8">G <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Point(</span>
<span id="cb4-9">    bitcoin_curve,</span>
<span id="cb4-10">    x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bn" style="color: #AD0000;
background-color: null;
font-style: inherit;">0x79BE667EF9DCBBAC55A06295CE870B07029BFCDB2DCE28D959F2815B16F81798</span>,</span>
<span id="cb4-11">    y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bn" style="color: #AD0000;
background-color: null;
font-style: inherit;">0x483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8</span>,    </span>
<span id="cb4-12">)</span>
<span id="cb4-13"></span>
<span id="cb4-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># xÃ¡c nháº­n xem G cÃ³ náº±m trÃªn Ä‘Æ°á»ng cong hay khÃ´ng, tá»©c lÃ  y^2 = x^3 + 7 (mod p)</span></span>
<span id="cb4-15"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"G is on the curve:"</span>, (G.y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> G.x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span> bitcoin_curve.p <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb4-16"></span>
<span id="cb4-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># cÃ¡c giÃ¡ trá»‹ báº¥t ká»³ khÃ¡c Háº¦U NHÆ¯ sáº½ khÃ´ng náº±m trÃªn Ä‘Æ°á»ng cong:</span></span>
<span id="cb4-18"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> random</span>
<span id="cb4-19">random.seed(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1337</span>)</span>
<span id="cb4-20">x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> random.randrange(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, bitcoin_curve.p) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ngáº«u nhiÃªn giá»¯a 0 vÃ  p</span></span>
<span id="cb4-21">y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> random.randrange(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, bitcoin_curve.p)</span>
<span id="cb4-22"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"G is on the curve:"</span>, (y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span> bitcoin_curve.p <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>G is on the curve: True
G is on the curve: False</code></pre>
</div>
</div>
<p>Some notes to be updated here</p>
<div id="af99d5c1" class="cell" data-execution_count="4">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb6-1"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">@dataclass</span></span>
<span id="cb6-2"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">class</span> Generator:</span>
<span id="cb6-3">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""</span></span>
<span id="cb6-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    A Generator over a curve: an initial point and pre-declared order.</span></span>
<span id="cb6-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    """</span></span>
<span id="cb6-6">    G: Point <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># starting point on the curve</span></span>
<span id="cb6-7">    n: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># the order 0*G = n*G = INF (????)</span></span>
<span id="cb6-8"></span>
<span id="cb6-9">bitcoin_gen <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Generator(</span>
<span id="cb6-10">    G <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> G,</span>
<span id="cb6-11">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># the order of G is known and can be mathematically derived</span></span>
<span id="cb6-12">    n <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bn" style="color: #AD0000;
background-color: null;
font-style: inherit;">0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD0364141</span>,</span>
<span id="cb6-13">)</span></code></pre></div>
</details>
</div>
<p>NhÆ° váº­y Ä‘Ã£ Ä‘á»‹nh nghÄ©a xong ÄÆ°á»ng Cong, Äiá»ƒm sinh (<code>G</code>), vÃ  TrÃ¬nh táº¡o. Giá» ta sáº½ táº¡o <code>private key</code> (hay <code>secret key</code>) - má»™t sá»‘ nguyÃªn ngáº«u nhiÃªn thá»a <code>1&lt;= key &lt; n</code> (n Ä‘áº¡i diá»‡n cho order).</p>
<div id="b9d6501d" class="cell" data-execution_count="5">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb7-1">secret_key <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span>.from_bytes(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">b'Hi, this is Tuan'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'big'</span>) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># this is how I will do it for reproducibility</span></span>
<span id="cb7-2"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">assert</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> secret_key <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> bitcoin_gen.n</span>
<span id="cb7-3"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(secret_key)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>96250501864010348276735010787267273070</code></pre>
</div>
</div>
<p>Giá» chÃºng ta sáº½ táº¡o <code>public key</code>, chá»‰nh lÃ  cá»™ng <code>G</code> <code>private key</code> láº§n.</p>
<div id="29cce254" class="cell" data-execution_count="6">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb9-1">INF <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Point(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># special point at "infinity", kind of like a zero</span></span>
<span id="cb9-2"></span>
<span id="cb9-3"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> extended_euclidean_algorithm(a, b):</span>
<span id="cb9-4">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""</span></span>
<span id="cb9-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    Returns (gcd, x, y) s.t. a * x + b * y == gcd</span></span>
<span id="cb9-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    This function implements the extended Euclidean</span></span>
<span id="cb9-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    algorithm and runs in O(log b) in the worst case,</span></span>
<span id="cb9-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    taken from Wikipedia.</span></span>
<span id="cb9-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    """</span></span>
<span id="cb9-10">    old_r, r <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> a, b</span>
<span id="cb9-11">    old_s, s <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb9-12">    old_t, t <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb9-13">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">while</span> r <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>:</span>
<span id="cb9-14">        quotient <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> old_r <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//</span> r</span>
<span id="cb9-15">        old_r, r <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> r, old_r <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> quotient <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> r</span>
<span id="cb9-16">        old_s, s <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> s, old_s <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> quotient <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> s</span>
<span id="cb9-17">        old_t, t <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> t, old_t <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> quotient <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> t</span>
<span id="cb9-18">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> old_r, old_s, old_t</span>
<span id="cb9-19"></span>
<span id="cb9-20"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> inv(n, p):</span>
<span id="cb9-21">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">""" returns modular multiplicate inverse m s.t. (n * m) % p == 1 """</span></span>
<span id="cb9-22">    gcd, x, y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> extended_euclidean_algorithm(n, p) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># pylint: disable=unused-variable</span></span>
<span id="cb9-23">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span> p</span>
<span id="cb9-24"></span>
<span id="cb9-25"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> elliptic_curve_addition(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, other: Point) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span> Point:</span>
<span id="cb9-26">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># handle special case of P + 0 = 0 + P = 0</span></span>
<span id="cb9-27">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> INF:</span>
<span id="cb9-28">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> other</span>
<span id="cb9-29">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> other <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> INF:</span>
<span id="cb9-30">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span></span>
<span id="cb9-31">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># handle special case of P + (-P) = 0</span></span>
<span id="cb9-32">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> other.x <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">and</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> other.y:</span>
<span id="cb9-33">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> INF</span>
<span id="cb9-34">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># compute the "slope"</span></span>
<span id="cb9-35">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> other.x: <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># (self.y = other.y is guaranteed too per above check)</span></span>
<span id="cb9-36">        m <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.curve.a) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> inv(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.y, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.curve.p)</span>
<span id="cb9-37">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span>:</span>
<span id="cb9-38">        m <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> other.y) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> inv(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> other.x, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.curve.p)</span>
<span id="cb9-39">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># compute the new point</span></span>
<span id="cb9-40">    rx <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (m<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> other.x) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.curve.p</span>
<span id="cb9-41">    ry <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>(m<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>(rx <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.x) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.y)) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.curve.p</span>
<span id="cb9-42">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> Point(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.curve, rx, ry)</span>
<span id="cb9-43"></span>
<span id="cb9-44">Point.<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__add__</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> elliptic_curve_addition <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># monkey patch addition into the Point class</span></span></code></pre></div>
</details>
</div>
<p>Giá» ta sáº½ thá»­ gen má»™t sá»‘ bá»™ <code>private key</code>, <code>public key</code>:</p>
<div id="3aef3e9d" class="cell" data-execution_count="7">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb10-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># if our secret key was the integer 1, then our public key would just be G:</span></span>
<span id="cb10-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># use sk for secret key = private key</span></span>
<span id="cb10-3">sk <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb10-4">pk <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> G</span>
<span id="cb10-5"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f" secret key: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>sk<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;"> public key: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>(pk.x, pk.y)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb10-6"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Verify the public key is on the curve: "</span>, (pk.y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> pk.x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span> bitcoin_curve.p <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb10-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># if it was 2, the public key is G + G:</span></span>
<span id="cb10-8">sk <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb10-9">pk <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> G <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> G</span>
<span id="cb10-10"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f" secret key: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>sk<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;"> public key: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>(pk.x, pk.y)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb10-11"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Verify the public key is on the curve: "</span>, (pk.y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> pk.x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span> bitcoin_curve.p <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb10-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># etc.:</span></span>
<span id="cb10-13">sk <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span></span>
<span id="cb10-14">pk <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> G <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> G <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> G</span>
<span id="cb10-15"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f" secret key: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>sk<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;"> public key: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>(pk.x, pk.y)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb10-16"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Verify the public key is on the curve: "</span>, (pk.y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> pk.x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span> bitcoin_curve.p <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> secret key: 1
 public key: (55066263022277343669578718895168534326250603453777594175500187360389116729240, 32670510020758816978083085130507043184471273380659243275938904335757337482424)
Verify the public key is on the curve:  True
 secret key: 2
 public key: (89565891926547004231252920425935692360644145829622209833684329913297188986597, 12158399299693830322967808612713398636155367887041628176798871954788371653930)
Verify the public key is on the curve:  True
 secret key: 3
 public key: (112711660439710606056748659173929673102114977341539408544630613555209775888121, 25583027980570883691656905877401976406448868254816295069919888960541586679410)
Verify the public key is on the curve:  True</code></pre>
</div>
</div>
<p>ChÃºng ta cáº§n tÄƒng tá»‘c viá»‡c cá»™ng <code>G</code> vá»›i chÃ­nh nÃ³ vá»›i sá»‘ láº§n cá»±c kÃ¬ lá»›n, do Ä‘Ã³ Andrej sá»­ dá»¥ng 1 thuáº­t toÃ¡n <code>double_and_add</code> nhÆ° sau:</p>
<div id="7ea37b33" class="cell" data-execution_count="8">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb12-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> double_and_add(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, k: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span> Point:</span>
<span id="cb12-2">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">assert</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">isinstance</span>(k, <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span>) <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">and</span> k <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb12-3">    result <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> INF</span>
<span id="cb12-4">    append <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span></span>
<span id="cb12-5">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">while</span> k:</span>
<span id="cb12-6">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> k <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>:</span>
<span id="cb12-7">            result <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> append</span>
<span id="cb12-8">        append <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> append</span>
<span id="cb12-9">        k <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb12-10">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> result</span>
<span id="cb12-11"></span>
<span id="cb12-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># monkey patch double and add into the Point class for convenience</span></span>
<span id="cb12-13">Point.<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__rmul__</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> double_and_add</span>
<span id="cb12-14"></span>
<span id="cb12-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># "verify" correctness</span></span>
<span id="cb12-16"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(G <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>G)</span>
<span id="cb12-17"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(G <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> G <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>G)</span>
<span id="cb12-18"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(G <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> G <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> G <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>G)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>True
True
True</code></pre>
</div>
</div>
<p>Giá» test vá»›i <code>private_key</code> mÃ  chÃºng ta táº¡o lÃºc Ä‘áº§u:</p>
<div id="eed4d025" class="cell" data-execution_count="9">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb14-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># efficiently calculate our actual public key!</span></span>
<span id="cb14-2">public_key <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> secret_key <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> G</span>
<span id="cb14-3"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"x: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>public_key<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">y: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>public_key<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>y<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb14-4"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Verify the public key is on the curve: "</span>, (public_key.y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> public_key.x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span> bitcoin_curve.p <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>x: 95402322600731393781298762734940467224395293762704745012558525900395478371250
y: 53299222514341331201918874000650944949613849271347665849281678080211837503484
Verify the public key is on the curve:  True</code></pre>
</div>
</div>
<p><strong>ğŸš€ÄÃ£ Ä‘Æ°á»£c modulized á»Ÿ</strong> <a href=""><code>curves.py</code></a></p>
<p>Vá»›i cáº·p private/public key ta Ä‘Ã£ implement Ä‘Æ°á»£c kháº£ nÄƒng Ä‘á»‹nh danh cho Bitcoin. Giá» ta cáº§n liÃªn káº¿t nÃ³ vá»›i Ä‘á»‹a chá»‰ vÃ­. TrÆ°á»›c háº¿t ta cáº§n triá»ƒn khai má»™t sá»‘ hÃ m hash.</p>
<p>CÃ³ thá»ƒ sá»­ dá»¥ng <code>hashlib</code> cá»§a Python tuy nhiÃªn Andrej khÃ´ng muá»‘n sá»­ dá»¥ng thÆ° viá»‡n phá»¥ thuá»™c. Andrej Ä‘Ã£ viáº¿t láº¡i hai hÃ m hash mÃ  Bitcoin sá»­ dá»¥ng lÃ  <code>SHA-256</code> vÃ  <code>RIPEMD-160</code>, láº§n lÆ°á»£t dÆ°á»›i Ä‘Ã¢y, mÃ¬nh note giáº£i thÃ­ch cá»§a Andrej á»Ÿ pháº§n code comment.</p>
<p>CÃ³ láº½ sáº½ cáº§n má»™t dá»‹p khÃ¡c Ä‘á»ƒ hiá»ƒu hai hÃ m bÄƒm nÃ y, nÃ³ náº±m ngoÃ i kháº£ nÄƒng cá»§a mÃ¬nh.</p>
<div id="2ccabec9" class="cell" data-execution_count="10">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb16-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> gen_sha256_with_variable_scope_protector_to_not_pollute_global_namespace():</span>
<span id="cb16-2"></span>
<span id="cb16-3">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""</span></span>
<span id="cb16-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    SHA256 implementation.</span></span>
<span id="cb16-5"></span>
<span id="cb16-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    Follows the FIPS PUB 180-4 description for calculating SHA-256 hash function</span></span>
<span id="cb16-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.180-4.pdf</span></span>
<span id="cb16-8"></span>
<span id="cb16-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    Noone in their right mind should use this for any serious reason. This was written</span></span>
<span id="cb16-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    purely for educational purposes.</span></span>
<span id="cb16-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    """</span></span>
<span id="cb16-12"></span>
<span id="cb16-13">    <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> math</span>
<span id="cb16-14">    <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> itertools <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> count, islice</span>
<span id="cb16-15"></span>
<span id="cb16-16">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># -----------------------------------------------------------------------------</span></span>
<span id="cb16-17">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># SHA-256 Functions, defined in Section 4</span></span>
<span id="cb16-18"></span>
<span id="cb16-19">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> rotr(x, n, size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">32</span>):</span>
<span id="cb16-20">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> (x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span> n) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> (x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;&lt;</span> size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> n) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span>size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb16-21"></span>
<span id="cb16-22">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> shr(x, n):</span>
<span id="cb16-23">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span> n</span>
<span id="cb16-24"></span>
<span id="cb16-25">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> sig0(x):</span>
<span id="cb16-26">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> rotr(x, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span> rotr(x, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">18</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span> shr(x, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span>
<span id="cb16-27"></span>
<span id="cb16-28">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> sig1(x):</span>
<span id="cb16-29">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> rotr(x, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">17</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span> rotr(x, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">19</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span> shr(x, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>)</span>
<span id="cb16-30"></span>
<span id="cb16-31">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> capsig0(x):</span>
<span id="cb16-32">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> rotr(x, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span> rotr(x, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span> rotr(x, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">22</span>)</span>
<span id="cb16-33"></span>
<span id="cb16-34">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> capsig1(x):</span>
<span id="cb16-35">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> rotr(x, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span> rotr(x, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">11</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span> rotr(x, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>)</span>
<span id="cb16-36"></span>
<span id="cb16-37">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> ch(x, y, z):</span>
<span id="cb16-38">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> (x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> y)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span> (<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span>x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> z)</span>
<span id="cb16-39"></span>
<span id="cb16-40">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> maj(x, y, z):</span>
<span id="cb16-41">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> (x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> y) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span> (x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> z) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span> (y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> z)</span>
<span id="cb16-42"></span>
<span id="cb16-43">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> b2i(b):</span>
<span id="cb16-44">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span>.from_bytes(b, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'big'</span>)</span>
<span id="cb16-45"></span>
<span id="cb16-46">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> i2b(i):</span>
<span id="cb16-47">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> i.to_bytes(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'big'</span>)</span>
<span id="cb16-48"></span>
<span id="cb16-49">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># -----------------------------------------------------------------------------</span></span>
<span id="cb16-50">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># SHA-256 Constants</span></span>
<span id="cb16-51"></span>
<span id="cb16-52">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> is_prime(n):</span>
<span id="cb16-53">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">not</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">any</span>(f <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> f <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span>(math.sqrt(n))<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>f <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb16-54"></span>
<span id="cb16-55">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> first_n_primes(n):</span>
<span id="cb16-56">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> islice(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">filter</span>(is_prime, count(start<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)), n)</span>
<span id="cb16-57"></span>
<span id="cb16-58">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> frac_bin(f, n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">32</span>):</span>
<span id="cb16-59">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">""" return the first n bits of fractional part of float f """</span></span>
<span id="cb16-60">        f <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-=</span> math.floor(f) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># get only the fractional part</span></span>
<span id="cb16-61">        f <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span>n <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># shift left</span></span>
<span id="cb16-62">        f <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span>(f) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># truncate the rest of the fractional content</span></span>
<span id="cb16-63">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> f</span>
<span id="cb16-64"></span>
<span id="cb16-65">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> genK():</span>
<span id="cb16-66">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""</span></span>
<span id="cb16-67"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        Follows Section 4.2.2 to generate K</span></span>
<span id="cb16-68"></span>
<span id="cb16-69"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        The first 32 bits of the fractional parts of the cube roots of the first</span></span>
<span id="cb16-70"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        64 prime numbers:</span></span>
<span id="cb16-71"></span>
<span id="cb16-72"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        428a2f98 71374491 b5c0fbcf e9b5dba5 3956c25b 59f111f1 923f82a4 ab1c5ed5</span></span>
<span id="cb16-73"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        d807aa98 12835b01 243185be 550c7dc3 72be5d74 80deb1fe 9bdc06a7 c19bf174</span></span>
<span id="cb16-74"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        e49b69c1 efbe4786 0fc19dc6 240ca1cc 2de92c6f 4a7484aa 5cb0a9dc 76f988da</span></span>
<span id="cb16-75"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        983e5152 a831c66d b00327c8 bf597fc7 c6e00bf3 d5a79147 06ca6351 14292967</span></span>
<span id="cb16-76"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        27b70a85 2e1b2138 4d2c6dfc 53380d13 650a7354 766a0abb 81c2c92e 92722c85</span></span>
<span id="cb16-77"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        a2bfe8a1 a81a664b c24b8b70 c76c51a3 d192e819 d6990624 f40e3585 106aa070</span></span>
<span id="cb16-78"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        19a4c116 1e376c08 2748774c 34b0bcb5 391c0cb3 4ed8aa4a 5b9cca4f 682e6ff3</span></span>
<span id="cb16-79"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        748f82ee 78a5636f 84c87814 8cc70208 90befffa a4506ceb bef9a3f7 c67178f2</span></span>
<span id="cb16-80"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        """</span></span>
<span id="cb16-81">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> [frac_bin(p <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.0</span>)) <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> p <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> first_n_primes(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">64</span>)]</span>
<span id="cb16-82"></span>
<span id="cb16-83">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> genH():</span>
<span id="cb16-84">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""</span></span>
<span id="cb16-85"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        Follows Section 5.3.3 to generate the initial hash value H^0</span></span>
<span id="cb16-86"></span>
<span id="cb16-87"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        The first 32 bits of the fractional parts of the square roots of</span></span>
<span id="cb16-88"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        the first 8 prime numbers.</span></span>
<span id="cb16-89"></span>
<span id="cb16-90"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        6a09e667 bb67ae85 3c6ef372 a54ff53a 9b05688c 510e527f 1f83d9ab 5be0cd19</span></span>
<span id="cb16-91"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        """</span></span>
<span id="cb16-92">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> [frac_bin(p <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.0</span>)) <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> p <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> first_n_primes(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>)]</span>
<span id="cb16-93"></span>
<span id="cb16-94">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># -----------------------------------------------------------------------------</span></span>
<span id="cb16-95"></span>
<span id="cb16-96">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> pad(b):</span>
<span id="cb16-97">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">""" Follows Section 5.1: Padding the message """</span></span>
<span id="cb16-98">        b <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">bytearray</span>(b) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># convert to a mutable equivalent</span></span>
<span id="cb16-99">        l <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(b) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># note: len returns number of bytes not bits</span></span>
<span id="cb16-100"></span>
<span id="cb16-101">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># append but "1" to the end of the message</span></span>
<span id="cb16-102">        b.append(<span class="bn" style="color: #AD0000;
background-color: null;
font-style: inherit;">0b10000000</span>) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># appending 10000000 in binary (=128 in decimal)</span></span>
<span id="cb16-103"></span>
<span id="cb16-104">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># follow by k zero bits, where k is the smallest non-negative solution to</span></span>
<span id="cb16-105">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># l + 1 + k = 448 mod 512</span></span>
<span id="cb16-106">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># i.e. pad with zeros until we reach 448 (mod 512)</span></span>
<span id="cb16-107">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">while</span> (<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(b)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">512</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">448</span>:</span>
<span id="cb16-108">            b.append(<span class="bn" style="color: #AD0000;
background-color: null;
font-style: inherit;">0x00</span>)</span>
<span id="cb16-109"></span>
<span id="cb16-110">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># the last 64-bit block is the length l of the original message</span></span>
<span id="cb16-111">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># expressed in binary (big endian)</span></span>
<span id="cb16-112">        b.extend(l.to_bytes(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'big'</span>))</span>
<span id="cb16-113"></span>
<span id="cb16-114">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> b</span>
<span id="cb16-115"></span>
<span id="cb16-116">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> sha256(b: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">bytes</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">bytes</span>:</span>
<span id="cb16-117"></span>
<span id="cb16-118">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Section 4.2</span></span>
<span id="cb16-119">        K <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> genK()</span>
<span id="cb16-120"></span>
<span id="cb16-121">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Section 5: Preprocessing</span></span>
<span id="cb16-122">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Section 5.1: Pad the message</span></span>
<span id="cb16-123">        b <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pad(b)</span>
<span id="cb16-124">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Section 5.2: Separate the message into blocks of 512 bits (64 bytes)</span></span>
<span id="cb16-125">        blocks <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [b[i:i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">64</span>] <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(b), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">64</span>)]</span>
<span id="cb16-126"></span>
<span id="cb16-127">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># for each message block M^1 ... M^N</span></span>
<span id="cb16-128">        H <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> genH() <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Section 5.3</span></span>
<span id="cb16-129"></span>
<span id="cb16-130">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Section 6</span></span>
<span id="cb16-131">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> M <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> blocks: <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># each block is a 64-entry array of 8-bit bytes</span></span>
<span id="cb16-132"></span>
<span id="cb16-133">            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 1. Prepare the message schedule, a 64-entry array of 32-bit words</span></span>
<span id="cb16-134">            W <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb16-135">            <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> t <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">64</span>):</span>
<span id="cb16-136">                <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> t <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>:</span>
<span id="cb16-137">                    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># the first 16 words are just a copy of the block</span></span>
<span id="cb16-138">                    W.append(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">bytes</span>(M[t<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>:t<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>]))</span>
<span id="cb16-139">                <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span>:</span>
<span id="cb16-140">                    term1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> sig1(b2i(W[t<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>]))</span>
<span id="cb16-141">                    term2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> b2i(W[t<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>])</span>
<span id="cb16-142">                    term3 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> sig0(b2i(W[t<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>]))</span>
<span id="cb16-143">                    term4 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> b2i(W[t<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span>])</span>
<span id="cb16-144">                    total <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (term1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> term2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> term3 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> term4) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">32</span></span>
<span id="cb16-145">                    W.append(i2b(total))</span>
<span id="cb16-146"></span>
<span id="cb16-147">            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 2. Initialize the 8 working variables a,b,c,d,e,f,g,h with prev hash value</span></span>
<span id="cb16-148">            a, b, c, d, e, f, g, h <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> H</span>
<span id="cb16-149"></span>
<span id="cb16-150">            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 3.</span></span>
<span id="cb16-151">            <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> t <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">64</span>):</span>
<span id="cb16-152">                T1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (h <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> capsig1(e) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> ch(e, f, g) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> K[t] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> b2i(W[t])) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">32</span></span>
<span id="cb16-153">                T2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (capsig0(a) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> maj(a, b, c)) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">32</span></span>
<span id="cb16-154">                h <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> g</span>
<span id="cb16-155">                g <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> f</span>
<span id="cb16-156">                f <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> e</span>
<span id="cb16-157">                e <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (d <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> T1) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">32</span></span>
<span id="cb16-158">                d <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> c</span>
<span id="cb16-159">                c <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> b</span>
<span id="cb16-160">                b <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> a</span>
<span id="cb16-161">                a <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (T1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> T2) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">32</span></span>
<span id="cb16-162"></span>
<span id="cb16-163">            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 4. Compute the i-th intermediate hash value H^i</span></span>
<span id="cb16-164">            delta <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [a, b, c, d, e, f, g, h]</span>
<span id="cb16-165">            H <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [(i1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> i2) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">32</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> i1, i2 <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">zip</span>(H, delta)]</span>
<span id="cb16-166"></span>
<span id="cb16-167">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">b''</span>.join(i2b(i) <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> H)</span>
<span id="cb16-168"></span>
<span id="cb16-169">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> sha256</span>
<span id="cb16-170"></span>
<span id="cb16-171">sha256 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> gen_sha256_with_variable_scope_protector_to_not_pollute_global_namespace()</span>
<span id="cb16-172"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"verify empty hash:"</span>, sha256(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">b''</span>).<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">hex</span>()) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># should be e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855</span></span>
<span id="cb16-173"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(sha256(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">b'here is a random bytes message, cool right?'</span>).<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">hex</span>())</span>
<span id="cb16-174"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"number of bytes in a sha256 digest: "</span>, <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(sha256(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">b''</span>)))</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>verify empty hash: e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855
69b9779edaa573a509999cbae415d3408c30544bad09727a1d64eff353c95b89
number of bytes in a sha256 digest:  32</code></pre>
</div>
</div>
<p>HÃ m bÄƒm thá»© hai lÃ  <code>RIPEMD-160</code>:</p>
<div id="b3d4266c" class="cell" data-execution_count="11">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb18-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> gen_ripemd160_with_variable_scope_protector_to_not_pollute_global_namespace():</span>
<span id="cb18-2"></span>
<span id="cb18-3">    <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> sys</span>
<span id="cb18-4">    <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> struct</span>
<span id="cb18-5"></span>
<span id="cb18-6">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># -----------------------------------------------------------------------------</span></span>
<span id="cb18-7">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># public interface</span></span>
<span id="cb18-8"></span>
<span id="cb18-9">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> ripemd160(b: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">bytes</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">bytes</span>:</span>
<span id="cb18-10">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">""" simple wrapper for a simpler API to this hash function, just bytes to bytes """</span></span>
<span id="cb18-11">        ctx <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> RMDContext()</span>
<span id="cb18-12">        RMD160Update(ctx, b, <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(b))</span>
<span id="cb18-13">        digest <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> RMD160Final(ctx)</span>
<span id="cb18-14">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> digest</span>
<span id="cb18-15"></span>
<span id="cb18-16">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># -----------------------------------------------------------------------------</span></span>
<span id="cb18-17"></span>
<span id="cb18-18">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">class</span> RMDContext:</span>
<span id="cb18-19">        <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__init__</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>):</span>
<span id="cb18-20">            <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.state <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="bn" style="color: #AD0000;
background-color: null;
font-style: inherit;">0x67452301</span>, <span class="bn" style="color: #AD0000;
background-color: null;
font-style: inherit;">0xEFCDAB89</span>, <span class="bn" style="color: #AD0000;
background-color: null;
font-style: inherit;">0x98BADCFE</span>, <span class="bn" style="color: #AD0000;
background-color: null;
font-style: inherit;">0x10325476</span>, <span class="bn" style="color: #AD0000;
background-color: null;
font-style: inherit;">0xC3D2E1F0</span>] <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># uint32</span></span>
<span id="cb18-21">            <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.count <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># uint64</span></span>
<span id="cb18-22">            <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">buffer</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">64</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># uchar</span></span>
<span id="cb18-23"></span>
<span id="cb18-24">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> RMD160Update(ctx, inp, inplen):</span>
<span id="cb18-25">        have <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span>((ctx.count <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">64</span>)</span>
<span id="cb18-26">        inplen <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span>(inplen)</span>
<span id="cb18-27">        need <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">64</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> have</span>
<span id="cb18-28">        ctx.count <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> inplen</span>
<span id="cb18-29">        off <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb18-30">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> inplen <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span> need:</span>
<span id="cb18-31">            <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> have:</span>
<span id="cb18-32">                <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(need):</span>
<span id="cb18-33">                    ctx.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">buffer</span>[have<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>i] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> inp[i]</span>
<span id="cb18-34">                RMD160Transform(ctx.state, ctx.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">buffer</span>)</span>
<span id="cb18-35">                off <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> need</span>
<span id="cb18-36">                have <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb18-37">            <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">while</span> off <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">64</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> inplen:</span>
<span id="cb18-38">                RMD160Transform(ctx.state, inp[off:])</span>
<span id="cb18-39">                off <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">64</span></span>
<span id="cb18-40">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> off <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> inplen:</span>
<span id="cb18-41">            <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(inplen <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> off):</span>
<span id="cb18-42">                ctx.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">buffer</span>[have<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>i] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> inp[off<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>i]</span>
<span id="cb18-43"></span>
<span id="cb18-44">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> RMD160Final(ctx):</span>
<span id="cb18-45">        size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> struct.pack(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;Q"</span>, ctx.count)</span>
<span id="cb18-46">        padlen <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">64</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> ((ctx.count <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">64</span>)</span>
<span id="cb18-47">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> padlen <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>:</span>
<span id="cb18-48">            padlen <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">64</span></span>
<span id="cb18-49">        RMD160Update(ctx, PADDING, padlen<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>)</span>
<span id="cb18-50">        RMD160Update(ctx, size, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>)</span>
<span id="cb18-51">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> struct.pack(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;5L"</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>ctx.state)</span>
<span id="cb18-52"></span>
<span id="cb18-53">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># -----------------------------------------------------------------------------</span></span>
<span id="cb18-54"></span>
<span id="cb18-55">    K0 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bn" style="color: #AD0000;
background-color: null;
font-style: inherit;">0x00000000</span></span>
<span id="cb18-56">    K1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bn" style="color: #AD0000;
background-color: null;
font-style: inherit;">0x5A827999</span></span>
<span id="cb18-57">    K2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bn" style="color: #AD0000;
background-color: null;
font-style: inherit;">0x6ED9EBA1</span></span>
<span id="cb18-58">    K3 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bn" style="color: #AD0000;
background-color: null;
font-style: inherit;">0x8F1BBCDC</span></span>
<span id="cb18-59">    K4 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bn" style="color: #AD0000;
background-color: null;
font-style: inherit;">0xA953FD4E</span></span>
<span id="cb18-60">    KK0 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bn" style="color: #AD0000;
background-color: null;
font-style: inherit;">0x50A28BE6</span></span>
<span id="cb18-61">    KK1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bn" style="color: #AD0000;
background-color: null;
font-style: inherit;">0x5C4DD124</span></span>
<span id="cb18-62">    KK2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bn" style="color: #AD0000;
background-color: null;
font-style: inherit;">0x6D703EF3</span></span>
<span id="cb18-63">    KK3 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bn" style="color: #AD0000;
background-color: null;
font-style: inherit;">0x7A6D76E9</span></span>
<span id="cb18-64">    KK4 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bn" style="color: #AD0000;
background-color: null;
font-style: inherit;">0x00000000</span></span>
<span id="cb18-65"></span>
<span id="cb18-66">    PADDING <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="bn" style="color: #AD0000;
background-color: null;
font-style: inherit;">0x80</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">63</span></span>
<span id="cb18-67"></span>
<span id="cb18-68">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> ROL(n, x):</span>
<span id="cb18-69">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> ((x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;&lt;</span> n) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> <span class="bn" style="color: #AD0000;
background-color: null;
font-style: inherit;">0xffffffff</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> (x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">32</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> n))</span>
<span id="cb18-70"></span>
<span id="cb18-71">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> F0(x, y, z):</span>
<span id="cb18-72">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span> y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span> z</span>
<span id="cb18-73"></span>
<span id="cb18-74">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> F1(x, y, z):</span>
<span id="cb18-75">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> (x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> y) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> (((<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span>x) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span> <span class="bn" style="color: #AD0000;
background-color: null;
font-style: inherit;">0x100000000</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> z)</span>
<span id="cb18-76"></span>
<span id="cb18-77">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> F2(x, y, z):</span>
<span id="cb18-78">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> (x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> ((<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span>y) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span> <span class="bn" style="color: #AD0000;
background-color: null;
font-style: inherit;">0x100000000</span>)) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span> z</span>
<span id="cb18-79"></span>
<span id="cb18-80">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> F3(x, y, z):</span>
<span id="cb18-81">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> (x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> z) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> (((<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span>z) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span> <span class="bn" style="color: #AD0000;
background-color: null;
font-style: inherit;">0x100000000</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> y)</span>
<span id="cb18-82"></span>
<span id="cb18-83">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> F4(x, y, z):</span>
<span id="cb18-84">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span> (y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> ((<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span>z) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span> <span class="bn" style="color: #AD0000;
background-color: null;
font-style: inherit;">0x100000000</span>))</span>
<span id="cb18-85"></span>
<span id="cb18-86">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> R(a, b, c, d, e, Fj, Kj, sj, rj, X):</span>
<span id="cb18-87">        a <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ROL(sj, (a <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> Fj(b, c, d) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> X[rj] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> Kj) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span> <span class="bn" style="color: #AD0000;
background-color: null;
font-style: inherit;">0x100000000</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> e</span>
<span id="cb18-88">        c <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ROL(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, c)</span>
<span id="cb18-89">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> a <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span> <span class="bn" style="color: #AD0000;
background-color: null;
font-style: inherit;">0x100000000</span>, c</span>
<span id="cb18-90"></span>
<span id="cb18-91">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> RMD160Transform(state, block): <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#uint32 state[5], uchar block[64]</span></span>
<span id="cb18-92"></span>
<span id="cb18-93">        x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span></span>
<span id="cb18-94">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">assert</span> sys.byteorder <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'little'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Only little endian is supported atm for RIPEMD160"</span></span>
<span id="cb18-95">        x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> struct.unpack(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'&lt;16L'</span>, <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">bytes</span>(block[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">64</span>]))</span>
<span id="cb18-96"></span>
<span id="cb18-97">        a <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> state[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]</span>
<span id="cb18-98">        b <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> state[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span>
<span id="cb18-99">        c <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> state[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>]</span>
<span id="cb18-100">        d <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> state[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>]</span>
<span id="cb18-101">        e <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> state[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>]</span>
<span id="cb18-102"></span>
<span id="cb18-103">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#/* Round 1 */</span></span>
<span id="cb18-104">        a, c <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(a, b, c, d, e, F0, K0, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">11</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, x)</span>
<span id="cb18-105">        e, b <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(e, a, b, c, d, F0, K0, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, x)</span>
<span id="cb18-106">        d, a <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(d, e, a, b, c, F0, K0, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, x)</span>
<span id="cb18-107">        c, e <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(c, d, e, a, b, F0, K0, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, x)</span>
<span id="cb18-108">        b, d <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(b, c, d, e, a, F0, K0,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, x)</span>
<span id="cb18-109">        a, c <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(a, b, c, d, e, F0, K0,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, x)</span>
<span id="cb18-110">        e, b <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(e, a, b, c, d, F0, K0,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, x)</span>
<span id="cb18-111">        d, a <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(d, e, a, b, c, F0, K0,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>, x)</span>
<span id="cb18-112">        c, e <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(c, d, e, a, b, F0, K0, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">11</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>, x)</span>
<span id="cb18-113">        b, d <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(b, c, d, e, a, F0, K0, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>, x)</span>
<span id="cb18-114">        a, c <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(a, b, c, d, e, F0, K0, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, x)</span>
<span id="cb18-115">        e, b <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(e, a, b, c, d, F0, K0, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">11</span>, x)</span>
<span id="cb18-116">        d, a <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(d, e, a, b, c, F0, K0,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>, x)</span>
<span id="cb18-117">        c, e <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(c, d, e, a, b, F0, K0,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span>, x)</span>
<span id="cb18-118">        b, d <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(b, c, d, e, a, F0, K0,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>, x)</span>
<span id="cb18-119">        a, c <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(a, b, c, d, e, F0, K0,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>, x) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#/* #15 */</span></span>
<span id="cb18-120">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#/* Round 2 */</span></span>
<span id="cb18-121">        e, b <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(e, a, b, c, d, F1, K1,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>, x)</span>
<span id="cb18-122">        d, a <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(d, e, a, b, c, F1, K1,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, x)</span>
<span id="cb18-123">        c, e <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(c, d, e, a, b, F1, K1,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span>, x)</span>
<span id="cb18-124">        b, d <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(b, c, d, e, a, F1, K1, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, x)</span>
<span id="cb18-125">        a, c <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(a, b, c, d, e, F1, K1, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">11</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, x)</span>
<span id="cb18-126">        e, b <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(e, a, b, c, d, F1, K1,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, x)</span>
<span id="cb18-127">        d, a <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(d, e, a, b, c, F1, K1,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>, x)</span>
<span id="cb18-128">        c, e <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(c, d, e, a, b, F1, K1, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, x)</span>
<span id="cb18-129">        b, d <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(b, c, d, e, a, F1, K1,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>, x)</span>
<span id="cb18-130">        a, c <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(a, b, c, d, e, F1, K1, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, x)</span>
<span id="cb18-131">        e, b <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(e, a, b, c, d, F1, K1, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>, x)</span>
<span id="cb18-132">        d, a <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(d, e, a, b, c, F1, K1,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, x)</span>
<span id="cb18-133">        c, e <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(c, d, e, a, b, F1, K1, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">11</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, x)</span>
<span id="cb18-134">        b, d <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(b, c, d, e, a, F1, K1,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>, x)</span>
<span id="cb18-135">        a, c <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(a, b, c, d, e, F1, K1, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">11</span>, x)</span>
<span id="cb18-136">        e, b <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(e, a, b, c, d, F1, K1, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>, x) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#/* #31 */</span></span>
<span id="cb18-137">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#/* Round 3 */</span></span>
<span id="cb18-138">        d, a <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(d, e, a, b, c, F2, K2, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">11</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, x)</span>
<span id="cb18-139">        c, e <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(c, d, e, a, b, F2, K2, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, x)</span>
<span id="cb18-140">        b, d <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(b, c, d, e, a, F2, K2,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>, x)</span>
<span id="cb18-141">        a, c <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(a, b, c, d, e, F2, K2,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, x)</span>
<span id="cb18-142">        e, b <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(e, a, b, c, d, F2, K2, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>, x)</span>
<span id="cb18-143">        d, a <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(d, e, a, b, c, F2, K2,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>, x)</span>
<span id="cb18-144">        c, e <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(c, d, e, a, b, F2, K2, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>, x)</span>
<span id="cb18-145">        b, d <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(b, c, d, e, a, F2, K2, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, x)</span>
<span id="cb18-146">        a, c <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(a, b, c, d, e, F2, K2, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, x)</span>
<span id="cb18-147">        e, b <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(e, a, b, c, d, F2, K2,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>, x)</span>
<span id="cb18-148">        d, a <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(d, e, a, b, c, F2, K2, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, x)</span>
<span id="cb18-149">        c, e <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(c, d, e, a, b, F2, K2,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, x)</span>
<span id="cb18-150">        b, d <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(b, c, d, e, a, F2, K2,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span>, x)</span>
<span id="cb18-151">        a, c <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(a, b, c, d, e, F2, K2, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">11</span>, x)</span>
<span id="cb18-152">        e, b <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(e, a, b, c, d, F2, K2,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, x)</span>
<span id="cb18-153">        d, a <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(d, e, a, b, c, F2, K2,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>, x) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#/* #47 */</span></span>
<span id="cb18-154">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#/* Round 4 */</span></span>
<span id="cb18-155">        c, e <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(c, d, e, a, b, F3, K3, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">11</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, x)</span>
<span id="cb18-156">        b, d <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(b, c, d, e, a, F3, K3, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>, x)</span>
<span id="cb18-157">        a, c <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(a, b, c, d, e, F3, K3, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">11</span>, x)</span>
<span id="cb18-158">        e, b <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(e, a, b, c, d, F3, K3, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, x)</span>
<span id="cb18-159">        d, a <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(d, e, a, b, c, F3, K3, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, x)</span>
<span id="cb18-160">        c, e <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(c, d, e, a, b, F3, K3, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>, x)</span>
<span id="cb18-161">        b, d <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(b, c, d, e, a, F3, K3,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>, x)</span>
<span id="cb18-162">        a, c <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(a, b, c, d, e, F3, K3,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, x)</span>
<span id="cb18-163">        e, b <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(e, a, b, c, d, F3, K3,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span>, x)</span>
<span id="cb18-164">        d, a <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(d, e, a, b, c, F3, K3, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, x)</span>
<span id="cb18-165">        c, e <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(c, d, e, a, b, F3, K3,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>, x)</span>
<span id="cb18-166">        b, d <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(b, c, d, e, a, F3, K3,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>, x)</span>
<span id="cb18-167">        a, c <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(a, b, c, d, e, F3, K3,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>, x)</span>
<span id="cb18-168">        e, b <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(e, a, b, c, d, F3, K3,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, x)</span>
<span id="cb18-169">        d, a <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(d, e, a, b, c, F3, K3,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, x)</span>
<span id="cb18-170">        c, e <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(c, d, e, a, b, F3, K3, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, x) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#/* #63 */</span></span>
<span id="cb18-171">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#/* Round 5 */</span></span>
<span id="cb18-172">        b, d <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(b, c, d, e, a, F4, K4,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, x)</span>
<span id="cb18-173">        a, c <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(a, b, c, d, e, F4, K4, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, x)</span>
<span id="cb18-174">        e, b <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(e, a, b, c, d, F4, K4,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, x)</span>
<span id="cb18-175">        d, a <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(d, e, a, b, c, F4, K4, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">11</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>, x)</span>
<span id="cb18-176">        c, e <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(c, d, e, a, b, F4, K4,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>, x)</span>
<span id="cb18-177">        b, d <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(b, c, d, e, a, F4, K4,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>, x)</span>
<span id="cb18-178">        a, c <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(a, b, c, d, e, F4, K4, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, x)</span>
<span id="cb18-179">        e, b <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(e, a, b, c, d, F4, K4, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, x)</span>
<span id="cb18-180">        d, a <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(d, e, a, b, c, F4, K4,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>, x)</span>
<span id="cb18-181">        c, e <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(c, d, e, a, b, F4, K4, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, x)</span>
<span id="cb18-182">        b, d <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(b, c, d, e, a, F4, K4, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, x)</span>
<span id="cb18-183">        a, c <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(a, b, c, d, e, F4, K4, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>, x)</span>
<span id="cb18-184">        e, b <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(e, a, b, c, d, F4, K4, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">11</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">11</span>, x)</span>
<span id="cb18-185">        d, a <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(d, e, a, b, c, F4, K4,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, x)</span>
<span id="cb18-186">        c, e <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(c, d, e, a, b, F4, K4,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>, x)</span>
<span id="cb18-187">        b, d <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(b, c, d, e, a, F4, K4,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span>, x) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#/* #79 */</span></span>
<span id="cb18-188"></span>
<span id="cb18-189">        aa <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> a</span>
<span id="cb18-190">        bb <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> b</span>
<span id="cb18-191">        cc <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> c</span>
<span id="cb18-192">        dd <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> d</span>
<span id="cb18-193">        ee <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> e</span>
<span id="cb18-194"></span>
<span id="cb18-195">        a <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> state[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]</span>
<span id="cb18-196">        b <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> state[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span>
<span id="cb18-197">        c <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> state[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>]</span>
<span id="cb18-198">        d <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> state[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>]</span>
<span id="cb18-199">        e <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> state[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>]</span>
<span id="cb18-200"></span>
<span id="cb18-201">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#/* Parallel round 1 */</span></span>
<span id="cb18-202">        a, c <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(a, b, c, d, e, F4, KK0,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, x)</span>
<span id="cb18-203">        e, b <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(e, a, b, c, d, F4, KK0,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>, x)</span>
<span id="cb18-204">        d, a <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(d, e, a, b, c, F4, KK0,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>, x)</span>
<span id="cb18-205">        c, e <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(c, d, e, a, b, F4, KK0, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">11</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, x)</span>
<span id="cb18-206">        b, d <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(b, c, d, e, a, F4, KK0, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>, x)</span>
<span id="cb18-207">        a, c <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(a, b, c, d, e, F4, KK0, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, x)</span>
<span id="cb18-208">        e, b <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(e, a, b, c, d, F4, KK0, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">11</span>, x)</span>
<span id="cb18-209">        d, a <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(d, e, a, b, c, F4, KK0,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, x)</span>
<span id="cb18-210">        c, e <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(c, d, e, a, b, F4, KK0,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span>, x)</span>
<span id="cb18-211">        b, d <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(b, c, d, e, a, F4, KK0,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, x)</span>
<span id="cb18-212">        a, c <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(a, b, c, d, e, F4, KK0,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>, x)</span>
<span id="cb18-213">        e, b <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(e, a, b, c, d, F4, KK0, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">11</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>, x)</span>
<span id="cb18-214">        d, a <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(d, e, a, b, c, F4, KK0, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, x)</span>
<span id="cb18-215">        c, e <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(c, d, e, a, b, F4, KK0, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, x)</span>
<span id="cb18-216">        b, d <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(b, c, d, e, a, F4, KK0, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, x)</span>
<span id="cb18-217">        a, c <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(a, b, c, d, e, F4, KK0,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>, x) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#/* #15 */</span></span>
<span id="cb18-218">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#/* Parallel round 2 */</span></span>
<span id="cb18-219">        e, b <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(e, a, b, c, d, F3, KK1,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, x)</span>
<span id="cb18-220">        d, a <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(d, e, a, b, c, F3, KK1, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">11</span>, x)</span>
<span id="cb18-221">        c, e <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(c, d, e, a, b, F3, KK1, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, x)</span>
<span id="cb18-222">        b, d <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(b, c, d, e, a, F3, KK1,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>, x)</span>
<span id="cb18-223">        a, c <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(a, b, c, d, e, F3, KK1, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, x)</span>
<span id="cb18-224">        e, b <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(e, a, b, c, d, F3, KK1,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span>, x)</span>
<span id="cb18-225">        d, a <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(d, e, a, b, c, F3, KK1,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, x)</span>
<span id="cb18-226">        c, e <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(c, d, e, a, b, F3, KK1, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">11</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, x)</span>
<span id="cb18-227">        b, d <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(b, c, d, e, a, F3, KK1,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>, x)</span>
<span id="cb18-228">        a, c <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(a, b, c, d, e, F3, KK1,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>, x)</span>
<span id="cb18-229">        e, b <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(e, a, b, c, d, F3, KK1, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>, x)</span>
<span id="cb18-230">        d, a <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(d, e, a, b, c, F3, KK1,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>, x)</span>
<span id="cb18-231">        c, e <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(c, d, e, a, b, F3, KK1,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, x)</span>
<span id="cb18-232">        b, d <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(b, c, d, e, a, F3, KK1, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>, x)</span>
<span id="cb18-233">        a, c <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(a, b, c, d, e, F3, KK1, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, x)</span>
<span id="cb18-234">        e, b <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(e, a, b, c, d, F3, KK1, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">11</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, x) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#/* #31 */</span></span>
<span id="cb18-235">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#/* Parallel round 3 */</span></span>
<span id="cb18-236">        d, a <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(d, e, a, b, c, F2, KK2,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>, x)</span>
<span id="cb18-237">        c, e <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(c, d, e, a, b, F2, KK2,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, x)</span>
<span id="cb18-238">        b, d <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(b, c, d, e, a, F2, KK2, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, x)</span>
<span id="cb18-239">        a, c <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(a, b, c, d, e, F2, KK2, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">11</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, x)</span>
<span id="cb18-240">        e, b <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(e, a, b, c, d, F2, KK2,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>, x)</span>
<span id="cb18-241">        d, a <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(d, e, a, b, c, F2, KK2,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>, x)</span>
<span id="cb18-242">        c, e <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(c, d, e, a, b, F2, KK2,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, x)</span>
<span id="cb18-243">        b, d <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(b, c, d, e, a, F2, KK2, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>, x)</span>
<span id="cb18-244">        a, c <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(a, b, c, d, e, F2, KK2, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">11</span>, x)</span>
<span id="cb18-245">        e, b <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(e, a, b, c, d, F2, KK2, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>, x)</span>
<span id="cb18-246">        d, a <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(d, e, a, b, c, F2, KK2,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>, x)</span>
<span id="cb18-247">        c, e <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(c, d, e, a, b, F2, KK2, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, x)</span>
<span id="cb18-248">        b, d <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(b, c, d, e, a, F2, KK2, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, x)</span>
<span id="cb18-249">        a, c <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(a, b, c, d, e, F2, KK2, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, x)</span>
<span id="cb18-250">        e, b <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(e, a, b, c, d, F2, KK2,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, x)</span>
<span id="cb18-251">        d, a <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(d, e, a, b, c, F2, KK2,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span>, x) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#/* #47 */</span></span>
<span id="cb18-252">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#/* Parallel round 4 */</span></span>
<span id="cb18-253">        c, e <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(c, d, e, a, b, F1, KK3, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>, x)</span>
<span id="cb18-254">        b, d <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(b, c, d, e, a, F1, KK3,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, x)</span>
<span id="cb18-255">        a, c <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(a, b, c, d, e, F1, KK3,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, x)</span>
<span id="cb18-256">        e, b <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(e, a, b, c, d, F1, KK3, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">11</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, x)</span>
<span id="cb18-257">        d, a <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(d, e, a, b, c, F1, KK3, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, x)</span>
<span id="cb18-258">        c, e <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(c, d, e, a, b, F1, KK3, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">11</span>, x)</span>
<span id="cb18-259">        b, d <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(b, c, d, e, a, F1, KK3,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>, x)</span>
<span id="cb18-260">        a, c <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(a, b, c, d, e, F1, KK3, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, x)</span>
<span id="cb18-261">        e, b <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(e, a, b, c, d, F1, KK3,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, x)</span>
<span id="cb18-262">        d, a <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(d, e, a, b, c, F1, KK3,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>, x)</span>
<span id="cb18-263">        c, e <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(c, d, e, a, b, F1, KK3, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, x)</span>
<span id="cb18-264">        b, d <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(b, c, d, e, a, F1, KK3,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span>, x)</span>
<span id="cb18-265">        a, c <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(a, b, c, d, e, F1, KK3, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>, x)</span>
<span id="cb18-266">        e, b <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(e, a, b, c, d, F1, KK3,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>, x)</span>
<span id="cb18-267">        d, a <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(d, e, a, b, c, F1, KK3, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, x)</span>
<span id="cb18-268">        c, e <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(c, d, e, a, b, F1, KK3,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>, x) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#/* #63 */</span></span>
<span id="cb18-269">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#/* Parallel round 5 */</span></span>
<span id="cb18-270">        b, d <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(b, c, d, e, a, F0, KK4,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>, x)</span>
<span id="cb18-271">        a, c <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(a, b, c, d, e, F0, KK4,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>, x)</span>
<span id="cb18-272">        e, b <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(e, a, b, c, d, F0, KK4, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, x)</span>
<span id="cb18-273">        d, a <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(d, e, a, b, c, F0, KK4,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, x)</span>
<span id="cb18-274">        c, e <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(c, d, e, a, b, F0, KK4, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, x)</span>
<span id="cb18-275">        b, d <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(b, c, d, e, a, F0, KK4,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, x)</span>
<span id="cb18-276">        a, c <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(a, b, c, d, e, F0, KK4, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>, x)</span>
<span id="cb18-277">        e, b <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(e, a, b, c, d, F0, KK4,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>, x)</span>
<span id="cb18-278">        d, a <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(d, e, a, b, c, F0, KK4,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, x)</span>
<span id="cb18-279">        c, e <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(c, d, e, a, b, F0, KK4, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, x)</span>
<span id="cb18-280">        b, d <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(b, c, d, e, a, F0, KK4,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span>, x)</span>
<span id="cb18-281">        a, c <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(a, b, c, d, e, F0, KK4,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>, x)</span>
<span id="cb18-282">        e, b <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(e, a, b, c, d, F0, KK4, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, x)</span>
<span id="cb18-283">        d, a <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(d, e, a, b, c, F0, KK4, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, x)</span>
<span id="cb18-284">        c, e <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(c, d, e, a, b, F0, KK4, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">11</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>, x)</span>
<span id="cb18-285">        b, d <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> R(b, c, d, e, a, F0, KK4, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">11</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">11</span>, x) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#/* #79 */</span></span>
<span id="cb18-286"></span>
<span id="cb18-287">        t <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (state[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> cc <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> d) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span> <span class="bn" style="color: #AD0000;
background-color: null;
font-style: inherit;">0x100000000</span></span>
<span id="cb18-288">        state[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (state[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> dd <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> e) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span> <span class="bn" style="color: #AD0000;
background-color: null;
font-style: inherit;">0x100000000</span></span>
<span id="cb18-289">        state[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (state[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> ee <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> a) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span> <span class="bn" style="color: #AD0000;
background-color: null;
font-style: inherit;">0x100000000</span></span>
<span id="cb18-290">        state[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (state[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> aa <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> b) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span> <span class="bn" style="color: #AD0000;
background-color: null;
font-style: inherit;">0x100000000</span></span>
<span id="cb18-291">        state[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (state[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> bb <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> c) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span> <span class="bn" style="color: #AD0000;
background-color: null;
font-style: inherit;">0x100000000</span></span>
<span id="cb18-292">        state[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> t <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span> <span class="bn" style="color: #AD0000;
background-color: null;
font-style: inherit;">0x100000000</span></span>
<span id="cb18-293"></span>
<span id="cb18-294">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> ripemd160</span>
<span id="cb18-295"></span>
<span id="cb18-296">ripemd160 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> gen_ripemd160_with_variable_scope_protector_to_not_pollute_global_namespace()</span>
<span id="cb18-297"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(ripemd160(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">b'hello this is a test'</span>).<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">hex</span>())</span>
<span id="cb18-298"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"number of bytes in a RIPEMD-160 digest: "</span>, <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(ripemd160(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">b''</span>)))</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>f51960af7dd4813a587ab26388ddab3b28d1f7b4
number of bytes in a RIPEMD-160 digest:  20</code></pre>
</div>
</div>
<p>Ok giá» thÃ¬ cÃ³ thá»ƒ lÃ m viá»‡c vá»›i Bitcoin Address. ChÃºng ta sáº½ táº¡o má»™t class <code>PublicKet</code>, lÃ  con cá»§a <code>Point</code>, cÅ©ng lÃ  má»™t Ä‘iá»ƒm trÃªn <code>Curve</code>.</p>
<div id="504be61c" class="cell" data-execution_count="12">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb20" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb20-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">class</span> PublicKey(Point):</span>
<span id="cb20-2">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""</span></span>
<span id="cb20-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    The public key is just a Point on a Curve, but has some additional specific</span></span>
<span id="cb20-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    encoding / decoding functionality that this class implements.</span></span>
<span id="cb20-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    """</span></span>
<span id="cb20-6"></span>
<span id="cb20-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">@classmethod</span></span>
<span id="cb20-8">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> from_point(cls, pt: Point):</span>
<span id="cb20-9">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">""" promote a Point to be a PublicKey """</span></span>
<span id="cb20-10">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> cls(pt.curve, pt.x, pt.y)</span>
<span id="cb20-11"></span>
<span id="cb20-12">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> encode(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, compressed, hash160<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>):</span>
<span id="cb20-13">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">""" return the SEC bytes encoding of the public key Point """</span></span>
<span id="cb20-14">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># calculate the bytes</span></span>
<span id="cb20-15">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> compressed:</span>
<span id="cb20-16">            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># (x,y) is very redundant. Because y^2 = x^3 + 7,</span></span>
<span id="cb20-17">            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># we can just encode x, and then y = +/- sqrt(x^3 + 7),</span></span>
<span id="cb20-18">            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># so we need one more bit to encode whether it was the + or the -</span></span>
<span id="cb20-19">            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># but because this is modular arithmetic there is no +/-, instead</span></span>
<span id="cb20-20">            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># it can be shown that one y will always be even and the other odd.</span></span>
<span id="cb20-21">            prefix <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">b'</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\x02</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">b'</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\x03</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span></span>
<span id="cb20-22">            pkb <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> prefix <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.x.to_bytes(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">32</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'big'</span>)</span>
<span id="cb20-23">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span>:</span>
<span id="cb20-24">            pkb <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">b'</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\x04</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.x.to_bytes(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">32</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'big'</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.y.to_bytes(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">32</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'big'</span>)</span>
<span id="cb20-25">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># hash if desired</span></span>
<span id="cb20-26">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> ripemd160(sha256(pkb)) <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> hash160 <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span> pkb</span>
<span id="cb20-27"></span>
<span id="cb20-28">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> address(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, net: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>, compressed: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">bool</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>:</span>
<span id="cb20-29">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">""" return the associated bitcoin address for this public key as string """</span></span>
<span id="cb20-30">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># encode the public key into bytes and hash to get the payload</span></span>
<span id="cb20-31">        pkb_hash <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.encode(compressed<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>compressed, hash160<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span>
<span id="cb20-32">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># add version byte (0x00 for Main Network, or 0x6f for Test Network)</span></span>
<span id="cb20-33">        version <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'main'</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">b'</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\x00</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'test'</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">b'</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\x6f</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span>}</span>
<span id="cb20-34">        ver_pkb_hash <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> version[net] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> pkb_hash</span>
<span id="cb20-35">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># calculate the checksum</span></span>
<span id="cb20-36">        checksum <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> sha256(sha256(ver_pkb_hash))[:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>]</span>
<span id="cb20-37">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># append to form the full 25-byte binary Bitcoin Address</span></span>
<span id="cb20-38">        byte_address <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ver_pkb_hash <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> checksum</span>
<span id="cb20-39">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># finally b58 encode the result</span></span>
<span id="cb20-40">        b58check_address <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> b58encode(byte_address)</span>
<span id="cb20-41">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> b58check_address</span></code></pre></div>
</details>
</div>
<p>Step 1 not completed yet.</p>
<section id="part-1-summary-so-far" class="level2">
<h2 class="anchored" data-anchor-id="part-1-summary-so-far">Part 1: summary so far</h2>
</section>
</section>
<section id="part-2-obtaining-seed-funds-intro-to-bitcoin-under-the-hood" class="level1">
<h1>Part 2: Obtaining seed funds + intro to Bitcoin under the hood</h1>
</section>
<section id="part-3-crafting-our-transaction" class="level1">
<h1>Part 3: Crafting our transaction</h1>
</section>
<section id="digital-signature" class="level1">
<h1>Digital Signature</h1>
</section>
<section id="putting-it-all-together-one-more-consolidating-transaction" class="level1">
<h1>Putting it all together: One more consolidating transaction</h1>
</section>
<section id="resources" class="level1">
<h1>Resources</h1>
<p>Andrej Karpathyâ€™s <a href="https://karpathy.github.io/2021/06/21/blockchain/">blog post</a></p>


<!-- -->

</section>

 ]]></description>
  <category>til</category>
  <category>crypto</category>
  <category>bitcoin</category>
  <category>python</category>
  <category>andrej karpathy</category>
  <guid>https://lktuan.github.io/blog/2024-06-10-python-bitcoin/</guid>
  <pubDate>Sun, 09 Jun 2024 17:00:00 GMT</pubDate>
  <media:content url="https://lktuan.github.io/blog/2024-06-10-python-bitcoin/python_bitcoin.png" medium="image" type="image/png" height="81" width="144"/>
</item>
<item>
  <title>TIL: Xá»­ lÃ½ dynamic-ragged array trong Excel</title>
  <dc:creator>Tuan Le Khac</dc:creator>
  <link>https://lktuan.github.io/blog/2024-06-06-excel-blambda/</link>
  <description><![CDATA[ 





<section id="problem-statement" class="level1">
<h1>Problem statement</h1>
<p>TIL: HÃ´m nay mÃ¬nh thá»­ giáº£i má»™t <a href="https://www.linkedin.com/posts/owenhprice_data-analytics-sql-activity-7204129483144986624-R73I">challenge</a> cá»§a bÃ¡c <a href="https://www.linkedin.com/in/owenhprice/">Owen Price</a>. BÃ¡c lÃ  Microsoft MVP, master á»Ÿ khÃ­a cáº¡nh xá»­ lÃ­, lÃ m sáº¡ch, tháº­m chÃ­ lÃ  tá»‘i Æ°u viá»‡c xá»­ lÃ­ Ä‘Ã³ trong Excel, trang blog cá»§a bÃ¡c lÃ  <a href="https://www.flexyourdata.com/">FLEX YOUR DATA</a>, mÃ¬nh há»c Ä‘Æ°á»£c ráº¥t nhiá»u cÃ¡ch sá»­ dá»¥ng formulas, Ä‘áº·c biá»‡t lÃ  cÃ¡c hÃ m má»›i tá»« <code>LAMBDA()</code>, <code>MAP()</code>, <code>REDUCE()</code> cho Ä‘áº¿n gáº§n Ä‘Ã¢y lÃ  <strong>Python in Excel</strong>, <code>GROUPBY()</code>, <code>PIVOTBY</code>, vÃ  cÃ¡c hÃ m <code>REGEX_()</code>.</p>
<p>Ná»™i dung challenge lÃ , vá»›i <strong>má»™t pháº§n</strong> (1000 records) cá»§a bá»™ dá»¯ liá»‡u <a href="https://citibikenyc.com/system-data">Citi Bike</a>, trong Ä‘Ã³ chá»©a hai cá»™t <code>start_station_name</code>, <code>end_station_name</code>, má»—i cá»™t láº¡i chá»©a thÃ´ng tin cÃ¡c â€œstationâ€ ~ tráº¡m, liá»‡t kÃª 5 <strong>Ä‘á»‹a chá»‰</strong> cÃ¹ng sá»‘ láº§n xuáº¥t hiá»‡n vá»›i sá»‘ lÆ°á»£ng lá»›n nháº¥t!. HÃ¬nh dÆ°á»›i lÃ  10 dÃ²ng Ä‘áº§u tiÃªn cá»§a dá»¯ liá»‡u.</p>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="1">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://lktuan.github.io/blog/2024-06-06-excel-blambda/data.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption>10 dÃ²ng Ä‘áº§u tiÃªn cá»§a dá»¯ liá»‡u</figcaption>
</figure>
</div>
</div>
</div>
</div>
<p>Well lÃºc Ä‘áº§u mÃ¬nh nghÄ© nÃ³ cÅ©ng Ä‘Æ¡n giáº£n ğŸ˜‚, tháº­m chÃ­ cÅ©ng khÃ´ng hiá»ƒu táº¡i sao má»—i start hoáº·c end station láº¡i cÃ³ <em>hai station</em>, cÃ¡ch nhau bá»Ÿi kÃ½ tá»± <code>&amp;</code> (space before &amp; after). MÃ¬nh láº­p tá»©c Ä‘Æ°a ra lá»i giáº£i nhÆ° sau:</p>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode numberSource txt number-lines code-with-copy"><code class="sourceCode default"><span id="cb1-1">=LET(</span>
<span id="cb1-2">    _d, " &amp; ",</span>
<span id="cb1-3">    _all_records, TOCOL(</span>
<span id="cb1-4">        BYROW(</span>
<span id="cb1-5">            BYROW(</span>
<span id="cb1-6">                _tbl_CityBike[[start_station_name]:[end_station_name]],</span>
<span id="cb1-7">                LAMBDA(x, TEXTJOIN(_d, TRUE, x))</span>
<span id="cb1-8">            ),</span>
<span id="cb1-9">        LAMBDA(x, TEXTSPLIT(x, _d))</span>
<span id="cb1-10">        )</span>
<span id="cb1-11">    ),</span>
<span id="cb1-12">    _stations, UNIQUE(_all_records),</span>
<span id="cb1-13">    _cnt, BYROW(</span>
<span id="cb1-14">        --(_stations = TRANSPOSE(_all_records)), </span>
<span id="cb1-15">        // "--" equals to "+" will convert the boolean TRUE/FALSE to value 1/0</span>
<span id="cb1-16">        LAMBDA(x, SUM(x))</span>
<span id="cb1-17">    ),</span>
<span id="cb1-18">    TAKE(SORTBY(HSTACK(_stations, _cnt), _cnt, -1), 5, )</span>
<span id="cb1-19">)</span></code></pre></div>
<p>Káº¿t quáº£:</p>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="1">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://lktuan.github.io/blog/2024-06-06-excel-blambda/my_initial_result.png" class="img-fluid figure-img" style="width:50.0%"></p>
<figcaption>Káº¿t quáº£ Ä‘áº§u tiÃªn cá»§a mÃ¬nh</figcaption>
</figure>
</div>
</div>
</div>
</div>
<p>Äá»‘i chiáº¿u vá»›i cÃ¡c káº¿t quáº£ cá»§a nhá»¯ng ngÆ°á»i tham gia khÃ¡ch thÃ¬ nÃ³ sai! Ã tÆ°á»Ÿng cá»§a mÃ¬nh lÃ  Ä‘áº§u tiÃªn vá»›i má»—i hÃ ng, join chÃºng láº¡i vá»›i <code>&amp;</code> (<code>_d</code>), sau Ä‘Ã³ láº¡i split chÃºng ra vá»›i cÃ¹ng <code>_d</code> Ä‘Ã³, tá»« Ä‘Ã³ cÃ³ Ä‘Æ°á»£c danh sÃ¡ch occurence cá»§a táº¥t cáº£ cÃ¡c <strong>Ä‘á»‹a chá»‰</strong>. Tuy nhiÃªn mÃ¬nh nháº­n ra dá»¯ liá»‡u tráº£ vá» cho <code>_all_records</code> bá»‹ thiáº¿u sÃ³t. LÃ½ do lÃ  cÃ¡c tráº¡m (station) thÆ°á»ng lÃ  cÃ¡c giao lá»™, káº¿t há»£p tá»« hai Ä‘á»‹a chá»‰ vá»›i dáº¥u <code>&amp;</code>, tuy nhiÃªn cÃ³ má»™t sá»‘ tráº¡m láº¡i náº±m trÃªn má»™t con Ä‘Æ°á»ng. VÃ  vÃ¬ cháº¥t lÆ°á»£ng dá»¯ liá»‡u, cÅ©ng cÃ³ má»™t sá»‘ station lÃ  <code>null</code>. HÃ m <code>TOCOL()</code> lÃ  hÃ m máº£ng xá»­ lÃ­ cÃ¡c máº£ng con nháº­n Ä‘Æ°á»£c tá»« <code>BYROW(...,LAMBDA(...,TEXTSPLIT()))</code>, cÃ¡c máº£ng con nÃ y cÃ³ Ä‘á»™ dÃ i <strong>khÃ´ng Ä‘á»u</strong>, dáº«n Ä‘áº¿n <code>TOCOL()</code> chá»‰ take record Ä‘áº§u tiÃªn cá»§a má»—i máº£ng con, tráº£ vá» <code>_all_records</code> chá»‰ gá»“m <em>1000 dÃ²ng dá»¯ liá»‡u</em>.</p>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="1">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://lktuan.github.io/blog/2024-06-06-excel-blambda/special_data_points.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption>CÃ¡c Ä‘iá»ƒm dá»¯ liá»‡u Ä‘áº·c biá»‡t</figcaption>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="solution" class="level1 page-columns page-full">
<h1>Solution</h1>
<div class="page-columns page-full"><p>CÃ¡c máº£ng lá»Ÿm chá»Ÿm hay ragged/jagged array lÃ  cÃ¡c máº£ng gá»“m cÃ¡c máº£ng con cÃ³ Ä‘á»™ dÃ i khÃ´ng Ä‘á»u nhau.  Excel <strong>khÃ´ng thá»ƒ</strong> merge cÃ¡c báº£ng cÃ³ kÃ­ch cá»¡ khÃ´ng báº±ng nhau.</p><div class="no-row-height column-margin column-container"><span class="margin-aside">In computer science, a <strong>jagged array</strong>, also known as a <strong>ragged array</strong>, or <strong>irregular array</strong>, is an array of arrays of which the member arrays can be of different lengths, producing rows of jagged edges when visualized as output. In contrast, two-dimensional arrays are always rectangular, so jagged arrays should not be confused with multidimensional arrays, but the former is often used to emulate the latter. <a href="https://en.wikipedia.org/wiki/Jagged_array#:~:text=In%20computer%20science%2C%20a%20jagged,edges%20when%20visualized%20as%20output.">Wiki</a></span></div></div>
<p>Má»™t <a href="https://www.linkedin.com/feed/update/urn:li:activity:7204129483144986624?commentUrn=urn%3Ali%3Acomment%3A%28activity%3A7204129483144986624%2C7204309739827044353%29&amp;dashCommentUrn=urn%3Ali%3Afsd_comment%3A%287204309739827044353%2Curn%3Ali%3Aactivity%3A7204129483144986624%29">comment</a> Ä‘Æ°a mÃ¬nh tá»›i hÃ m <a href="https://gist.github.com/ncalm/0e72b08272ec14f411e8aaa763c0c0b5"><code>BLAMBDAÎ»()</code></a> cá»§a bÃ¡c MVP <a href="https://www.linkedin.com/in/peterbartholomew/">Peter Bartholemew</a> vÃ  <a href="https://www.linkedin.com/pulse/excel-lambda-spotlight-bisected-map-bmap%2525CE%2525BB-owen-price/">bÃ i giáº£i thÃ­ch</a> cá»§a Owen Price.</p>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="1">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://lktuan.github.io/blog/2024-06-06-excel-blambda/g4g_ragged_array.png" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption>Ragged or Jagged array, photo credit to <a href="https://www.geeksforgeeks.org/jagged-array-in-java/">Geeks for Geeks</a></figcaption>
</figure>
</div>
</div>
</div>
</div>
<p>VÃ  lá»i giáº£i Ä‘Ãºng, Ä‘Æ°á»£c dá»±a trÃªn Ã½ tÆ°á»Ÿng cá»§a <code>BLAMBDAÎ»()</code> lÃ :</p>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode numberSource txt number-lines code-with-copy"><code class="sourceCode default"><span id="cb2-1">=LET(</span>
<span id="cb2-2">    B, LAMBDA(B, v,</span>
<span id="cb2-3">        LET(</span>
<span id="cb2-4">            n, ROWS(v),</span>
<span id="cb2-5">            IF(</span>
<span id="cb2-6">                n &gt; 1,</span>
<span id="cb2-7">                VSTACK(B(B, TAKE(v, n / 2)), B(B, DROP(v, n / 2))),</span>
<span id="cb2-8">                TEXTSPLIT(TEXTJOIN(" &amp; ", , v), , " &amp; ")</span>
<span id="cb2-9">            )</span>
<span id="cb2-10">        )</span>
<span id="cb2-11">    ),</span>
<span id="cb2-12">    str, B(B, CHOOSECOLS(_tbl_CityBike, 4, 5)),</span>
<span id="cb2-13">    _u_str, UNIQUE(str),</span>
<span id="cb2-14">    _cnt, BYROW(--(_u_str = TRANSPOSE(str)), LAMBDA(x, SUM(x))),</span>
<span id="cb2-15">    TAKE(SORTBY(HSTACK(_u_str, _cnt), _cnt, -1), 5)</span>
<span id="cb2-16">)</span></code></pre></div>
<p>Náº¿u sá»­ dá»¥ng <code>GROUPBY()</code> thÃ¬ viá»‡c tÃ­nh toÃ¡n cuá»‘i cÃ¹ng sáº½ gá»n hÆ¡n, tuy nhiÃªn vÃ o thá»i Ä‘iá»ƒm viáº¿t bÃ i, hÃ m nÃ y váº«n chÆ°a Ä‘Æ°á»£c MS Ä‘Æ°a lÃªn 365 Production mÃ  chá»‰ á»Ÿ kÃªnh Insider.</p>
<p>Káº¿t quáº£ cuá»‘i cÃ¹ng:</p>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="1">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://lktuan.github.io/blog/2024-06-06-excel-blambda/final_result.png" class="img-fluid figure-img" style="width:50.0%"></p>
<figcaption>Káº¿t quáº£ Ä‘Ãºng</figcaption>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="blambdaÎ»" class="level1">
<h1><code>BLAMBDAÎ»()</code></h1>
<p>NguyÃªn vÄƒn má»¥c Ä‘Ã­ch cá»§a <code>BLAMBDAÎ»()</code> cá»§a Peter:</p>
<blockquote class="blockquote">
<p>Recursively bisects an array and applies a function to the leaf nodes. Useful for when the result of the FnÎ»(leaf) calls are not of equal length. As such, BMAPÎ» can produce ragged arrays.</p>
</blockquote>
<p>Owen cÅ©ng nháº­n xÃ©t lÃ  hÃ m nÃ y â€œmore computationally efficientâ€ so vá»›i <a href="https://gist.github.com/ncalm/ef7ed953571eec1475c291948aa2dbc3"><code>STACKER()</code></a> cá»§a á»•ng. Chi tiáº¿t vá» Ã½ tÆ°á»Ÿng hÃ m gá»‘c cÃ³ thá»ƒ tham kháº£o á»Ÿ cÃ¡c link trÃªn, giá» mÃ¬nh sáº½ tÃ¬m hiá»ƒu <code>BLAMBDAÎ»()</code> Ä‘Æ°á»£c Ã¡p dá»¥ng cho use case nÃ y.</p>
<p>Äáº§u tiÃªn <code>B()</code> (stands for Bisected) lÃ  má»™t hÃ m recursive:</p>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode numberSource txt number-lines code-with-copy"><code class="sourceCode default"><span id="cb3-1">B = LAMBDA(B, v,</span>
<span id="cb3-2">        LET(</span>
<span id="cb3-3">            n, ROWS(v),</span>
<span id="cb3-4">            IF(</span>
<span id="cb3-5">                n &gt; 1,</span>
<span id="cb3-6">                VSTACK(B(B, TAKE(v, n / 2)), B(B, DROP(v, n / 2))),</span>
<span id="cb3-7">                TEXTSPLIT(TEXTJOIN(" &amp; ", , v), , " &amp; ")</span>
<span id="cb3-8">            )</span>
<span id="cb3-9">        )</span>
<span id="cb3-10">    )</span></code></pre></div>
<p>Trong Ä‘Ã³:</p>
<ul>
<li><code>n</code> lÃ  sá»‘ dÃ²ng cá»§a <code>v</code> ~ máº£ng cáº§n tÃ­nh toÃ¡n</li>
<li>náº¿u <code>n</code> &gt; 1, tráº£ vá» káº¿t há»£p <code>VSTACK()</code> khi hÃ m <code>B()</code> Ä‘Æ°á»£c Ã¡p dá»¥ng cho hai ná»­a cá»§a máº£ng <code>v</code>, <code>TAKE()</code> sáº½ láº¥y â€œphÃ¢n ná»­aâ€ Ä‘áº§u tiÃªn, <code>DROP()</code> sáº½ bá» Ä‘i phÃ¢n ná»­a Ä‘áº§u tiÃªn ~ nghÄ©a lÃ  láº¥y phÃ¢n ná»­a thá»© 2 (lÆ°u Ã½ ráº±ng hai hÃ m nÃ y Ä‘á»u láº¥y sá»‘ nguyÃªn nhá» hÆ¡n gáº§n nháº¥t cá»§a <code>n / 2</code>, do Ä‘Ã³ khÃ´ng cáº§n láº¥y pháº§n nguyÃªn báº±ng <code>QUOTIENT(n,2)</code> nhÆ° hÃ m gá»‘c cá»§a Peter).</li>
<li>khi n = 1, nghÄ©a lÃ  vá»›i má»—i pháº§n tá»­ cá»§a máº£ng <code>v</code>, thá»±c hiá»‡n Ä‘á»™ng tÃ¡c <code>TEXTSPLIT(TEXTJOIN(...))</code> ~ trÆ°á»›c háº¿t join hai cá»™t rá»“i sau Ä‘Ã³ split.</li>
<li>hÃ m nÃ y Ä‘á»‡ quy vÃ  sáº½ <code>VSTACK()</code> táº¥t cáº£ cÃ¡c máº£ng dá»c sinh tá»« viá»‡c <code>TEXTSPLIT()</code> káº¿t quáº£ cá»§a <code>TEXTJOIN()</code> hai cá»™t trÃªn má»—i dÃ²ng cá»§a máº£ng <code>v</code>.</li>
</ul>
<p>MÃ¬nh cÅ©ng thá»­ viáº¿t láº¡i hÃ m <code>B()</code>, thay Ä‘á»•i má»™t chÃºt ~ thay vÃ¬ thá»±c hiá»‡n trÃªn 1 máº£ng 2 cá»™t mÃ¬nh cá»‘ gáº¯ng chuyá»ƒn máº£ng <code>v</code> thÃ nh má»™t cá»™t, tuy nhiÃªn chÆ°a thÃ nh cÃ´ng ğŸ˜ª <strong>(chÆ°a hiá»ƒu táº¡i sao)</strong>:</p>
<div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode numberSource txt number-lines code-with-copy"><code class="sourceCode default"><span id="cb4-1">=LET(</span>
<span id="cb4-2">    B, LAMBDA(B, v,</span>
<span id="cb4-3">        LET(</span>
<span id="cb4-4">            n, ROWS(v),</span>
<span id="cb4-5">            IF(n &gt; 1, VSTACK(B(B, TAKE(v, n / 2)), B(B, DROP(v, n / 2))), TEXTSPLIT(v, " &amp; "))</span>
<span id="cb4-6">        )</span>
<span id="cb4-7">    ),</span>
<span id="cb4-8">    _data, VSTACK(_tbl_CityBike[start_station_name], _tbl_CityBike[end_station_name]),</span>
<span id="cb4-9">    str, B(B, FILTER(_data, LEN(_data) &gt; 0)),</span>
<span id="cb4-10">    _u_str, UNIQUE(str),</span>
<span id="cb4-11">    _cnt, BYROW(--(_u_str = TRANSPOSE(str)), LAMBDA(x, SUM(x))),</span>
<span id="cb4-12">    TAKE(SORTBY(HSTACK(_u_str, _cnt), _cnt, -1), 5)</span>
<span id="cb4-13">)</span></code></pre></div>
<section id="edit-sau-khi-mÃ y-mÃ²-thÃªm-sá»­a-lá»—i-cho-giáº£i-phÃ¡p-trÃªn-mÃ¬nh-back-to-basic-vá»›i-lá»i-giáº£i-sau" class="level2">
<h2 class="anchored" data-anchor-id="edit-sau-khi-mÃ y-mÃ²-thÃªm-sá»­a-lá»—i-cho-giáº£i-phÃ¡p-trÃªn-mÃ¬nh-back-to-basic-vá»›i-lá»i-giáº£i-sau">ğŸš€ Edit: sau khi mÃ y mÃ² thÃªm sá»­a lá»—i cho giáº£i phÃ¡p trÃªn mÃ¬nh back to basic vá»›i lá»i giáº£i sau:</h2>
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode numberSource txt number-lines code-with-copy"><code class="sourceCode default"><span id="cb5-1">=LET(</span>
<span id="cb5-2">    _data, TOCOL(_tbl_CityBike[[start_station_name]:[end_station_name]], 3),</span>
<span id="cb5-3">    _str, DROP(REDUCE("", _data, LAMBDA(a, x, VSTACK(a, TEXTSPLIT(x, , " &amp; ")))), 1),</span>
<span id="cb5-4">    _u_str, UNIQUE(_str),</span>
<span id="cb5-5">    _cnt, BYROW(--(_u_str = TRANSPOSE(_str)), LAMBDA(x, SUM(x))),</span>
<span id="cb5-6">    TAKE(SORTBY(HSTACK(_u_str, _cnt), _cnt, -1), 5)</span>
<span id="cb5-7">)</span></code></pre></div>
<p>Táº¥t nhiÃªn tá»‘c Ä‘á»™ xá»­ lÃ­ sáº½ cháº­m hÆ¡n <code>BLAMBDAÎ»()</code> - O_log(n), giáº£i phÃ¡p nÃ y duyá»‡t qua tá»«ng pháº§n tá»­, nÃªn BigO lÃ  O(n)</p>
<p>Thanks Peter &amp; Owen for this great use of recursion presented in such a concise manner.</p>


<!-- -->

</section>
</section>

 ]]></description>
  <category>excel</category>
  <category>lambda</category>
  <category>til</category>
  <guid>https://lktuan.github.io/blog/2024-06-06-excel-blambda/</guid>
  <pubDate>Wed, 05 Jun 2024 17:00:00 GMT</pubDate>
  <media:content url="https://lktuan.github.io/blog/2024-06-06-excel-blambda/excel-lambda.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>Vá» quy Æ°á»›c Ä‘áº·t tÃªn dá»¯ liá»‡u</title>
  <dc:creator>Tuan Le Khac</dc:creator>
  <link>https://lktuan.github.io/blog/2024-06-05-cnac/</link>
  <description><![CDATA[ 





<div class="callout callout-style-default callout-note callout-titled" name="Edit">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>CÃ¡c báº¡n cÅ©ng cÃ³ thá»ƒ xem thÃªm slide vá» dbtplyr cá»§a Emily trong posit::conf á»Ÿ <a href="https://www.emilyriederer.com/talk/dbtplyr/">Ä‘Ã¢y</a>.</p>
</div>
</div>
<hr>
<p>ÄÃ¢y lÃ  keynote tá»« article <a href="https://emilyriederer.netlify.app/post/column-name-contracts/">Column Names as Contracts</a> cá»§a <a href="https://emilyriederer.netlify.app/about">Emily Riederer</a>.</p>
<p>CÃ¡c sáº£n pháº©m pháº§n má»m luÃ´n tuÃ¢n theo má»™t quy Æ°á»›c nháº¥t Ä‘á»‹nh (vá» hÃ¬nh áº£nh, kÃ½ tá»±) nháº±m Ä‘á»ƒ ngÆ°á»i dÃ¹ng cÃ³ thá»ƒ ngay láº­p tá»©c náº¯m báº¯t Ä‘Æ°á»£c cÃ¡ch thá»©c sá»­ dá»¥ng, giao tiáº¿p vá»›i nÃ³. VÃ­ dá»¥, nÃºt Home thÆ°á»ng sáº½ Ä‘Æ°a ngÆ°á»i dÃ¹ng vá» trang chá»§ cá»§a má»™t mobile app, nÃºt â€œblogâ€ trÃªn blog cá»§a tÃ´i sáº½ Ä‘Æ°a cÃ¡c báº¡n tiáº¿p cáº­n danh má»¥c bÃ i viáº¿t, etc. á» layer phÃ­a sau, cÃ¡c API Ä‘Æ°á»£c BE viáº¿t cáº§n tuÃ¢n thá»§ documented inputs &amp; outputs, Ä‘á»ƒ cÃ¡c BE khÃ¡c hay FE cÃ³ thá»ƒ sá»­ dá»¥ng.</p>
<p>Tuy nhiÃªn cÃ¡c báº£ng dá»¯ liá»‡u láº¡i náº±m á»Ÿ má»™t vÃ¹ng mÃ u xÃ¡m khÃ´ng rÃµ rÃ ng. Data service (tá»« producer i.e DE -&gt; user i.e DA, DS) Ä‘á»§ tÄ©nh Ä‘á»ƒ khÃ´ng Ä‘Æ°á»£c xem lÃ  normal service, nhÆ°ng cÅ©ng Ä‘á»§ thÃ´ Ä‘á»ƒ ngÆ°á»i ta Ã­t chÃº Ã½ Ä‘áº¿n nÃ³ vá» máº·t giao diá»‡n. DE cá»© thá»ƒ láº¥y háº¿t má»i dá»¯ liá»‡u trong há»‡ thá»‘ng, DA nhÃ¬n dá»¯ liá»‡u vÃ  ngay láº­p tá»©c giáº£ Ä‘á»‹nh Ä‘Æ°á»£c ná»™i dung cá»§a (cá»™t) dá»¯ liá»‡u Ä‘Ã³.</p>
<blockquote class="blockquote">
<p>Producers wonder why consumers arenâ€™t satisfied, and consumers wonder why the data is never â€œrightâ€.</p>
</blockquote>
<p>CÅ©ng cÃ³ má»™t cÃ¡ch Ä‘Æ°á»£c nhiá»u tá»• chá»©c sá»­ dá»¥ng nhÆ° lÃ  Metadata managament, nhÆ°:</p>
<ul>
<li>Lyftâ€™s <a href="https://eng.lyft.com/amundsen-lyfts-data-discovery-metadata-engine-62d27254fbb9">Amundsen</a></li>
<li>LinkedInâ€™s <a href="https://www.linkedin.com/blog/engineering/archive/data-hub">DataHub</a></li>
<li>Netflixâ€™s <a href="https://netflixtechblog.com/building-and-scaling-data-lineage-at-netflix-to-improve-data-infrastructure-reliability-and-1a52526a7977">Metacat</a></li>
</ul>
<p>Tuy nhiÃªn giáº£i phÃ¡p nÃ y lÃ  documentation oriented, producer vÃ  user Ä‘á»u pháº£i tuÃ¢n thá»§ nghiÃªm ngáº·t. NÃ³ khÃ´ng <em>trá»±c diá»‡n</em> khi DE Ä‘áº·t tÃªn cá»™t, hay DA Ä‘á»c dá»¯ liá»‡u.</p>
<p>Ã tÆ°á»Ÿng cá»§a Emily lÃ  chuáº©n hÃ³a cÃ¡c quy Æ°á»›c Ä‘áº·t tÃªn dá»¯ liá»‡u báº±ng <a href="https://en.wikipedia.org/wiki/Controlled_vocabulary">Controlled vocabulary</a>. Minh há»a báº±ng <code>pointblank</code>, <code>collapsibleTree</code>, vÃ  <code>dplyr</code>.</p>
<section id="controlled-vocabulary" class="level1">
<h1>Controlled Vocabulary</h1>
<p>CV lÃ  phÆ°Æ¡ng phÃ¡p sá»­ dá»¥ng má»™t táº­p há»£p cÃ¡c tá»«, cá»¥m tá»«, tá»« viáº¿t táº¯t Ä‘á»ƒ kÃ½ hiá»‡u thÃ´ng tin. Quy Æ°á»›c nÃ y cáº§n Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a Ä‘á» phÃ¹ há»£p cho tÃ­nh cháº¥t bá»™ dá»¯ liá»‡u, vÃ  cÅ©ng Ä‘á»§ Ä‘Æ¡n giáº£n Ä‘á»ƒ ngÆ°á»i táº¡o dá»¯ liá»‡u, ngÆ°á»i sá»­ dá»¥ng dá»¯ liá»‡u sá»­ dá»¥ng.</p>
<p>VÃ­ dá»¥, 1 á»©ng dá»¥ng booking.</p>
<section id="level-1-kiá»ƒu-dá»¯-liá»‡u-kiá»ƒu-Ä‘o-lÆ°á»ng" class="level2">
<h2 class="anchored" data-anchor-id="level-1-kiá»ƒu-dá»¯-liá»‡u-kiá»ƒu-Ä‘o-lÆ°á»ng">Level 1: Kiá»ƒu dá»¯ liá»‡u, kiá»ƒu Ä‘o lÆ°á»ng</h2>
<ul>
<li><code>ID</code>: chá»‰ Ä‘á»‘i tÆ°á»£ng, dáº¡ng numberic, tá»‘i Æ°u cho viá»‡c lÆ°u trá»¯ vÃ  thÆ°á»ng lÃ m khÃ³a chÃ­nh cÃ¡c báº£ngâ€™</li>
<li><code>IND</code>: giÃ¡ trá»‹ boolean 0/1, tÃ´i thÃ¬ thÆ°á»ng sá»­ dá»¥ng cÃ¡c tá»« nhÆ° <code>IS</code>, <code>FLAG</code>;</li>
<li><code>N</code>: chá»‰ cÃ¡c dáº¡ng thÃ´ng tin <em>cÃ³ thá»ƒ Ä‘áº¿m (count)</em> Ä‘Æ°á»£c;</li>
<li><code>AMT</code>: chá»‰ cÃ¡c dáº¡ng thÃ´ng tin cÃ³ thá»ƒ tá»•ng, thÆ°á»ng Ä‘á» cáº­p Ä‘áº¿n <em>currency</em>;</li>
<li><code>VAL</code>: cÅ©ng lÃ  sá»‘ nhÆ°ng khÃ´ng thá»ƒ tá»•ng Ä‘Æ°á»£c (khÃ´ng cÃ³ Ã½ nghÄ©a), vÃ­ dá»¥ nhÆ° <em>kinh Ä‘á»™</em>, <em>vÄ© Ä‘á»™</em>;</li>
<li><code>DT</code>: ngÃ y;</li>
<li><code>TM</code>: giá» hoáº·c ngÃ y giá»;</li>
<li><code>CAT</code>: category</li>
</ul>
<p>CÅ©ng tÃ¹y vÃ o dá»¯ liá»‡u, cÃ³ thá»ƒ thÃªm cÃ¡c cá»¥m tá»« nháº¥t Ä‘á»‹nh Ä‘á» Ä‘á» cáº­p Ä‘áº¿n thÃ´ng tin dá»¯ liá»‡u Ä‘Ã³ mang láº¡i, vÃ­ dá»¥ <code>ADD</code> cho address.</p>
</section>
<section id="level-2-Ä‘á»‘i-tÆ°á»£ng-chá»§-Ä‘á»" class="level2">
<h2 class="anchored" data-anchor-id="level-2-Ä‘á»‘i-tÆ°á»£ng-chá»§-Ä‘á»">Level 2: Äá»‘i tÆ°á»£ng, chá»§ Ä‘á»</h2>
<p>Má»‘i quan tÃ¢m cá»§a ngÆ°á»i dÃ¹ng dá»¯ liá»‡u cÅ©ng giá»‘ng nhÆ° nhÃ  quáº£n trá»‹, xung quanh cÃ¡c Ä‘á»‘i tÆ°á»£ng cá»§a business: <code>USER</code>, <code>TRANSACTION</code>, etc.</p>
<p>Äá»‘i vá»›i á»©ng dá»¥ng Ä‘áº·t xe, cÃ¡c chá»§ thá»ƒ cÃ³ thá»ƒ cáº§n quan tÃ¢m lÃ  <code>TRIP</code>, <code>TRAVELER</code>, <code>ACCOMODATION</code>, <code>TRANSPORTATION</code>, etc.</p>
</section>
<section id="level-3-n-chi-tiáº¿t" class="level2">
<h2 class="anchored" data-anchor-id="level-3-n-chi-tiáº¿t">Level 3-n: Chi tiáº¿t</h2>
<p>Hai táº§ng trÃªn vá» cÆ¡ báº£n Ä‘Ã£ cho phÃ©p chÃºng ta mÃ´ táº£ Ä‘Æ°á»£c cá»™t thÃ´ng tin, chÃºng Ä‘á»u thá»ƒ hiá»‡n Ä‘Æ°á»£c thuá»™c tÃ­nh cá»§a chá»§ thá»ƒ. VÃ­ dá»¥:</p>
<ul>
<li><code>AMT_TRIP</code>: giÃ¡ trá»‹ deal cá»§a Trip;</li>
<li><code>ADD_DESTINATION</code>: Äiá»ƒm Ä‘áº¿n cá»§a trip.</li>
</ul>
<p>Tuy nhiÃªn tÃ¹y vÃ o tá»«ng use case, chÃºng ta hoÃ n toÃ n cÃ³ thá»ƒ má»Ÿ rá»™ng Ä‘Æ°á»£c vá» cáº£ hai phÃ­a. VÃ­ dá»¥:</p>
<ul>
<li>Vá» phÃ­a trÆ°á»›c: khi lÃ m viá»‡c vá»›i nhiá»u layer dá»¯ liá»‡u, ta cÃ³ thá»ƒ dÃ¹ng <code>RAW</code>, <code>STAGING</code>, <code>DW</code>, <code>DL</code>, <code>DM</code>, etc<br>
</li>
<li>Vá» phÃ­a sau: <code>DAY</code> hoáº·c <code>MONTH</code> cho <code>N_DURATION</code>, <code>VND</code> hoáº·c <code>USD</code> cho currency <code>AMT</code>.</li>
</ul>
<p>Miá»…n lÃ  cÃ³ má»™t quy chuáº©n, vÃ  nÃ³ Ä‘á»§ Ä‘Æ¡n giáº£n Ä‘á»ƒ sá»­ dá»¥ng.</p>
</section>
<section id="káº¿t-há»£p-chÃºng-láº¡i" class="level2">
<h2 class="anchored" data-anchor-id="káº¿t-há»£p-chÃºng-láº¡i">Káº¿t há»£p chÃºng láº¡i</h2>
<p>Táº¥t nhiÃªn rÃ ng buá»™c viá»‡c Ä‘áº·t tÃªn nhÆ° váº­y khÃ´ng chá»‰ Ä‘á»ƒ trang trÃ­, nÃ³ sáº½ giÃºp chÃºng ta tá»± Ä‘á»™ng hÃ³a quy trÃ¬nh kiá»ƒm soÃ¡t cháº¥t lÆ°á»£ng dá»¯ liá»‡u, .</p>
<p>TÃ´i sá»­ dá»¥ng <a href="https://www.kaggle.com/datasets/rkiattisak/traveler-trip-data">bá»™ dá»¯ liá»‡u</a> nÃ y Ä‘á»ƒ thá»±c hÃ nh (cá»™t dá»¯ liá»‡u Ä‘Ã£ Ä‘Æ°á»£c Ä‘á»•i tÃªn).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(trip_data)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 Ã— 13
  ID_TRIP CAT_DESTINATION_CITY DT_START  DT_END N_DURATION_DAY CAT_TRAVELER_NAME
    &lt;dbl&gt; &lt;chr&gt;                &lt;chr&gt;     &lt;chr&gt;           &lt;dbl&gt; &lt;chr&gt;            
1       1 London, UK           5/1/2023  5/8/2â€¦              7 John Smith       
2       2 Phuket, Thailand     6/15/2023 6/20/â€¦              5 Jane Doe         
3       3 Bali, Indonesia      7/1/2023  7/8/2â€¦              7 David Lee        
4       4 New York, USA        8/15/2023 8/29/â€¦             14 Sarah Johnson    
5       5 Tokyo, Japan         9/10/2023 9/17/â€¦              7 Kim Nguyen       
6       6 Paris, France        10/5/2023 10/10â€¦              5 Michael Brown    
# â„¹ 7 more variables: VAL_AGE_TRAVELER &lt;dbl&gt;, IND_GENDER_TRAVELER &lt;chr&gt;,
#   CAT_TRAVELER_NATIONALITY &lt;chr&gt;, CAT_ACCOMMODATION_TYPE &lt;chr&gt;,
#   AMT_ACCOMMODATION_COST &lt;chr&gt;, CAT_TRANSPORTATION_TYPE &lt;chr&gt;,
#   AMT_TRANSPORTATION_COST &lt;chr&gt;</code></pre>
</div>
</div>
</section>
</section>
<section id="data-validation" class="level1 page-columns page-full">
<h1>Data Validation</h1>
<p>Sá»­ dá»¥ng <code>pointblank</code> cá»§a R Ä‘á»ƒ kiáº¿m tra má»™t sá»‘ tÃ­nh cháº¥t cá»§a dá»¯ liá»‡u:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(pointblank)</span>
<span id="cb3-2"></span>
<span id="cb3-3">agent <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span></span>
<span id="cb3-4">  trip_data  <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb3-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">create_agent</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">actions =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">action_levels</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">stop_at =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.001</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb3-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">col_vals_gte</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">starts_with</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"N"</span>), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># check if cols start with N is GTE 0 or not</span></span>
<span id="cb3-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">col_vals_gte</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">starts_with</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"VAL"</span>), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># check if cols start with VAL is GTE 0 or not</span></span>
<span id="cb3-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">col_vals_not_null</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">starts_with</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"IND"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># check if cols start with IND contain Null or not</span></span>
<span id="cb3-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">col_vals_in_set</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">starts_with</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"IND"</span>), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Male"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Female"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># validate the value of only column started with IND - Gender</span></span>
<span id="cb3-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">col_is_date</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">starts_with</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"DT"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># check validation of date columns</span></span>
<span id="cb3-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">interrogate</span>()</span></code></pre></div>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<p>Note: To type <code>pipe</code> operator in VS Code, use this in the <code>keybindings.json</code> file:</p>
<div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode numberSource json number-lines code-with-copy"><code class="sourceCode json"><span id="cb4-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb4-2">  <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"key"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Ctrl+Shift+m"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">,</span>             </span>
<span id="cb4-3">  <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"command"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"type"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">,</span> </span>
<span id="cb4-4">  <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"args"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">{</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"text"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" %&gt;% "</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">},</span></span>
<span id="cb4-5">  <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"when"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"editorTextFocus </span></span>
<span id="cb4-6"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">            &amp;&amp; !editorHasSelection </span></span>
<span id="cb4-7"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">            &amp;&amp; editorLangId </span></span>
<span id="cb4-8"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">            == 'quarto'"</span> </span>
<span id="cb4-9"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">}</span></span></code></pre></div>
<p>Then you can get the <code>pipe</code> when type <code>Ctrl + Shift + M</code>.</p>
</div></div><div class="cell">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1">agent</span></code></pre></div>
<div class="cell-output-display">
<div>
<div id="pb_agent" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>@import url("https://fonts.googleapis.com/css2?family=IBM+Plex+Sans:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://unpkg.com/balloon-css/balloon.min.css");
#pb_agent table {
  font-family: 'IBM Plex Sans', system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#pb_agent thead, #pb_agent tbody, #pb_agent tfoot, #pb_agent tr, #pb_agent td, #pb_agent th {
  border-style: none;
}

#pb_agent p {
  margin: 0;
  padding: 0;
}

#pb_agent .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 90%;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#pb_agent .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#pb_agent .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#pb_agent .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#pb_agent .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#pb_agent .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#pb_agent .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#pb_agent .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#pb_agent .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#pb_agent .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#pb_agent .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#pb_agent .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#pb_agent .gt_spanner_row {
  border-bottom-style: hidden;
}

#pb_agent .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#pb_agent .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#pb_agent .gt_from_md > :first-child {
  margin-top: 0;
}

#pb_agent .gt_from_md > :last-child {
  margin-bottom: 0;
}

#pb_agent .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#pb_agent .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#pb_agent .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#pb_agent .gt_row_group_first td {
  border-top-width: 2px;
}

#pb_agent .gt_row_group_first th {
  border-top-width: 2px;
}

#pb_agent .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#pb_agent .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#pb_agent .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#pb_agent .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#pb_agent .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#pb_agent .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#pb_agent .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#pb_agent .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#pb_agent .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#pb_agent .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#pb_agent .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#pb_agent .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#pb_agent .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#pb_agent .gt_left {
  text-align: left;
}

#pb_agent .gt_center {
  text-align: center;
}

#pb_agent .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#pb_agent .gt_font_normal {
  font-weight: normal;
}

#pb_agent .gt_font_bold {
  font-weight: bold;
}

#pb_agent .gt_font_italic {
  font-style: italic;
}

#pb_agent .gt_super {
  font-size: 65%;
}

#pb_agent .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#pb_agent .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#pb_agent .gt_indent_1 {
  text-indent: 5px;
}

#pb_agent .gt_indent_2 {
  text-indent: 10px;
}

#pb_agent .gt_indent_3 {
  text-indent: 15px;
}

#pb_agent .gt_indent_4 {
  text-indent: 20px;
}

#pb_agent .gt_indent_5 {
  text-indent: 25px;
}

#pb_agent {
  -webkit-font-smoothing: antialiased;
}

#pb_agent .gt_row {
  overflow: visible;
}

#pb_agent .gt_sourcenote {
  height: 35px;
  padding: 0;
}

#pb_agent code {
  font-family: 'IBM Plex Mono', monospace, courier;
  color: black;
  background-color: transparent;
  padding: 0;
}
</style>

<table class="gt_table table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_heading">
<th colspan="14" class="gt_heading gt_title gt_font_normal" style="text-align: left; color: #444444; font-size: 28px; font-weight: 500;">Pointblank Validation</th>
</tr>
<tr class="odd gt_heading">
<th colspan="14" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border" style="text-align: left; font-size: 12px;"><span style="text-decoration-style:solid;text-decoration-color:#ADD8E6;text-decoration-line:underline;text-underline-position:under;color:#333333;font-variant-numeric:tabular-nums;padding-left:4px;margin-right:5px;padding-right:2px;">[2024-07-04|09:52:39]</span>
<p></p>
<div style="height:25px;padding-top:10px;">
<span style="background-color: #F1D35A;color: #222222;padding: 0.5em 0.5em;position: inherit;text-transform: uppercase;margin: 5px 1px 5px 4px;font-weight: bold;border: solid 1px #F1D35A;padding: 2px 10px 2px 10px;font-size: smaller;">tibble</span><span style="background-color:#E5AB00;color:white;padding:0.5em 0.5em;position:inherit;text-transform:uppercase;margin:5px 0px 5px 5px;font-weight:bold;border:solid 1px #E5AB00;padding:2px 15px 2px 15px;font-size:smaller;">WARN</span> <span style="background-color:none;color:#333333;padding:0.5em 0.5em;position:inherit;margin:5px 0px 5px -4px;font-weight:bold;border:solid 1px #E5AB00;padding:2px 15px 2px 15px;font-size:smaller;">â€”</span> <span style="background-color:#D0182F;color:white;padding:0.5em 0.5em;position:inherit;text-transform:uppercase;margin:5px 0px 5px 1px;font-weight:bold;border:solid 1px #D0182F;padding:2px 15px 2px 15px;font-size:smaller;">STOP</span> <span style="background-color:none;color:#333333;padding:0.5em 0.5em;position:inherit;margin:5px 0px 5px -4px;font-weight:bold;border:solid 1px #D0182F;padding:2px 15px 2px 15px;font-size:smaller;">0.00</span> <span style="background-color:#499FFE;color:white;padding:0.5em 0.5em;position:inherit;text-transform:uppercase;margin:5px 0px 5px 1px;font-weight:bold;border:solid 1px #499FFE;padding:2px 15px 2px 15px;font-size:smaller;">NOTIFY</span> <span style="background-color:none;color:#333333;padding:0.5em 0.5em;position:inherit;margin:5px 0px 5px -4px;font-weight:bold;border:solid 1px #499FFE;padding:2px 15px 2px 15px;font-size:smaller;">â€”</span>
</div></th>
</tr>
<tr class="header gt_col_headings">
<th class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" style="color: #666666; font-weight: bold" scope="col"></th>
<th class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" style="color: #666666; font-weight: bold" scope="col"></th>
<th id="STEP" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" style="color: #666666; font-weight: bold" scope="col">STEP</th>
<th id="COLUMNS" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" style="color: #666666; font-weight: bold" scope="col">COLUMNS</th>
<th id="VALUES" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" style="color: #666666; font-weight: bold" scope="col">VALUES</th>
<th id="TBL" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" style="color: #666666; font-weight: bold" scope="col">TBL</th>
<th id="EVAL" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" style="color: #666666; font-weight: bold" scope="col">EVAL</th>
<th id="UNITS" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" style="color: #666666; font-weight: bold" scope="col">UNITS</th>
<th id="PASS" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" style="color: #666666; font-weight: bold" scope="col">PASS</th>
<th id="FAIL" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" style="color: #666666; font-weight: bold" scope="col">FAIL</th>
<th id="W" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" style="color: #666666; font-weight: bold" scope="col">W</th>
<th id="S" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" style="color: #666666; font-weight: bold" scope="col">S</th>
<th id="N" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" style="color: #666666; font-weight: bold" scope="col">N</th>
<th id="EXT" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" style="color: #666666; font-weight: bold" scope="col">EXT</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="status_color" style="background-color: #CF142B; height: 40px"><br>
</td>
<td class="gt_row gt_right" headers="i" style="color: #666666; font-size: 13px; font-weight: bold; height: 40px">1</td>
<td class="gt_row gt_left" headers="type" style="height: 40px"><div aria-label="Expect that values in `N_DURATION_DAY` should be >= `0`. " data-balloon-pos="right" style="width:fit-content;">
<div style="margin:0;padding:0;display:inline-block;height:30px;vertical-align:middle;">
<svg width="30px" height="30px" viewbox="0 0 67 67" version="1.1" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink">
<title>
col_vals_gte
</title>
<g id="All-Icons" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"> <g id="col_vals_gte" transform="translate(0.000000, 0.241379)"> <path d="M56.712234,1 C59.1975153,1 61.4475153,2.00735931 63.076195,3.63603897 C64.7048747,5.26471863 65.712234,7.51471863 65.712234,10 L65.712234,10 L65.712234,65 L10.712234,65 C8.22695259,65 5.97695259,63.9926407 4.34827294,62.363961 C2.71959328,60.7352814 1.71223397,58.4852814 1.71223397,56 L1.71223397,56 L1.71223397,10 C1.71223397,7.51471863 2.71959328,5.26471863 4.34827294,3.63603897 C5.97695259,2.00735931 8.22695259,1 10.712234,1 L10.712234,1 Z" id="rectangle" stroke="#000000" stroke-width="2" fill="#FFFFFF"></path> <path d="M49.712234,12 L17.712234,12 C14.952234,12 12.712234,14.24 12.712234,17 L12.712234,49 C12.712234,51.76 14.952234,54 17.712234,54 L49.712234,54 C52.472234,54 54.712234,51.76 54.712234,49 L54.712234,17 C54.712234,14.24 52.472234,12 49.712234,12 Z M44.712234,47 L22.712234,47 L22.712234,45 L44.712234,45 L44.712234,47 Z M24.182234,40.88 L23.242234,39.12 L40.562234,30 L23.242234,20.88 L24.182234,19.12 L44.862234,30 L24.182234,40.88 Z" id="greater_than_equal" fill="#000000" fill-rule="nonzero"></path> </g> </g>
</svg>
</div>
<code style="font-size:11px;">&nbsp;col_vals_gte()</code>
</div></td>
<td class="gt_row gt_left" headers="columns" style="border-left-width: 1px; border-left-style: dashed; border-left-color: #E5E5E5; height: 40px"><div aria-label="N_DURATION_DAY" data-balloon-pos="left">
<p><span style="color:purple;"><code>â–®</code></span><code>N_DURATION_DAY</code></p>
</div></td>
<td class="gt_row gt_left" headers="values" style="border-left-width: 1px; border-left-style: dashed; border-left-color: #E5E5E5; height: 40px"><div aria-label="0" data-balloon-pos="left">
<p><code>0</code></p>
</div></td>
<td class="gt_row gt_center" headers="precon" style="border-left-width: 1px; border-left-style: solid; border-left-color: #D3D3D3; background-color: #FCFCFC; height: 40px"><span style="background:transparent;padding:0;color:#333333;vertical-align:middle;font-size:10px;border:none;border-radius:4px;" aria-label="No modifications of the table." data-balloon-pos="left">
<svg width="25px" height="25px" viewbox="0 0 25 25" version="1.1" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" style="vertical-align: middle;">
<g id="unchanged" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"> <g id="unchanged" transform="translate(0.500000, 0.570147)"> <rect id="Rectangle" x="0.125132506" y="0" width="23.749735" height="23.7894737"></rect> <path d="M5.80375046,8.18194736 C3.77191832,8.18194736 2.11875046,9.83495328 2.11875046,11.8669474 C2.11875046,13.8989414 3.77191832,15.5519474 5.80375046,15.5519474 C7.8355826,15.5519474 9.48875046,13.8989414 9.48875046,11.8669474 C9.48875046,9.83495328 7.83552863,8.18194736 5.80375046,8.18194736 Z M5.80375046,14.814915 C4.17821997,14.814915 2.85578285,13.4924778 2.85578285,11.8669474 C2.85578285,10.2414169 4.17821997,8.91897975 5.80375046,8.91897975 C7.42928095,8.91897975 8.75171807,10.2414169 8.75171807,11.8669474 C8.75171807,13.4924778 7.42928095,14.814915 5.80375046,14.814915 Z" id="Shape" fill="#000000" fill-rule="nonzero"></path> <path d="M13.9638189,8.699335 C13.9364621,8.70430925 13.9091059,8.71176968 13.8842359,8.71923074 C13.7822704,8.73663967 13.6877654,8.77643115 13.6056956,8.83860518 L10.2433156,11.3852598 C10.0766886,11.5046343 9.97720993,11.6986181 9.97720993,11.9025491 C9.97720993,12.1064807 10.0766886,12.3004639 10.2433156,12.4198383 L13.6056956,14.966493 C13.891697,15.1803725 14.2970729,15.1231721 14.5109517,14.8371707 C14.7248313,14.5511692 14.6676309,14.145794 14.3816294,13.9319145 L12.5313257,12.5392127 L21.8812495,12.5392127 L21.8812495,11.2658854 L12.5313257,11.2658854 L14.3816294,9.87318364 C14.6377872,9.71650453 14.7497006,9.40066014 14.6477351,9.11714553 C14.5482564,8.83363156 14.262255,8.65954352 13.9638189,8.699335 Z" id="arrow" fill="#000000" transform="translate(15.929230, 11.894737) rotate(-180.000000) translate(-15.929230, -11.894737) "></path> </g> </g>
</svg>
</span></td>
<td class="gt_row gt_center" headers="eval_sym" style="border-right-width: 1px; border-right-style: solid; border-right-color: #D3D3D3; background-color: #FCFCFC; height: 40px"><span style="background:transparent;padding:5px;color:#4CA64C;vertical-align:middle;font-size:15px;border:none;" aria-label="No evaluation issues." data-balloon-pos="left">âœ“</span></td>
<td class="gt_row gt_right" headers="units" style="font-size: 11px; height: 40px"><code>139</code></td>
<td class="gt_row gt_right" headers="n_pass" style="border-left-width: 1px; border-left-style: dashed; border-left-color: #E5E5E5; font-size: 11px; height: 40px"><code>137</code><br>
<code>0.98561</code></td>
<td class="gt_row gt_right" headers="n_fail" style="border-left-width: 1px; border-left-style: dashed; border-left-color: #E5E5E5; font-size: 11px; height: 40px"><code>2</code><br>
<code>0.01439</code></td>
<td class="gt_row gt_center" headers="W" style="border-left-width: 1px; border-left-style: solid; border-left-color: #D3D3D3; background-color: #FCFCFC; height: 40px">â€”</td>
<td class="gt_row gt_center" headers="S" style="background-color: #FCFCFC; height: 40px"><span style="color: #CF142B;">â—</span></td>
<td class="gt_row gt_center" headers="N" style="border-right-width: 1px; border-right-style: solid; border-right-color: #D3D3D3; background-color: #FCFCFC; height: 40px">â€”</td>
<td class="gt_row gt_center" headers="extract" style="height: 40px"><a href="data:text/csv;base64,IklEX1RSSVAiLCJDQVRfREVTVElOQVRJT05fQ0lUWSIsIkRUX1NUQVJUIiwiRFRfRU5EIiwiTl9EVVJBVElPTl9EQVkiLCJDQVRfVFJBVkVMRVJfTkFNRSIsIlZBTF9BR0VfVFJBVkVMRVIiLCJJTkRfR0VOREVSX1RSQVZFTEVSIiwiQ0FUX1RSQVZFTEVSX05BVElPTkFMSVRZIiwiQ0FUX0FDQ09NTU9EQVRJT05fVFlQRSIsIkFNVF9BQ0NPTU1PREFUSU9OX0NPU1QiLCJDQVRfVFJBTlNQT1JUQVRJT05fVFlQRSIsIkFNVF9UUkFOU1BPUlRBVElPTl9DT1NUIg0KNzIsTkEsTkEsTkEsTkEsTkEsTkEsTkEsTkEsTkEsTkEsTkEsTkENCjEyOCxOQSxOQSxOQSxOQSxOQSxOQSxOQSxOQSxOQSxOQSxOQSxOQQ0K" download="extract_0001.csv">
<button aria-label="There are 2 'fail' rows available as a CSV file." data-balloon-pos="left" style="background-color:#67C2DC;color:#FFFFFF;border:none;padding:5px;font-weight:bold;cursor:pointer;border-radius:4px;">
CSV
</button>
</a></td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="status_color" style="background-color: #CF142B; height: 40px"><br>
</td>
<td class="gt_row gt_right" headers="i" style="color: #666666; font-size: 13px; font-weight: bold; height: 40px">2</td>
<td class="gt_row gt_left" headers="type" style="height: 40px"><div aria-label="Expect that values in `VAL_AGE_TRAVELER` should be >= `0`. " data-balloon-pos="right" style="width:fit-content;">
<div style="margin:0;padding:0;display:inline-block;height:30px;vertical-align:middle;">
<svg width="30px" height="30px" viewbox="0 0 67 67" version="1.1" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink">
<title>
col_vals_gte
</title>
<g id="All-Icons" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"> <g id="col_vals_gte" transform="translate(0.000000, 0.241379)"> <path d="M56.712234,1 C59.1975153,1 61.4475153,2.00735931 63.076195,3.63603897 C64.7048747,5.26471863 65.712234,7.51471863 65.712234,10 L65.712234,10 L65.712234,65 L10.712234,65 C8.22695259,65 5.97695259,63.9926407 4.34827294,62.363961 C2.71959328,60.7352814 1.71223397,58.4852814 1.71223397,56 L1.71223397,56 L1.71223397,10 C1.71223397,7.51471863 2.71959328,5.26471863 4.34827294,3.63603897 C5.97695259,2.00735931 8.22695259,1 10.712234,1 L10.712234,1 Z" id="rectangle" stroke="#000000" stroke-width="2" fill="#FFFFFF"></path> <path d="M49.712234,12 L17.712234,12 C14.952234,12 12.712234,14.24 12.712234,17 L12.712234,49 C12.712234,51.76 14.952234,54 17.712234,54 L49.712234,54 C52.472234,54 54.712234,51.76 54.712234,49 L54.712234,17 C54.712234,14.24 52.472234,12 49.712234,12 Z M44.712234,47 L22.712234,47 L22.712234,45 L44.712234,45 L44.712234,47 Z M24.182234,40.88 L23.242234,39.12 L40.562234,30 L23.242234,20.88 L24.182234,19.12 L44.862234,30 L24.182234,40.88 Z" id="greater_than_equal" fill="#000000" fill-rule="nonzero"></path> </g> </g>
</svg>
</div>
<code style="font-size:11px;">&nbsp;col_vals_gte()</code>
</div></td>
<td class="gt_row gt_left" headers="columns" style="border-left-width: 1px; border-left-style: dashed; border-left-color: #E5E5E5; height: 40px"><div aria-label="VAL_AGE_TRAVELER" data-balloon-pos="left">
<p><span style="color:purple;"><code>â–®</code></span><code>VAL_AGE_TRAVELER</code></p>
</div></td>
<td class="gt_row gt_left" headers="values" style="border-left-width: 1px; border-left-style: dashed; border-left-color: #E5E5E5; height: 40px"><div aria-label="0" data-balloon-pos="left">
<p><code>0</code></p>
</div></td>
<td class="gt_row gt_center" headers="precon" style="border-left-width: 1px; border-left-style: solid; border-left-color: #D3D3D3; background-color: #FCFCFC; height: 40px"><span style="background:transparent;padding:0;color:#333333;vertical-align:middle;font-size:10px;border:none;border-radius:4px;" aria-label="No modifications of the table." data-balloon-pos="left">
<svg width="25px" height="25px" viewbox="0 0 25 25" version="1.1" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" style="vertical-align: middle;">
<g id="unchanged" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"> <g id="unchanged" transform="translate(0.500000, 0.570147)"> <rect id="Rectangle" x="0.125132506" y="0" width="23.749735" height="23.7894737"></rect> <path d="M5.80375046,8.18194736 C3.77191832,8.18194736 2.11875046,9.83495328 2.11875046,11.8669474 C2.11875046,13.8989414 3.77191832,15.5519474 5.80375046,15.5519474 C7.8355826,15.5519474 9.48875046,13.8989414 9.48875046,11.8669474 C9.48875046,9.83495328 7.83552863,8.18194736 5.80375046,8.18194736 Z M5.80375046,14.814915 C4.17821997,14.814915 2.85578285,13.4924778 2.85578285,11.8669474 C2.85578285,10.2414169 4.17821997,8.91897975 5.80375046,8.91897975 C7.42928095,8.91897975 8.75171807,10.2414169 8.75171807,11.8669474 C8.75171807,13.4924778 7.42928095,14.814915 5.80375046,14.814915 Z" id="Shape" fill="#000000" fill-rule="nonzero"></path> <path d="M13.9638189,8.699335 C13.9364621,8.70430925 13.9091059,8.71176968 13.8842359,8.71923074 C13.7822704,8.73663967 13.6877654,8.77643115 13.6056956,8.83860518 L10.2433156,11.3852598 C10.0766886,11.5046343 9.97720993,11.6986181 9.97720993,11.9025491 C9.97720993,12.1064807 10.0766886,12.3004639 10.2433156,12.4198383 L13.6056956,14.966493 C13.891697,15.1803725 14.2970729,15.1231721 14.5109517,14.8371707 C14.7248313,14.5511692 14.6676309,14.145794 14.3816294,13.9319145 L12.5313257,12.5392127 L21.8812495,12.5392127 L21.8812495,11.2658854 L12.5313257,11.2658854 L14.3816294,9.87318364 C14.6377872,9.71650453 14.7497006,9.40066014 14.6477351,9.11714553 C14.5482564,8.83363156 14.262255,8.65954352 13.9638189,8.699335 Z" id="arrow" fill="#000000" transform="translate(15.929230, 11.894737) rotate(-180.000000) translate(-15.929230, -11.894737) "></path> </g> </g>
</svg>
</span></td>
<td class="gt_row gt_center" headers="eval_sym" style="border-right-width: 1px; border-right-style: solid; border-right-color: #D3D3D3; background-color: #FCFCFC; height: 40px"><span style="background:transparent;padding:5px;color:#4CA64C;vertical-align:middle;font-size:15px;border:none;" aria-label="No evaluation issues." data-balloon-pos="left">âœ“</span></td>
<td class="gt_row gt_right" headers="units" style="font-size: 11px; height: 40px"><code>139</code></td>
<td class="gt_row gt_right" headers="n_pass" style="border-left-width: 1px; border-left-style: dashed; border-left-color: #E5E5E5; font-size: 11px; height: 40px"><code>137</code><br>
<code>0.98561</code></td>
<td class="gt_row gt_right" headers="n_fail" style="border-left-width: 1px; border-left-style: dashed; border-left-color: #E5E5E5; font-size: 11px; height: 40px"><code>2</code><br>
<code>0.01439</code></td>
<td class="gt_row gt_center" headers="W" style="border-left-width: 1px; border-left-style: solid; border-left-color: #D3D3D3; background-color: #FCFCFC; height: 40px">â€”</td>
<td class="gt_row gt_center" headers="S" style="background-color: #FCFCFC; height: 40px"><span style="color: #CF142B;">â—</span></td>
<td class="gt_row gt_center" headers="N" style="border-right-width: 1px; border-right-style: solid; border-right-color: #D3D3D3; background-color: #FCFCFC; height: 40px">â€”</td>
<td class="gt_row gt_center" headers="extract" style="height: 40px"><a href="data:text/csv;base64,IklEX1RSSVAiLCJDQVRfREVTVElOQVRJT05fQ0lUWSIsIkRUX1NUQVJUIiwiRFRfRU5EIiwiTl9EVVJBVElPTl9EQVkiLCJDQVRfVFJBVkVMRVJfTkFNRSIsIlZBTF9BR0VfVFJBVkVMRVIiLCJJTkRfR0VOREVSX1RSQVZFTEVSIiwiQ0FUX1RSQVZFTEVSX05BVElPTkFMSVRZIiwiQ0FUX0FDQ09NTU9EQVRJT05fVFlQRSIsIkFNVF9BQ0NPTU1PREFUSU9OX0NPU1QiLCJDQVRfVFJBTlNQT1JUQVRJT05fVFlQRSIsIkFNVF9UUkFOU1BPUlRBVElPTl9DT1NUIg0KNzIsTkEsTkEsTkEsTkEsTkEsTkEsTkEsTkEsTkEsTkEsTkEsTkENCjEyOCxOQSxOQSxOQSxOQSxOQSxOQSxOQSxOQSxOQSxOQSxOQSxOQQ0K" download="extract_0002.csv">
<button aria-label="There are 2 'fail' rows available as a CSV file." data-balloon-pos="left" style="background-color:#67C2DC;color:#FFFFFF;border:none;padding:5px;font-weight:bold;cursor:pointer;border-radius:4px;">
CSV
</button>
</a></td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="status_color" style="background-color: #CF142B; height: 40px"><br>
</td>
<td class="gt_row gt_right" headers="i" style="color: #666666; font-size: 13px; font-weight: bold; height: 40px">3</td>
<td class="gt_row gt_left" headers="type" style="height: 40px"><div aria-label="Expect that all values in `IND_GENDER_TRAVELER` should not be NULL. " data-balloon-pos="right" style="width:fit-content;">
<div style="margin:0;padding:0;display:inline-block;height:30px;vertical-align:middle;">
<svg width="30px" height="30px" viewbox="0 0 67 67" version="1.1" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink">
<title>
col_vals_not_null
</title>
<g id="All-Icons" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"> <g id="col_vals_not_null" transform="translate(0.000000, 0.551724)"> <path d="M56.712234,1 C59.1975153,1 61.4475153,2.00735931 63.076195,3.63603897 C64.7048747,5.26471863 65.712234,7.51471863 65.712234,10 L65.712234,10 L65.712234,65 L10.712234,65 C8.22695259,65 5.97695259,63.9926407 4.34827294,62.363961 C2.71959328,60.7352814 1.71223397,58.4852814 1.71223397,56 L1.71223397,56 L1.71223397,10 C1.71223397,7.51471863 2.71959328,5.26471863 4.34827294,3.63603897 C5.97695259,2.00735931 8.22695259,1 10.712234,1 L10.712234,1 Z" id="rectangle" stroke="#000000" stroke-width="2" fill="#FFFFFF"></path> <path d="M40.6120805,47.037834 C37.4692348,47.037834 35.0126139,45.9348613 33.712234,44.0140597 C32.4118541,45.9348613 29.9552331,47.037834 26.8123883,47.037834 C22.6574397,47.037834 16.0646712,43.4437723 16.0646712,33.8021619 C16.0646712,29.3401361 17.4715879,18.962166 30.5035862,18.962166 C30.9454018,18.962166 31.3057481,19.3225124 31.3057481,19.7643279 L31.3057481,21.3686518 C31.3057481,21.8104674 30.9454018,22.1708138 30.5035862,22.1708138 C26.6400486,22.1708138 22.4819668,25.8118774 22.4819668,33.8021619 C22.4819668,37.5090277 23.7635456,43.0270243 27.2949384,43.0270243 C29.795428,43.0270243 31.224279,40.4231312 32.0985095,38.2861221 C30.5067194,35.6101596 29.7014243,33.1034035 29.7014243,30.8347892 C29.7014243,25.6238707 31.8603677,23.7751377 33.712234,23.7751377 C35.5641002,23.7751377 37.7230437,25.6238707 37.7230437,30.8347892 C37.7230437,33.1347383 36.9396828,35.5788255 35.3290916,38.2861221 C36.6294715,41.4321009 38.243196,43.0270243 40.1295295,43.0270243 C43.6609223,43.0270243 44.9425012,37.5090277 44.9425012,33.8021619 C44.9425012,25.8118774 40.7844193,22.1708138 36.9208817,22.1708138 C36.4759329,22.1708138 36.1187198,21.8104674 36.1187198,21.3686518 L36.1187198,19.7643279 C36.1187198,19.3225124 36.4759329,18.962166 36.9208817,18.962166 C49.9528801,18.962166 51.3597967,29.3401361 51.3597967,33.8021619 C51.3597967,43.4437723 44.7670282,47.037834 40.6120805,47.037834 Z" id="omega" fill="#000000" fill-rule="nonzero"></path> <path d="M33,7.93597705 C33.2761424,7.93597705 33.5,8.15983467 33.5,8.43597705 L33.5,57.564023 C33.5,57.8401653 33.2761424,58.064023 33,58.064023 C32.7238576,58.064023 32.5,57.8401653 32.5,57.564023 L32.5,8.43597705 C32.5,8.15983467 32.7238576,7.93597705 33,7.93597705 Z" id="line_black" fill="#000000" transform="translate(33.000000, 33.000000) rotate(-320.000000) translate(-33.000000, -33.000000) "></path> <polygon id="line_white" fill="#FFFFFF" transform="translate(34.899496, 32.153303) rotate(-320.000000) translate(-34.899496, -32.153303) " points="34.3994962 8.54160469 35.3994962 8.54160469 35.3994962 55.7650019 34.3994962 55.7650019"></polygon> </g> </g>
</svg>
</div>
<code style="font-size:10px;">&nbsp;col_vals_not_null()</code>
</div></td>
<td class="gt_row gt_left" headers="columns" style="border-left-width: 1px; border-left-style: dashed; border-left-color: #E5E5E5; height: 40px"><div aria-label="IND_GENDER_TRAVELER" data-balloon-pos="left">
<p><span style="color:purple;"><code>â–®</code></span><code>IND_GENDER_TRAVELER</code></p>
</div></td>
<td class="gt_row gt_left" headers="values" style="border-left-width: 1px; border-left-style: dashed; border-left-color: #E5E5E5; height: 40px">â€”</td>
<td class="gt_row gt_center" headers="precon" style="border-left-width: 1px; border-left-style: solid; border-left-color: #D3D3D3; background-color: #FCFCFC; height: 40px"><span style="background:transparent;padding:0;color:#333333;vertical-align:middle;font-size:10px;border:none;border-radius:4px;" aria-label="No modifications of the table." data-balloon-pos="left">
<svg width="25px" height="25px" viewbox="0 0 25 25" version="1.1" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" style="vertical-align: middle;">
<g id="unchanged" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"> <g id="unchanged" transform="translate(0.500000, 0.570147)"> <rect id="Rectangle" x="0.125132506" y="0" width="23.749735" height="23.7894737"></rect> <path d="M5.80375046,8.18194736 C3.77191832,8.18194736 2.11875046,9.83495328 2.11875046,11.8669474 C2.11875046,13.8989414 3.77191832,15.5519474 5.80375046,15.5519474 C7.8355826,15.5519474 9.48875046,13.8989414 9.48875046,11.8669474 C9.48875046,9.83495328 7.83552863,8.18194736 5.80375046,8.18194736 Z M5.80375046,14.814915 C4.17821997,14.814915 2.85578285,13.4924778 2.85578285,11.8669474 C2.85578285,10.2414169 4.17821997,8.91897975 5.80375046,8.91897975 C7.42928095,8.91897975 8.75171807,10.2414169 8.75171807,11.8669474 C8.75171807,13.4924778 7.42928095,14.814915 5.80375046,14.814915 Z" id="Shape" fill="#000000" fill-rule="nonzero"></path> <path d="M13.9638189,8.699335 C13.9364621,8.70430925 13.9091059,8.71176968 13.8842359,8.71923074 C13.7822704,8.73663967 13.6877654,8.77643115 13.6056956,8.83860518 L10.2433156,11.3852598 C10.0766886,11.5046343 9.97720993,11.6986181 9.97720993,11.9025491 C9.97720993,12.1064807 10.0766886,12.3004639 10.2433156,12.4198383 L13.6056956,14.966493 C13.891697,15.1803725 14.2970729,15.1231721 14.5109517,14.8371707 C14.7248313,14.5511692 14.6676309,14.145794 14.3816294,13.9319145 L12.5313257,12.5392127 L21.8812495,12.5392127 L21.8812495,11.2658854 L12.5313257,11.2658854 L14.3816294,9.87318364 C14.6377872,9.71650453 14.7497006,9.40066014 14.6477351,9.11714553 C14.5482564,8.83363156 14.262255,8.65954352 13.9638189,8.699335 Z" id="arrow" fill="#000000" transform="translate(15.929230, 11.894737) rotate(-180.000000) translate(-15.929230, -11.894737) "></path> </g> </g>
</svg>
</span></td>
<td class="gt_row gt_center" headers="eval_sym" style="border-right-width: 1px; border-right-style: solid; border-right-color: #D3D3D3; background-color: #FCFCFC; height: 40px"><span style="background:transparent;padding:5px;color:#4CA64C;vertical-align:middle;font-size:15px;border:none;" aria-label="No evaluation issues." data-balloon-pos="left">âœ“</span></td>
<td class="gt_row gt_right" headers="units" style="font-size: 11px; height: 40px"><code>139</code></td>
<td class="gt_row gt_right" headers="n_pass" style="border-left-width: 1px; border-left-style: dashed; border-left-color: #E5E5E5; font-size: 11px; height: 40px"><code>137</code><br>
<code>0.98561</code></td>
<td class="gt_row gt_right" headers="n_fail" style="border-left-width: 1px; border-left-style: dashed; border-left-color: #E5E5E5; font-size: 11px; height: 40px"><code>2</code><br>
<code>0.01439</code></td>
<td class="gt_row gt_center" headers="W" style="border-left-width: 1px; border-left-style: solid; border-left-color: #D3D3D3; background-color: #FCFCFC; height: 40px">â€”</td>
<td class="gt_row gt_center" headers="S" style="background-color: #FCFCFC; height: 40px"><span style="color: #CF142B;">â—</span></td>
<td class="gt_row gt_center" headers="N" style="border-right-width: 1px; border-right-style: solid; border-right-color: #D3D3D3; background-color: #FCFCFC; height: 40px">â€”</td>
<td class="gt_row gt_center" headers="extract" style="height: 40px"><a href="data:text/csv;base64,IklEX1RSSVAiLCJDQVRfREVTVElOQVRJT05fQ0lUWSIsIkRUX1NUQVJUIiwiRFRfRU5EIiwiTl9EVVJBVElPTl9EQVkiLCJDQVRfVFJBVkVMRVJfTkFNRSIsIlZBTF9BR0VfVFJBVkVMRVIiLCJJTkRfR0VOREVSX1RSQVZFTEVSIiwiQ0FUX1RSQVZFTEVSX05BVElPTkFMSVRZIiwiQ0FUX0FDQ09NTU9EQVRJT05fVFlQRSIsIkFNVF9BQ0NPTU1PREFUSU9OX0NPU1QiLCJDQVRfVFJBTlNQT1JUQVRJT05fVFlQRSIsIkFNVF9UUkFOU1BPUlRBVElPTl9DT1NUIg0KNzIsTkEsTkEsTkEsTkEsTkEsTkEsTkEsTkEsTkEsTkEsTkEsTkENCjEyOCxOQSxOQSxOQSxOQSxOQSxOQSxOQSxOQSxOQSxOQSxOQSxOQQ0K" download="extract_0003.csv">
<button aria-label="There are 2 'fail' rows available as a CSV file." data-balloon-pos="left" style="background-color:#67C2DC;color:#FFFFFF;border:none;padding:5px;font-weight:bold;cursor:pointer;border-radius:4px;">
CSV
</button>
</a></td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="status_color" style="background-color: #CF142B; height: 40px"><br>
</td>
<td class="gt_row gt_right" headers="i" style="color: #666666; font-size: 13px; font-weight: bold; height: 40px">4</td>
<td class="gt_row gt_left" headers="type" style="height: 40px"><div aria-label="Expect that values in `IND_GENDER_TRAVELER` should be in the set of `Male`, `Female`. " data-balloon-pos="right" style="width:fit-content;">
<div style="margin:0;padding:0;display:inline-block;height:30px;vertical-align:middle;">
<svg width="30px" height="30px" viewbox="0 0 67 67" version="1.1" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink">
<title>
col_vals_in_set
</title>
<g id="All-Icons" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"> <g id="col_vals_in_set" transform="translate(0.000000, 0.172414)"> <path d="M56.712234,1 C59.1975153,1 61.4475153,2.00735931 63.076195,3.63603897 C64.7048747,5.26471863 65.712234,7.51471863 65.712234,10 L65.712234,10 L65.712234,65 L10.712234,65 C8.22695259,65 5.97695259,63.9926407 4.34827294,62.363961 C2.71959328,60.7352814 1.71223397,58.4852814 1.71223397,56 L1.71223397,56 L1.71223397,10 C1.71223397,7.51471863 2.71959328,5.26471863 4.34827294,3.63603897 C5.97695259,2.00735931 8.22695259,1 10.712234,1 L10.712234,1 Z" id="rectangle" stroke="#000000" stroke-width="2" fill="#FFFFFF"></path> <path d="M44.127969,41.1538382 L31.0814568,41.1538382 C29.9510748,41.1536429 28.8827052,40.9256134 27.9079888,40.5136953 C26.4467442,39.8960136 25.19849,38.8599685 24.3189894,37.5577099 C23.8792391,36.906727 23.5314818,36.1899233 23.2936866,35.4252675 C23.2130217,35.16589 23.1460289,34.9005554 23.0913409,34.6307286 L44.1278714,34.6307286 C45.028466,34.6306309 45.7586488,33.9004481 45.7586488,32.9998535 C45.7586488,32.0992589 45.028466,31.3690761 44.1278714,31.3690761 L23.0905596,31.3690761 C23.1990567,30.8337194 23.3597028,30.3180894 23.5675173,29.8264831 C24.185199,28.3652386 25.2212442,27.1169844 26.5236004,26.2374838 C27.1745833,25.7977334 27.891387,25.4499762 28.6560428,25.2122786 C29.4208939,24.9744833 30.2334994,24.8459665 31.0813591,24.8459665 L44.1277737,24.8459665 C45.0283683,24.8459665 45.7586488,24.1157837 45.7586488,23.2151891 C45.7586488,22.3145945 45.0283683,21.5844117 44.1277737,21.5844117 L31.0813591,21.5844117 C29.5096643,21.5844117 28.0039858,21.9038483 26.6373711,22.4820765 C24.5866678,23.3498583 22.8469049,24.7950871 21.6163267,26.616296 C20.3856508,28.4362354 19.665136,30.6413347 19.6658191,33.0000488 C19.6658191,34.5717436 19.9852563,36.0774222 20.5635822,37.4440369 C21.4312663,39.4947402 22.8765927,41.2345031 24.697704,42.4650813 C26.5176434,43.6957572 28.7227427,44.4155883 31.0814568,44.4155883 L44.1278714,44.4155883 C45.028466,44.4155883 45.7586488,43.6854055 45.7586488,42.7848109 C45.7586488,41.8842163 45.0285636,41.1538382 44.127969,41.1538382 Z" id="set_of" fill="#000000" fill-rule="nonzero"></path> </g> </g>
</svg>
</div>
<code style="font-size:11px;">&nbsp;col_vals_in_set()</code>
</div></td>
<td class="gt_row gt_left" headers="columns" style="border-left-width: 1px; border-left-style: dashed; border-left-color: #E5E5E5; height: 40px"><div aria-label="IND_GENDER_TRAVELER" data-balloon-pos="left">
<p><span style="color:purple;"><code>â–®</code></span><code>IND_GENDER_TRAVELER</code></p>
</div></td>
<td class="gt_row gt_left" headers="values" style="border-left-width: 1px; border-left-style: dashed; border-left-color: #E5E5E5; height: 40px"><div aria-label="Male, Female" data-balloon-pos="left">
<p><code>Male, Female</code></p>
</div></td>
<td class="gt_row gt_center" headers="precon" style="border-left-width: 1px; border-left-style: solid; border-left-color: #D3D3D3; background-color: #FCFCFC; height: 40px"><span style="background:transparent;padding:0;color:#333333;vertical-align:middle;font-size:10px;border:none;border-radius:4px;" aria-label="No modifications of the table." data-balloon-pos="left">
<svg width="25px" height="25px" viewbox="0 0 25 25" version="1.1" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" style="vertical-align: middle;">
<g id="unchanged" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"> <g id="unchanged" transform="translate(0.500000, 0.570147)"> <rect id="Rectangle" x="0.125132506" y="0" width="23.749735" height="23.7894737"></rect> <path d="M5.80375046,8.18194736 C3.77191832,8.18194736 2.11875046,9.83495328 2.11875046,11.8669474 C2.11875046,13.8989414 3.77191832,15.5519474 5.80375046,15.5519474 C7.8355826,15.5519474 9.48875046,13.8989414 9.48875046,11.8669474 C9.48875046,9.83495328 7.83552863,8.18194736 5.80375046,8.18194736 Z M5.80375046,14.814915 C4.17821997,14.814915 2.85578285,13.4924778 2.85578285,11.8669474 C2.85578285,10.2414169 4.17821997,8.91897975 5.80375046,8.91897975 C7.42928095,8.91897975 8.75171807,10.2414169 8.75171807,11.8669474 C8.75171807,13.4924778 7.42928095,14.814915 5.80375046,14.814915 Z" id="Shape" fill="#000000" fill-rule="nonzero"></path> <path d="M13.9638189,8.699335 C13.9364621,8.70430925 13.9091059,8.71176968 13.8842359,8.71923074 C13.7822704,8.73663967 13.6877654,8.77643115 13.6056956,8.83860518 L10.2433156,11.3852598 C10.0766886,11.5046343 9.97720993,11.6986181 9.97720993,11.9025491 C9.97720993,12.1064807 10.0766886,12.3004639 10.2433156,12.4198383 L13.6056956,14.966493 C13.891697,15.1803725 14.2970729,15.1231721 14.5109517,14.8371707 C14.7248313,14.5511692 14.6676309,14.145794 14.3816294,13.9319145 L12.5313257,12.5392127 L21.8812495,12.5392127 L21.8812495,11.2658854 L12.5313257,11.2658854 L14.3816294,9.87318364 C14.6377872,9.71650453 14.7497006,9.40066014 14.6477351,9.11714553 C14.5482564,8.83363156 14.262255,8.65954352 13.9638189,8.699335 Z" id="arrow" fill="#000000" transform="translate(15.929230, 11.894737) rotate(-180.000000) translate(-15.929230, -11.894737) "></path> </g> </g>
</svg>
</span></td>
<td class="gt_row gt_center" headers="eval_sym" style="border-right-width: 1px; border-right-style: solid; border-right-color: #D3D3D3; background-color: #FCFCFC; height: 40px"><span style="background:transparent;padding:5px;color:#4CA64C;vertical-align:middle;font-size:15px;border:none;" aria-label="No evaluation issues." data-balloon-pos="left">âœ“</span></td>
<td class="gt_row gt_right" headers="units" style="font-size: 11px; height: 40px"><code>139</code></td>
<td class="gt_row gt_right" headers="n_pass" style="border-left-width: 1px; border-left-style: dashed; border-left-color: #E5E5E5; font-size: 11px; height: 40px"><code>137</code><br>
<code>0.98561</code></td>
<td class="gt_row gt_right" headers="n_fail" style="border-left-width: 1px; border-left-style: dashed; border-left-color: #E5E5E5; font-size: 11px; height: 40px"><code>2</code><br>
<code>0.01439</code></td>
<td class="gt_row gt_center" headers="W" style="border-left-width: 1px; border-left-style: solid; border-left-color: #D3D3D3; background-color: #FCFCFC; height: 40px">â€”</td>
<td class="gt_row gt_center" headers="S" style="background-color: #FCFCFC; height: 40px"><span style="color: #CF142B;">â—</span></td>
<td class="gt_row gt_center" headers="N" style="border-right-width: 1px; border-right-style: solid; border-right-color: #D3D3D3; background-color: #FCFCFC; height: 40px">â€”</td>
<td class="gt_row gt_center" headers="extract" style="height: 40px"><a href="data:text/csv;base64,IklEX1RSSVAiLCJDQVRfREVTVElOQVRJT05fQ0lUWSIsIkRUX1NUQVJUIiwiRFRfRU5EIiwiTl9EVVJBVElPTl9EQVkiLCJDQVRfVFJBVkVMRVJfTkFNRSIsIlZBTF9BR0VfVFJBVkVMRVIiLCJJTkRfR0VOREVSX1RSQVZFTEVSIiwiQ0FUX1RSQVZFTEVSX05BVElPTkFMSVRZIiwiQ0FUX0FDQ09NTU9EQVRJT05fVFlQRSIsIkFNVF9BQ0NPTU1PREFUSU9OX0NPU1QiLCJDQVRfVFJBTlNQT1JUQVRJT05fVFlQRSIsIkFNVF9UUkFOU1BPUlRBVElPTl9DT1NUIg0KNzIsTkEsTkEsTkEsTkEsTkEsTkEsTkEsTkEsTkEsTkEsTkEsTkENCjEyOCxOQSxOQSxOQSxOQSxOQSxOQSxOQSxOQSxOQSxOQSxOQSxOQQ0K" download="extract_0004.csv">
<button aria-label="There are 2 'fail' rows available as a CSV file." data-balloon-pos="left" style="background-color:#67C2DC;color:#FFFFFF;border:none;padding:5px;font-weight:bold;cursor:pointer;border-radius:4px;">
CSV
</button>
</a></td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="status_color" style="background-color: #CF142B; height: 40px"><br>
</td>
<td class="gt_row gt_right" headers="i" style="color: #666666; font-size: 13px; font-weight: bold; height: 40px">5</td>
<td class="gt_row gt_left" headers="type" style="height: 40px"><div aria-label="Expect that column `DT_START` is of type: Date. " data-balloon-pos="right" style="width:fit-content;">
<div style="margin:0;padding:0;display:inline-block;height:30px;vertical-align:middle;">
<svg width="30px" height="30px" viewbox="0 0 67 67" version="1.1" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink">
<title>
col_is_date
</title>
<g id="All-Icons" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"> <g id="col_is_date" transform="translate(0.000000, 0.379310)"> <path d="M56.712234,1.01466935 C59.1975153,1.01466935 61.4475153,2.02202867 63.076195,3.65070832 C64.7048747,5.27938798 65.712234,7.52938798 65.712234,10.0146694 L65.712234,10.0146694 L65.712234,65.0146694 L10.712234,65.0146694 C8.22695259,65.0146694 5.97695259,64.00731 4.34827294,62.3786304 C2.71959328,60.7499507 1.71223397,58.4999507 1.71223397,56.0146694 L1.71223397,56.0146694 L1.71223397,10.0146694 C1.71223397,7.52938798 2.71959328,5.27938798 4.34827294,3.65070832 C5.97695259,2.02202867 8.22695259,1.01466935 10.712234,1.01466935 L10.712234,1.01466935 Z" id="rectangle" stroke="#000000" stroke-width="2" fill="#FFFFFF"></path> <rect id="column" fill="#000000" x="12.2117153" y="12.0146694" width="20" height="42" rx="1"></rect> <path d="M40.7190873,43.0146694 L40.7190873,24.2256069 L46.9651811,24.2256069 C48.8271696,24.2256069 50.3315491,24.4329616 51.4783647,24.8476772 C52.6251803,25.2623928 53.6175206,25.9648597 54.4554155,26.955099 C55.7841981,28.5293257 56.4485795,30.6028726 56.4485795,33.1758022 C56.4485795,36.2988647 55.6233925,38.7194134 53.9729936,40.4375209 C52.3225947,42.1556285 49.9993758,43.0146694 47.003267,43.0146694 L40.7190873,43.0146694 Z M43.385103,41.0215053 L46.800142,41.0215053 C49.2376542,41.0215053 50.9641994,40.3655874 51.9798295,39.0537319 C53.0716319,37.6572405 53.6175248,35.7825848 53.6175248,33.4297084 C53.6175248,31.220713 53.0800953,29.4857043 52.0052202,28.2246303 C51.3535242,27.4544441 50.5748861,26.9275939 49.6692827,26.6440639 C48.7636792,26.3605338 47.4010626,26.2187709 45.581392,26.2187709 L43.385103,26.2187709 L43.385103,41.0215053 Z" id="D" fill="#000000"></path> </g> </g>
</svg>
</div>
<code style="font-size:11px;">&nbsp;col_is_date()</code>
</div></td>
<td class="gt_row gt_left" headers="columns" style="border-left-width: 1px; border-left-style: dashed; border-left-color: #E5E5E5; height: 40px"><div aria-label="DT_START" data-balloon-pos="left">
<p><span style="color:purple;"><code>â–®</code></span><code>DT_START</code></p>
</div></td>
<td class="gt_row gt_left" headers="values" style="border-left-width: 1px; border-left-style: dashed; border-left-color: #E5E5E5; height: 40px">â€”</td>
<td class="gt_row gt_center" headers="precon" style="border-left-width: 1px; border-left-style: solid; border-left-color: #D3D3D3; background-color: #FCFCFC; height: 40px"><span style="background:transparent;padding:0;color:#333333;vertical-align:middle;font-size:10px;border:none;border-radius:4px;" aria-label="No modifications of the table." data-balloon-pos="left">
<svg width="25px" height="25px" viewbox="0 0 25 25" version="1.1" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" style="vertical-align: middle;">
<g id="unchanged" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"> <g id="unchanged" transform="translate(0.500000, 0.570147)"> <rect id="Rectangle" x="0.125132506" y="0" width="23.749735" height="23.7894737"></rect> <path d="M5.80375046,8.18194736 C3.77191832,8.18194736 2.11875046,9.83495328 2.11875046,11.8669474 C2.11875046,13.8989414 3.77191832,15.5519474 5.80375046,15.5519474 C7.8355826,15.5519474 9.48875046,13.8989414 9.48875046,11.8669474 C9.48875046,9.83495328 7.83552863,8.18194736 5.80375046,8.18194736 Z M5.80375046,14.814915 C4.17821997,14.814915 2.85578285,13.4924778 2.85578285,11.8669474 C2.85578285,10.2414169 4.17821997,8.91897975 5.80375046,8.91897975 C7.42928095,8.91897975 8.75171807,10.2414169 8.75171807,11.8669474 C8.75171807,13.4924778 7.42928095,14.814915 5.80375046,14.814915 Z" id="Shape" fill="#000000" fill-rule="nonzero"></path> <path d="M13.9638189,8.699335 C13.9364621,8.70430925 13.9091059,8.71176968 13.8842359,8.71923074 C13.7822704,8.73663967 13.6877654,8.77643115 13.6056956,8.83860518 L10.2433156,11.3852598 C10.0766886,11.5046343 9.97720993,11.6986181 9.97720993,11.9025491 C9.97720993,12.1064807 10.0766886,12.3004639 10.2433156,12.4198383 L13.6056956,14.966493 C13.891697,15.1803725 14.2970729,15.1231721 14.5109517,14.8371707 C14.7248313,14.5511692 14.6676309,14.145794 14.3816294,13.9319145 L12.5313257,12.5392127 L21.8812495,12.5392127 L21.8812495,11.2658854 L12.5313257,11.2658854 L14.3816294,9.87318364 C14.6377872,9.71650453 14.7497006,9.40066014 14.6477351,9.11714553 C14.5482564,8.83363156 14.262255,8.65954352 13.9638189,8.699335 Z" id="arrow" fill="#000000" transform="translate(15.929230, 11.894737) rotate(-180.000000) translate(-15.929230, -11.894737) "></path> </g> </g>
</svg>
</span></td>
<td class="gt_row gt_center" headers="eval_sym" style="border-right-width: 1px; border-right-style: solid; border-right-color: #D3D3D3; background-color: #FCFCFC; height: 40px"><span style="background:transparent;padding:5px;color:#4CA64C;vertical-align:middle;font-size:15px;border:none;" aria-label="No evaluation issues." data-balloon-pos="left">âœ“</span></td>
<td class="gt_row gt_right" headers="units" style="font-size: 11px; height: 40px"><code>1</code></td>
<td class="gt_row gt_right" headers="n_pass" style="border-left-width: 1px; border-left-style: dashed; border-left-color: #E5E5E5; font-size: 11px; height: 40px"><code>0</code><br>
<code>0</code></td>
<td class="gt_row gt_right" headers="n_fail" style="border-left-width: 1px; border-left-style: dashed; border-left-color: #E5E5E5; font-size: 11px; height: 40px"><code>1</code><br>
<code>1</code></td>
<td class="gt_row gt_center" headers="W" style="border-left-width: 1px; border-left-style: solid; border-left-color: #D3D3D3; background-color: #FCFCFC; height: 40px">â€”</td>
<td class="gt_row gt_center" headers="S" style="background-color: #FCFCFC; height: 40px"><span style="color: #CF142B;">â—</span></td>
<td class="gt_row gt_center" headers="N" style="border-right-width: 1px; border-right-style: solid; border-right-color: #D3D3D3; background-color: #FCFCFC; height: 40px">â€”</td>
<td class="gt_row gt_center" headers="extract" style="height: 40px">â€”</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="status_color" style="background-color: #CF142B; height: 40px"><br>
</td>
<td class="gt_row gt_right" headers="i" style="color: #666666; font-size: 13px; font-weight: bold; height: 40px">6</td>
<td class="gt_row gt_left" headers="type" style="height: 40px"><div aria-label="Expect that column `DT_END` is of type: Date. " data-balloon-pos="right" style="width:fit-content;">
<div style="margin:0;padding:0;display:inline-block;height:30px;vertical-align:middle;">
<svg width="30px" height="30px" viewbox="0 0 67 67" version="1.1" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink">
<title>
col_is_date
</title>
<g id="All-Icons" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"> <g id="col_is_date" transform="translate(0.000000, 0.379310)"> <path d="M56.712234,1.01466935 C59.1975153,1.01466935 61.4475153,2.02202867 63.076195,3.65070832 C64.7048747,5.27938798 65.712234,7.52938798 65.712234,10.0146694 L65.712234,10.0146694 L65.712234,65.0146694 L10.712234,65.0146694 C8.22695259,65.0146694 5.97695259,64.00731 4.34827294,62.3786304 C2.71959328,60.7499507 1.71223397,58.4999507 1.71223397,56.0146694 L1.71223397,56.0146694 L1.71223397,10.0146694 C1.71223397,7.52938798 2.71959328,5.27938798 4.34827294,3.65070832 C5.97695259,2.02202867 8.22695259,1.01466935 10.712234,1.01466935 L10.712234,1.01466935 Z" id="rectangle" stroke="#000000" stroke-width="2" fill="#FFFFFF"></path> <rect id="column" fill="#000000" x="12.2117153" y="12.0146694" width="20" height="42" rx="1"></rect> <path d="M40.7190873,43.0146694 L40.7190873,24.2256069 L46.9651811,24.2256069 C48.8271696,24.2256069 50.3315491,24.4329616 51.4783647,24.8476772 C52.6251803,25.2623928 53.6175206,25.9648597 54.4554155,26.955099 C55.7841981,28.5293257 56.4485795,30.6028726 56.4485795,33.1758022 C56.4485795,36.2988647 55.6233925,38.7194134 53.9729936,40.4375209 C52.3225947,42.1556285 49.9993758,43.0146694 47.003267,43.0146694 L40.7190873,43.0146694 Z M43.385103,41.0215053 L46.800142,41.0215053 C49.2376542,41.0215053 50.9641994,40.3655874 51.9798295,39.0537319 C53.0716319,37.6572405 53.6175248,35.7825848 53.6175248,33.4297084 C53.6175248,31.220713 53.0800953,29.4857043 52.0052202,28.2246303 C51.3535242,27.4544441 50.5748861,26.9275939 49.6692827,26.6440639 C48.7636792,26.3605338 47.4010626,26.2187709 45.581392,26.2187709 L43.385103,26.2187709 L43.385103,41.0215053 Z" id="D" fill="#000000"></path> </g> </g>
</svg>
</div>
<code style="font-size:11px;">&nbsp;col_is_date()</code>
</div></td>
<td class="gt_row gt_left" headers="columns" style="border-left-width: 1px; border-left-style: dashed; border-left-color: #E5E5E5; height: 40px"><div aria-label="DT_END" data-balloon-pos="left">
<p><span style="color:purple;"><code>â–®</code></span><code>DT_END</code></p>
</div></td>
<td class="gt_row gt_left" headers="values" style="border-left-width: 1px; border-left-style: dashed; border-left-color: #E5E5E5; height: 40px">â€”</td>
<td class="gt_row gt_center" headers="precon" style="border-left-width: 1px; border-left-style: solid; border-left-color: #D3D3D3; background-color: #FCFCFC; height: 40px"><span style="background:transparent;padding:0;color:#333333;vertical-align:middle;font-size:10px;border:none;border-radius:4px;" aria-label="No modifications of the table." data-balloon-pos="left">
<svg width="25px" height="25px" viewbox="0 0 25 25" version="1.1" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" style="vertical-align: middle;">
<g id="unchanged" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"> <g id="unchanged" transform="translate(0.500000, 0.570147)"> <rect id="Rectangle" x="0.125132506" y="0" width="23.749735" height="23.7894737"></rect> <path d="M5.80375046,8.18194736 C3.77191832,8.18194736 2.11875046,9.83495328 2.11875046,11.8669474 C2.11875046,13.8989414 3.77191832,15.5519474 5.80375046,15.5519474 C7.8355826,15.5519474 9.48875046,13.8989414 9.48875046,11.8669474 C9.48875046,9.83495328 7.83552863,8.18194736 5.80375046,8.18194736 Z M5.80375046,14.814915 C4.17821997,14.814915 2.85578285,13.4924778 2.85578285,11.8669474 C2.85578285,10.2414169 4.17821997,8.91897975 5.80375046,8.91897975 C7.42928095,8.91897975 8.75171807,10.2414169 8.75171807,11.8669474 C8.75171807,13.4924778 7.42928095,14.814915 5.80375046,14.814915 Z" id="Shape" fill="#000000" fill-rule="nonzero"></path> <path d="M13.9638189,8.699335 C13.9364621,8.70430925 13.9091059,8.71176968 13.8842359,8.71923074 C13.7822704,8.73663967 13.6877654,8.77643115 13.6056956,8.83860518 L10.2433156,11.3852598 C10.0766886,11.5046343 9.97720993,11.6986181 9.97720993,11.9025491 C9.97720993,12.1064807 10.0766886,12.3004639 10.2433156,12.4198383 L13.6056956,14.966493 C13.891697,15.1803725 14.2970729,15.1231721 14.5109517,14.8371707 C14.7248313,14.5511692 14.6676309,14.145794 14.3816294,13.9319145 L12.5313257,12.5392127 L21.8812495,12.5392127 L21.8812495,11.2658854 L12.5313257,11.2658854 L14.3816294,9.87318364 C14.6377872,9.71650453 14.7497006,9.40066014 14.6477351,9.11714553 C14.5482564,8.83363156 14.262255,8.65954352 13.9638189,8.699335 Z" id="arrow" fill="#000000" transform="translate(15.929230, 11.894737) rotate(-180.000000) translate(-15.929230, -11.894737) "></path> </g> </g>
</svg>
</span></td>
<td class="gt_row gt_center" headers="eval_sym" style="border-right-width: 1px; border-right-style: solid; border-right-color: #D3D3D3; background-color: #FCFCFC; height: 40px"><span style="background:transparent;padding:5px;color:#4CA64C;vertical-align:middle;font-size:15px;border:none;" aria-label="No evaluation issues." data-balloon-pos="left">âœ“</span></td>
<td class="gt_row gt_right" headers="units" style="font-size: 11px; height: 40px"><code>1</code></td>
<td class="gt_row gt_right" headers="n_pass" style="border-left-width: 1px; border-left-style: dashed; border-left-color: #E5E5E5; font-size: 11px; height: 40px"><code>0</code><br>
<code>0</code></td>
<td class="gt_row gt_right" headers="n_fail" style="border-left-width: 1px; border-left-style: dashed; border-left-color: #E5E5E5; font-size: 11px; height: 40px"><code>1</code><br>
<code>1</code></td>
<td class="gt_row gt_center" headers="W" style="border-left-width: 1px; border-left-style: solid; border-left-color: #D3D3D3; background-color: #FCFCFC; height: 40px">â€”</td>
<td class="gt_row gt_center" headers="S" style="background-color: #FCFCFC; height: 40px"><span style="color: #CF142B;">â—</span></td>
<td class="gt_row gt_center" headers="N" style="border-right-width: 1px; border-right-style: solid; border-right-color: #D3D3D3; background-color: #FCFCFC; height: 40px">â€”</td>
<td class="gt_row gt_center" headers="extract" style="height: 40px">â€”</td>
</tr>
</tbody><tfoot class="gt_sourcenotes">
<tr class="odd">
<td colspan="14" class="gt_sourcenote"><span style="background-color:#FFF;color:#444;padding:0.5em 0.5em;position:inherit;text-transform:uppercase;margin-left:10px;border:solid 1px #999999;font-variant-numeric:tabular-nums;border-radius:0;padding:2px 10px 2px 10px;padding:2px 10px 2px 10px;">2024-07-04 09:52:39 +07</span> <span style="background-color:#FFF;color:#444;padding:0.5em 0.5em;position:inherit;margin:5px 1px 5px 0;border:solid 1px #999999;font-variant-numeric:tabular-nums;border-radius:0;padding:2px 10px 2px 10px;">&lt; 1 s</span> <span style="background-color:#FFF;color:#444;padding:0.5em 0.5em;position:inherit;text-transform:uppercase;margin:5px 1px 5px -1px;border:solid 1px #999999;font-variant-numeric:tabular-nums;border-radius:0;padding:2px 10px 2px 10px;">2024-07-04 09:52:39 +07</span></td>
</tr>
</tfoot>

</table>

</div>
</div>
</div>
</div>
<p>Cool! KhÃ´ng chá»‰ kiá»ƒm tra Ä‘Æ°á»£c tÃ­nh Ä‘Ãºng Ä‘áº¯n cá»§a dá»¯ liá»‡u, cÅ©ng cÃ³ thá»ƒ xÃ¡c Ä‘á»‹nh Ä‘Æ°á»£c biáº¿n nÃ o khÃ´ng tuÃ¢n theo quy táº¯c Ä‘áº·t tÃªn.</p>
</section>
<section id="data-discoverability" class="level1">
<h1>Data Discoverability</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1">cols_data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(trip_data)</span>
<span id="cb6-2">cols_data_split <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">strsplit</span>(cols_data,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"_"</span>)</span>
<span id="cb6-3">cols_components <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(</span>
<span id="cb6-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">variable =</span> cols_data,</span>
<span id="cb6-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">level1 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">vapply</span>(cols_data_split, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">FUN =</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(x) x[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">FUN.VALUE =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">character</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)),</span>
<span id="cb6-6">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">level2 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">vapply</span>(cols_data_split, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">FUN =</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(x) x[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">FUN.VALUE =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">character</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>))</span>
<span id="cb6-7">)</span>
<span id="cb6-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(cols_components)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              variable level1      level2
1              ID_TRIP     ID        TRIP
2 CAT_DESTINATION_CITY    CAT DESTINATION
3             DT_START     DT       START
4               DT_END     DT         END
5       N_DURATION_DAY      N    DURATION
6    CAT_TRAVELER_NAME    CAT    TRAVELER</code></pre>
</div>
</div>
<p>ÄÃ¢y lÃ  má»™t cÃ¡ch Ä‘á»ƒ xÃ¢y dá»±ng metadata, chÃºng ta cÃ³ thá»ƒ touch má»™t cÃ¡ch interactive vá»›i:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(DT)</span>
<span id="cb8-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">datatable</span>(cols_components,  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">filter =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'top'</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">clear =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>))</span></code></pre></div>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-38da5d6e8848be63810c" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-38da5d6e8848be63810c">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td><\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n    <\/div>\n  <\/td>\n<\/tr>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13"],["ID_TRIP","CAT_DESTINATION_CITY","DT_START","DT_END","N_DURATION_DAY","CAT_TRAVELER_NAME","VAL_AGE_TRAVELER","IND_GENDER_TRAVELER","CAT_TRAVELER_NATIONALITY","CAT_ACCOMMODATION_TYPE","AMT_ACCOMMODATION_COST","CAT_TRANSPORTATION_TYPE","AMT_TRANSPORTATION_COST"],["ID","CAT","DT","DT","N","CAT","VAL","IND","CAT","CAT","AMT","CAT","AMT"],["TRIP","DESTINATION","START","END","DURATION","TRAVELER","AGE","GENDER","TRAVELER","ACCOMMODATION","ACCOMMODATION","TRANSPORTATION","TRANSPORTATION"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>variable<\/th>\n      <th>level1<\/th>\n      <th>level2<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"variable","targets":1},{"name":"level1","targets":2},{"name":"level2","targets":3}],"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>CÅ©ng cÃ³ thá»ƒ visualize thÃ nh má»™t tree nhÆ° bÃªn dÆ°á»›i:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(collapsibleTree)</span>
<span id="cb9-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">collapsibleTree</span>(cols_components, </span>
<span id="cb9-3">                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hierarchy =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"level"</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>),</span>
<span id="cb9-4">                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nodeSize =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"leafCount"</span></span>
<span id="cb9-5">                )</span></code></pre></div>
<div class="cell-output-display">
<div class="collapsibleTree html-widget html-fill-item" id="htmlwidget-848b250e5c4166207b6a" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-848b250e5c4166207b6a">{"x":{"data":{"name":"cols_components","SizeOfNode":34.41,"children":[{"name":"ID","SizeOfNode":9.93,"children":[{"name":"TRIP","SizeOfNode":9.93}]},{"name":"CAT","SizeOfNode":19.87,"children":[{"name":"DESTINATION","SizeOfNode":9.93},{"name":"TRAVELER","SizeOfNode":9.93},{"name":"ACCOMMODATION","SizeOfNode":9.93},{"name":"TRANSPORTATION","SizeOfNode":9.93}]},{"name":"DT","SizeOfNode":14.05,"children":[{"name":"START","SizeOfNode":9.93},{"name":"END","SizeOfNode":9.93}]},{"name":"N","SizeOfNode":9.93,"children":[{"name":"DURATION","SizeOfNode":9.93}]},{"name":"VAL","SizeOfNode":9.93,"children":[{"name":"AGE","SizeOfNode":9.93}]},{"name":"IND","SizeOfNode":9.93,"children":[{"name":"GENDER","SizeOfNode":9.93}]},{"name":"AMT","SizeOfNode":14.05,"children":[{"name":"ACCOMMODATION","SizeOfNode":9.93},{"name":"TRANSPORTATION","SizeOfNode":9.93}]}]},"options":{"hierarchy":["level1","level2"],"input":null,"attribute":"leafCount","linkLength":null,"fontSize":10,"tooltip":false,"collapsed":true,"zoomable":true,"margin":{"top":20,"bottom":20,"left":124.41,"right":95},"fill":"lightsteelblue"}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>ÄÃ¢y lÃ  cÃ¡ch xem tá»« kiá»ƒu dá»¯ liá»‡u -&gt; chá»§ thá»ƒ, chÃºng ta cÅ©ng cÃ³ thá»ƒ lÃ m ngÆ°á»£c láº¡i:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">collapsibleTree</span>(cols_components, </span>
<span id="cb10-2">                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hierarchy =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"level"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)),</span>
<span id="cb10-3">                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nodeSize =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"leafCount"</span></span>
<span id="cb10-4">                )</span></code></pre></div>
<div class="cell-output-display">
<div class="collapsibleTree html-widget html-fill-item" id="htmlwidget-7e3f955f97ec0b1d8268" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-7e3f955f97ec0b1d8268">{"x":{"data":{"name":"cols_components","SizeOfNode":34.41,"children":[{"name":"TRIP","SizeOfNode":9.93,"children":[{"name":"ID","SizeOfNode":9.93}]},{"name":"DESTINATION","SizeOfNode":9.93,"children":[{"name":"CAT","SizeOfNode":9.93}]},{"name":"START","SizeOfNode":9.93,"children":[{"name":"DT","SizeOfNode":9.93}]},{"name":"END","SizeOfNode":9.93,"children":[{"name":"DT","SizeOfNode":9.93}]},{"name":"DURATION","SizeOfNode":9.93,"children":[{"name":"N","SizeOfNode":9.93}]},{"name":"TRAVELER","SizeOfNode":9.93,"children":[{"name":"CAT","SizeOfNode":9.93}]},{"name":"AGE","SizeOfNode":9.93,"children":[{"name":"VAL","SizeOfNode":9.93}]},{"name":"GENDER","SizeOfNode":9.93,"children":[{"name":"IND","SizeOfNode":9.93}]},{"name":"ACCOMMODATION","SizeOfNode":14.05,"children":[{"name":"CAT","SizeOfNode":9.93},{"name":"AMT","SizeOfNode":9.93}]},{"name":"TRANSPORTATION","SizeOfNode":14.05,"children":[{"name":"CAT","SizeOfNode":9.93},{"name":"AMT","SizeOfNode":9.93}]}]},"options":{"hierarchy":["level2","level1"],"input":null,"attribute":"leafCount","linkLength":null,"fontSize":10,"tooltip":false,"collapsed":true,"zoomable":true,"margin":{"top":20,"bottom":20,"left":124.41,"right":40},"fill":"lightsteelblue"}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>Bá»™ dá»¯ liá»‡u mÃ¬nh sá»­ dá»¥ng khÃ¡ nghÃ¨o nÃ n vÃ  táº­p trung vá» má»™t chá»§ thá»ƒ duy nháº¥t lÃ  <code>TRIP</code>, nÃªn kháº£ nÄƒng minh há»a khÃ´ng Ä‘Æ°á»£c phong phÃº ğŸ˜‚. NgoÃ i ra, viá»‡c Ä‘áº·t tÃªn nhÆ° tháº¿ cÅ©ng giÃºp ta dá»… dÃ ng gá»i biáº¿n á»Ÿ IDE.</p>
</section>
<section id="data-wrangling" class="level1">
<h1>Data Wrangling</h1>
<p>TÆ°Æ¡ng tá»±, vá»›i viá»‡c sá»­ dá»¥ng má»™t bá»™ tá»« Ä‘iá»ƒn cÃ³ há»‡ thá»‘ng, lá»›p lang cÅ©ng support chÃºng ta trong viá»‡c biáº¿n Ä‘á»•i dá»¯ liá»‡u. VÃ­ dá»¥ chÃºng ta cÃ³ thá»ƒ táº­n dá»¥ng â€œselect helpersâ€ trong gÃ³i <code>dplyr</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(dplyr)</span>
<span id="cb11-2">trip_data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.data.frame</span>(trip_data)</span>
<span id="cb11-3">trip_data <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb11-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">if_any</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">everything</span>(), <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(.))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb11-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(CAT_TRAVELER_NATIONALITY) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb11-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarize</span>(</span>
<span id="cb11-7">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">across</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">starts_with</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"DT_"</span>), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(min,max))</span>
<span id="cb11-8">  )</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 42 Ã— 5
   CAT_TRAVELER_NATIONALITY DT_START_1 DT_START_2 DT_END_1   DT_END_2 
   &lt;chr&gt;                    &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;    
 1 American                 1/1/2023   9/15/2022  1/1/2023   9/22/2022
 2 Australian               11/20/2023 9/5/2022   11/30/2023 9/14/2022
 3 Brazil                   4/3/2024   4/3/2024   4/10/2024  4/10/2024
 4 Brazilian                1/15/2024  8/1/2023   1/12/2024  8/10/2023
 5 British                  1/1/2025   8/20/2022  1/15/2023  9/2/2022 
 6 Cambodia                 9/10/2022  9/10/2022  9/15/2022  9/15/2022
 7 Canada                   7/1/2022   9/1/2022   7/10/2022  9/10/2022
 8 Canadian                 1/2/2023   8/15/2023  1/9/2023   8/22/2023
 9 China                    5/8/2023   5/8/2023   5/14/2023  5/14/2023
10 Chinese                  11/11/2022 9/1/2023   11/21/2022 9/8/2023 
# â„¹ 32 more rows</code></pre>
</div>
</div>
</section>
<section id="other-languages" class="level1">
<h1>Other languages</h1>
<section id="generating-sql" class="level2">
<h2 class="anchored" data-anchor-id="generating-sql">Generating SQL</h2>
<p>Sá»­ dá»¥ng R Ä‘á»ƒ generate SQL query</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(dbplyr)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'dbplyr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:dplyr':

    ident, sql</code></pre>
</div>
<div class="sourceCode cell-code" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(RSQLite)</span>
<span id="cb16-2">df_mem <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">memdb_frame</span>(trip_data, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.name =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"example_table"</span>)</span>
<span id="cb16-3"></span>
<span id="cb16-4">df_mem <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb16-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(CAT_TRAVELER_NATIONALITY) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb16-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarize_at</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">vars</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">starts_with</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"N_"</span>)), mean, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb16-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">show_query</span>()</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;SQL&gt;
SELECT `CAT_TRAVELER_NATIONALITY`, AVG(`N_DURATION_DAY`) AS `N_DURATION_DAY`
FROM `example_table`
GROUP BY `CAT_TRAVELER_NATIONALITY`</code></pre>
</div>
</div>
</section>
<section id="r---base-data.table" class="level2">
<h2 class="anchored" data-anchor-id="r---base-data.table">R - <code>base</code> &amp; <code>data.table</code></h2>
<p>sá»­ dá»¥ng <code>base::grep</code> Ä‘á»ƒ tÃ¬m táº¥t cáº£ cÃ¡c columns báº¯t Ä‘áº§u báº±ng <code>AMT_</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1">cols_n <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grep</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"^AMT_"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(trip_data), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">value =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb18-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(cols_n)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "AMT_ACCOMMODATION_COST"  "AMT_TRANSPORTATION_COST"</code></pre>
</div>
</div>
<p>sá»­ dá»¥ng vector Ä‘á»ƒ lÆ°u cÃ¡c cá»™t chÃºng ta muá»‘n group by:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20" style="background: #f1f3f5;"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1">cols_grp <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"CAT_TRAVELER_NATIONALITY"</span>)</span></code></pre></div>
</div>
<p>chÃºng ta cÃ³ thá»ƒ dÃ¹ng vector nÃ y trong <code>stats::aggregate</code></p>
<p>hoáº·c trong <code>data.table</code></p>
</section>
<section id="python-pandas" class="level2">
<h2 class="anchored" data-anchor-id="python-pandas">python <code>pandas</code></h2>
<p>tÆ°Æ¡ng tá»± trong python, sá»­ dá»¥ng list comprehension:</p>
<div class="sourceCode" id="cb21" style="background: #f1f3f5;"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb21-1"><span class="in" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">```{python}</span></span>
<span id="cb21-2"></span>
<span id="cb21-3"><span class="in" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">import pandas as pd</span></span>
<span id="cb21-4"><span class="in" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">cols_n   = [vbl for vbl in trip_data.columns if vbl[0:2] == 'AMT_']</span></span>
<span id="cb21-5"><span class="in" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">cols_grp = ["CAT_TRAVELER_NATIONALITY"]</span></span>
<span id="cb21-6"><span class="in" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">trip_data.groupby(cols_grp)[cols_n].sum()</span></span>
<span id="cb21-7"><span class="in" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">```</span></span></code></pre></div>
</section>
</section>
<section id="updates-by-emily" class="level1">
<h1>Updates by Emily</h1>
<section id="concept-map" class="level2">
<h2 class="anchored" data-anchor-id="concept-map">Concept Map</h2>
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">%%{init: {'theme':'dark'}}%%
flowchart LR
  A(dataframe)-- has --&gt; B(columns)
  A(dataframe)-- has --&gt; C(names)
  B -- have --&gt; D(data types)
  B -- have --&gt; E(units)
  B -- have --&gt; F(meaning)
  C -- should encode --&gt; D
  C -- should encode --&gt; E
  C -- should encode --&gt; F
  C -- can support --&gt; G(validation)
  C -- explained in --&gt; H(documentation)
  G -- should check consistency of --&gt; C
  G -- should check consistency of --&gt; H
  H --&gt; I(data dictionary)
  H --&gt; K(ERD)
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
</section>
<section id="new-package-dec-2020" class="level2">
<h2 class="anchored" data-anchor-id="new-package-dec-2020">New Package (Dec 2020)</h2>
<p><a href="https://emilyriederer.github.io/convo/articles/quickstart-guide.html"><code>convo</code></a> lÃ  má»™t thÆ° viá»‡n released bá»Ÿi Emily phá»¥c vá»¥ cho viá»‡c quáº£n lÃ½ controlled vocabulary:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22" style="background: #f1f3f5;"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(convo)</span></code></pre></div>
</div>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>vocab.yaml</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb23" style="background: #f1f3f5;"><pre class="sourceCode numberSource yaml number-lines code-with-copy"><code class="sourceCode yaml"><span id="cb23-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">level1</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb23-2"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">  </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ID</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb23-3"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">desc</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> Unique identifier</span></span>
<span id="cb23-4"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">valid</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb23-5"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">-</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> col_vals_not_null()</span></span>
<span id="cb23-6"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">-</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> col_is_numeric()</span></span>
<span id="cb23-7"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">-</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> col_vals_between(1000, 99999)</span></span>
<span id="cb23-8"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">  </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">IND</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb23-9"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">desc</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> Binary indicator</span></span>
<span id="cb23-10"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">valid</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb23-11"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">-</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> col_is_numeric()</span></span>
<span id="cb23-12"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">-</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> col_vals_in_set(c(0,1))</span></span>
<span id="cb23-13"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rename</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb23-14"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">-</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">when</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> SUM</span></span>
<span id="cb23-15"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">        </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">then</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'N'</span></span>
<span id="cb23-16"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">-</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">when</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> AVG</span></span>
<span id="cb23-17"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">        </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">then</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> P</span></span>
<span id="cb23-18"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">  </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">AMT</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb23-19"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">desc</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> Non-negative, summable quantity</span></span>
<span id="cb23-20"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">valid</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb23-21"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">-</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> col_is_numeric()</span></span>
<span id="cb23-22"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">-</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> col_vals_gte(0)</span></span>
<span id="cb23-23"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">  </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">VAL</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb23-24"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">desc</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> Value</span></span>
<span id="cb23-25"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">valid</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb23-26"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">-</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> col_is_numeric()</span></span>
<span id="cb23-27"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rename</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb23-28"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">-</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">when</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> AVG</span></span>
<span id="cb23-29"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">        </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">then</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> VALAV</span></span></code></pre></div>
</div>
</div>
</section>
<section id="new-package-april-2021" class="level2">
<h2 class="anchored" data-anchor-id="new-package-april-2021">New Package (April 2021)</h2>
<p><a href="https://emilyriederer.github.io/dbtplyr/#!/overview"><code>dbtplyr</code></a> lÃ  má»™t package port tÃ­nh nÄƒng â€œselect helpersâ€ cá»§a <code>dplyr</code> sang <code>dbt</code>.</p>


<!-- -->

</section>
</section>

 ]]></description>
  <category>data quality</category>
  <category>name convention</category>
  <category>controlled vocabulary</category>
  <category>metadata</category>
  <guid>https://lktuan.github.io/blog/2024-06-05-cnac/</guid>
  <pubDate>Tue, 04 Jun 2024 17:00:00 GMT</pubDate>
  <media:content url="https://lktuan.github.io/blog/2024-06-05-cnac/pepe.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>Storytelling with Data: Letâ€™s Practice, Improve this table!</title>
  <dc:creator>Tuan Le Khac</dc:creator>
  <link>https://lktuan.github.io/blog/2024-05-22-swd-p2-improve-table/</link>
  <description><![CDATA[ 





<section id="motivation" class="level1">
<h1>1. Motivation</h1>
<p>Láº¥y cáº£m há»©ng tá»« bÃ i <a href="https://rpubs.com/chidungkt/1139405">post</a> cá»§a tháº§y Nguyá»…n ChÃ­ DÅ©ng vá» viá»‡c giáº£i cÃ¡c exercise thuá»™c ChÆ°Æ¡ng 2 cuá»‘n sÃ¡ch <strong>Storytelling with Data: Letâ€™s Practice</strong> cá»§a tÃ¡c giáº£ <a href="https://www.linkedin.com/in/colenussbaumer/">Cole Nussbaumer Knaflic</a> sá»­ dá»¥ng R, mÃ¬nh muá»‘n cáº£i thiá»‡n 1 báº£ng biá»ƒu nhÆ°ng sá»­ dá»¥ng Python (trong cuá»‘n sÃ¡ch gá»‘c, tÃ¡c giáº£ sá»­ dá»¥ng Excel Ä‘á»ƒ makeover cÃ¡c graph).</p>
<p>ÄÃ¢y lÃ  má»™t cuá»‘n sÃ¡ch hay vá» chá»§ Ä‘á»ƒ visualization, dÃ nh cho nhá»¯ng ngÆ°á»i sá»­ dá»¥ng biá»ƒu Ä‘á»“ nhiá»u Ä‘á»ƒ communicate trong cÃ´ng viá»‡c. Cá»¥m tá»« â€œstorytellingâ€ Ä‘ang Ä‘Æ°á»£c sá»­ dá»¥ng ráº¥t nhiá»u, tháº­m chÃ­ nhÆ° lÃ  má»™t buzzword, má»™t keyword cáº§n cÃ³ trong CV cá»§a má»—i ngÆ°á»i lÃ m data. Äá»‘i vá»›i mÃ¬nh, â€œstorytellingâ€ chá»‰ nÃªn Ä‘Æ°á»£c sá»­ dá»¥ng khi báº¡n Ä‘Ã£ cÃ³ sáºµn cÃ¡c káº¿t quáº£ phÃ¢n tÃ­ch, Ä‘Æ°á»£c thá»±c hiá»‡n má»™t cÃ¡ch khoa há»c, vÃ  báº¡n muá»‘n truyá»n táº£i nÃ³ tá»›i business unit/management má»™t cÃ¡ch hiá»‡u quáº£. â€œStorytellingâ€ nÃªn khÃ´ng bao giá» lÃ  Ä‘á»™ng cÆ¡ Ä‘á»ƒ báº¡n thá»±c hiá»‡n má»™t phÃ¢n tÃ­ch (thá»© thay vÃ o Ä‘Ã³ nÃªn lÃ  má»™t <strong>cÃ¢u há»i</strong>), thiÃªn kiáº¿n sáº½ áº£nh hÆ°á»Ÿng tá»›i phÆ°Æ¡ng phÃ¡p thá»±c hiá»‡n, vÃ  ráº¥t dá»… náº£y sinh ngá»¥y biá»‡n khi káº¿t luáº­n. HÃ£y xem bÃ i viáº¿t nÃ y cá»§a <a href="https://www.linkedin.com/pulse/data-professionals-beware-storytelling-keith-mcnulty/">Keith McNulty</a> vÃ  <a href="https://www.linkedin.com/posts/keith-mcnulty_my-most-hated-word-in-data-science-activity-7017097392759918592-2Atc/">discussion</a> trÃªn Linked In.</p>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="1">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://lktuan.github.io/blog/2024-05-22-swd-p2-improve-table/swd_chap5.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption>Photo credit to <a href="https://www.storytellingwithdata.com/blog/2019/8/27/lets-practice">swd</a></figcaption>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="lets-practice" class="level1">
<h1>2. Letâ€™s Practice</h1>
<p>MÃ¬nh Ä‘ang há»c <code>{ggplot2}</code> trÃªn R Ä‘á»ƒ thá»±c hÃ nh hÃ¬nh áº£nh hÃ³a dá»¯ liá»‡u, tuy nhiÃªn cÃ³ váº» package nÃ y (vÃ  tÆ°Æ¡ng á»©ng lÃ  <code>plotnine</code> trÃªn Python khÃ´ng phÃ¹ há»£p cho bÃ¡o cÃ¡o báº£ng). Trong bÃ i post, tháº§y DÅ©ng cÅ©ng sá»­ dá»¥ng má»™t library khÃ¡c lÃ  <code>kableExtra</code> (tham kháº£o <a href="https://cran.r-project.org/web/packages/kableExtra/vignettes/awesome_table_in_html.html">Ä‘Ã¢y</a>).</p>
<p>Sau má»™t lÃºc google thÃ¬ cÃ³ váº» cÃ³ má»™t package cá»§a Python phÃ¹ há»£p Ä‘á»ƒ lÃ m nhiá»‡m vá»¥ nÃ y, Ä‘Ã³ lÃ  <code>great_tables</code> (tham kháº£o <a href="https://posit-dev.github.io/great-tables/articles/intro.html">Ä‘Ã¢y</a>). Package nÃ y cÅ©ng Ä‘Æ°á»£c khuyáº¿n khÃ­ch sá»­ dá»¥ng cho má»¥c Ä‘Ã­ch communication bá»Ÿi <a href="https://www.emilyriederer.com/post/py-rgo/#the-stack">Emily Riederer</a>.</p>
<section id="import-the-data" class="level2">
<h2 class="anchored" data-anchor-id="import-the-data">2.1. Import the data</h2>
<p>Okay Ä‘áº§u tiÃªn cáº§n import vÃ  lÃ m sáº¡ch dá»¯ liá»‡u. Báº£ng cÃ³ sáºµn trong file Exercise cÃ³ váº» dÃ¹ng Ä‘á»ƒ bÃ¡o cÃ¡o hÆ¡n lÃ  lÆ°u trá»¯ dá»¯ liá»‡u.</p>
<div id="562db42c" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> pandas <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> pd</span>
<span id="cb1-2"></span>
<span id="cb1-3">data <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pd.read_excel(</span>
<span id="cb1-4">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"2.1 EXERCISE.xlsx"</span>,</span>
<span id="cb1-5">  sheet_name <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"EXERCISE 2.1"</span>,</span>
<span id="cb1-6">  skiprows<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span></span>
<span id="cb1-7">)</span>
<span id="cb1-8"></span>
<span id="cb1-9">data <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> data.drop(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Unnamed: 0'</span>, axis<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb1-10">data <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> data.rename(columns<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>{ <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Tier"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tier"</span></span>
<span id="cb1-11">                    ,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# of Accounts"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"no_of_account"</span></span>
<span id="cb1-12">                    ,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"% Accounts"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pct_of_account"</span></span>
<span id="cb1-13">                    ,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Revenue ($M)"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"revenue"</span></span>
<span id="cb1-14">                    ,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"% Revenue"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pct_of_revenue"</span>})</span></code></pre></div>
</div>
</section>
<section id="data-manipulation" class="level2">
<h2 class="anchored" data-anchor-id="data-manipulation">2.2. Data manipulation</h2>
<p>Yep giá» ta Ä‘Ã£ cÃ³ 1 báº£ng data khÃ¡ sáº¡ch, tuy nhiÃªn lÆ°u Ã½ lÃ  báº£ng Ä‘ang khÃ´ng thá»ƒ hiá»‡n toÃ n bá»™ dá»¯ liá»‡u (total cá»§a <code>pct_of_account</code> chá»‰ lÃ  <code>81.86%</code>). Ta cáº§n tÃ­nh toÃ¡n thÃªm <code>All other</code> vÃ  <code>Grand Total</code> (lÃ½ do lÃ  mÃ¬nh chÆ°a tÃ¬m tháº¥y function hiá»ƒn thá»‹ Grand Total vá»›i package Ä‘ang sá»­ dá»¥ng, ngay cáº£ trong vÃ­ dá»¥ <a href="https://posit-dev.github.io/great-tables/blog/pycon-2024-great-tables-are-possible/">nÃ y</a>, GT cÅ©ng sá»­ dá»¥ng data Ä‘Ã£ cÃ³ sáºµn Grand Total).</p>
<div id="19805bdd" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb2-1">all_other_pct_of_account <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> data[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pct_of_account"</span>].<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sum</span>()</span>
<span id="cb2-2">all_other_no_of_account <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">round</span>(all_other_pct_of_account <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> data[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pct_of_account"</span>][<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> data[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"no_of_account"</span>][<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>],<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb2-3"></span>
<span id="cb2-4">all_other_pct_of_revenue <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> data[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pct_of_revenue"</span>].<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sum</span>()</span>
<span id="cb2-5">all_other_revenue <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">round</span>(all_other_pct_of_revenue <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> data[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pct_of_revenue"</span>][<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> data[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"revenue"</span>][<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>],<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span>
<span id="cb2-6"></span>
<span id="cb2-7">all_other <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pd.Series({ <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tier"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"All other"</span>,</span>
<span id="cb2-8">                        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"no_of_account"</span>: all_other_no_of_account,</span>
<span id="cb2-9">                        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pct_of_account"</span>: all_other_pct_of_account,</span>
<span id="cb2-10">                        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"revenue"</span>:all_other_revenue,</span>
<span id="cb2-11">                        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pct_of_revenue"</span>: all_other_pct_of_revenue})</span>
<span id="cb2-12"></span>
<span id="cb2-13">data <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pd.concat([data, all_other.to_frame().T], ignore_index<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span>
<span id="cb2-14"></span>
<span id="cb2-15">data.loc[<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(data.index)] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> data.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sum</span>()</span>
<span id="cb2-16">data.loc[data.index[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'tier'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Grand Total'</span></span></code></pre></div>
</div>
<p>Show the data:</p>
<div id="f85da960" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb3-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> great_tables <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> GT</span>
<span id="cb3-2"></span>
<span id="cb3-3">( </span>
<span id="cb3-4">  GT(data)</span>
<span id="cb3-5">  .fmt_number(columns<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"no_of_account"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pct_of_account"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"revenue"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pct_of_revenue"</span>],decimals<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>))</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="3">
<div>
<div id="craneejhel" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>
#craneejhel table {
          font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
          -webkit-font-smoothing: antialiased;
          -moz-osx-font-smoothing: grayscale;
        }

#craneejhel thead, tbody, tfoot, tr, td, th { border-style: none; }
 tr { background-color: transparent; }
#craneejhel p { margin: 0; padding: 0; }
 #craneejhel .gt_table { display: table; border-collapse: collapse; line-height: normal; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; }
 #craneejhel .gt_caption { padding-top: 4px; padding-bottom: 4px; }
 #craneejhel .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; padding-left: 5px; padding-right: 5px; border-bottom-color: #FFFFFF; border-bottom-width: 0; }
 #craneejhel .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 3px; padding-bottom: 5px; padding-left: 5px; padding-right: 5px; border-top-color: #FFFFFF; border-top-width: 0; }
 #craneejhel .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; }
 #craneejhel .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; }
 #craneejhel .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; }
 #craneejhel .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 5px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; }
 #craneejhel .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; }
 #craneejhel .gt_column_spanner_outer:first-child { padding-left: 0; }
 #craneejhel .gt_column_spanner_outer:last-child { padding-right: 0; }
 #craneejhel .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 5px; overflow-x: hidden; display: inline-block; width: 100%; }
 #craneejhel .gt_spanner_row { border-bottom-style: hidden; }
 #craneejhel .gt_group_heading { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; text-align: left; }
 #craneejhel .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; }
 #craneejhel .gt_from_md> :first-child { margin-top: 0; }
 #craneejhel .gt_from_md> :last-child { margin-bottom: 0; }
 #craneejhel .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; }
 #craneejhel .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 5px; padding-right: 5px; }
 #craneejhel .gt_stub_row_group { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 5px; padding-right: 5px; vertical-align: top; }
 #craneejhel .gt_row_group_first td { border-top-width: 2px; }
 #craneejhel .gt_row_group_first th { border-top-width: 2px; }
 #craneejhel .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; }
 #craneejhel .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; }
 #craneejhel .gt_sourcenote { font-size: 90%; padding-top: 4px; padding-bottom: 4px; padding-left: 5px; padding-right: 5px; text-align: left; }
 #craneejhel .gt_left { text-align: left; }
 #craneejhel .gt_center { text-align: center; }
 #craneejhel .gt_right { text-align: right; font-variant-numeric: tabular-nums; }
 #craneejhel .gt_font_normal { font-weight: normal; }
 #craneejhel .gt_font_bold { font-weight: bold; }
 #craneejhel .gt_font_italic { font-style: italic; }
 #craneejhel .gt_super { font-size: 65%; }
 #craneejhel .gt_footnote_marks { font-size: 75%; vertical-align: 0.4em; position: initial; }
 #craneejhel .gt_asterisk { font-size: 100%; vertical-align: 0; }
 
</style>

<table class="gt_table table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<tbody>
<tr class="odd gt_col_headings">
<td id="tier" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">tier</td>
<td id="no_of_account" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">no_of_account</td>
<td id="pct_of_account" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">pct_of_account</td>
<td id="revenue" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">revenue</td>
<td id="pct_of_revenue" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">pct_of_revenue</td>
</tr>
</tbody>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left">A</td>
<td class="gt_row gt_right">77.00</td>
<td class="gt_row gt_right">0.07</td>
<td class="gt_row gt_right">4.67</td>
<td class="gt_row gt_right">0.25</td>
</tr>
<tr class="even">
<td class="gt_row gt_left">A+</td>
<td class="gt_row gt_right">19.00</td>
<td class="gt_row gt_right">0.02</td>
<td class="gt_row gt_right">3.93</td>
<td class="gt_row gt_right">0.21</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left">B</td>
<td class="gt_row gt_right">338.00</td>
<td class="gt_row gt_right">0.31</td>
<td class="gt_row gt_right">5.98</td>
<td class="gt_row gt_right">0.32</td>
</tr>
<tr class="even">
<td class="gt_row gt_left">C</td>
<td class="gt_row gt_right">425.00</td>
<td class="gt_row gt_right">0.39</td>
<td class="gt_row gt_right">2.80</td>
<td class="gt_row gt_right">0.15</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left">D</td>
<td class="gt_row gt_right">24.00</td>
<td class="gt_row gt_right">0.02</td>
<td class="gt_row gt_right">0.37</td>
<td class="gt_row gt_right">0.02</td>
</tr>
<tr class="even">
<td class="gt_row gt_left">All other</td>
<td class="gt_row gt_right">205.00</td>
<td class="gt_row gt_right">0.19</td>
<td class="gt_row gt_right">0.94</td>
<td class="gt_row gt_right">0.05</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left">Grand Total</td>
<td class="gt_row gt_right">1,088.00</td>
<td class="gt_row gt_right">1.00</td>
<td class="gt_row gt_right">18.70</td>
<td class="gt_row gt_right">1.00</td>
</tr>
</tbody>
</table>


</div>
        
</div>
</div>
</div>
</section>
<section id="visualization" class="level2">
<h2 class="anchored" data-anchor-id="visualization">2.3. Visualization</h2>
<p>ÄÆ°á»£c rá»“i, giá» ta cÃ³ thá»ƒ dÃ¹ng <code>great_tables</code> Ä‘á»ƒ tiáº¿n hÃ nh visualize. Vá» cÆ¡ báº£n, chá»‰ cáº§n khá»Ÿi táº¡o má»™t object <code>GT()</code> cÃ³ thá»ƒ má»Ÿ rá»™ng Ä‘Æ°á»£c, cÃ¡c element/hoáº·c format Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a vá» sau.</p>
<p>DÆ°á»›i Ä‘Ã¢y chÃºng ta trÃ¬nh bÃ y má»™t báº£ng Ä‘Æ¡n giáº£n vá»›i tiÃªu Ä‘á», tÃªn cá»™t, cÅ©ng nhÆ° Ä‘á»‹nh dáº¡ng láº¡i dá»¯ liá»‡u.</p>
<div id="de0bc25c" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb4-1">(</span>
<span id="cb4-2">  GT(data)</span>
<span id="cb4-3">  .tab_header(title<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"New client tier share"</span>)</span>
<span id="cb4-4">  .cols_label(</span>
<span id="cb4-5">    tier <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Tier"</span>,</span>
<span id="cb4-6">    no_of_account <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# of Accounts"</span>,</span>
<span id="cb4-7">    pct_of_account <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"% Accounts"</span>,</span>
<span id="cb4-8">    revenue <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Revenue ($M)"</span>,</span>
<span id="cb4-9">    pct_of_revenue <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"% Revenue"</span></span>
<span id="cb4-10">  )</span>
<span id="cb4-11">  .fmt_number(columns<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"no_of_account"</span>,decimals<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb4-12">  .fmt_percent(columns<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pct_of_account"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pct_of_revenue"</span>], decimals<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb4-13">  .fmt_currency(columns <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"revenue"</span>, currency<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"USD"</span>, decimals<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb4-14">  .tab_source_note(source_note<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Figure 2.1b: Slightly improved table"</span>)</span>
<span id="cb4-15">)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<div>
<div id="owjzkcqqrj" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>
#owjzkcqqrj table {
          font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
          -webkit-font-smoothing: antialiased;
          -moz-osx-font-smoothing: grayscale;
        }

#owjzkcqqrj thead, tbody, tfoot, tr, td, th { border-style: none; }
 tr { background-color: transparent; }
#owjzkcqqrj p { margin: 0; padding: 0; }
 #owjzkcqqrj .gt_table { display: table; border-collapse: collapse; line-height: normal; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; }
 #owjzkcqqrj .gt_caption { padding-top: 4px; padding-bottom: 4px; }
 #owjzkcqqrj .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; padding-left: 5px; padding-right: 5px; border-bottom-color: #FFFFFF; border-bottom-width: 0; }
 #owjzkcqqrj .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 3px; padding-bottom: 5px; padding-left: 5px; padding-right: 5px; border-top-color: #FFFFFF; border-top-width: 0; }
 #owjzkcqqrj .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; }
 #owjzkcqqrj .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; }
 #owjzkcqqrj .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; }
 #owjzkcqqrj .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 5px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; }
 #owjzkcqqrj .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; }
 #owjzkcqqrj .gt_column_spanner_outer:first-child { padding-left: 0; }
 #owjzkcqqrj .gt_column_spanner_outer:last-child { padding-right: 0; }
 #owjzkcqqrj .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 5px; overflow-x: hidden; display: inline-block; width: 100%; }
 #owjzkcqqrj .gt_spanner_row { border-bottom-style: hidden; }
 #owjzkcqqrj .gt_group_heading { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; text-align: left; }
 #owjzkcqqrj .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; }
 #owjzkcqqrj .gt_from_md> :first-child { margin-top: 0; }
 #owjzkcqqrj .gt_from_md> :last-child { margin-bottom: 0; }
 #owjzkcqqrj .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; }
 #owjzkcqqrj .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 5px; padding-right: 5px; }
 #owjzkcqqrj .gt_stub_row_group { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 5px; padding-right: 5px; vertical-align: top; }
 #owjzkcqqrj .gt_row_group_first td { border-top-width: 2px; }
 #owjzkcqqrj .gt_row_group_first th { border-top-width: 2px; }
 #owjzkcqqrj .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; }
 #owjzkcqqrj .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; }
 #owjzkcqqrj .gt_sourcenote { font-size: 90%; padding-top: 4px; padding-bottom: 4px; padding-left: 5px; padding-right: 5px; text-align: left; }
 #owjzkcqqrj .gt_left { text-align: left; }
 #owjzkcqqrj .gt_center { text-align: center; }
 #owjzkcqqrj .gt_right { text-align: right; font-variant-numeric: tabular-nums; }
 #owjzkcqqrj .gt_font_normal { font-weight: normal; }
 #owjzkcqqrj .gt_font_bold { font-weight: bold; }
 #owjzkcqqrj .gt_font_italic { font-style: italic; }
 #owjzkcqqrj .gt_super { font-size: 65%; }
 #owjzkcqqrj .gt_footnote_marks { font-size: 75%; vertical-align: 0.4em; position: initial; }
 #owjzkcqqrj .gt_asterisk { font-size: 100%; vertical-align: 0; }
 
</style>

<table class="gt_table table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead class="gt_header">
<tr class="header">
<th colspan="5" class="gt_heading gt_title gt_font_normal" data-quarto-table-cell-role="th">New client tier share</th>
</tr>
</thead>
<tbody>
<tr class="odd gt_col_headings">
<td id="Tier" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">Tier</td>
<td id="# of Accounts" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col"># of Accounts</td>
<td id="% Accounts" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">% Accounts</td>
<td id="Revenue ($M)" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Revenue ($M)</td>
<td id="% Revenue" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">% Revenue</td>
</tr>
</tbody>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left">A</td>
<td class="gt_row gt_right">77</td>
<td class="gt_row gt_right">7.08%</td>
<td class="gt_row gt_right">$4.67</td>
<td class="gt_row gt_right">25.00%</td>
</tr>
<tr class="even">
<td class="gt_row gt_left">A+</td>
<td class="gt_row gt_right">19</td>
<td class="gt_row gt_right">1.75%</td>
<td class="gt_row gt_right">$3.93</td>
<td class="gt_row gt_right">21.00%</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left">B</td>
<td class="gt_row gt_right">338</td>
<td class="gt_row gt_right">31.07%</td>
<td class="gt_row gt_right">$5.98</td>
<td class="gt_row gt_right">32.00%</td>
</tr>
<tr class="even">
<td class="gt_row gt_left">C</td>
<td class="gt_row gt_right">425</td>
<td class="gt_row gt_right">39.06%</td>
<td class="gt_row gt_right">$2.80</td>
<td class="gt_row gt_right">15.00%</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left">D</td>
<td class="gt_row gt_right">24</td>
<td class="gt_row gt_right">2.21%</td>
<td class="gt_row gt_right">$0.37</td>
<td class="gt_row gt_right">2.00%</td>
</tr>
<tr class="even">
<td class="gt_row gt_left">All other</td>
<td class="gt_row gt_right">205</td>
<td class="gt_row gt_right">18.84%</td>
<td class="gt_row gt_right">$0.94</td>
<td class="gt_row gt_right">5.00%</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left">Grand Total</td>
<td class="gt_row gt_right">1,088</td>
<td class="gt_row gt_right">100.00%</td>
<td class="gt_row gt_right">$18.70</td>
<td class="gt_row gt_right">100.00%</td>
</tr>
</tbody><tfoot class="gt_sourcenotes">
<tr class="odd">
<td colspan="5" class="gt_sourcenote">Figure 2.1b: Slightly improved table</td>
</tr>
</tfoot>

</table>


</div>
        
</div>
</div>
</div>
<p>TrÃ´ng á»•n (Ã­t nháº¥t lÃ  trÃ¬nh bÃ y sá»‘ liá»‡u má»™t cÃ¡ch toÃ n váº¹n) so vá»›i báº£n gá»‘c rá»“i!</p>
<p>Tiáº¿p tá»¥c, ta dÃ¹ng - helper <code>md()</code> Ä‘á»ƒ Ä‘á»‹nh dáº¡ng láº¡i tiÃªu Ä‘á»; - sá»­ dá»¥ng <code>.data_color()</code> Ä‘á»ƒ táº¡o heatmapping; - sá»­ dá»¥ng <code>tab_style()</code> Ä‘á»ƒ format dÃ²ng Grand Total; - sá»­ dá»¥ng <code>.opt_stylize()</code> Ä‘á»ƒ theming.</p>
<div id="35220963" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb5-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> great_tables <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> md, style, loc</span>
<span id="cb5-2"></span>
<span id="cb5-3">(</span>
<span id="cb5-4">  GT(data)</span>
<span id="cb5-5">  .tab_header(title<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>md(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;strong&gt;New client tier share&lt;/strong&gt;"</span>))</span>
<span id="cb5-6">  .opt_align_table_header(align<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"left"</span>)</span>
<span id="cb5-7">  .cols_label(</span>
<span id="cb5-8">    tier <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Tier"</span>,</span>
<span id="cb5-9">    no_of_account <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# of Accounts"</span>,</span>
<span id="cb5-10">    pct_of_account <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"% Accounts"</span>,</span>
<span id="cb5-11">    revenue <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"($M) Revenue"</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># change the label</span></span>
<span id="cb5-12">    pct_of_revenue <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"% Revenue"</span></span>
<span id="cb5-13">  )</span>
<span id="cb5-14">  .fmt_number(columns<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"no_of_account"</span>,decimals<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb5-15">  .fmt_percent(columns<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pct_of_account"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pct_of_revenue"</span>], decimals<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># changed decimals</span></span>
<span id="cb5-16">  .fmt_currency(columns <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"revenue"</span>, currency<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"USD"</span>, decimals<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)<span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># changed decimals</span></span>
<span id="cb5-17">  .tab_source_note(source_note<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Figure 2.1c: Table with heatmapping"</span>)</span>
<span id="cb5-18">  .data_color(</span>
<span id="cb5-19">    columns<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pct_of_account"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pct_of_revenue"</span>],</span>
<span id="cb5-20">    palette<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#57A6A1"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#577B8D"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#344C64"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#240750"</span>],</span>
<span id="cb5-21">    domain<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>],</span>
<span id="cb5-22">    na_color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lightgray"</span>,</span>
<span id="cb5-23">    autocolor_text <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span></span>
<span id="cb5-24">  )</span>
<span id="cb5-25">  .tab_style(</span>
<span id="cb5-26">        style<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[</span>
<span id="cb5-27">          style.text(style<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bolder"</span>),</span>
<span id="cb5-28">          style.fill(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#EEEEEE"</span>),</span>
<span id="cb5-29">          style.borders(sides<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"top"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bottom"</span>], weight<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'2px'</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey"</span>)</span>
<span id="cb5-30">          ],</span>
<span id="cb5-31">        locations<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>loc.body(rows<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>])</span>
<span id="cb5-32">  )</span>
<span id="cb5-33">  .opt_stylize(style<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span> ,color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'blue'</span>)</span>
<span id="cb5-34">)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<div>
<div id="xlwzucecqv" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>
#xlwzucecqv table {
          font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
          -webkit-font-smoothing: antialiased;
          -moz-osx-font-smoothing: grayscale;
        }

#xlwzucecqv thead, tbody, tfoot, tr, td, th { border-style: none; }
 tr { background-color: transparent; }
#xlwzucecqv p { margin: 0; padding: 0; }
 #xlwzucecqv .gt_table { display: table; border-collapse: collapse; line-height: normal; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #D5D5D5; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D5D5D5; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; }
 #xlwzucecqv .gt_caption { padding-top: 4px; padding-bottom: 4px; }
 #xlwzucecqv .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; padding-left: 5px; padding-right: 5px; border-bottom-color: #FFFFFF; border-bottom-width: 0; }
 #xlwzucecqv .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 3px; padding-bottom: 5px; padding-left: 5px; padding-right: 5px; border-top-color: #FFFFFF; border-top-width: 0; }
 #xlwzucecqv .gt_heading { background-color: #FFFFFF; text-align: left; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; }
 #xlwzucecqv .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D5D5D5; }
 #xlwzucecqv .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D5D5D5; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D5D5D5; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; }
 #xlwzucecqv .gt_col_heading { color: #FFFFFF; background-color: #004D80; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 5px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; }
 #xlwzucecqv .gt_column_spanner_outer { color: #FFFFFF; background-color: #004D80; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; }
 #xlwzucecqv .gt_column_spanner_outer:first-child { padding-left: 0; }
 #xlwzucecqv .gt_column_spanner_outer:last-child { padding-right: 0; }
 #xlwzucecqv .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D5D5D5; vertical-align: bottom; padding-top: 5px; padding-bottom: 5px; overflow-x: hidden; display: inline-block; width: 100%; }
 #xlwzucecqv .gt_spanner_row { border-bottom-style: hidden; }
 #xlwzucecqv .gt_group_heading { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D5D5D5; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D5D5D5; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; text-align: left; }
 #xlwzucecqv .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D5D5D5; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D5D5D5; vertical-align: middle; }
 #xlwzucecqv .gt_from_md> :first-child { margin-top: 0; }
 #xlwzucecqv .gt_from_md> :last-child { margin-bottom: 0; }
 #xlwzucecqv .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D5D5D5; border-left-style: solid; border-left-width: 1px; border-left-color: #D5D5D5; border-right-style: solid; border-right-width: 1px; border-right-color: #D5D5D5; vertical-align: middle; overflow-x: hidden; }
 #xlwzucecqv .gt_stub { color: #333333; background-color: #929292; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D5D5D5; padding-left: 5px; padding-right: 5px; }
 #xlwzucecqv .gt_stub_row_group { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 5px; padding-right: 5px; vertical-align: top; }
 #xlwzucecqv .gt_row_group_first td { border-top-width: 2px; }
 #xlwzucecqv .gt_row_group_first th { border-top-width: 2px; }
 #xlwzucecqv .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D5D5D5; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D5D5D5; }
 #xlwzucecqv .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; }
 #xlwzucecqv .gt_sourcenote { font-size: 90%; padding-top: 4px; padding-bottom: 4px; padding-left: 5px; padding-right: 5px; text-align: left; }
 #xlwzucecqv .gt_left { text-align: left; }
 #xlwzucecqv .gt_center { text-align: center; }
 #xlwzucecqv .gt_right { text-align: right; font-variant-numeric: tabular-nums; }
 #xlwzucecqv .gt_font_normal { font-weight: normal; }
 #xlwzucecqv .gt_font_bold { font-weight: bold; }
 #xlwzucecqv .gt_font_italic { font-style: italic; }
 #xlwzucecqv .gt_super { font-size: 65%; }
 #xlwzucecqv .gt_footnote_marks { font-size: 75%; vertical-align: 0.4em; position: initial; }
 #xlwzucecqv .gt_asterisk { font-size: 100%; vertical-align: 0; }
 
</style>

<table class="gt_table table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead class="gt_header">
<tr class="header">
<th colspan="5" class="gt_heading gt_title gt_font_normal" data-quarto-table-cell-role="th"><strong>New client tier share</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd gt_col_headings">
<td id="Tier" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">Tier</td>
<td id="# of Accounts" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col"># of Accounts</td>
<td id="% Accounts" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">% Accounts</td>
<td id="($M) Revenue" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">($M) Revenue</td>
<td id="% Revenue" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">% Revenue</td>
</tr>
</tbody>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left">A</td>
<td class="gt_row gt_right">77</td>
<td class="gt_row gt_right" style="background-color: #579d9d">7%</td>
<td class="gt_row gt_right">$4.7</td>
<td class="gt_row gt_right" style="background-color: #578692">25%</td>
</tr>
<tr class="even">
<td class="gt_row gt_left">A+</td>
<td class="gt_row gt_right">19</td>
<td class="gt_row gt_right" style="background-color: #57a4a0">2%</td>
<td class="gt_row gt_right">$3.9</td>
<td class="gt_row gt_right" style="background-color: #578b94">21%</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left">B</td>
<td class="gt_row gt_right">338</td>
<td class="gt_row gt_right" style="background-color: #577e8e">31%</td>
<td class="gt_row gt_right">$6.0</td>
<td class="gt_row gt_right" style="background-color: #577d8e">32%</td>
</tr>
<tr class="even">
<td class="gt_row gt_left">C</td>
<td class="gt_row gt_right">425</td>
<td class="gt_row gt_right" style="background-color: #517386">39%</td>
<td class="gt_row gt_right">$2.8</td>
<td class="gt_row gt_right" style="background-color: #579398">15%</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left">D</td>
<td class="gt_row gt_right">24</td>
<td class="gt_row gt_right" style="background-color: #57a3a0">2%</td>
<td class="gt_row gt_right">$0.4</td>
<td class="gt_row gt_right" style="background-color: #57a3a0">2%</td>
</tr>
<tr class="even">
<td class="gt_row gt_left">All other</td>
<td class="gt_row gt_right">205</td>
<td class="gt_row gt_right" style="background-color: #578e96">19%</td>
<td class="gt_row gt_right">$0.9</td>
<td class="gt_row gt_right" style="background-color: #57a09e">5%</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" style="font-style: bolder; background-color: #EEEEEE; border-top: 2px solid grey; border-bottom: 2px solid grey">Grand Total</td>
<td class="gt_row gt_right" style="font-style: bolder; background-color: #EEEEEE; border-top: 2px solid grey; border-bottom: 2px solid grey">1,088</td>
<td class="gt_row gt_right" style="background-color: #240750; font-style: bolder; background-color: #EEEEEE; border-top: 2px solid grey; border-bottom: 2px solid grey">100%</td>
<td class="gt_row gt_right" style="font-style: bolder; background-color: #EEEEEE; border-top: 2px solid grey; border-bottom: 2px solid grey">$18.7</td>
<td class="gt_row gt_right" style="background-color: #240750; font-style: bolder; background-color: #EEEEEE; border-top: 2px solid grey; border-bottom: 2px solid grey">100%</td>
</tr>
</tbody><tfoot class="gt_sourcenotes">
<tr class="odd">
<td colspan="5" class="gt_sourcenote">Figure 2.1c: Table with heatmapping</td>
</tr>
</tfoot>

</table>


</div>
        
</div>
</div>
</div>
<p>Tiáº¿p theo, chÃºng ta sáº½ thá»­ dÃ¹ng <code>fmt_nanoplot()</code> Ä‘á»ƒ táº¡o má»™t bar plots thay cho hai cá»™t percentage.</p>
<p>ÄÃ¢y lÃ  má»™t tÃ­nh nÄƒng trong giai Ä‘oáº¡n thá»­ nghiá»‡m nÃªn mÃ¬nh tháº¥y chÆ°a thá»±c sá»­ á»•n Ä‘á»‹nh vÃ  tuÃ¢n theo document mÃ  nhÃ  phÃ¡t triá»ƒn Ä‘á» cáº­p. Trong vÃ­ dá»¥ dÆ°á»›i Ä‘Ã¢y mÃ¬nh sá»­ dá»¥ng data bar, loáº¡i bá» format do hÃ ng cuá»‘i cÃ¹ng. Tuy nhiÃªn, Ä‘á»“ thá»‹ váº«n include giÃ¡ trá»‹ <code>100%</code> á»Ÿ hÃ ng Grand Total Ä‘á»ƒ Ä‘iá»u chá»‰nh bar scale.</p>
<p>ThÃªm ná»¯a mÃ¬nh cáº§n chuyá»ƒn dataframe vá» polar dataframe, khi Ä‘Ã³ má»™t column cá»§a dl.df lÃ  iterable.</p>
<div id="be86356a" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb6-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> great_tables <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> md, style, loc, nanoplot_options</span>
<span id="cb6-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> numpy <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> np</span>
<span id="cb6-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> polars <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> pl</span>
<span id="cb6-4"></span>
<span id="cb6-5">data.at[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pct_of_account"</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.nan</span>
<span id="cb6-6">data.at[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pct_of_revenue"</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.nan</span>
<span id="cb6-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># so that the data scale looks better</span></span>
<span id="cb6-8"></span>
<span id="cb6-9">pl_data <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pl.from_pandas(data)</span>
<span id="cb6-10"></span>
<span id="cb6-11">(</span>
<span id="cb6-12">  GT(pl_data, rowname_col<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tier"</span>)</span>
<span id="cb6-13">  .tab_header(title<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>md(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;strong&gt;New client tier share&lt;/strong&gt;"</span>))</span>
<span id="cb6-14">  .opt_align_table_header(align<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"left"</span>)</span>
<span id="cb6-15">  .tab_source_note(source_note<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Figure 2.1d: Table with data bar"</span>)</span>
<span id="cb6-16">  .cols_label(</span>
<span id="cb6-17">    tier <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Tier"</span>,</span>
<span id="cb6-18">    no_of_account <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"# of Accounts"</span>,</span>
<span id="cb6-19">    pct_of_account <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"% Accounts"</span>,</span>
<span id="cb6-20">    revenue <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"($M) Revenue"</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># change the label</span></span>
<span id="cb6-21">    pct_of_revenue <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"% Revenue"</span></span>
<span id="cb6-22">  )</span>
<span id="cb6-23">  .fmt_number(columns<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"no_of_account"</span>,decimals<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb6-24">  .fmt_currency(columns <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"revenue"</span>, currency<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"USD"</span>, decimals<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb6-25">  .fmt_percent(columns<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pct_of_account"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pct_of_revenue"</span>], decimals<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># changed decimals</span></span>
<span id="cb6-26">  .cols_width(</span>
<span id="cb6-27">    cases<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>{</span>
<span id="cb6-28">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tier"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"20%"</span>,</span>
<span id="cb6-29">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"no_of_account"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"20%"</span>,</span>
<span id="cb6-30">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pct_of_account"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"20%"</span>,</span>
<span id="cb6-31">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"revenue"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"20%"</span>,</span>
<span id="cb6-32">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pct_of_revenue"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"20%"</span>      </span>
<span id="cb6-33">    }</span>
<span id="cb6-34">    )</span>
<span id="cb6-35">  .fmt_nanoplot(</span>
<span id="cb6-36">    columns<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pct_of_account"</span>,</span>
<span id="cb6-37">    rows <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>],</span>
<span id="cb6-38">    plot_type<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bar"</span>,</span>
<span id="cb6-39">    plot_height <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"3em"</span>,</span>
<span id="cb6-40">    autoscale<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>,</span>
<span id="cb6-41">    options<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>nanoplot_options(</span>
<span id="cb6-42">      data_bar_stroke_color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#577B8D"</span>,</span>
<span id="cb6-43">      data_bar_stroke_width<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">80</span>,</span>
<span id="cb6-44">      data_bar_fill_color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#577B8D"</span>,)</span>
<span id="cb6-45">    )</span>
<span id="cb6-46">  .fmt_nanoplot(</span>
<span id="cb6-47">    columns<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pct_of_revenue"</span>,</span>
<span id="cb6-48">    rows <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>],</span>
<span id="cb6-49">    plot_type<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bar"</span>,</span>
<span id="cb6-50">    plot_height <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"3em"</span>,</span>
<span id="cb6-51">    autoscale<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>,</span>
<span id="cb6-52">    options<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>nanoplot_options(</span>
<span id="cb6-53">      data_bar_stroke_color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#577B8D"</span>,</span>
<span id="cb6-54">      data_bar_stroke_width<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">80</span>,</span>
<span id="cb6-55">      data_bar_fill_color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#577B8D"</span>,)</span>
<span id="cb6-56">  )</span>
<span id="cb6-57">  .tab_style(</span>
<span id="cb6-58">        style<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[</span>
<span id="cb6-59">          style.text(style<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bolder"</span>),</span>
<span id="cb6-60">          style.fill(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#EEEEEE"</span>),</span>
<span id="cb6-61">          style.borders(sides<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"top"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bottom"</span>], weight<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'2px'</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey"</span>)</span>
<span id="cb6-62">          ],</span>
<span id="cb6-63">        locations<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>loc.body(rows<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>])</span>
<span id="cb6-64">  )</span>
<span id="cb6-65">  .tab_style(</span>
<span id="cb6-66">        style<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[</span>
<span id="cb6-67">          style.text(color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#EEEEEE"</span>, size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>),</span>
<span id="cb6-68">          ],</span>
<span id="cb6-69">        locations<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>loc.body(rows<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>], columns<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pct_of_account"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pct_of_revenue"</span>])</span>
<span id="cb6-70">  )</span>
<span id="cb6-71">  .opt_stylize(style<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span> ,color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'blue'</span>)</span>
<span id="cb6-72">)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">
<div>
<div id="xsdfljskly" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>
#xsdfljskly table {
          font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
          -webkit-font-smoothing: antialiased;
          -moz-osx-font-smoothing: grayscale;
        }

#xsdfljskly thead, tbody, tfoot, tr, td, th { border-style: none; }
 tr { background-color: transparent; }
#xsdfljskly p { margin: 0; padding: 0; }
 #xsdfljskly .gt_table { display: table; border-collapse: collapse; line-height: normal; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #929292; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #929292; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; }
 #xsdfljskly .gt_caption { padding-top: 4px; padding-bottom: 4px; }
 #xsdfljskly .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; padding-left: 5px; padding-right: 5px; border-bottom-color: #FFFFFF; border-bottom-width: 0; }
 #xsdfljskly .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 3px; padding-bottom: 5px; padding-left: 5px; padding-right: 5px; border-top-color: #FFFFFF; border-top-width: 0; }
 #xsdfljskly .gt_heading { background-color: #FFFFFF; text-align: left; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; }
 #xsdfljskly .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #929292; }
 #xsdfljskly .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #929292; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #929292; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; }
 #xsdfljskly .gt_col_heading { color: #FFFFFF; background-color: #004D80; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 5px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; }
 #xsdfljskly .gt_column_spanner_outer { color: #FFFFFF; background-color: #004D80; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; }
 #xsdfljskly .gt_column_spanner_outer:first-child { padding-left: 0; }
 #xsdfljskly .gt_column_spanner_outer:last-child { padding-right: 0; }
 #xsdfljskly .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #929292; vertical-align: bottom; padding-top: 5px; padding-bottom: 5px; overflow-x: hidden; display: inline-block; width: 100%; }
 #xsdfljskly .gt_spanner_row { border-bottom-style: hidden; }
 #xsdfljskly .gt_group_heading { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #929292; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #929292; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; text-align: left; }
 #xsdfljskly .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #929292; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #929292; vertical-align: middle; }
 #xsdfljskly .gt_from_md> :first-child { margin-top: 0; }
 #xsdfljskly .gt_from_md> :last-child { margin-bottom: 0; }
 #xsdfljskly .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: dashed; border-top-width: 1px; border-top-color: #929292; border-left-style: none; border-left-width: 1px; border-left-color: #929292; border-right-style: none; border-right-width: 1px; border-right-color: #929292; vertical-align: middle; overflow-x: hidden; }
 #xsdfljskly .gt_stub { color: #333333; background-color: #D5D5D5; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: none; border-right-width: 2px; border-right-color: #FFFFFF; padding-left: 5px; padding-right: 5px; }
 #xsdfljskly .gt_stub_row_group { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 5px; padding-right: 5px; vertical-align: top; }
 #xsdfljskly .gt_row_group_first td { border-top-width: 2px; }
 #xsdfljskly .gt_row_group_first th { border-top-width: 2px; }
 #xsdfljskly .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #929292; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #929292; }
 #xsdfljskly .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; }
 #xsdfljskly .gt_sourcenote { font-size: 90%; padding-top: 4px; padding-bottom: 4px; padding-left: 5px; padding-right: 5px; text-align: left; }
 #xsdfljskly .gt_left { text-align: left; }
 #xsdfljskly .gt_center { text-align: center; }
 #xsdfljskly .gt_right { text-align: right; font-variant-numeric: tabular-nums; }
 #xsdfljskly .gt_font_normal { font-weight: normal; }
 #xsdfljskly .gt_font_bold { font-weight: bold; }
 #xsdfljskly .gt_font_italic { font-style: italic; }
 #xsdfljskly .gt_super { font-size: 65%; }
 #xsdfljskly .gt_footnote_marks { font-size: 75%; vertical-align: 0.4em; position: initial; }
 #xsdfljskly .gt_asterisk { font-size: 100%; vertical-align: 0; }
 
</style>

<table class="gt_table table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<colgroup>
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
</colgroup>
<thead class="gt_header">
<tr class="header">
<th colspan="5" class="gt_heading gt_title gt_font_normal" data-quarto-table-cell-role="th"><strong>New client tier share</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd gt_col_headings">
<td class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"></td>
<td id="# of Accounts" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col"># of Accounts</td>
<td id="% Accounts" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">% Accounts</td>
<td id="($M) Revenue" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">($M) Revenue</td>
<td id="% Revenue" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">% Revenue</td>
</tr>
</tbody>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left gt_stub" data-quarto-table-cell-role="th">A</td>
<td class="gt_row gt_right">77</td>
<td class="gt_row gt_right"><div>
<svg viewbox="0 0 600 130" style="height: 3em; margin-left: auto; margin-right: auto; font-size: inherit; overflow: visible; vertical-align: middle; position:relative;">
<defs><pattern id="area_pattern" width="8" height="8" patternunits="userSpaceOnUse"><path class="pattern-line" d="M 0,8 l 8,-8 M -1,1 l 4,-4 M 6,10 l 4,-4" stroke="#FF0000" stroke-width="1.5" stroke-linecap="round" shape-rendering="geometricPrecision"></path></pattern></defs>
<style> text { font-family: ui-monospace, 'Cascadia Code', 'Source Code Pro', Menlo, Consolas, 'DejaVu Sans Mono', monospace; stroke-width: 0.15em; paint-order: stroke; stroke-linejoin: round; cursor: default; } .vert-line:hover rect { fill: #911EB4; fill-opacity: 40%; stroke: #FFFFFF60; color: red; } .vert-line:hover text { stroke: white; fill: #212427; } .horizontal-line:hover text {stroke: white; fill: #212427; } .ref-line:hover rect { stroke: #FFFFFF60; } .ref-line:hover line { stroke: #FF0000; } .ref-line:hover text { stroke: white; fill: #212427; } .y-axis-line:hover rect { fill: #EDEDED; fill-opacity: 60%; stroke: #FFFFFF60; color: red; } .y-axis-line:hover text { stroke: white; stroke-width: 0.20em; fill: #1A1C1F; } </style>
<line x1="0.0" y1="5.0" x2="0.0" y2="125.0" stroke="#BFBFBF" stroke-width="4"></line><rect x="0.0" y="45.0" width="108.70588235294117" height="40" stroke="#577B8D" stroke-width="80" fill="#577B8D"></rect><g class="horizontal-line"><rect x="0" y="45.0" width="600" height="40" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="10.0" y="25" fill="transparent" stroke="transparent" font-size="30px">0.071</text></g>
</svg>
</div></td>
<td class="gt_row gt_right">$4.7</td>
<td class="gt_row gt_right"><div>
<svg viewbox="0 0 600 130" style="height: 3em; margin-left: auto; margin-right: auto; font-size: inherit; overflow: visible; vertical-align: middle; position:relative;">
<defs><pattern id="area_pattern" width="8" height="8" patternunits="userSpaceOnUse"><path class="pattern-line" d="M 0,8 l 8,-8 M -1,1 l 4,-4 M 6,10 l 4,-4" stroke="#FF0000" stroke-width="1.5" stroke-linecap="round" shape-rendering="geometricPrecision"></path></pattern></defs>
<style> text { font-family: ui-monospace, 'Cascadia Code', 'Source Code Pro', Menlo, Consolas, 'DejaVu Sans Mono', monospace; stroke-width: 0.15em; paint-order: stroke; stroke-linejoin: round; cursor: default; } .vert-line:hover rect { fill: #911EB4; fill-opacity: 40%; stroke: #FFFFFF60; color: red; } .vert-line:hover text { stroke: white; fill: #212427; } .horizontal-line:hover text {stroke: white; fill: #212427; } .ref-line:hover rect { stroke: #FFFFFF60; } .ref-line:hover line { stroke: #FF0000; } .ref-line:hover text { stroke: white; fill: #212427; } .y-axis-line:hover rect { fill: #EDEDED; fill-opacity: 60%; stroke: #FFFFFF60; color: red; } .y-axis-line:hover text { stroke: white; stroke-width: 0.20em; fill: #1A1C1F; } </style>
<line x1="0.0" y1="5.0" x2="0.0" y2="125.0" stroke="#BFBFBF" stroke-width="4"></line><rect x="0.0" y="45.0" width="468.75" height="40" stroke="#577B8D" stroke-width="80" fill="#577B8D"></rect><g class="horizontal-line"><rect x="0" y="45.0" width="600" height="40" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="10.0" y="25" fill="transparent" stroke="transparent" font-size="30px">0.25</text></g>
</svg>
</div></td>
</tr>
<tr class="even">
<td class="gt_row gt_left gt_stub" data-quarto-table-cell-role="th">A+</td>
<td class="gt_row gt_right">19</td>
<td class="gt_row gt_right"><div>
<svg viewbox="0 0 600 130" style="height: 3em; margin-left: auto; margin-right: auto; font-size: inherit; overflow: visible; vertical-align: middle; position:relative;">
<defs><pattern id="area_pattern" width="8" height="8" patternunits="userSpaceOnUse"><path class="pattern-line" d="M 0,8 l 8,-8 M -1,1 l 4,-4 M 6,10 l 4,-4" stroke="#FF0000" stroke-width="1.5" stroke-linecap="round" shape-rendering="geometricPrecision"></path></pattern></defs>
<style> text { font-family: ui-monospace, 'Cascadia Code', 'Source Code Pro', Menlo, Consolas, 'DejaVu Sans Mono', monospace; stroke-width: 0.15em; paint-order: stroke; stroke-linejoin: round; cursor: default; } .vert-line:hover rect { fill: #911EB4; fill-opacity: 40%; stroke: #FFFFFF60; color: red; } .vert-line:hover text { stroke: white; fill: #212427; } .horizontal-line:hover text {stroke: white; fill: #212427; } .ref-line:hover rect { stroke: #FFFFFF60; } .ref-line:hover line { stroke: #FF0000; } .ref-line:hover text { stroke: white; fill: #212427; } .y-axis-line:hover rect { fill: #EDEDED; fill-opacity: 60%; stroke: #FFFFFF60; color: red; } .y-axis-line:hover text { stroke: white; stroke-width: 0.20em; fill: #1A1C1F; } </style>
<line x1="0.0" y1="5.0" x2="0.0" y2="125.0" stroke="#BFBFBF" stroke-width="4"></line><rect x="0.0" y="45.0" width="26.823529411764707" height="40" stroke="#577B8D" stroke-width="80" fill="#577B8D"></rect><g class="horizontal-line"><rect x="0" y="45.0" width="600" height="40" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="10.0" y="25" fill="transparent" stroke="transparent" font-size="30px">0.017</text></g>
</svg>
</div></td>
<td class="gt_row gt_right">$3.9</td>
<td class="gt_row gt_right"><div>
<svg viewbox="0 0 600 130" style="height: 3em; margin-left: auto; margin-right: auto; font-size: inherit; overflow: visible; vertical-align: middle; position:relative;">
<defs><pattern id="area_pattern" width="8" height="8" patternunits="userSpaceOnUse"><path class="pattern-line" d="M 0,8 l 8,-8 M -1,1 l 4,-4 M 6,10 l 4,-4" stroke="#FF0000" stroke-width="1.5" stroke-linecap="round" shape-rendering="geometricPrecision"></path></pattern></defs>
<style> text { font-family: ui-monospace, 'Cascadia Code', 'Source Code Pro', Menlo, Consolas, 'DejaVu Sans Mono', monospace; stroke-width: 0.15em; paint-order: stroke; stroke-linejoin: round; cursor: default; } .vert-line:hover rect { fill: #911EB4; fill-opacity: 40%; stroke: #FFFFFF60; color: red; } .vert-line:hover text { stroke: white; fill: #212427; } .horizontal-line:hover text {stroke: white; fill: #212427; } .ref-line:hover rect { stroke: #FFFFFF60; } .ref-line:hover line { stroke: #FF0000; } .ref-line:hover text { stroke: white; fill: #212427; } .y-axis-line:hover rect { fill: #EDEDED; fill-opacity: 60%; stroke: #FFFFFF60; color: red; } .y-axis-line:hover text { stroke: white; stroke-width: 0.20em; fill: #1A1C1F; } </style>
<line x1="0.0" y1="5.0" x2="0.0" y2="125.0" stroke="#BFBFBF" stroke-width="4"></line><rect x="0.0" y="45.0" width="393.75" height="40" stroke="#577B8D" stroke-width="80" fill="#577B8D"></rect><g class="horizontal-line"><rect x="0" y="45.0" width="600" height="40" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="10.0" y="25" fill="transparent" stroke="transparent" font-size="30px">0.21</text></g>
</svg>
</div></td>
</tr>
<tr class="odd">
<td class="gt_row gt_left gt_stub" data-quarto-table-cell-role="th">B</td>
<td class="gt_row gt_right">338</td>
<td class="gt_row gt_right"><div>
<svg viewbox="0 0 600 130" style="height: 3em; margin-left: auto; margin-right: auto; font-size: inherit; overflow: visible; vertical-align: middle; position:relative;">
<defs><pattern id="area_pattern" width="8" height="8" patternunits="userSpaceOnUse"><path class="pattern-line" d="M 0,8 l 8,-8 M -1,1 l 4,-4 M 6,10 l 4,-4" stroke="#FF0000" stroke-width="1.5" stroke-linecap="round" shape-rendering="geometricPrecision"></path></pattern></defs>
<style> text { font-family: ui-monospace, 'Cascadia Code', 'Source Code Pro', Menlo, Consolas, 'DejaVu Sans Mono', monospace; stroke-width: 0.15em; paint-order: stroke; stroke-linejoin: round; cursor: default; } .vert-line:hover rect { fill: #911EB4; fill-opacity: 40%; stroke: #FFFFFF60; color: red; } .vert-line:hover text { stroke: white; fill: #212427; } .horizontal-line:hover text {stroke: white; fill: #212427; } .ref-line:hover rect { stroke: #FFFFFF60; } .ref-line:hover line { stroke: #FF0000; } .ref-line:hover text { stroke: white; fill: #212427; } .y-axis-line:hover rect { fill: #EDEDED; fill-opacity: 60%; stroke: #FFFFFF60; color: red; } .y-axis-line:hover text { stroke: white; stroke-width: 0.20em; fill: #1A1C1F; } </style>
<line x1="0.0" y1="5.0" x2="0.0" y2="125.0" stroke="#BFBFBF" stroke-width="4"></line><rect x="0.0" y="45.0" width="477.1764705882353" height="40" stroke="#577B8D" stroke-width="80" fill="#577B8D"></rect><g class="horizontal-line"><rect x="0" y="45.0" width="600" height="40" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="10.0" y="25" fill="transparent" stroke="transparent" font-size="30px">0.31</text></g>
</svg>
</div></td>
<td class="gt_row gt_right">$6.0</td>
<td class="gt_row gt_right"><div>
<svg viewbox="0 0 600 130" style="height: 3em; margin-left: auto; margin-right: auto; font-size: inherit; overflow: visible; vertical-align: middle; position:relative;">
<defs><pattern id="area_pattern" width="8" height="8" patternunits="userSpaceOnUse"><path class="pattern-line" d="M 0,8 l 8,-8 M -1,1 l 4,-4 M 6,10 l 4,-4" stroke="#FF0000" stroke-width="1.5" stroke-linecap="round" shape-rendering="geometricPrecision"></path></pattern></defs>
<style> text { font-family: ui-monospace, 'Cascadia Code', 'Source Code Pro', Menlo, Consolas, 'DejaVu Sans Mono', monospace; stroke-width: 0.15em; paint-order: stroke; stroke-linejoin: round; cursor: default; } .vert-line:hover rect { fill: #911EB4; fill-opacity: 40%; stroke: #FFFFFF60; color: red; } .vert-line:hover text { stroke: white; fill: #212427; } .horizontal-line:hover text {stroke: white; fill: #212427; } .ref-line:hover rect { stroke: #FFFFFF60; } .ref-line:hover line { stroke: #FF0000; } .ref-line:hover text { stroke: white; fill: #212427; } .y-axis-line:hover rect { fill: #EDEDED; fill-opacity: 60%; stroke: #FFFFFF60; color: red; } .y-axis-line:hover text { stroke: white; stroke-width: 0.20em; fill: #1A1C1F; } </style>
<line x1="0.0" y1="5.0" x2="0.0" y2="125.0" stroke="#BFBFBF" stroke-width="4"></line><rect x="0.0" y="45.0" width="600.0" height="40" stroke="#577B8D" stroke-width="80" fill="#577B8D"></rect><g class="horizontal-line"><rect x="0" y="45.0" width="600" height="40" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="10.0" y="25" fill="transparent" stroke="transparent" font-size="30px">0.32</text></g>
</svg>
</div></td>
</tr>
<tr class="even">
<td class="gt_row gt_left gt_stub" data-quarto-table-cell-role="th">C</td>
<td class="gt_row gt_right">425</td>
<td class="gt_row gt_right"><div>
<svg viewbox="0 0 600 130" style="height: 3em; margin-left: auto; margin-right: auto; font-size: inherit; overflow: visible; vertical-align: middle; position:relative;">
<defs><pattern id="area_pattern" width="8" height="8" patternunits="userSpaceOnUse"><path class="pattern-line" d="M 0,8 l 8,-8 M -1,1 l 4,-4 M 6,10 l 4,-4" stroke="#FF0000" stroke-width="1.5" stroke-linecap="round" shape-rendering="geometricPrecision"></path></pattern></defs>
<style> text { font-family: ui-monospace, 'Cascadia Code', 'Source Code Pro', Menlo, Consolas, 'DejaVu Sans Mono', monospace; stroke-width: 0.15em; paint-order: stroke; stroke-linejoin: round; cursor: default; } .vert-line:hover rect { fill: #911EB4; fill-opacity: 40%; stroke: #FFFFFF60; color: red; } .vert-line:hover text { stroke: white; fill: #212427; } .horizontal-line:hover text {stroke: white; fill: #212427; } .ref-line:hover rect { stroke: #FFFFFF60; } .ref-line:hover line { stroke: #FF0000; } .ref-line:hover text { stroke: white; fill: #212427; } .y-axis-line:hover rect { fill: #EDEDED; fill-opacity: 60%; stroke: #FFFFFF60; color: red; } .y-axis-line:hover text { stroke: white; stroke-width: 0.20em; fill: #1A1C1F; } </style>
<line x1="0.0" y1="5.0" x2="0.0" y2="125.0" stroke="#BFBFBF" stroke-width="4"></line><rect x="0.0" y="45.0" width="600.0" height="40" stroke="#577B8D" stroke-width="80" fill="#577B8D"></rect><g class="horizontal-line"><rect x="0" y="45.0" width="600" height="40" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="10.0" y="25" fill="transparent" stroke="transparent" font-size="30px">0.39</text></g>
</svg>
</div></td>
<td class="gt_row gt_right">$2.8</td>
<td class="gt_row gt_right"><div>
<svg viewbox="0 0 600 130" style="height: 3em; margin-left: auto; margin-right: auto; font-size: inherit; overflow: visible; vertical-align: middle; position:relative;">
<defs><pattern id="area_pattern" width="8" height="8" patternunits="userSpaceOnUse"><path class="pattern-line" d="M 0,8 l 8,-8 M -1,1 l 4,-4 M 6,10 l 4,-4" stroke="#FF0000" stroke-width="1.5" stroke-linecap="round" shape-rendering="geometricPrecision"></path></pattern></defs>
<style> text { font-family: ui-monospace, 'Cascadia Code', 'Source Code Pro', Menlo, Consolas, 'DejaVu Sans Mono', monospace; stroke-width: 0.15em; paint-order: stroke; stroke-linejoin: round; cursor: default; } .vert-line:hover rect { fill: #911EB4; fill-opacity: 40%; stroke: #FFFFFF60; color: red; } .vert-line:hover text { stroke: white; fill: #212427; } .horizontal-line:hover text {stroke: white; fill: #212427; } .ref-line:hover rect { stroke: #FFFFFF60; } .ref-line:hover line { stroke: #FF0000; } .ref-line:hover text { stroke: white; fill: #212427; } .y-axis-line:hover rect { fill: #EDEDED; fill-opacity: 60%; stroke: #FFFFFF60; color: red; } .y-axis-line:hover text { stroke: white; stroke-width: 0.20em; fill: #1A1C1F; } </style>
<line x1="0.0" y1="5.0" x2="0.0" y2="125.0" stroke="#BFBFBF" stroke-width="4"></line><rect x="0.0" y="45.0" width="281.25" height="40" stroke="#577B8D" stroke-width="80" fill="#577B8D"></rect><g class="horizontal-line"><rect x="0" y="45.0" width="600" height="40" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="10.0" y="25" fill="transparent" stroke="transparent" font-size="30px">0.15</text></g>
</svg>
</div></td>
</tr>
<tr class="odd">
<td class="gt_row gt_left gt_stub" data-quarto-table-cell-role="th">D</td>
<td class="gt_row gt_right">24</td>
<td class="gt_row gt_right"><div>
<svg viewbox="0 0 600 130" style="height: 3em; margin-left: auto; margin-right: auto; font-size: inherit; overflow: visible; vertical-align: middle; position:relative;">
<defs><pattern id="area_pattern" width="8" height="8" patternunits="userSpaceOnUse"><path class="pattern-line" d="M 0,8 l 8,-8 M -1,1 l 4,-4 M 6,10 l 4,-4" stroke="#FF0000" stroke-width="1.5" stroke-linecap="round" shape-rendering="geometricPrecision"></path></pattern></defs>
<style> text { font-family: ui-monospace, 'Cascadia Code', 'Source Code Pro', Menlo, Consolas, 'DejaVu Sans Mono', monospace; stroke-width: 0.15em; paint-order: stroke; stroke-linejoin: round; cursor: default; } .vert-line:hover rect { fill: #911EB4; fill-opacity: 40%; stroke: #FFFFFF60; color: red; } .vert-line:hover text { stroke: white; fill: #212427; } .horizontal-line:hover text {stroke: white; fill: #212427; } .ref-line:hover rect { stroke: #FFFFFF60; } .ref-line:hover line { stroke: #FF0000; } .ref-line:hover text { stroke: white; fill: #212427; } .y-axis-line:hover rect { fill: #EDEDED; fill-opacity: 60%; stroke: #FFFFFF60; color: red; } .y-axis-line:hover text { stroke: white; stroke-width: 0.20em; fill: #1A1C1F; } </style>
<line x1="0.0" y1="5.0" x2="0.0" y2="125.0" stroke="#BFBFBF" stroke-width="4"></line><rect x="0.0" y="45.0" width="33.88235294117647" height="40" stroke="#577B8D" stroke-width="80" fill="#577B8D"></rect><g class="horizontal-line"><rect x="0" y="45.0" width="600" height="40" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="10.0" y="25" fill="transparent" stroke="transparent" font-size="30px">0.022</text></g>
</svg>
</div></td>
<td class="gt_row gt_right">$0.4</td>
<td class="gt_row gt_right"><div>
<svg viewbox="0 0 600 130" style="height: 3em; margin-left: auto; margin-right: auto; font-size: inherit; overflow: visible; vertical-align: middle; position:relative;">
<defs><pattern id="area_pattern" width="8" height="8" patternunits="userSpaceOnUse"><path class="pattern-line" d="M 0,8 l 8,-8 M -1,1 l 4,-4 M 6,10 l 4,-4" stroke="#FF0000" stroke-width="1.5" stroke-linecap="round" shape-rendering="geometricPrecision"></path></pattern></defs>
<style> text { font-family: ui-monospace, 'Cascadia Code', 'Source Code Pro', Menlo, Consolas, 'DejaVu Sans Mono', monospace; stroke-width: 0.15em; paint-order: stroke; stroke-linejoin: round; cursor: default; } .vert-line:hover rect { fill: #911EB4; fill-opacity: 40%; stroke: #FFFFFF60; color: red; } .vert-line:hover text { stroke: white; fill: #212427; } .horizontal-line:hover text {stroke: white; fill: #212427; } .ref-line:hover rect { stroke: #FFFFFF60; } .ref-line:hover line { stroke: #FF0000; } .ref-line:hover text { stroke: white; fill: #212427; } .y-axis-line:hover rect { fill: #EDEDED; fill-opacity: 60%; stroke: #FFFFFF60; color: red; } .y-axis-line:hover text { stroke: white; stroke-width: 0.20em; fill: #1A1C1F; } </style>
<line x1="0.0" y1="5.0" x2="0.0" y2="125.0" stroke="#BFBFBF" stroke-width="4"></line><rect x="0.0" y="45.0" width="37.5" height="40" stroke="#577B8D" stroke-width="80" fill="#577B8D"></rect><g class="horizontal-line"><rect x="0" y="45.0" width="600" height="40" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="10.0" y="25" fill="transparent" stroke="transparent" font-size="30px">0.020</text></g>
</svg>
</div></td>
</tr>
<tr class="even">
<td class="gt_row gt_left gt_stub" data-quarto-table-cell-role="th">All other</td>
<td class="gt_row gt_right">205</td>
<td class="gt_row gt_right"><div>
<svg viewbox="0 0 600 130" style="height: 3em; margin-left: auto; margin-right: auto; font-size: inherit; overflow: visible; vertical-align: middle; position:relative;">
<defs><pattern id="area_pattern" width="8" height="8" patternunits="userSpaceOnUse"><path class="pattern-line" d="M 0,8 l 8,-8 M -1,1 l 4,-4 M 6,10 l 4,-4" stroke="#FF0000" stroke-width="1.5" stroke-linecap="round" shape-rendering="geometricPrecision"></path></pattern></defs>
<style> text { font-family: ui-monospace, 'Cascadia Code', 'Source Code Pro', Menlo, Consolas, 'DejaVu Sans Mono', monospace; stroke-width: 0.15em; paint-order: stroke; stroke-linejoin: round; cursor: default; } .vert-line:hover rect { fill: #911EB4; fill-opacity: 40%; stroke: #FFFFFF60; color: red; } .vert-line:hover text { stroke: white; fill: #212427; } .horizontal-line:hover text {stroke: white; fill: #212427; } .ref-line:hover rect { stroke: #FFFFFF60; } .ref-line:hover line { stroke: #FF0000; } .ref-line:hover text { stroke: white; fill: #212427; } .y-axis-line:hover rect { fill: #EDEDED; fill-opacity: 60%; stroke: #FFFFFF60; color: red; } .y-axis-line:hover text { stroke: white; stroke-width: 0.20em; fill: #1A1C1F; } </style>
<line x1="0.0" y1="5.0" x2="0.0" y2="125.0" stroke="#BFBFBF" stroke-width="4"></line><rect x="0.0" y="45.0" width="289.41176470588226" height="40" stroke="#577B8D" stroke-width="80" fill="#577B8D"></rect><g class="horizontal-line"><rect x="0" y="45.0" width="600" height="40" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="10.0" y="25" fill="transparent" stroke="transparent" font-size="30px">0.19</text></g>
</svg>
</div></td>
<td class="gt_row gt_right">$0.9</td>
<td class="gt_row gt_right"><div>
<svg viewbox="0 0 600 130" style="height: 3em; margin-left: auto; margin-right: auto; font-size: inherit; overflow: visible; vertical-align: middle; position:relative;">
<defs><pattern id="area_pattern" width="8" height="8" patternunits="userSpaceOnUse"><path class="pattern-line" d="M 0,8 l 8,-8 M -1,1 l 4,-4 M 6,10 l 4,-4" stroke="#FF0000" stroke-width="1.5" stroke-linecap="round" shape-rendering="geometricPrecision"></path></pattern></defs>
<style> text { font-family: ui-monospace, 'Cascadia Code', 'Source Code Pro', Menlo, Consolas, 'DejaVu Sans Mono', monospace; stroke-width: 0.15em; paint-order: stroke; stroke-linejoin: round; cursor: default; } .vert-line:hover rect { fill: #911EB4; fill-opacity: 40%; stroke: #FFFFFF60; color: red; } .vert-line:hover text { stroke: white; fill: #212427; } .horizontal-line:hover text {stroke: white; fill: #212427; } .ref-line:hover rect { stroke: #FFFFFF60; } .ref-line:hover line { stroke: #FF0000; } .ref-line:hover text { stroke: white; fill: #212427; } .y-axis-line:hover rect { fill: #EDEDED; fill-opacity: 60%; stroke: #FFFFFF60; color: red; } .y-axis-line:hover text { stroke: white; stroke-width: 0.20em; fill: #1A1C1F; } </style>
<line x1="0.0" y1="5.0" x2="0.0" y2="125.0" stroke="#BFBFBF" stroke-width="4"></line><rect x="0.0" y="45.0" width="93.74999999999987" height="40" stroke="#577B8D" stroke-width="80" fill="#577B8D"></rect><g class="horizontal-line"><rect x="0" y="45.0" width="600" height="40" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="10.0" y="25" fill="transparent" stroke="transparent" font-size="30px">0.050</text></g>
</svg>
</div></td>
</tr>
<tr class="odd">
<td class="gt_row gt_left gt_stub" data-quarto-table-cell-role="th">Grand Total</td>
<td class="gt_row gt_right" style="font-style: bolder; background-color: #EEEEEE; border-top: 2px solid grey; border-bottom: 2px solid grey">1,088</td>
<td class="gt_row gt_right" style="font-style: bolder; background-color: #EEEEEE; border-top: 2px solid grey; border-bottom: 2px solid grey; color: #EEEEEE; font-size: 0.5">None</td>
<td class="gt_row gt_right" style="font-style: bolder; background-color: #EEEEEE; border-top: 2px solid grey; border-bottom: 2px solid grey">$18.7</td>
<td class="gt_row gt_right" style="font-style: bolder; background-color: #EEEEEE; border-top: 2px solid grey; border-bottom: 2px solid grey; color: #EEEEEE; font-size: 0.5">None</td>
</tr>
</tbody><tfoot class="gt_sourcenotes">
<tr class="odd">
<td colspan="5" class="gt_sourcenote">Figure 2.1d: Table with data bar</td>
</tr>
</tfoot>

</table>


</div>
        
</div>
</div>
</div>
<p><code>great_tables</code> váº«n chÆ°a thá»±c sá»± render ra Ä‘Æ°á»£c báº£ng biá»ƒu Ä‘Ãºng nhÆ° setting.</p>
<p>BÃ i thá»±c hÃ nh Ä‘áº¿n Ä‘Ã¢y lÃ  káº¿t thÃºc! ğŸš€</p>
</section>
</section>
<section id="references" class="level1">
<h1>References</h1>
<ol type="1">
<li><a href="https://www.storytellingwithdata.com/books" class="uri">https://www.storytellingwithdata.com/books</a></li>
<li><a href="https://rpubs.com/chidungkt/1139405" class="uri">https://rpubs.com/chidungkt/1139405</a></li>
<li><a href="https://posit-dev.github.io/great-tables/articles/intro.html" class="uri">https://posit-dev.github.io/great-tables/articles/intro.html</a></li>
</ol>


<!-- -->

</section>

 ]]></description>
  <category>Python</category>
  <category>Visualization</category>
  <guid>https://lktuan.github.io/blog/2024-05-22-swd-p2-improve-table/</guid>
  <pubDate>Tue, 21 May 2024 17:00:00 GMT</pubDate>
  <media:content url="https://lktuan.github.io/blog/2024-05-22-swd-p2-improve-table/SWD-Cover-FULL-R5-MED.png" medium="image" type="image/png" height="180" width="144"/>
</item>
</channel>
</rss>
