<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.554">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Tuan Le Khac">
<meta name="dcterms.date" content="2024-05-21">
<meta name="description" content="I am a Risk Modeler 🚀">

<title>Le Khac Tuan - Python is cool</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../img/rocket_1613268.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/quarto-contrib/fontawesome6-0.1.0/all.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/fontawesome6-0.1.0/latex-fontsize.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="html/styles.scss">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Le Khac Tuan</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about/index.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../blog.html"> 
<span class="menu-text">Blog</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../学汉语的日记.html"> 
<span class="menu-text">学汉语的日记</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/lktuan"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/tuanlekhac/"> <i class="bi bi-linkedin" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="mailto:tuan.lekhac0905@gmail.com"> <i class="bi bi-envelope" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Python is cool</h1>
                  <div>
        <div class="description">
          Unknown Python’s features
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">Python</div>
                <div class="quarto-category">Lambda</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p><a href="https://lktuan.github.io/">Tuan Le Khac</a> </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">May 21, 2024</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#motivation" id="toc-motivation" class="nav-link active" data-scroll-target="#motivation">1. Motivation</a></li>
  <li><a href="#lambda-map-filter-reduce" id="toc-lambda-map-filter-reduce" class="nav-link" data-scroll-target="#lambda-map-filter-reduce">2. Lambda, map, filter, &amp; reduce</a>
  <ul class="collapse">
  <li><a href="#hiệu-suất-hàm-lambda" id="toc-hiệu-suất-hàm-lambda" class="nav-link" data-scroll-target="#hiệu-suất-hàm-lambda">Hiệu suất hàm Lambda</a></li>
  </ul></li>
  <li><a href="#list-manipulation" id="toc-list-manipulation" class="nav-link" data-scroll-target="#list-manipulation">3. List manipulation</a>
  <ul class="collapse">
  <li><a href="#unpacking" id="toc-unpacking" class="nav-link" data-scroll-target="#unpacking">3.1. Unpacking</a></li>
  <li><a href="#slicing" id="toc-slicing" class="nav-link" data-scroll-target="#slicing">3.2. Slicing</a></li>
  <li><a href="#insertion" id="toc-insertion" class="nav-link" data-scroll-target="#insertion">3.3. Insertion</a></li>
  <li><a href="#flattening" id="toc-flattening" class="nav-link" data-scroll-target="#flattening">3.4. Flattening</a></li>
  <li><a href="#list-vs-generator" id="toc-list-vs-generator" class="nav-link" data-scroll-target="#list-vs-generator">3.5. List vs Generator</a></li>
  </ul></li>
  <li><a href="#local-namespace-objects-attributes" id="toc-local-namespace-objects-attributes" class="nav-link" data-scroll-target="#local-namespace-objects-attributes">5. Local namespace, object’s attributes</a></li>
  <li><a href="#wild-import" id="toc-wild-import" class="nav-link" data-scroll-target="#wild-import">6. Wild Import</a></li>
  <li><a href="#decorator-to-time-your-functions" id="toc-decorator-to-time-your-functions" class="nav-link" data-scroll-target="#decorator-to-time-your-functions">7. Decorator to time your functions</a></li>
  <li><a href="#caching-with-functools.lru_cache" id="toc-caching-with-functools.lru_cache" class="nav-link" data-scroll-target="#caching-with-functools.lru_cache">8. Caching with <code>@functools.lru_cache</code></a></li>
  <li><a href="#reference" id="toc-reference" class="nav-link" data-scroll-target="#reference">Reference</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<section id="motivation" class="level1">
<h1>1. Motivation</h1>
<hr>
<p>Đây là một bài thực hành theo một <a href="https://github.com/chiphuyen/python-is-cool/tree/master">post</a> bởi chị <a href="https://huyenchip.com/">Chip Huyen</a> về một số features đặc biệt của Python. Là một DA không sử dụng Python quá nhiều, chỉ một số feature dưới đây là mình đã từng <em>nghe</em> qua. Hi vọng bài thực hành sẽ giúp mình hứng thú với Python hơn!</p>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="1">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="python.jpg" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption>Dong Nai Cultural Nature Reserve, a python lying along the stream waiting for the prey. Photo credit to <a href="https://www.instagram.com/vietnamphotos_herping/">PhucNguyenPhotos</a></figcaption>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="lambda-map-filter-reduce" class="level1">
<h1>2. Lambda, map, filter, &amp; reduce</h1>
<hr>
<p>Lambda cho phép người dùng định nghĩa in-line functions. Việc sử dụng <code>lambda()</code> rất thuận tiện khi gọi lại (callback ~ một function được thực thi sau khi một function khác được thực thi; một cách lưu trữ function) hoặc khi đầu ra của một function là đối số cho một function khác.</p>
<p>Hai hàm <code>square_fn</code> và <code>square_ld</code> dưới đây là một:</p>
<div id="8242066b" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw">def</span> square_fn(x):</span>
<span id="cb1-2"><a href="#cb1-2"></a>    <span class="cf">return</span> x <span class="op">*</span> x</span>
<span id="cb1-3"><a href="#cb1-3"></a></span>
<span id="cb1-4"><a href="#cb1-4"></a>square_ld <span class="op">=</span> <span class="kw">lambda</span> x : x <span class="op">*</span> x</span>
<span id="cb1-5"><a href="#cb1-5"></a></span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">10</span>):</span>
<span id="cb1-7"><a href="#cb1-7"></a>    <span class="cf">assert</span> square_fn(i) <span class="op">==</span> square_ld(i)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>lambda</code> rất hữu ích khi sử dụng cùng với các function khác như <code>map</code>, <code>filter</code>, và <code>reduce</code> (mình rất hay sử dụng pattern này trên Excel 😂). <code>map(fn, interable)</code> sẽ apply hàm <code>fn</code> cho tất cả các phần tử trong <code>iterable</code> (như list, set, dict, tuple, string), trả về map object.</p>
<div id="74dc00a0" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1"></a>nums <span class="op">=</span> [<span class="dv">1</span><span class="op">/</span><span class="dv">3</span>, <span class="dv">2</span><span class="op">/</span><span class="dv">7</span>, <span class="dv">1001</span><span class="op">/</span><span class="dv">37500</span>, <span class="dv">40</span><span class="op">/</span><span class="dv">27</span>]</span>
<span id="cb2-2"><a href="#cb2-2"></a>nums_squared <span class="op">=</span> [num <span class="op">*</span> num <span class="cf">for</span> num <span class="kw">in</span> nums]</span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="bu">print</span>(nums_squared)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[0.1111111111111111, 0.08163265306122448, 0.0007125340444444445, 2.194787379972565]</code></pre>
</div>
</div>
<p>Dùng <code>map</code> và một hàm callback, cho ra kết quả tương đương:</p>
<div id="d4131fd4" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1"></a>nums_squared_1 <span class="op">=</span> <span class="bu">map</span>(square_fn, nums)</span>
<span id="cb4-2"><a href="#cb4-2"></a>nums_squared_2 <span class="op">=</span> <span class="bu">map</span>(<span class="kw">lambda</span> x: x<span class="op">*</span>x, nums)</span>
<span id="cb4-3"><a href="#cb4-3"></a><span class="bu">print</span>(<span class="bu">list</span>(nums_squared_1)) <span class="co"># list to list the elements of map object</span></span>
<span id="cb4-4"><a href="#cb4-4"></a><span class="bu">print</span>(<span class="bu">list</span>(nums_squared_2))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[0.1111111111111111, 0.08163265306122448, 0.0007125340444444445, 2.194787379972565]
[0.1111111111111111, 0.08163265306122448, 0.0007125340444444445, 2.194787379972565]</code></pre>
</div>
</div>
<p>Có thể dùng <code>map</code> với nhiều hơn 1 iterable. Ví dụ muốn tính MSE cho một hồi quy tuyến tính đơn giản <code>f(x) = ax + b</code> với ground tru <code>labels</code>, hai phương pháp sau tương đương:</p>
<div id="2664db9c" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1"></a>a, b <span class="op">=</span> <span class="dv">3</span>, <span class="op">-</span><span class="fl">0.5</span></span>
<span id="cb6-2"><a href="#cb6-2"></a>xs <span class="op">=</span> [<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>]</span>
<span id="cb6-3"><a href="#cb6-3"></a>labels <span class="op">=</span> [<span class="fl">6.4</span>, <span class="fl">8.9</span>, <span class="fl">10.9</span>, <span class="fl">15.3</span>]</span>
<span id="cb6-4"><a href="#cb6-4"></a></span>
<span id="cb6-5"><a href="#cb6-5"></a><span class="co"># Phương pháp 1, loop</span></span>
<span id="cb6-6"><a href="#cb6-6"></a>errors <span class="op">=</span> []</span>
<span id="cb6-7"><a href="#cb6-7"></a><span class="cf">for</span> i,x <span class="kw">in</span> <span class="bu">enumerate</span>(xs):</span>
<span id="cb6-8"><a href="#cb6-8"></a>    errors.append( (a <span class="op">*</span> x <span class="op">+</span> b <span class="op">-</span> labels[i])<span class="op">**</span><span class="dv">2</span> )</span>
<span id="cb6-9"><a href="#cb6-9"></a>result_1 <span class="op">=</span> <span class="bu">sum</span>(errors)<span class="op">**</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>) <span class="op">/</span> <span class="bu">len</span>(xs)</span>
<span id="cb6-10"><a href="#cb6-10"></a></span>
<span id="cb6-11"><a href="#cb6-11"></a><span class="co"># Phương pháp 2, map</span></span>
<span id="cb6-12"><a href="#cb6-12"></a>diff <span class="op">=</span> <span class="bu">map</span>(<span class="kw">lambda</span> x, y: (a <span class="op">*</span> x <span class="op">+</span> b <span class="op">-</span> y) <span class="op">**</span> <span class="dv">2</span>, xs, labels) </span>
<span id="cb6-13"><a href="#cb6-13"></a>result_2 <span class="op">=</span> <span class="bu">sum</span>(diff)<span class="op">**</span><span class="fl">.5</span> <span class="op">/</span> <span class="bu">len</span>(xs)</span>
<span id="cb6-14"><a href="#cb6-14"></a></span>
<span id="cb6-15"><a href="#cb6-15"></a><span class="bu">print</span>(result_1, result_2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.35089172119045514 0.35089172119045514</code></pre>
</div>
</div>
<p><code>filter(fn, iterable)</code> giống như <code>map</code>, tuy nhiên <code>fn</code> là một hàm trả về giá trị boolean true/false, và <code>filter</code> sẽ trả về các phần tử của <code>iterable</code> khi <code>fn</code> trả về true.</p>
<div id="7322639d" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1"></a>bad_preds <span class="op">=</span> <span class="bu">filter</span>(<span class="kw">lambda</span> x: x <span class="op">&gt;</span> <span class="fl">0.5</span>, errors)</span>
<span id="cb8-2"><a href="#cb8-2"></a></span>
<span id="cb8-3"><a href="#cb8-3"></a><span class="bu">print</span>(<span class="bu">list</span>(bad_preds))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[0.8100000000000006, 0.6400000000000011]</code></pre>
</div>
</div>
<p><code>reduce(fn, iterable, initializer)</code> được dùng khi ta muốn áp dụng một toán lên tất cả thành phần trong danh sách. Ví dụ muốn tính kết quả nhân của toàn bộ phần tử:</p>
<div id="9f160304" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1"></a>product <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb10-2"><a href="#cb10-2"></a><span class="cf">for</span> num <span class="kw">in</span> nums:</span>
<span id="cb10-3"><a href="#cb10-3"></a>    product <span class="op">*=</span> num</span>
<span id="cb10-4"><a href="#cb10-4"></a><span class="bu">print</span>(product)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.0037662551440329215</code></pre>
</div>
</div>
<p>Sử dụng <code>reduce</code>:</p>
<div id="61973cf9" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1"></a><span class="im">from</span> functools <span class="im">import</span> <span class="bu">reduce</span></span>
<span id="cb12-2"><a href="#cb12-2"></a></span>
<span id="cb12-3"><a href="#cb12-3"></a>product <span class="op">=</span> <span class="bu">reduce</span>(<span class="kw">lambda</span> x, y: x <span class="op">*</span> y, nums)</span>
<span id="cb12-4"><a href="#cb12-4"></a><span class="bu">print</span>(product)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.0037662551440329215</code></pre>
</div>
</div>
<section id="hiệu-suất-hàm-lambda" class="level3">
<h3 class="anchored" data-anchor-id="hiệu-suất-hàm-lambda">Hiệu suất hàm Lambda</h3>
<p>Lambda được thiết kế để sử dụng một lần. Mỗi lần được gọi, hàm <code>lambda x: dosomething(x)</code> đều được tạo lại, và do đó ảnh hưởng tới hiệu suất.</p>
<p>Khi hàm lambda được định nghĩa trước <code>fn = lambda x: dosomething(x)</code>, hiệu suất của nó vẫn chậm hơn <code>def</code>, tuy nhiên không <a href="https://stackoverflow.com/questions/26540885/lambda-is-slower-than-function-call-in-python-why">đáng kể</a>.</p>
<p>🚀Nguyên văn chị Chip:</p>
<blockquote class="blockquote">
<p>Even though I find lambdas cool, I personally recommend using named functions when you can for the sake of clarity.</p>
</blockquote>
</section>
</section>
<section id="list-manipulation" class="level1">
<h1>3. List manipulation</h1>
<hr>
<section id="unpacking" class="level2">
<h2 class="anchored" data-anchor-id="unpacking">3.1. Unpacking</h2>
<p>Chúng ta có thể “giải nén” một list như thế này:</p>
<div id="3030c12e" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1"></a>elems <span class="op">=</span> [<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>]</span>
<span id="cb14-2"><a href="#cb14-2"></a>a,b,c,d <span class="op">=</span> elems</span>
<span id="cb14-3"><a href="#cb14-3"></a></span>
<span id="cb14-4"><a href="#cb14-4"></a><span class="bu">print</span>(a,b,c,d)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1 2 3 4</code></pre>
</div>
</div>
<p>Cũng có thể làm như thế này:</p>
<div id="a5374c04" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1"></a>a, <span class="op">*</span>new_elems, d <span class="op">=</span> elems <span class="co"># remember the char * for extended unpacking</span></span>
<span id="cb16-2"><a href="#cb16-2"></a></span>
<span id="cb16-3"><a href="#cb16-3"></a><span class="bu">print</span>(a)</span>
<span id="cb16-4"><a href="#cb16-4"></a><span class="bu">print</span>(new_elems)</span>
<span id="cb16-5"><a href="#cb16-5"></a><span class="bu">print</span>(b)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1
[2, 3]
2</code></pre>
</div>
</div>
</section>
<section id="slicing" class="level2">
<h2 class="anchored" data-anchor-id="slicing">3.2. Slicing</h2>
<p>Chúng ta có thể reverse/đảo ngược một list với <code>[::-1]</code></p>
<div id="86520671" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1"></a>elem <span class="op">=</span> <span class="bu">list</span>(<span class="bu">range</span>(<span class="dv">10</span>))</span>
<span id="cb18-2"><a href="#cb18-2"></a><span class="bu">print</span>(elem)</span>
<span id="cb18-3"><a href="#cb18-3"></a></span>
<span id="cb18-4"><a href="#cb18-4"></a></span>
<span id="cb18-5"><a href="#cb18-5"></a><span class="bu">print</span>(elem[::<span class="op">-</span><span class="dv">1</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
[9, 8, 7, 6, 5, 4, 3, 2, 1, 0]</code></pre>
</div>
</div>
<p>Cú pháp <code>[x:y:z]</code> có nghĩa là lấy <strong><em>mỗi</em></strong> phần tử thứ <code>z</code> từ index <code>x</code> tới index <code>y</code>. Khi <code>z</code> âm, tương đương với việc lấy theo thứ tự ngược lại. <code>x</code> để trống chỉ việc lấy từ phần tử đầu tiên, <code>y</code> để rỗng chỉ việc lấy tới phần tử cuối cùng.</p>
<div id="70c33574" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1"></a>evens <span class="op">=</span> elem[::<span class="dv">2</span>]</span>
<span id="cb20-2"><a href="#cb20-2"></a><span class="bu">print</span>(evens)</span>
<span id="cb20-3"><a href="#cb20-3"></a></span>
<span id="cb20-4"><a href="#cb20-4"></a>reversed_evens <span class="op">=</span> elem[<span class="dv">2</span>::<span class="op">-</span><span class="dv">2</span>]</span>
<span id="cb20-5"><a href="#cb20-5"></a><span class="bu">print</span>(reversed_evens)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[0, 2, 4, 6, 8]
[2, 0]</code></pre>
</div>
</div>
<p>Cũng có thể dùng slicing để xóa các phần tử như thế này:</p>
<div id="0a67417b" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1"></a><span class="kw">del</span> elems[::<span class="dv">2</span>]</span>
<span id="cb22-2"><a href="#cb22-2"></a><span class="bu">print</span>(elems)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[2, 4]</code></pre>
</div>
</div>
</section>
<section id="insertion" class="level2">
<h2 class="anchored" data-anchor-id="insertion">3.3. Insertion</h2>
<p>Chúng ta có thể thay đổi giá trị một phần tử trong một list như sau:</p>
<div id="af517936" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1"></a>elems <span class="op">=</span> <span class="bu">list</span>(<span class="bu">range</span>(<span class="dv">10</span>))</span>
<span id="cb24-2"><a href="#cb24-2"></a></span>
<span id="cb24-3"><a href="#cb24-3"></a>elems[<span class="dv">1</span>] <span class="op">=</span> <span class="dv">100</span></span>
<span id="cb24-4"><a href="#cb24-4"></a><span class="bu">print</span>(elems)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[0, 100, 2, 3, 4, 5, 6, 7, 8, 9]</code></pre>
</div>
</div>
<p>Cũng có thể thay thế một giá trị bằng nhiều giá trị:</p>
<div id="efc2fc11" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1"></a>elems <span class="op">=</span> <span class="bu">list</span>(<span class="bu">range</span>(<span class="dv">10</span>))</span>
<span id="cb26-2"><a href="#cb26-2"></a>elems[<span class="dv">1</span>:<span class="dv">2</span>] <span class="op">=</span> [<span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">40</span>]</span>
<span id="cb26-3"><a href="#cb26-3"></a><span class="bu">print</span>(elems)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[0, 20, 30, 40, 2, 3, 4, 5, 6, 7, 8, 9]</code></pre>
</div>
</div>
<p>Nếu chúng ta muốn thêm 3 giá trị <code>0.3, 0.4, 0.5</code> vào giữa phần tử thứ 0 và 1 của list này, thì:</p>
<div id="32f86bed" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1"></a>elems <span class="op">=</span> <span class="bu">list</span>(<span class="bu">range</span>(<span class="dv">10</span>))</span>
<span id="cb28-2"><a href="#cb28-2"></a>elems[<span class="dv">1</span>:<span class="dv">1</span>] <span class="op">=</span> [<span class="fl">.3</span>, <span class="fl">.4</span>, <span class="fl">.5</span>]</span>
<span id="cb28-3"><a href="#cb28-3"></a><span class="bu">print</span>(elems)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[0, 0.3, 0.4, 0.5, 1, 2, 3, 4, 5, 6, 7, 8, 9]</code></pre>
</div>
</div>
</section>
<section id="flattening" class="level2">
<h2 class="anchored" data-anchor-id="flattening">3.4. Flattening</h2>
<p>Chúng ta có thể flatten một list sử dung <code>sum(0)</code>:</p>
<div id="2afefd40" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1"></a>list_of_lists <span class="op">=</span> [[<span class="dv">1</span>], [<span class="dv">2</span>, <span class="dv">3</span>], [<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>]]</span>
<span id="cb30-2"><a href="#cb30-2"></a><span class="bu">sum</span>(list_of_lists, [])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="16">
<pre><code>[1, 2, 3, 4, 5, 6]</code></pre>
</div>
</div>
<p>Cũng có thể sử dụng recursive lambda (another beauty of lambda)</p>
<div id="289520d2" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1"></a>nested_lists <span class="op">=</span> [[<span class="dv">1</span>, <span class="dv">2</span>], [[<span class="dv">3</span>, <span class="dv">4</span>], [<span class="dv">5</span>, <span class="dv">6</span>], [[<span class="dv">7</span>, <span class="dv">8</span>], [<span class="dv">9</span>, <span class="dv">10</span>], [[<span class="dv">11</span>, [<span class="dv">12</span>, <span class="dv">13</span>]]]]]]</span>
<span id="cb32-2"><a href="#cb32-2"></a>flatten <span class="op">=</span> <span class="kw">lambda</span> x: [y <span class="cf">for</span> i <span class="kw">in</span> x <span class="cf">for</span> y <span class="kw">in</span> flatten(i)] <span class="cf">if</span> <span class="bu">type</span>(x) <span class="kw">is</span> <span class="bu">list</span> <span class="cf">else</span> [x]</span>
<span id="cb32-3"><a href="#cb32-3"></a></span>
<span id="cb32-4"><a href="#cb32-4"></a><span class="bu">print</span>(flatten(nested_lists))</span>
<span id="cb32-5"><a href="#cb32-5"></a></span>
<span id="cb32-6"><a href="#cb32-6"></a><span class="co"># This line of code is from</span></span>
<span id="cb32-7"><a href="#cb32-7"></a><span class="co"># https://github.com/sahands/python-by-example/blob/master/python-by-example.rst#flattening-lists</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]</code></pre>
</div>
</div>
</section>
<section id="list-vs-generator" class="level2">
<h2 class="anchored" data-anchor-id="list-vs-generator">3.5. List vs Generator</h2>
<p>🚀Generator là cái gì vậy? Trích <a href="https://manhhomienbienthuy.github.io/2016/01/05/python-iterator-generator.html">bài viết</a>:</p>
<blockquote class="blockquote">
<p>Từ generator được sử dụng cho cả hàm (hàm generator là hàm đã nói ở trên) và kết quả mà hàm đó sinh ra (đối tượng được hàm generator sinh ra cũng được gọi là generator). Vì vậy đôi khi việc này gây khó hiểu một chút. Hãy xem ví dụ về việc tạo n-grams từ một danh sách tokens dưới đây để hiểu sự khác biệt giữa list và generator:</p>
</blockquote>
<div id="8442291b" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1"></a>tokens <span class="op">=</span> [<span class="st">'i'</span>, <span class="st">'want'</span>, <span class="st">'to'</span>, <span class="st">'go'</span>, <span class="st">'to'</span>, <span class="st">'school'</span>]</span>
<span id="cb34-2"><a href="#cb34-2"></a></span>
<span id="cb34-3"><a href="#cb34-3"></a><span class="kw">def</span> ngrams(tokens, n):</span>
<span id="cb34-4"><a href="#cb34-4"></a>    length <span class="op">=</span> <span class="bu">len</span>(tokens)</span>
<span id="cb34-5"><a href="#cb34-5"></a>    grams <span class="op">=</span> []</span>
<span id="cb34-6"><a href="#cb34-6"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(length <span class="op">-</span> n <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb34-7"><a href="#cb34-7"></a>        grams.append(tokens[i:i<span class="op">+</span>n])</span>
<span id="cb34-8"><a href="#cb34-8"></a>    <span class="cf">return</span> grams</span>
<span id="cb34-9"><a href="#cb34-9"></a></span>
<span id="cb34-10"><a href="#cb34-10"></a><span class="bu">print</span>(ngrams(tokens, <span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[['i', 'want', 'to'], ['want', 'to', 'go'], ['to', 'go', 'to'], ['go', 'to', 'school']]</code></pre>
</div>
</div>
<p>Trong ví dụ này, chúng ta phải lưu toàn bộ n-grams một lúc. Nếu có <code>m</code> tokens, memory requirement là <code>O(nm)</code> - sẽ là vấn đề nếu <code>m</code> lớn. Thay vào đó, chúng ta có thể sử dụng generator để tạo n-grams tiếp theo khi được yêu cầu. Đây gọi là lazy evaluation. Chúng ta có thể tạo một hàm <code>ngrams</code> trả về một generator sử dụng keyword <code>yield</code>, lúc này memory requirement là <code>O(n+m)</code>.</p>
<div id="78e554c5" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1"></a><span class="kw">def</span> ngrams(tokens, n):</span>
<span id="cb36-2"><a href="#cb36-2"></a>    length <span class="op">=</span> <span class="bu">len</span>(tokens)</span>
<span id="cb36-3"><a href="#cb36-3"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(length <span class="op">-</span> n <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb36-4"><a href="#cb36-4"></a>        <span class="cf">yield</span> tokens[i:i<span class="op">+</span>n]</span>
<span id="cb36-5"><a href="#cb36-5"></a></span>
<span id="cb36-6"><a href="#cb36-6"></a>ngrams_generator <span class="op">=</span> ngrams(tokens, <span class="dv">3</span>)</span>
<span id="cb36-7"><a href="#cb36-7"></a><span class="bu">print</span>(ngrams_generator)</span>
<span id="cb36-8"><a href="#cb36-8"></a></span>
<span id="cb36-9"><a href="#cb36-9"></a><span class="cf">for</span> ngram <span class="kw">in</span> ngrams_generator:</span>
<span id="cb36-10"><a href="#cb36-10"></a>    <span class="bu">print</span>(ngram)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;generator object ngrams at 0x0000026BBDFADE40&gt;
['i', 'want', 'to']
['want', 'to', 'go']
['to', 'go', 'to']
['go', 'to', 'school']</code></pre>
</div>
</div>
<p>Một cách khác để tạo n-grams là slice để lấy các sub-list <code>[0, 1, 2, ...,-n]</code>, <code>[1, 2, 3, ...,-n+1]</code>, <code>[2, 3, 4, ...,-n+2]</code>,… <code>[n-1, n, ...,-1]</code>, sau đó <code>zip</code> chúng lại:</p>
<div id="d56a8f3e" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1"></a><span class="kw">def</span> ngrams(tokens, n):</span>
<span id="cb38-2"><a href="#cb38-2"></a>    length <span class="op">=</span> <span class="bu">len</span>(tokens)</span>
<span id="cb38-3"><a href="#cb38-3"></a>    slices <span class="op">=</span> (tokens[i:length<span class="op">-</span>n<span class="op">+</span>i<span class="op">+</span><span class="dv">1</span>] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n))</span>
<span id="cb38-4"><a href="#cb38-4"></a>    <span class="cf">return</span> <span class="bu">zip</span>(<span class="op">*</span>slices)</span>
<span id="cb38-5"><a href="#cb38-5"></a></span>
<span id="cb38-6"><a href="#cb38-6"></a>ngrams_generator <span class="op">=</span> ngrams(tokens, <span class="dv">3</span>)</span>
<span id="cb38-7"><a href="#cb38-7"></a><span class="bu">print</span>(ngrams_generator)</span>
<span id="cb38-8"><a href="#cb38-8"></a></span>
<span id="cb38-9"><a href="#cb38-9"></a></span>
<span id="cb38-10"><a href="#cb38-10"></a><span class="cf">for</span> ngram <span class="kw">in</span> ngrams_generator:</span>
<span id="cb38-11"><a href="#cb38-11"></a>    <span class="bu">print</span>(ngram)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;zip object at 0x0000026BBE006400&gt;
('i', 'want', 'to')
('want', 'to', 'go')
('to', 'go', 'to')
('go', 'to', 'school')</code></pre>
</div>
</div>
<p>Lưu ý chúng ta sử dụng <code>(tokens[...] for i in range(n))</code>, chứ không phải <code>[tokens[...] for i in range(n)]</code>. <code>[]</code> trả về một list, <code>()</code> trả về generator. # 4. Classes &amp; magic methods</p>
<hr>
<p>Trong Python, magic methods được prefixed và suffixed bởi double underscore <code>__</code> (aka dunder). Magic method được biết đến rộng rãi nhất là <code>__init__</code>.</p>
<div id="846ab4aa" class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1"></a><span class="kw">class</span> Node:</span>
<span id="cb40-2"><a href="#cb40-2"></a>    <span class="co">""" A struct to denote the node of a binary tree.</span></span>
<span id="cb40-3"><a href="#cb40-3"></a><span class="co">    It contains a value and pointers to left and right children.</span></span>
<span id="cb40-4"><a href="#cb40-4"></a><span class="co">    """</span></span>
<span id="cb40-5"><a href="#cb40-5"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, value, left<span class="op">=</span><span class="va">None</span>, right<span class="op">=</span><span class="va">None</span>):</span>
<span id="cb40-6"><a href="#cb40-6"></a>        <span class="va">self</span>.value <span class="op">=</span> value</span>
<span id="cb40-7"><a href="#cb40-7"></a>        <span class="va">self</span>.left <span class="op">=</span> left</span>
<span id="cb40-8"><a href="#cb40-8"></a>        <span class="va">self</span>.right <span class="op">=</span> right</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In ra object, tuy nhiên nhìn không tường minh lắm!</p>
<div id="c52e4e41" class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1"></a>root <span class="op">=</span> Node(<span class="dv">5</span>)</span>
<span id="cb41-2"><a href="#cb41-2"></a><span class="bu">print</span>(root) <span class="co"># &lt;__main__.Node object at 0x1069c4518&gt;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;__main__.Node object at 0x0000026BBDFF6A50&gt;</code></pre>
</div>
</div>
<p>Chúng ta mong muốn khi in ra một Node, giá trị của nó cũng như giá trị của các Node con (nếu có) cũng sẽ được in ra. Chúng ta dùng <code>__repr__</code>:</p>
<div id="00b93f61" class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1"></a><span class="kw">class</span> Node:</span>
<span id="cb43-2"><a href="#cb43-2"></a>    <span class="co">""" A struct to denote the node of a binary tree.</span></span>
<span id="cb43-3"><a href="#cb43-3"></a><span class="co">    It contains a value and pointers to left and right children.</span></span>
<span id="cb43-4"><a href="#cb43-4"></a><span class="co">    """</span></span>
<span id="cb43-5"><a href="#cb43-5"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, value, left<span class="op">=</span><span class="va">None</span>, right<span class="op">=</span><span class="va">None</span>):</span>
<span id="cb43-6"><a href="#cb43-6"></a>        <span class="va">self</span>.value <span class="op">=</span> value</span>
<span id="cb43-7"><a href="#cb43-7"></a>        <span class="va">self</span>.left <span class="op">=</span> left</span>
<span id="cb43-8"><a href="#cb43-8"></a>        <span class="va">self</span>.right <span class="op">=</span> right</span>
<span id="cb43-9"><a href="#cb43-9"></a></span>
<span id="cb43-10"><a href="#cb43-10"></a>    <span class="kw">def</span> <span class="fu">__repr__</span>(<span class="va">self</span>):</span>
<span id="cb43-11"><a href="#cb43-11"></a>        strings <span class="op">=</span> [<span class="ss">f'value: </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>value<span class="sc">}</span><span class="ss">'</span>]</span>
<span id="cb43-12"><a href="#cb43-12"></a>        strings.append(<span class="ss">f'left: </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>left<span class="sc">.</span>value<span class="sc">}</span><span class="ss">'</span> <span class="cf">if</span> <span class="va">self</span>.left <span class="cf">else</span> <span class="st">'left: None'</span>)</span>
<span id="cb43-13"><a href="#cb43-13"></a>        strings.append(<span class="ss">f'right: </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>right<span class="sc">.</span>value<span class="sc">}</span><span class="ss">'</span> <span class="cf">if</span> <span class="va">self</span>.right <span class="cf">else</span> <span class="st">'right: None'</span>)</span>
<span id="cb43-14"><a href="#cb43-14"></a>        <span class="cf">return</span> <span class="st">', '</span>.join(strings)</span>
<span id="cb43-15"><a href="#cb43-15"></a></span>
<span id="cb43-16"><a href="#cb43-16"></a>left <span class="op">=</span> Node(<span class="dv">4</span>)</span>
<span id="cb43-17"><a href="#cb43-17"></a>root <span class="op">=</span> Node(<span class="dv">5</span>, left)</span>
<span id="cb43-18"><a href="#cb43-18"></a><span class="bu">print</span>(root) <span class="co"># value: 5, left: 4, right: None</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>value: 5, left: 4, right: None</code></pre>
</div>
</div>
<p>Chúng ta cũng muốn hai Node có thể được so sánh được với nhau, vì thế tạo ra các magic method để implement các operator: <code>==</code> với <code>__eq__</code>, <code>&gt;</code> với <code>__lt__</code>, ‘&gt;=’ với <code>__ge__</code>:</p>
<div id="cd81f726" class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1"></a><span class="kw">class</span> Node:</span>
<span id="cb45-2"><a href="#cb45-2"></a>    <span class="co">""" A struct to denote the node of a binary tree.</span></span>
<span id="cb45-3"><a href="#cb45-3"></a><span class="co">    It contains a value and pointers to left and right children.</span></span>
<span id="cb45-4"><a href="#cb45-4"></a><span class="co">    """</span></span>
<span id="cb45-5"><a href="#cb45-5"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, value, left<span class="op">=</span><span class="va">None</span>, right<span class="op">=</span><span class="va">None</span>):</span>
<span id="cb45-6"><a href="#cb45-6"></a>        <span class="va">self</span>.value <span class="op">=</span> value</span>
<span id="cb45-7"><a href="#cb45-7"></a>        <span class="va">self</span>.left <span class="op">=</span> left</span>
<span id="cb45-8"><a href="#cb45-8"></a>        <span class="va">self</span>.right <span class="op">=</span> right</span>
<span id="cb45-9"><a href="#cb45-9"></a></span>
<span id="cb45-10"><a href="#cb45-10"></a>    <span class="kw">def</span> <span class="fu">__eq__</span>(<span class="va">self</span>, other):</span>
<span id="cb45-11"><a href="#cb45-11"></a>        <span class="cf">return</span> <span class="va">self</span>.value <span class="op">==</span> other.value</span>
<span id="cb45-12"><a href="#cb45-12"></a></span>
<span id="cb45-13"><a href="#cb45-13"></a>    <span class="kw">def</span> <span class="fu">__lt__</span>(<span class="va">self</span>, other):</span>
<span id="cb45-14"><a href="#cb45-14"></a>        <span class="cf">return</span> <span class="va">self</span>.value <span class="op">&lt;</span> other.value</span>
<span id="cb45-15"><a href="#cb45-15"></a></span>
<span id="cb45-16"><a href="#cb45-16"></a>    <span class="kw">def</span> <span class="fu">__ge__</span>(<span class="va">self</span>, other):</span>
<span id="cb45-17"><a href="#cb45-17"></a>        <span class="cf">return</span> <span class="va">self</span>.value <span class="op">&gt;=</span> other.value</span>
<span id="cb45-18"><a href="#cb45-18"></a></span>
<span id="cb45-19"><a href="#cb45-19"></a></span>
<span id="cb45-20"><a href="#cb45-20"></a>left <span class="op">=</span> Node(<span class="dv">4</span>)</span>
<span id="cb45-21"><a href="#cb45-21"></a>root <span class="op">=</span> Node(<span class="dv">5</span>, left)</span>
<span id="cb45-22"><a href="#cb45-22"></a><span class="bu">print</span>(left <span class="op">==</span> root) <span class="co"># False</span></span>
<span id="cb45-23"><a href="#cb45-23"></a><span class="bu">print</span>(left <span class="op">&lt;</span> root) <span class="co"># True</span></span>
<span id="cb45-24"><a href="#cb45-24"></a><span class="bu">print</span>(left <span class="op">&gt;=</span> root) <span class="co"># False</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>False
True
False</code></pre>
</div>
</div>
<p>Xem <a href="https://www.tutorialsteacher.com/python/magic-methods-in-python">ở đây</a>, hoặc <a href="https://docs.python.org/3/reference/datamodel.html#special-method-names">ở đây</a> danh sách đầy đủ các magic method mà Python hỗ trợ.</p>
<p>Một số magic method khác cần chú ý <code>__len__</code>, <code>__str__</code>, <code>__iter__</code>, and <code>__slots__</code> (tham khảo <a href="https://stackoverflow.com/questions/472000/usage-of-slots/28059785#28059785">đây</a>)</p>
</section>
</section>
<section id="local-namespace-objects-attributes" class="level1">
<h1>5. Local namespace, object’s attributes</h1>
<hr>
<p>Hàm <code>locals()</code> trả về danh sách các biến nằm trong local namespace:</p>
<div id="4d257abb" class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1"></a><span class="kw">class</span> Model1:</span>
<span id="cb47-2"><a href="#cb47-2"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, hidden_size<span class="op">=</span><span class="dv">100</span>, num_layers<span class="op">=</span><span class="dv">3</span>, learning_rate<span class="op">=</span><span class="fl">3e-4</span>):</span>
<span id="cb47-3"><a href="#cb47-3"></a>        <span class="bu">print</span>(<span class="bu">locals</span>())</span>
<span id="cb47-4"><a href="#cb47-4"></a>        <span class="va">self</span>.hidden_size <span class="op">=</span> hidden_size</span>
<span id="cb47-5"><a href="#cb47-5"></a>        <span class="va">self</span>.num_layers <span class="op">=</span> num_layers</span>
<span id="cb47-6"><a href="#cb47-6"></a>        <span class="va">self</span>.learning_rate <span class="op">=</span> learning_rate</span>
<span id="cb47-7"><a href="#cb47-7"></a></span>
<span id="cb47-8"><a href="#cb47-8"></a>model1 <span class="op">=</span> Model1()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>{'self': &lt;__main__.Model1 object at 0x0000026BBE005850&gt;, 'hidden_size': 100, 'num_layers': 3, 'learning_rate': 0.0003}</code></pre>
</div>
</div>
<p>Các attributes của 1 object cũng được lưu hết trong <code>__dict__</code>:</p>
<div id="40f7eabe" class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1"></a><span class="bu">print</span>(model1.__dict__)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>{'hidden_size': 100, 'num_layers': 3, 'learning_rate': 0.0003}</code></pre>
</div>
</div>
<p>Khi có quá nhiều arguments, việc assign nó trong <code>__init__</code> trở nên phiền hà, chúng ta có thể làm như sau:</p>
<div id="c75ceec1" class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1"></a><span class="kw">class</span> Model2:</span>
<span id="cb51-2"><a href="#cb51-2"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, hidden_size<span class="op">=</span><span class="dv">100</span>, num_layers<span class="op">=</span><span class="dv">3</span>, learning_rate<span class="op">=</span><span class="fl">3e-4</span>):</span>
<span id="cb51-3"><a href="#cb51-3"></a>        params <span class="op">=</span> <span class="bu">locals</span>()</span>
<span id="cb51-4"><a href="#cb51-4"></a>        <span class="kw">del</span> params[<span class="st">'self'</span>]</span>
<span id="cb51-5"><a href="#cb51-5"></a>        <span class="va">self</span>.__dict__ <span class="op">=</span> params</span>
<span id="cb51-6"><a href="#cb51-6"></a></span>
<span id="cb51-7"><a href="#cb51-7"></a>model2 <span class="op">=</span> Model2()</span>
<span id="cb51-8"><a href="#cb51-8"></a><span class="bu">print</span>(model2.__dict__)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>{'hidden_size': 100, 'num_layers': 3, 'learning_rate': 0.0003}</code></pre>
</div>
</div>
<p>Thậm chí rất tiện khi làm việc với <code>*kwargs</code>:</p>
<div id="8ea0d71d" class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1"></a><span class="kw">class</span> Model3:</span>
<span id="cb53-2"><a href="#cb53-2"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, <span class="op">**</span>kwargs):</span>
<span id="cb53-3"><a href="#cb53-3"></a>        <span class="va">self</span>.__dict__ <span class="op">=</span> kwargs</span>
<span id="cb53-4"><a href="#cb53-4"></a></span>
<span id="cb53-5"><a href="#cb53-5"></a>model3 <span class="op">=</span> Model3(hidden_size<span class="op">=</span><span class="dv">100</span>, num_layers<span class="op">=</span><span class="dv">3</span>, learning_rate<span class="op">=</span><span class="fl">3e-4</span>)</span>
<span id="cb53-6"><a href="#cb53-6"></a><span class="bu">print</span>(model3.__dict__)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>{'hidden_size': 100, 'num_layers': 3, 'learning_rate': 0.0003}</code></pre>
</div>
</div>
<p>Đọc thêm về <code>*args</code> và <code>*kwargs</code> ở <a href="https://manhhomienbienthuy.github.io/2019/09/20/python-args-kwargs.html">đây</a>.</p>
</section>
<section id="wild-import" class="level1">
<h1>6. Wild Import</h1>
<hr>
<p>Chúng ta thường <code>import</code> tất cả như thế này:</p>
<p><code>file.py</code></p>
<div id="e156d379" class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1"></a><span class="im">from</span> parts <span class="im">import</span> <span class="op">*</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Sẽ là vô trách nhiệm khi chúng ta import toàn bộ module, ví dụ nếu <code>parts.py</code> có cấu trúc như thế này: <code>parts.py</code></p>
<div id="d58a3b6a" class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1"></a><span class="im">import</span> numpy </span>
<span id="cb56-2"><a href="#cb56-2"></a><span class="im">import</span> tensorflow </span>
<span id="cb56-3"><a href="#cb56-3"></a><span class="kw">class</span> Encoder: </span>
<span id="cb56-4"><a href="#cb56-4"></a>    ... </span>
<span id="cb56-5"><a href="#cb56-5"></a><span class="kw">class</span> Decoder: </span>
<span id="cb56-6"><a href="#cb56-6"></a>    ... </span>
<span id="cb56-7"><a href="#cb56-7"></a><span class="kw">class</span> Loss: </span>
<span id="cb56-8"><a href="#cb56-8"></a>    ... </span>
<span id="cb56-9"><a href="#cb56-9"></a><span class="kw">def</span> helper(<span class="op">*</span>args, <span class="op">**</span>kwargs): </span>
<span id="cb56-10"><a href="#cb56-10"></a>    ...</span>
<span id="cb56-11"><a href="#cb56-11"></a><span class="kw">def</span> utils(<span class="op">*</span>args, <span class="op">**</span>kwargs): </span>
<span id="cb56-12"><a href="#cb56-12"></a>    ... </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Vì <code>parts.py</code> không định nghĩa <code>__all__</code>, nên <code>file.py</code> sẽ import tất cả Encoder, Decoder, Loss, helper, untils cùng với numpy và tensorFlow. Nếu chỉ muốn import Encoder, Decoder, Loss, chúng ta nên làm như sau: <code>parts.py</code></p>
<div id="4efb8a40" class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1"></a>__all__ <span class="op">=</span> [<span class="st">'Encoder'</span>, <span class="st">'Decoder'</span>, <span class="st">'Loss'</span>] </span>
<span id="cb57-2"><a href="#cb57-2"></a><span class="im">import</span> numpy </span>
<span id="cb57-3"><a href="#cb57-3"></a><span class="im">import</span> tensorflow </span>
<span id="cb57-4"><a href="#cb57-4"></a><span class="kw">class</span> Encoder: </span>
<span id="cb57-5"><a href="#cb57-5"></a>    ... </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Chúng ta có thể dùng <code>__all__</code> để tìm hiểu thành phần một module.</p>
</section>
<section id="decorator-to-time-your-functions" class="level1">
<h1>7. Decorator to time your functions</h1>
<hr>
<p>Chúng ta thường muốn đo lường thời gian chạy của 1 function. Các tự nhiên thường dùng là đặt <code>time.time()</code> ở hai điểm đầu và cuối giữa các lệnh.</p>
<p>Ví dụ, với hàm tìm số Fibbonacci thứ n, với hai cách (1 cách sử dụng memoization).</p>
<div id="2127dbe6" class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1"></a><span class="kw">def</span> fib_helper(n):</span>
<span id="cb58-2"><a href="#cb58-2"></a>    <span class="cf">if</span> n <span class="op">&lt;</span> <span class="dv">2</span>:</span>
<span id="cb58-3"><a href="#cb58-3"></a>        <span class="cf">return</span> n</span>
<span id="cb58-4"><a href="#cb58-4"></a>    <span class="cf">return</span> fib_helper(n <span class="op">-</span> <span class="dv">1</span>) <span class="op">+</span> fib_helper(n <span class="op">-</span> <span class="dv">2</span>)</span>
<span id="cb58-5"><a href="#cb58-5"></a></span>
<span id="cb58-6"><a href="#cb58-6"></a><span class="kw">def</span> fib(n):</span>
<span id="cb58-7"><a href="#cb58-7"></a>    <span class="co">""" fib is a wrapper function so that later we can change its behavior</span></span>
<span id="cb58-8"><a href="#cb58-8"></a><span class="co">    at the top level without affecting the behavior at every recursion step.</span></span>
<span id="cb58-9"><a href="#cb58-9"></a><span class="co">    """</span></span>
<span id="cb58-10"><a href="#cb58-10"></a>    <span class="cf">return</span> fib_helper(n)</span>
<span id="cb58-11"><a href="#cb58-11"></a></span>
<span id="cb58-12"><a href="#cb58-12"></a><span class="kw">def</span> fib_m_helper(n, computed):</span>
<span id="cb58-13"><a href="#cb58-13"></a>    <span class="cf">if</span> n <span class="kw">in</span> computed:</span>
<span id="cb58-14"><a href="#cb58-14"></a>        <span class="cf">return</span> computed[n]</span>
<span id="cb58-15"><a href="#cb58-15"></a>    computed[n] <span class="op">=</span> fib_m_helper(n <span class="op">-</span> <span class="dv">1</span>, computed) <span class="op">+</span> fib_m_helper(n <span class="op">-</span> <span class="dv">2</span>, computed)</span>
<span id="cb58-16"><a href="#cb58-16"></a>    <span class="cf">return</span> computed[n]</span>
<span id="cb58-17"><a href="#cb58-17"></a></span>
<span id="cb58-18"><a href="#cb58-18"></a><span class="kw">def</span> fib_m(n):</span>
<span id="cb58-19"><a href="#cb58-19"></a>    <span class="cf">return</span> fib_m_helper(n, {<span class="dv">0</span>: <span class="dv">0</span>, <span class="dv">1</span>: <span class="dv">1</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Hãy chắc chắn <code>fib</code> và <code>fib_m</code> tương đương nhau:</p>
<div id="67b55eeb" class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1"></a><span class="cf">for</span> n <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">20</span>):</span>
<span id="cb59-2"><a href="#cb59-2"></a>    <span class="cf">assert</span> fib(n) <span class="op">==</span> fib_m(n)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Đo lường thời gian chạy:</p>
<div id="319f0200" class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1"></a><span class="im">import</span> time</span>
<span id="cb60-2"><a href="#cb60-2"></a></span>
<span id="cb60-3"><a href="#cb60-3"></a>start <span class="op">=</span> time.time()</span>
<span id="cb60-4"><a href="#cb60-4"></a>fib(<span class="dv">30</span>)</span>
<span id="cb60-5"><a href="#cb60-5"></a><span class="bu">print</span>(<span class="ss">f'Without memoization, it takes </span><span class="sc">{</span>time<span class="sc">.</span>time() <span class="op">-</span> start<span class="sc">:7f}</span><span class="ss"> seconds.'</span>)</span>
<span id="cb60-6"><a href="#cb60-6"></a></span>
<span id="cb60-7"><a href="#cb60-7"></a>start <span class="op">=</span> time.time()</span>
<span id="cb60-8"><a href="#cb60-8"></a>fib_m(<span class="dv">30</span>)</span>
<span id="cb60-9"><a href="#cb60-9"></a><span class="bu">print</span>(<span class="ss">f'With memoization, it takes </span><span class="sc">{</span>time<span class="sc">.</span>time() <span class="op">-</span> start<span class="sc">:.7f}</span><span class="ss"> seconds.'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Without memoization, it takes 0.169084 seconds.
With memoization, it takes 0.0000000 seconds.</code></pre>
</div>
</div>
<p>Using decorator, define <code>timeit</code>:</p>
<div id="1ae7ac1d" class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1"></a><span class="kw">def</span> timeit(fn): </span>
<span id="cb62-2"><a href="#cb62-2"></a>    <span class="co"># *args and **kwargs are to support positional and named arguments of fn</span></span>
<span id="cb62-3"><a href="#cb62-3"></a>    <span class="kw">def</span> get_time(<span class="op">*</span>args, <span class="op">**</span>kwargs): </span>
<span id="cb62-4"><a href="#cb62-4"></a>        start <span class="op">=</span> time.time() </span>
<span id="cb62-5"><a href="#cb62-5"></a>        output <span class="op">=</span> fn(<span class="op">*</span>args, <span class="op">**</span>kwargs)</span>
<span id="cb62-6"><a href="#cb62-6"></a>        <span class="bu">print</span>(<span class="ss">f"Time taken in </span><span class="sc">{</span>fn<span class="sc">.</span><span class="va">__name__</span><span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>time<span class="sc">.</span>time() <span class="op">-</span> start<span class="sc">:.7f}</span><span class="ss">"</span>)</span>
<span id="cb62-7"><a href="#cb62-7"></a>        <span class="cf">return</span> output  <span class="co"># make sure that the decorator returns the output of fn</span></span>
<span id="cb62-8"><a href="#cb62-8"></a>    <span class="cf">return</span> get_time </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Sau đó thêm <code>@timeit</code> tới function:</p>
<div id="98e01368" class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1"></a><span class="at">@timeit</span></span>
<span id="cb63-2"><a href="#cb63-2"></a><span class="kw">def</span> fib(n):</span>
<span id="cb63-3"><a href="#cb63-3"></a>    <span class="cf">return</span> fib_helper(n)</span>
<span id="cb63-4"><a href="#cb63-4"></a></span>
<span id="cb63-5"><a href="#cb63-5"></a><span class="at">@timeit</span></span>
<span id="cb63-6"><a href="#cb63-6"></a><span class="kw">def</span> fib_m(n):</span>
<span id="cb63-7"><a href="#cb63-7"></a>    <span class="cf">return</span> fib_m_helper(n, {<span class="dv">0</span>: <span class="dv">0</span>, <span class="dv">1</span>: <span class="dv">1</span>})</span>
<span id="cb63-8"><a href="#cb63-8"></a></span>
<span id="cb63-9"><a href="#cb63-9"></a>fib(<span class="dv">30</span>)</span>
<span id="cb63-10"><a href="#cb63-10"></a>fib_m(<span class="dv">30</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Time taken in fib: 0.1950800
Time taken in fib_m: 0.0000000</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="33">
<pre><code>832040</code></pre>
</div>
</div>
</section>
<section id="caching-with-functools.lru_cache" class="level1">
<h1>8. Caching with <code>@functools.lru_cache</code></h1>
<hr>
<p>🚀Nguyên văn chị Huyền: &gt; Memoization is a form of cache: we cache the previously calculated Fibonacci numbers so that we don’t have to calculate them again.</p>
<div id="4be7fd9a" class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1"></a><span class="im">import</span> functools</span>
<span id="cb66-2"><a href="#cb66-2"></a></span>
<span id="cb66-3"><a href="#cb66-3"></a><span class="at">@functools.lru_cache</span>()</span>
<span id="cb66-4"><a href="#cb66-4"></a><span class="kw">def</span> fib_helper(n):</span>
<span id="cb66-5"><a href="#cb66-5"></a>    <span class="cf">if</span> n <span class="op">&lt;</span> <span class="dv">2</span>:</span>
<span id="cb66-6"><a href="#cb66-6"></a>        <span class="cf">return</span> n</span>
<span id="cb66-7"><a href="#cb66-7"></a>    <span class="cf">return</span> fib_helper(n <span class="op">-</span> <span class="dv">1</span>) <span class="op">+</span> fib_helper(n <span class="op">-</span> <span class="dv">2</span>)</span>
<span id="cb66-8"><a href="#cb66-8"></a></span>
<span id="cb66-9"><a href="#cb66-9"></a><span class="at">@timeit</span></span>
<span id="cb66-10"><a href="#cb66-10"></a><span class="kw">def</span> fib(n):</span>
<span id="cb66-11"><a href="#cb66-11"></a>    <span class="co">""" fib is a wrapper function so that later we can change its behavior</span></span>
<span id="cb66-12"><a href="#cb66-12"></a><span class="co">    at the top level without affecting the behavior at every recursion step.</span></span>
<span id="cb66-13"><a href="#cb66-13"></a><span class="co">    """</span></span>
<span id="cb66-14"><a href="#cb66-14"></a>    <span class="cf">return</span> fib_helper(n)</span>
<span id="cb66-15"><a href="#cb66-15"></a></span>
<span id="cb66-16"><a href="#cb66-16"></a>fib(<span class="dv">50</span>)</span>
<span id="cb66-17"><a href="#cb66-17"></a>fib_m(<span class="dv">50</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Time taken in fib: 0.0000000
Time taken in fib_m: 0.0000000</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="34">
<pre><code>12586269025</code></pre>
</div>
</div>
<p><code>lru</code> stands for “least recently used”. For more information on cache, see <a href="https://docs.python.org/3/library/functools.html">here</a>.</p>
</section>
<section id="reference" class="level1">
<h1>Reference</h1>
<hr>
<p>Source: <a href="https://github.com/chiphuyen/python-is-cool/tree/master" class="uri">https://github.com/chiphuyen/python-is-cool/tree/master</a></p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p><span class="faux-block"><a href="https://creativecommons.org/licenses/by-nc-nd/4.0/"><i class="fa-brands fa-creative-commons" aria-label="creative-commons"></i></a> 2023-2024 Le Khac Tuan</span></p>
</div>   
    <div class="nav-footer-center">
<p><span class="faux-block">Designed with <i class="fa-solid fa-heart" aria-label="heart"></i></span></p>
</div>
    <div class="nav-footer-right">
<p><span class="faux-block">Made with <a href="https://quarto.org/">Quarto</a></span> <span class="faux-block"><a href="https://github.com/lktuan/lktuan.github.io">View the source at <i class="fa-brands fa-github" aria-label="github"></i> GitHub</a></span></p>
</div>
  </div>
</footer>




</body></html>