<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.554">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Tuan Le Khac">
<meta name="dcterms.date" content="2024-07-08">
<meta name="description" content="I am a Risk Modeler 🚀">

<title>Le Khac Tuan - A lesson of advanced python from Juan Rodríguez</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../img/rocket_1613268.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/quarto-contrib/fontawesome6-0.1.0/all.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/fontawesome6-0.1.0/latex-fontsize.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="html/styles.scss">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Le Khac Tuan</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about/index.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../curriculum/index.html"> 
<span class="menu-text">Curriculum</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../blog.html"> 
<span class="menu-text">Blog</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../学汉语的日记.html"> 
<span class="menu-text">学汉语的日记</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../jiu_jitsu_journal/index.html"> 
<span class="menu-text">Jiu Jitsu Journal</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/lktuan"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/tuanlekhac/"> <i class="bi bi-linkedin" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.facebook.com/toilatuan.lk/"> <i class="bi bi-facebook" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="mailto:tuan.lekhac0905@gmail.com"> <i class="bi bi-envelope" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <div class="quarto-title-block"><div><h1 class="title">A lesson of advanced python from Juan Rodríguez</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
                  <div>
        <div class="description">
          The lecture by Juan Luis Cano Rodríguez in Master in Business Analytics and Big Data, 2021-2022, which focused on modern SWE practices using Python and the insight we can gain on how Data Science projects are put into production.
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">python</div>
                <div class="quarto-category">pydata</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p><a href="https://lktuan.github.io/">Tuan Le Khac</a> </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">July 8, 2024</p>
      </div>
    </div>
    
      <div>
      <div class="quarto-title-meta-heading">Modified</div>
      <div class="quarto-title-meta-contents">
        <p class="date-modified">August 1, 2024</p>
      </div>
    </div>
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#intro" id="toc-intro" class="nav-link active" data-scroll-target="#intro">00 intro</a>
  <ul class="collapse">
  <li><a href="#learning-objectives" id="toc-learning-objectives" class="nav-link" data-scroll-target="#learning-objectives">learning objectives</a></li>
  </ul></li>
  <li><a href="#git" id="toc-git" class="nav-link" data-scroll-target="#git">01 git</a>
  <ul class="collapse">
  <li><a href="#glossary" id="toc-glossary" class="nav-link" data-scroll-target="#glossary">glossary</a></li>
  <li><a href="#git-uses-a-linux-like-cli-so-now-linux-cli-101-and-how-to-do-the-same-on-window-pwsh" id="toc-git-uses-a-linux-like-cli-so-now-linux-cli-101-and-how-to-do-the-same-on-window-pwsh" class="nav-link" data-scroll-target="#git-uses-a-linux-like-cli-so-now-linux-cli-101-and-how-to-do-the-same-on-window-pwsh">git uses a Linux-like cli so now Linux cli 101 (and how to do the same on Window pwsh)</a></li>
  <li><a href="#workflow" id="toc-workflow" class="nav-link" data-scroll-target="#workflow">workflow</a></li>
  <li><a href="#branching" id="toc-branching" class="nav-link" data-scroll-target="#branching">branching</a></li>
  <li><a href="#merging" id="toc-merging" class="nav-link" data-scroll-target="#merging">merging</a></li>
  <li><a href="#other" id="toc-other" class="nav-link" data-scroll-target="#other">other</a></li>
  <li><a href="#triangular-workflows-in-git" id="toc-triangular-workflows-in-git" class="nav-link" data-scroll-target="#triangular-workflows-in-git">triangular workflows in git</a></li>
  <li><a href="#after-creating-a-pr" id="toc-after-creating-a-pr" class="nav-link" data-scroll-target="#after-creating-a-pr">after creating a PR</a></li>
  </ul></li>
  <li><a href="#pythonpath" id="toc-pythonpath" class="nav-link" data-scroll-target="#pythonpath">02 pythonpath</a>
  <ul class="collapse">
  <li><a href="#how-does-import-work" id="toc-how-does-import-work" class="nav-link" data-scroll-target="#how-does-import-work">how does <code>import</code> work?</a></li>
  <li><a href="#how-can-i-import-my-code" id="toc-how-can-i-import-my-code" class="nav-link" data-scroll-target="#how-can-i-import-my-code">how can I <code>import</code> my code?</a></li>
  <li><a href="#my-first-python-lib" id="toc-my-first-python-lib" class="nav-link" data-scroll-target="#my-first-python-lib">my first python lib</a></li>
  <li><a href="#the-pythonpath" id="toc-the-pythonpath" class="nav-link" data-scroll-target="#the-pythonpath">the <code>PYTHONPATH</code></a></li>
  <li><a href="#what-does-import-do" id="toc-what-does-import-do" class="nav-link" data-scroll-target="#what-does-import-do">what does <code>import</code> do?</a></li>
  <li><a href="#how-to-separate-running-code-from-reusable-pieces" id="toc-how-to-separate-running-code-from-reusable-pieces" class="nav-link" data-scroll-target="#how-to-separate-running-code-from-reusable-pieces">how to separate “running code” from reusable pieces</a></li>
  </ul></li>
  <li><a href="#pip-vs.-conda" id="toc-pip-vs.-conda" class="nav-link" data-scroll-target="#pip-vs.-conda">03&amp;04 pip vs.&nbsp;conda</a>
  <ul class="collapse">
  <li><a href="#managing-python-environments" id="toc-managing-python-environments" class="nav-link" data-scroll-target="#managing-python-environments">managing python environments</a></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary">summary</a></li>
  <li><a href="#pip-and-pypi" id="toc-pip-and-pypi" class="nav-link" data-scroll-target="#pip-and-pypi"><code>pip</code> and <code>PyPI</code></a></li>
  </ul></li>
  <li><a href="#layout" id="toc-layout" class="nav-link" data-scroll-target="#layout">05 layout</a>
  <ul class="collapse">
  <li><a href="#creating-a-package" id="toc-creating-a-package" class="nav-link" data-scroll-target="#creating-a-package">creating a package</a></li>
  <li><a href="#intermezzo-version-numbers" id="toc-intermezzo-version-numbers" class="nav-link" data-scroll-target="#intermezzo-version-numbers">intermezzo: version numbers</a></li>
  <li><a href="#project-requirements" id="toc-project-requirements" class="nav-link" data-scroll-target="#project-requirements">project requirements</a></li>
  </ul></li>
  <li><a href="#unit-test" id="toc-unit-test" class="nav-link" data-scroll-target="#unit-test">06 unit test</a>
  <ul class="collapse">
  <li><a href="#test-driven-development" id="toc-test-driven-development" class="nav-link" data-scroll-target="#test-driven-development">test-driven development</a></li>
  <li><a href="#testing-in-python" id="toc-testing-in-python" class="nav-link" data-scroll-target="#testing-in-python">testing in Python</a></li>
  </ul></li>
  <li><a href="#oop" id="toc-oop" class="nav-link" data-scroll-target="#oop">07&amp;08 oop</a>
  <ul class="collapse">
  <li><a href="#what-are-objects-anyway" id="toc-what-are-objects-anyway" class="nav-link" data-scroll-target="#what-are-objects-anyway">what are “objects” anyway?</a></li>
  <li><a href="#classes-and-instances" id="toc-classes-and-instances" class="nav-link" data-scroll-target="#classes-and-instances">classes and instances</a>
  <ul class="collapse">
  <li><a href="#example" id="toc-example" class="nav-link" data-scroll-target="#example">Example</a></li>
  <li><a href="#using-the-instance-self" id="toc-using-the-instance-self" class="nav-link" data-scroll-target="#using-the-instance-self">Using the instance: <code>self</code></a></li>
  <li><a href="#intermezzo-f-strings" id="toc-intermezzo-f-strings" class="nav-link" data-scroll-target="#intermezzo-f-strings">intermezzo: f-strings</a></li>
  <li><a href="#initializing-our-instances" id="toc-initializing-our-instances" class="nav-link" data-scroll-target="#initializing-our-instances">initializing our instances</a></li>
  <li><a href="#exercise" id="toc-exercise" class="nav-link" data-scroll-target="#exercise">exercise</a></li>
  <li><a href="#extra-date-formatting" id="toc-extra-date-formatting" class="nav-link" data-scroll-target="#extra-date-formatting">extra: date formatting</a></li>
  <li><a href="#protecting-properties" id="toc-protecting-properties" class="nav-link" data-scroll-target="#protecting-properties">protecting properties</a></li>
  </ul></li>
  <li><a href="#inheritance" id="toc-inheritance" class="nav-link" data-scroll-target="#inheritance">inheritance</a>
  <ul class="collapse">
  <li><a href="#more-special-methods" id="toc-more-special-methods" class="nav-link" data-scroll-target="#more-special-methods">more special methods</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#flask" id="toc-flask" class="nav-link" data-scroll-target="#flask">09&amp;10 flask</a></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion">conclusion</a>
  <ul class="collapse">
  <li><a href="#where-do-we-go-from-here" id="toc-where-do-we-go-from-here" class="nav-link" data-scroll-target="#where-do-we-go-from-here">where do we go from here</a></li>
  <li><a href="#keep-improving-the-art-of-python-packaging" id="toc-keep-improving-the-art-of-python-packaging" class="nav-link" data-scroll-target="#keep-improving-the-art-of-python-packaging">keep improving the art of python packaging</a></li>
  <li><a href="#explore-other-options-for-high-performance-python" id="toc-explore-other-options-for-high-performance-python" class="nav-link" data-scroll-target="#explore-other-options-for-high-performance-python">explore other options for high performance python</a></li>
  </ul></li>
  <li><a href="#other-resources" id="toc-other-resources" class="nav-link" data-scroll-target="#other-resources">other resources</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block page-columns page-full" id="quarto-document-content">





<p>This <a href="https://github.com/astrojuanlu/ie-mbd-advanced-python/tree/main">lesson</a> was found on <a href="https://github.com/astrojuanlu">Juan Luis Cano Rodríguez’s</a> github profile when I came across his talk <a href="https://www.youtube.com/watch?v=ffDHdtz_vKc">“Building the composable Python data stack with Kedro &amp; Ibis”</a> (bookmarked for learning later) in <a href="https://www.youtube.com/playlist?list=PLGVZCDnMOq0rrhYTNedKKuJ9716fEaAdK">Pydata London 2024</a>.</p>
<p>This is my notes:</p>
<section id="intro" class="level1">
<h1>00 <a href="https://github.com/astrojuanlu/ie-mbd-advanced-python/blob/main/sessions/00_intro.ipynb">intro</a></h1>
<section id="learning-objectives" class="level2">
<h2 class="anchored" data-anchor-id="learning-objectives">learning objectives</h2>
<ul>
<li>Learn modern software engineering practices using Python</li>
<li>Understand the value of automation in the software engineering process</li>
<li>Gain insight into how Data Science projects are put in production</li>
<li>Learn better techniques to collaborate in software projects</li>
</ul>
<p>The instructor used Linux / Conda, err I just have Window here so there is no other way but right I will try to make stuffs work in Window. Let’s get started!</p>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="1">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://raw.githubusercontent.com/astrojuanlu/ie-mbd-advanced-python/e2224276f91529280ebfcd42ddc7dc22cf0d2010/img/quote-talk-is-cheap-show-me-the-code-linus-torvalds-273528.jpg" class="img-fluid figure-img"></p>
<figcaption>stolen from the lecture</figcaption>
</figure>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="git" class="level1">
<h1>01 <a href="https://github.com/astrojuanlu/ie-mbd-advanced-python/blob/main/sessions/01_git.ipynb">git</a></h1>
<section id="glossary" class="level2">
<h2 class="anchored" data-anchor-id="glossary">glossary</h2>
<ul>
<li><strong>Repository</strong>: Directory tracked by git, contains a <code>.git</code> folder and it’s created by <code>$ git init</code>;</li>
<li><strong>Commit</strong>: State or snapshot of the repository, they are created by <code>$ git commit</code>;</li>
<li><strong>Branch</strong>: A parallel or separate line of development, the default one is master and they are created by <code>$ git branch</code> or <code>$ git checkout -b</code>.</li>
</ul>
</section>
<section id="git-uses-a-linux-like-cli-so-now-linux-cli-101-and-how-to-do-the-same-on-window-pwsh" class="level2">
<h2 class="anchored" data-anchor-id="git-uses-a-linux-like-cli-so-now-linux-cli-101-and-how-to-do-the-same-on-window-pwsh">git uses a Linux-like cli so now Linux cli 101 (and how to do the same on Window pwsh)</h2>
<ul>
<li><code>whoami</code>: who am i</li>
<li><code>pwd</code>: print working directory</li>
<li><code>ls</code>: list all file in the dir, <code>.</code> for current folder, <code>..</code> for parent one (seems there is no <code>--color</code> or <code>-a</code> in pwsh)</li>
<li><code>cd</code>: change dir</li>
<li><code>touch</code>: create empty file (in pwsh we use <code>echo "" &gt;&gt; file_name</code>)</li>
<li><code>cat</code>: concatenate, print file contents</li>
<li><code>nano</code>: edit a file from the command line (there is a <a href="https://www.hanselman.com/blog/developers-can-run-bash-shell-and-usermode-ubuntu-linux-binaries-on-windows-10">way</a> that allows us to do the same in win10, but ya, nope)</li>
</ul>
</section>
<section id="workflow" class="level2">
<h2 class="anchored" data-anchor-id="workflow">workflow</h2>
<p>I did these in pwsh:</p>
<ol type="1">
<li>Create a directory <code>mkdir test_project</code> and navigate there <code>cd test_project</code>;</li>
<li>Init a git repository <code>git init</code>;</li>
<li>Check status <code>git status</code> (“on branch master, no commits yet, nothing to commit”);</li>
<li>Create some files <code>echo "#Hello, world!" &gt;&gt; readme.md</code>;</li>
<li>Stage the files <code>git add readme.md</code>;</li>
<li>Commit the changes <code>git commit -m "initial commit"</code>;</li>
</ol>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>Do not run <code>git init</code> on your home directory, as it can lead to confusion and potential data loss. If <code>git status</code> gives a lot of untracked files unrelated to your project, you might want to <code>rm -rf .git</code> and start in another directory. Notice that this command removes all git history.</p>
</div>
</div>
</section>
<section id="branching" class="level2">
<h2 class="anchored" data-anchor-id="branching">branching</h2>
<ol type="1">
<li>Create and checkout to new branch <code>git switch -c branch1</code> (<code>-c</code> stands for create);</li>
<li>Commit there (see above);</li>
<li>Go back to main branch <code>git switch master</code>;</li>
<li>Merge changes <code>git merge branch1</code>;</li>
<li>Delete branch <code>git branch -d branch1</code> (<code>-d</code> stands for delete, don’t forget this step!).</li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Normally, the <code>git merge</code> step happens online using <em>pull requests</em> or <em>merge requests</em>, which are <strong>not</strong> git concepts, but GitHub/GitLab concepts.</li>
<li>If <code>git switch</code> does not work for you, you might have an older version of Git. Consider upgrading, or alternatively replace all <code>git switch -c</code> with <code>git checkout -b</code>.</li>
</ul>
</div>
</div>
<blockquote class="blockquote">
<p>Pull requests (PR) let you tell others about changes you’ve pushed to a branch in a repository on GitHub. Once a pull request is opened, you can discuss and review the potential changes with collaborators and add follow-up commits before your changes are merged into the base branch. – GitHub</p>
</blockquote>
<blockquote class="blockquote">
<p>A merge request (MR) is a proposal to incorporate changes from a source branch to a target branch. – GitLab</p>
</blockquote>
<blockquote class="blockquote">
<p>Remember to <strong>never commit to master</strong>. – Git Workflow</p>
</blockquote>
</section>
<section id="merging" class="level2">
<h2 class="anchored" data-anchor-id="merging">merging</h2>
<p>2 types of merging:</p>
<ul>
<li><strong>Fast-forward merge</strong>: There is no diverging history, and git just “advances the pointer” of the current branch. <code>git merge new-branch --ff-only</code> will fail if a fast-forward merge is not possible;</li>
<li><strong>Non fast-forward merge</strong>: The history diverged, and git will create a merge commit (hence ask for a commit message) with two parents that combines the two branches. <code>git merge new-branch --no-ff</code> always creates a merge commit even if a fast-forward merge is possible.</li>
</ul>
<p>GitHub use <code>--no--ff</code> option for pull requests, see <a href="https://docs.github.com/en/pull-requests/collaborating-with-pull-requests/incorporating-changes-from-a-pull-request/merging-a-pull-request">here</a>, and this old-but-gold <a href="https://stackoverflow.com/questions/9069061/what-effect-does-the-no-ff-flag-have-for-git-merge">discussion</a>.</p>
<ul>
<li>Non fast-forward merges can end up in conflicts. In that case, git will halt the merge operation and leave traces in the affected files;</li>
<li>To abort a merge <code>git merge --abort</code> (useful if we are scared and don’t know what to do);</li>
<li>To merge overriding everything with the upcoming branch <code>git merge new-branch --strategy-option theirs</code>;</li>
<li>To merge overriding everything with the current branch <code>git merge new-branch --strategy-option ours</code>.</li>
</ul>
<p><strong>Be careful</strong> while editing files that are in conflict.</p>
</section>
<section id="other" class="level2">
<h2 class="anchored" data-anchor-id="other">other</h2>
<ul>
<li>Ignoring files <code>.gitignore</code>;</li>
<li>Amend the last commit: <code>git commit --amend</code>;</li>
<li>Show pretty history: <code>git log --graph --oneline --decorate --all</code>;</li>
<li>Configuring git aliases: <code>git config --global alias.lg "log --graph --oneline --decorate"</code> (and now you have <code>git lg</code>!).</li>
</ul>
<p>This excellent chart will help you in git workflow decision making.</p>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="1">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="git_pretty.png" class="img-fluid figure-img"></p>
<figcaption>git flowchart, photo credit to this SO <a href="https://stackoverflow.com/questions/14096721/how-to-add-file-to-a-previous-commit">thread</a></figcaption>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="triangular-workflows-in-git" class="level2">
<h2 class="anchored" data-anchor-id="triangular-workflows-in-git">triangular workflows in git</h2>
<p>When collaborating with a project hosted online on GitHub or GitLab, the most common setup is having a central repository, one remote fork per user, and local clones/checkouts:</p>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="1">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://github.blog/wp-content/uploads/2015/07/5dcdcae4-354a-11e5-9f82-915914fad4f7.png?resize=2000%2C951" class="img-fluid figure-img"></p>
<figcaption>triangular workflows in git, <a href="https://github.blog/2015-07-29-git-2-5-including-multiple-worktrees-and-triangular-workflows/">source</a></figcaption>
</figure>
</div>
</div>
</div>
</div>
<p>Notice the different naming conventions between this website and the first image:</p>
<ul>
<li>Convention 1: upstream/origin/local</li>
<li>Convention 2: origin/<username>/local</username></li>
</ul>
<p>We will be consistent with the Aaron Meurer guide and therefore use Convention 2 all the time.</p>
</section>
<section id="after-creating-a-pr" class="level2">
<h2 class="anchored" data-anchor-id="after-creating-a-pr">after creating a PR</h2>
<p>After your pull request has been merged to <code>master</code>, your local <code>master</code> and <code>&lt;username&gt;/master</code> will be outdated with respect to <code>origin/master</code>. On the other hand, you should <strong>avoid working on this branch anymore in the future</strong>: remember branches should be ephemeral and short-lived.</p>
<p>To put yourself in a clean state again, you have to:</p>
<ol type="1">
<li>Click “remove branch” in the pull request (don’t click “remove fork”!);</li>
<li><code>git checkout master</code> (go back to master);</li>
<li><code>git fetch origin</code> (<strong>never, ever</strong> use <code>git pull</code> unless you know exactly what you’re doing)</li>
<li><code>git merge --ff-only origin master</code> (update your local master with origin/master, and fail if you accidentally made any commit in master)</li>
<li><code>git fetch -p &lt;username&gt;</code> (✨ acknowledge the removal of the remote branch ✨)</li>
<li><code>git branch -d old-branch</code> (remove the old branch)</li>
<li><code>git push &lt;username&gt; master</code> (update your fork with respect to origin)</li>
<li><code>git checkout -b new-branch</code> (start working in the new feature!)</li>
</ol>
<p>This process has to be repeated <strong>after every pull request</strong>.</p>
<p>Some organizations where all the members are trusted do not use forks, and everybody pushes their branches to the same repository instead. While this simplifies some parts of the workflow, it also requires proper checks in place to prevent bad code to be merged - for example, by <a href="https://docs.github.com/en/repositories/configuring-branches-and-merges-in-your-repository/managing-protected-branches/managing-a-branch-protection-rule">requiring a minimum number of reviews</a> or some <a href="https://docs.github.com/en/repositories/configuring-branches-and-merges-in-your-repository/managing-protected-branches/about-protected-branches">automated status checks</a>.</p>
</section>
</section>
<section id="pythonpath" class="level1">
<h1>02 <a href="https://github.com/astrojuanlu/ie-mbd-advanced-python/blob/main/sessions/02_pythonpath.ipynb">pythonpath</a></h1>
<section id="how-does-import-work" class="level2">
<h2 class="anchored" data-anchor-id="how-does-import-work">how does <code>import</code> work?</h2>
<p>How do <code>import os, pandas</code> work? If <code>pandas</code> was not installed, what happen?</p>
</section>
<section id="how-can-i-import-my-code" class="level2">
<h2 class="anchored" data-anchor-id="how-can-i-import-my-code">how can I <code>import</code> my code?</h2>
<p>There are three ways to import our own code:</p>
<ul>
<li><strong>Being on the same directory</strong>: This is the quickest, however it scales quite poorly (imagine having all of pandas and scikit-learn in a single directory to do any data analysis project!)</li>
<li><strong>Appending our code location to PYTHONPATH</strong>: This is effective, but we will try to avoid it because it can bring problems in the future.</li>
<li><strong>Making our code installable</strong>: Since any code that’s installed can be imported, this shifts the question to “how to make our code installable”.</li>
</ul>
</section>
<section id="my-first-python-lib" class="level2">
<h2 class="anchored" data-anchor-id="my-first-python-lib">my first python lib</h2>
<p>We will create a new Python library, “IE Titanic utils”, to analyze the <a href="https://www.kaggle.com/c/titanic/data">Titanic dataset</a>. I will create a project <code>ie-titanic-utils</code>, add <code>readme.md</code> and <code>.gitignore</code> files.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1"></a><span class="fu">mkdir</span> it-titanic-utils</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="fu">git</span> init</span>
<span id="cb1-3"><a href="#cb1-3"></a></span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="bu">echo</span> <span class="st">"# This is utility to help analyze Titanic dataset"</span> <span class="op">&gt;&gt;</span> readme.md</span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="ex">Invoke-WebRequest</span> <span class="at">-Uri</span> <span class="st">"https://www.toptal.com/developers/gitignore/api/python,jupyternotebooks"</span> <span class="kw">|</span> <span class="ex">Select-Object</span> <span class="at">-ExpandProperty</span> Content <span class="kw">|</span> <span class="ex">Out-File</span> <span class="at">-FilePath</span> .gitignore <span class="at">-Encoding</span> utf8</span>
<span id="cb1-6"><a href="#cb1-6"></a></span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="fu">git</span> add readme.md .gitignore</span>
<span id="cb1-8"><a href="#cb1-8"></a><span class="fu">git</span> commit <span class="at">-m</span> <span class="st">"initial commit"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Now I will create <code>str_utils.py</code> file (using VS code for convenience), with a function called <code>tokenize</code> that takes a str sentence and splits it into a list of words.</p>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>str_utils.py</strong></pre>
</div>
<div class="sourceCode" id="cb2" data-filename="str_utils.py"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1"></a><span class="kw">def</span> tokenize(sentence: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">list</span>[<span class="bu">str</span>]:</span>
<span id="cb2-2"><a href="#cb2-2"></a>    <span class="cf">return</span> sentence.split()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In pwsh, I can import and use this function</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1"></a><span class="ex">python</span></span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="ex">Python</span> 3.11.4 <span class="er">(</span><span class="ex">tags/v3.11.4:d2340ef,</span> Jun  7 2023, 05:45:37<span class="kw">)</span> <span class="ex">[MSC</span> v.1934 64 bit <span class="er">(</span><span class="ex">AMD64</span><span class="kw">)</span><span class="ex">]</span> on win32</span>
<span id="cb3-3"><a href="#cb3-3"></a><span class="ex">Type</span> <span class="st">"help"</span>, <span class="st">"copyright"</span>, <span class="st">"credits"</span> or <span class="st">"license"</span> for more information.</span>
<span id="cb3-4"><a href="#cb3-4"></a><span class="op">&gt;&gt;&gt;</span> from <span class="ex">str_utils</span> import tokenize</span>
<span id="cb3-5"><a href="#cb3-5"></a><span class="op">&gt;&gt;&gt;</span> tokenize<span class="kw">(</span><span class="st">"Toi la Le Khac Tuan"</span><span class="kw">)</span></span>
<span id="cb3-6"><a href="#cb3-6"></a><span class="ex">[</span><span class="st">'Toi'</span><span class="ex">,</span> <span class="st">'la'</span>, <span class="st">'Le'</span>, <span class="st">'Khac'</span>, <span class="st">'Tuan'</span>]</span>
<span id="cb3-7"><a href="#cb3-7"></a><span class="op">&gt;&gt;&gt;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="the-pythonpath" class="level2">
<h2 class="anchored" data-anchor-id="the-pythonpath">the <code>PYTHONPATH</code></h2>
<p>We saw above that we could easily import our <code>tokenize</code> function. However, this only works if we are in the same directory. Why? Python looks in some predefined locations to know where to find what we want to import, called the “PATH”.</p>
<div id="e4b08fa3" class="cell" data-execution_count="1">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1"></a><span class="im">import</span> sys</span>
<span id="cb4-2"><a href="#cb4-2"></a>sys.path <span class="co"># i will not execute this code</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Therefore, there are two ways of making our code <strong>globally importable</strong>:</p>
<ol type="1">
<li>Modify the “PATH”</li>
<li>Put our code inside a location predefined in the “PATH”</li>
</ol>
<p>The first option can be achieved like this:</p>
<div id="d729e316" class="cell" data-execution_count="2">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1"></a><span class="op">&gt;&gt;&gt;</span> sys.path.insert(<span class="dv">0</span>, <span class="st">"/home/username/ie-titanic-utils"</span>)</span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="op">&gt;&gt;&gt;</span> <span class="im">import</span> str_utils  <span class="co"># Works!</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Or, alternatively, from outside of the interpreter: <code>export PYTHONPATH=/home/username/ie-titanic-utils</code>.</p>
<p>However, both are <strong>bad practices and should be avoided</strong>.</p>
</section>
<section id="what-does-import-do" class="level2">
<h2 class="anchored" data-anchor-id="what-does-import-do">what does <code>import</code> do?</h2>
<p>Python code is normally written in <code>.py</code> scripts. These scripts can be imported in the same way that any model or package from the standard library can:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1"></a><span class="ex">$</span> python3</span>
<span id="cb6-2"><a href="#cb6-2"></a><span class="op">&gt;&gt;&gt;</span> import <span class="ex">math</span>  <span class="co"># Works, because it's in stdlib</span></span>
<span id="cb6-3"><a href="#cb6-3"></a><span class="op">&gt;&gt;&gt;</span> import <span class="ex">numpy</span> as np  <span class="co"># Works if you ran `pip install numpy` in advance</span></span>
<span id="cb6-4"><a href="#cb6-4"></a><span class="op">&gt;&gt;&gt;</span> import <span class="ex">str_utils</span>  <span class="co"># Works if you are in the same directory</span></span>
<span id="cb6-5"><a href="#cb6-5"></a><span class="ex">[</span><span class="st">'Hello,'</span><span class="ex">,</span> <span class="st">'world!'</span>]</span>
<span id="cb6-6"><a href="#cb6-6"></a><span class="op">&gt;&gt;&gt;</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>When the user imports a script, <strong>Python runs the script</strong>. That’s the way all the possible functions and classes inside it are available.</p>
</section>
<section id="how-to-separate-running-code-from-reusable-pieces" class="level2">
<h2 class="anchored" data-anchor-id="how-to-separate-running-code-from-reusable-pieces">how to separate “running code” from reusable pieces</h2>
<p>A Python module (any <code>.py</code> script) might contain code that we want to run, as well as code that we only want to import. To separate these, we use this trick:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1"></a><span class="ex"></span> ie-titanic-utils  get-content <span class="at">-Tail</span> 2 .str_utils.py</span>
<span id="cb7-2"><a href="#cb7-2"></a><span class="cf">if</span> <span class="ex">__name__</span> == <span class="st">"__main__"</span>:</span>
<span id="cb7-3"><a href="#cb7-3"></a>    <span class="ex">print</span><span class="er">(</span><span class="ex">tokenize</span><span class="er">(</span><span class="st">"hello, world!"</span><span class="kw">))</span></span>
<span id="cb7-4"><a href="#cb7-4"></a></span>
<span id="cb7-5"><a href="#cb7-5"></a><span class="ex"></span> ie-titanic-utils  python .str_utils.py <span class="co"># The `print` runs</span></span>
<span id="cb7-6"><a href="#cb7-6"></a><span class="ex">[</span><span class="st">'hello,'</span><span class="ex">,</span> <span class="st">'world!'</span>]</span>
<span id="cb7-7"><a href="#cb7-7"></a></span>
<span id="cb7-8"><a href="#cb7-8"></a><span class="ex"></span> ie-titanic-utils  python</span>
<span id="cb7-9"><a href="#cb7-9"></a><span class="op">&gt;&gt;&gt;</span> from <span class="ex">str_utils</span> import tokenize</span>
<span id="cb7-10"><a href="#cb7-10"></a><span class="op">&gt;&gt;&gt;</span> tokenize<span class="kw">(</span><span class="st">"Hi, world!"</span><span class="kw">)</span></span>
<span id="cb7-11"><a href="#cb7-11"></a><span class="ex">[</span><span class="st">'Hi,'</span><span class="ex">,</span> <span class="st">'world!'</span>] <span class="co"># The `print` doesn't run!</span></span>
<span id="cb7-12"><a href="#cb7-12"></a><span class="op">&gt;&gt;&gt;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>Here is what Claude sonnet 3.5 gave me:</p>
<p>To separate code that we want to run directly from code that we only want to import, we should use the if <code>__name__ == "__main__"</code>: idiom in Python. This is a common pattern that allows a Python script to be both importable and executable. Here’s an explanation:</p>
<ol type="1">
<li>When a Python file is run directly, Python sets the special <code>__name__</code> variable to “<code>__main__</code>”.</li>
<li>When a Python file is imported as a module,<code>__name__</code>is set to the name of the module.</li>
</ol>
<p>By using this idiom, we can control which code runs when the script is executed directly versus when it’s imported as a module.</p>
</div>
</div>
</section>
</section>
<section id="pip-vs.-conda" class="level1">
<h1>03&amp;04 <a href="https://github.com/astrojuanlu/ie-mbd-advanced-python/blob/main/sessions/03-04_pip-vs-conda.ipynb">pip vs.&nbsp;conda</a></h1>
<section id="managing-python-environments" class="level2">
<h2 class="anchored" data-anchor-id="managing-python-environments">managing python environments</h2>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="1">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://raw.githubusercontent.com/astrojuanlu/ie-mbd-advanced-python/e2224276f91529280ebfcd42ddc7dc22cf0d2010/img/python_comrades.png" class="img-fluid figure-img"></p>
<figcaption>stolen from the lecture</figcaption>
</figure>
</div>
</div>
</div>
</div>
<blockquote class="blockquote">
<p>Simple is better than complex.</p>
<p>Complex is better than complicated.</p>
</blockquote>
<p>How do people install and upgrade Python? -&gt; Most of people choose Python.org, the same for me!</p>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Caution
</div>
</div>
<div class="callout-body-container callout-body">
<p>This way ships a tool to create development environments (<code>venv</code>). However, <code>venv</code> cannot create environments with different Python versions (you’re tied to the one you downloaded) and certain packages will require extra steps to be installed. Therefore, it <strong>is not</strong> for everyone.</p>
</div>
</div>
<p>Juan chose to use <code>conda</code>. As I am learning Docker, I choose Docker for this tutorial.</p>
<p>How do people create isolated development environments? -&gt; The most popular is <code>Virtualenv</code>. But normally when doing an analysis task, I use <code>venv</code> which is built-in python lib. Recently I followed my dev team to use <code>pipenv</code>, I do also see <code>poetry</code> is worth-learning approach.</p>
<blockquote class="blockquote">
<p>“More than a half of the users of Jupyter Notebook and JupyterLab choose Conda”</p>
</blockquote>
<p>As I think a model which is not deployed yet is useless model, I choose VS Code and Docker - more deployment-oriented.</p>
</section>
<section id="summary" class="level2">
<h2 class="anchored" data-anchor-id="summary">summary</h2>
<blockquote class="blockquote">
<p>For the user, the most salient distinction is probably this: pip installs python packages within any environment; conda installs any package within conda environments.</p>
<p>—Jake Vanderplas</p>
</blockquote>
<p>However, I will be using <code>pipenv</code> to achieve what Juan done in upcoming sections. I will specify version of each package I used.</p>
</section>
<section id="pip-and-pypi" class="level2">
<h2 class="anchored" data-anchor-id="pip-and-pypi"><code>pip</code> and <code>PyPI</code></h2>
<p><code>pip</code> is the default Python installer. By default, it fetches packages from <a href="https://pypi.org/" class="uri">https://pypi.org/</a>, which is the community repository for Python packages.</p>
</section>
</section>
<section id="layout" class="level1">
<h1>05 layout</h1>
<p>here is my project’s layout:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1"></a><span class="ex">ie-titanic-utils</span></span>
<span id="cb8-2"><a href="#cb8-2"></a><span class="ex">├─</span> src</span>
<span id="cb8-3"><a href="#cb8-3"></a><span class="ex">│</span>  └─ ie_titanic_utils</span>
<span id="cb8-4"><a href="#cb8-4"></a><span class="ex">│</span>     ├─ __init__.py</span>
<span id="cb8-5"><a href="#cb8-5"></a><span class="ex">│</span>     └─ ...</span>
<span id="cb8-6"><a href="#cb8-6"></a><span class="ex">├─</span> tests</span>
<span id="cb8-7"><a href="#cb8-7"></a><span class="ex">│</span>  └─ ...</span>
<span id="cb8-8"><a href="#cb8-8"></a><span class="ex">├─</span> .gitignore</span>
<span id="cb8-9"><a href="#cb8-9"></a><span class="ex">├─</span> README.md</span>
<span id="cb8-10"><a href="#cb8-10"></a><span class="ex">└─</span> pyproject.toml</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>The <code>src/package_name</code> contains the source code of the library. <code>package_name</code> must be Python identifier. It should contain a <code>__init__.py</code> that can be empty;</li>
<li>The <code>tests</code> directory contains the tests. It must not contain any <code>__init__.py</code> because it’s not meant to be imported as a package. In very specific cases it’s included inside <code>src/package_name</code>;</li>
<li>Every project contains a <code>README.md</code> that at least explains what the project is;</li>
<li><code>pyproject.toml</code> contains the metadata of the project. The absolutely required fields are <code>module</code>, <code>author</code>, and some extra information that tells Python how to install the package.</li>
</ul>
<section id="creating-a-package" class="level2">
<h2 class="anchored" data-anchor-id="creating-a-package">creating a package</h2>
<ol type="1">
<li>run <code>flit init</code> to create the metadata</li>
</ol>
<div class="sourceCode" id="cb9"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1"></a><span class="ex"></span> ie-titanic-utils  flit init</span>
<span id="cb9-2"><a href="#cb9-2"></a><span class="ex">pyproject.toml</span> exists <span class="at">-</span> overwrite it<span class="pp">?</span> <span class="pp">[</span><span class="ss">y/N</span><span class="pp">]</span>: y</span>
<span id="cb9-3"><a href="#cb9-3"></a><span class="ex">Module</span> name <span class="pp">[</span><span class="ss">ie_titanic_utils</span><span class="pp">]</span>: ie_utils</span>
<span id="cb9-4"><a href="#cb9-4"></a><span class="ex">Author:</span> Tuan Le Khac</span>
<span id="cb9-5"><a href="#cb9-5"></a><span class="ex">Author</span> email: tuan.lekhac0905@gmail.com</span>
<span id="cb9-6"><a href="#cb9-6"></a><span class="ex">Home</span> page: </span>
<span id="cb9-7"><a href="#cb9-7"></a><span class="ex">Choose</span> a license <span class="er">(</span><span class="ex">see</span> http://choosealicense.com/ for more info<span class="kw">)</span></span>
<span id="cb9-8"><a href="#cb9-8"></a><span class="ex">1.</span> MIT <span class="at">-</span> simple and permissive</span>
<span id="cb9-9"><a href="#cb9-9"></a><span class="ex">2.</span> Apache <span class="at">-</span> explicitly grants patent rights</span>
<span id="cb9-10"><a href="#cb9-10"></a><span class="ex">3.</span> GPL <span class="at">-</span> ensures that code based on this is shared with the same terms</span>
<span id="cb9-11"><a href="#cb9-11"></a><span class="ex">4.</span> Skip <span class="at">-</span> choose a license later</span>
<span id="cb9-12"><a href="#cb9-12"></a><span class="ex">Enter</span> 1-4: 4</span>
<span id="cb9-13"><a href="#cb9-13"></a></span>
<span id="cb9-14"><a href="#cb9-14"></a><span class="ex">Written</span> pyproject.toml<span class="kw">;</span> <span class="ex">edit</span> that file to add optional extra info.</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ol start="2" type="1">
<li>place some code under the source directory. In <code>__init__.py</code> there must be a docstring giving a description of the project and a <code>__version__</code> variable indicating the version:</li>
</ol>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>__init__.py</strong></pre>
</div>
<div class="sourceCode" id="cb10" data-filename="__init__.py"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1"></a><span class="co">"""IE utils (test package)."""</span></span>
<span id="cb10-2"><a href="#cb10-2"></a></span>
<span id="cb10-3"><a href="#cb10-3"></a>__version__ <span class="op">=</span> <span class="st">"0.1.0"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="3" type="1">
<li>Install the code using <code>pip install</code>! (this did not work for me currently. edit: the project name should match the <code>src/package_name</code> omg)</li>
</ol>
<div class="sourceCode" id="cb11"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb11-1"><a href="#cb11-1"></a><span class="ex"></span> ie-titanic-utils  pip install .</span>
<span id="cb11-2"><a href="#cb11-2"></a><span class="ex">Processing</span> .ie-titanic-utils</span>
<span id="cb11-3"><a href="#cb11-3"></a><span class="ex">...</span></span>
<span id="cb11-4"><a href="#cb11-4"></a><span class="ex">Successfully</span> installed ie_titanic_utils-0.1.0</span>
<span id="cb11-5"><a href="#cb11-5"></a><span class="ex"></span> ie-titanic-utils  python</span>
<span id="cb11-6"><a href="#cb11-6"></a><span class="ex">Python</span> 3.11.4 <span class="er">(</span><span class="ex">tags/v3.11.4:d2340ef,</span> Jun  7 2023, 05:45:37<span class="kw">)</span> <span class="ex">[MSC</span> v.1934 64 bit <span class="er">(</span><span class="ex">AMD64</span><span class="kw">)</span><span class="ex">]</span> on win32</span>
<span id="cb11-7"><a href="#cb11-7"></a><span class="ex">Type</span> <span class="st">"help"</span>, <span class="st">"copyright"</span>, <span class="st">"credits"</span> or <span class="st">"license"</span> for more information.</span>
<span id="cb11-8"><a href="#cb11-8"></a><span class="op">&gt;&gt;&gt;</span> import <span class="ex">ie_titanic_utils</span></span>
<span id="cb11-9"><a href="#cb11-9"></a><span class="op">&gt;&gt;&gt;</span> ie_titanic_utils.__version__</span>
<span id="cb11-10"><a href="#cb11-10"></a><span class="st">'0.1.0'</span></span>
<span id="cb11-11"><a href="#cb11-11"></a><span class="op">&gt;&gt;&gt;</span>    </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ol start="4" type="1">
<li><code>readme.md</code> and a <code>.gitignore</code> files were created.</li>
<li>commit the change</li>
</ol>
<div class="sourceCode" id="cb12"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb12-1"><a href="#cb12-1"></a><span class="fu">git</span> checkout <span class="at">-b</span> first_module <span class="co"># i should be using switch (-c) haha, checkout is old syntax</span></span>
<span id="cb12-2"><a href="#cb12-2"></a><span class="fu">git</span> status</span>
<span id="cb12-3"><a href="#cb12-3"></a><span class="fu">git</span> add .</span>
<span id="cb12-4"><a href="#cb12-4"></a><span class="fu">git</span> commit <span class="at">-m</span> <span class="st">"initial very first module"</span></span>
<span id="cb12-5"><a href="#cb12-5"></a><span class="fu">git</span> checkout master</span>
<span id="cb12-6"><a href="#cb12-6"></a></span>
<span id="cb12-7"><a href="#cb12-7"></a><span class="ex"></span> ie-titanic-utils  git merge <span class="at">--no-ff</span> first_module</span>
<span id="cb12-8"><a href="#cb12-8"></a><span class="ex">Merge</span> made by the <span class="st">'ort'</span> strategy.</span>
<span id="cb12-9"><a href="#cb12-9"></a> <span class="ex">pyproject.toml</span>                    <span class="kw">|</span> <span class="ex">30</span> ++++++++++++++++++++++++++++++</span>
<span id="cb12-10"><a href="#cb12-10"></a> <span class="ex">src/ie_titanic_utils/__init__.py</span>  <span class="kw">|</span>  <span class="ex">6</span> ++++++</span>
<span id="cb12-11"><a href="#cb12-11"></a> <span class="ex">src/ie_titanic_utils/str_utils.py</span> <span class="kw">|</span>  <span class="ex">6</span> ++++++</span>
<span id="cb12-12"><a href="#cb12-12"></a> <span class="ex">3</span> files changed, 42 insertions<span class="er">(</span><span class="ex">+</span><span class="kw">)</span></span>
<span id="cb12-13"><a href="#cb12-13"></a> <span class="ex">create</span> mode 100644 pyproject.toml</span>
<span id="cb12-14"><a href="#cb12-14"></a> <span class="ex">create</span> mode 100644 src/ie_titanic_utils/__init__.py</span>
<span id="cb12-15"><a href="#cb12-15"></a> <span class="ex">create</span> mode 100644 src/ie_titanic_utils/str_utils.py</span>
<span id="cb12-16"><a href="#cb12-16"></a></span>
<span id="cb12-17"><a href="#cb12-17"></a><span class="fu">git</span> branch <span class="at">-d</span> first_module</span>
<span id="cb12-18"><a href="#cb12-18"></a><span class="co"># git push origin master</span></span>
<span id="cb12-19"><a href="#cb12-19"></a><span class="co"># as I will not upload this code to GitHub</span></span>
<span id="cb12-20"><a href="#cb12-20"></a><span class="co"># https://stackoverflow.com/questions/32238616/git-push-fatal-origin-does-not-appear-to-be-a-git-repository-fatal-could-n</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Now if I log the git, I will see this:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb13-1"><a href="#cb13-1"></a><span class="ex"></span> ie-titanic-utils  git log <span class="at">--graph</span> <span class="at">--oneline</span> <span class="at">--decorate</span> <span class="at">--all</span></span>
<span id="cb13-2"><a href="#cb13-2"></a><span class="ex">*</span>   39105c7 <span class="er">(</span><span class="ex">HEAD</span> <span class="at">-</span><span class="op">&gt;</span> master<span class="kw">)</span> <span class="ex">Merge</span> branch <span class="st">'first_module'</span></span>
<span id="cb13-3"><a href="#cb13-3"></a><span class="kw">|</span></span>
<span id="cb13-4"><a href="#cb13-4"></a><span class="kw">|</span> <span class="ex">*</span> 7a33844 initial very first module</span>
<span id="cb13-5"><a href="#cb13-5"></a><span class="kw">|</span><span class="ex">/</span></span>
<span id="cb13-6"><a href="#cb13-6"></a><span class="ex">*</span> 793bd67 initial commit</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Yeah til now I can create a “package” in my computer and install so I can use it <strong>globally</strong>. But I have not use any env management yet.</p>
</section>
<section id="intermezzo-version-numbers" class="level2">
<h2 class="anchored" data-anchor-id="intermezzo-version-numbers">intermezzo: version numbers</h2>
<ul>
<li>Version numbers for Python packages are explained in <a href="https://www.python.org/dev/peps/pep-0440/">PEP 440</a></li>
<li>For libraries, the most widely used convention is <a href="https://semver.org/">semantic versioning</a>: X.Y.Z
<ul>
<li>Z <strong>must</strong> be incremented if only backwards compatible bug fixes are introduced (a bug fix is defined as an internal change that fixes incorrect behavior)</li>
<li>Y <strong>must</strong> be incremented every time there is new, backwards-compatible functionality</li>
<li>X <strong>must</strong> be incremented every time there are backwards-incompatible changes</li>
</ul></li>
<li>Between releases, the version should have the <code>.dev0</code> suffix</li>
<li>Recommendation: start with 0.1.dev0 (development version), then make a <code>0.1.0</code> release, then progress to <code>0.1.1</code> for quick fixes and <code>0.2.0</code> for new functionality, and when you want to make a promise of relative stability jump to <code>1.0.0</code>.</li>
<li>For applications, other conventions are more appropriate, like <a href="https://calver.org/">calendar versioning</a>: <code>[YY]YY.MM.??</code></li>
</ul>
</section>
<section id="project-requirements" class="level2">
<h2 class="anchored" data-anchor-id="project-requirements">project requirements</h2>
<p>Sometimes our project will depend on third-party libraries (pandas, scikit-learn). To make pip install those dependencies automatically, we can add them to our <code>pyproject.toml</code> under the <code>[tool.flit.metadata]</code> section, using the <code>requires</code> option:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode numberSource md number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb14-1"><a href="#cb14-1"></a><span class="co">[</span><span class="ot">build-system</span><span class="co">]</span></span>
<span id="cb14-2"><a href="#cb14-2"></a>requires = <span class="co">[</span><span class="ot">"flit_core&gt;=3.4"</span><span class="co">]</span></span>
<span id="cb14-3"><a href="#cb14-3"></a>build-backend = "flit_core.buildapi"</span>
<span id="cb14-4"><a href="#cb14-4"></a></span>
<span id="cb14-5"><a href="#cb14-5"></a><span class="co">[</span><span class="ot">project</span><span class="co">]</span></span>
<span id="cb14-6"><a href="#cb14-6"></a>name = "ie_titanic_utils"</span>
<span id="cb14-7"><a href="#cb14-7"></a>authors = <span class="co">[</span><span class="ot">{name = "Tuan Le Khac", email = "tuan.lekhac0905@gmail.com"}</span><span class="co">]</span></span>
<span id="cb14-8"><a href="#cb14-8"></a>readme = "readme.md"</span>
<span id="cb14-9"><a href="#cb14-9"></a>requires-python = "&gt;=3.11"</span>
<span id="cb14-10"><a href="#cb14-10"></a>dynamic = <span class="co">[</span><span class="ot">"version", "description"</span><span class="co">]</span></span>
<span id="cb14-11"><a href="#cb14-11"></a>classifiers = [</span>
<span id="cb14-12"><a href="#cb14-12"></a>    "Programming Language :: Python :: 3",</span>
<span id="cb14-13"><a href="#cb14-13"></a>    "License :: OSI Approved :: MIT License",</span>
<span id="cb14-14"><a href="#cb14-14"></a>    "Operating System :: OS Independent",</span>
<span id="cb14-15"><a href="#cb14-15"></a>]</span>
<span id="cb14-16"><a href="#cb14-16"></a>requires = [</span>
<span id="cb14-17"><a href="#cb14-17"></a>    "pandas",</span>
<span id="cb14-18"><a href="#cb14-18"></a>    "matplotlib&gt;=2",</span>
<span id="cb14-19"><a href="#cb14-19"></a>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>We might want to specify <em>optional</em> dependencies that should only be installed upon request, or for some specific purposes. A typical example will be development dependencies: we will need things like <code>pytest</code> and <code>black</code>, but we don’t want the user to install them as part as our library. To do that, we can specify <em>groups</em> of optional dependencies under the <code>tool.flit.metadata.requires-extra</code> section:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode numberSource md number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb15-1"><a href="#cb15-1"></a>In my case, I use <span class="in">`project.optional-dependencies`</span>: flit_core.config.ConfigError: Use <span class="co">[</span><span class="ot">project</span><span class="co">]</span> table for metadata or <span class="co">[</span><span class="ot">tool.flit.metadata</span><span class="co">]</span>, not both.</span>
<span id="cb15-2"><a href="#cb15-2"></a><span class="co">[</span><span class="ot">project.optional-dependencies</span><span class="co">]</span></span>
<span id="cb15-3"><a href="#cb15-3"></a>dev = [</span>
<span id="cb15-4"><a href="#cb15-4"></a>    "pytest&gt;=6.0",</span>
<span id="cb15-5"><a href="#cb15-5"></a>    "black&gt;=20.8b1",</span>
<span id="cb15-6"><a href="#cb15-6"></a>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>That way, they will only get installed when <code>[dev]</code> is added after the name of our library:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb16-1"><a href="#cb16-1"></a><span class="ex"></span> ie-titanic-utils  pip install .<span class="pp">[</span><span class="ss">dev</span><span class="pp">]</span></span>
<span id="cb16-2"><a href="#cb16-2"></a><span class="co"># Successfully installed black-24.4.2 ie_titanic_utils-0.1.0 iniconfig-2.0.0 pytest-8.2.2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="unit-test" class="level1">
<h1>06 <a href="https://github.com/astrojuanlu/ie-mbd-advanced-python/blob/main/sessions/06_unit-tests.ipynb">unit test</a></h1>
<blockquote class="blockquote">
<p>If you use software that lacks automated tests, you are the tests.</p>
<p>— Jenny Bryan (<span class="citation" data-cites="JennyBryan">@JennyBryan</span>) <a href="https://x.com/JennyBryan/status/1043307291909316609?ref_src=twsrc%5Etfw">September 22, 2018</a></p>
</blockquote>
<p>Testing is <strong>essential</strong>. Computers excel at doing repetitive tasks: they basically never make mistakes (the mistake might be in what we told the computer to do). Humans, on the other hand, fail more often, especially under pressure, or on Friday afternoons and Monday mornings. Therefore, instead of letting the humans be the tests, we will use the computer to <strong>frequently verify that our software works as specified</strong>.</p>
<p>I will be using <code>pytest</code> to achieve this.</p>
<section id="test-driven-development" class="level2">
<h2 class="anchored" data-anchor-id="test-driven-development">test-driven development</h2>
<p>The “test-driven development mantra” is <span style="color:red;font-weight:bold;">Red</span> - <span style="color:green;font-weight:bold;">Green</span> - <span style="color:grey;font-weight:bold;">Refactor</span>:</p>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="1">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://raw.githubusercontent.com/astrojuanlu/ie-mbd-advanced-python/e2224276f91529280ebfcd42ddc7dc22cf0d2010/img/red-green-refactor.png" class="img-fluid figure-img"></p>
<figcaption>Make it work. Make it right. Make it fast.</figcaption>
</figure>
</div>
</div>
</div>
</div>
<ol type="1">
<li>Write a test. <span style="color:red;font-weight:bold;">Watch it fail</span>.</li>
<li>Write just enough code to <span style="color:green;font-weight:bold;">pass the test</span>.</li>
<li>Improve the code without breaking the test.</li>
</ol>
<p>Repeat.</p>
</section>
<section id="testing-in-python" class="level2">
<h2 class="anchored" data-anchor-id="testing-in-python">testing in Python</h2>
<p>Summary: use <code>pytest</code>. Everybody does. It rocks.</p>
<p><a href="https://docs.pytest.org/en/8.2.x/">pytest</a> is a testing framework for Python that makes writing tests extremely easy. It is much more powerful than the standard library equivalent, <code>unittest</code>. We can use by install it first <code>pip install pytest</code>.</p>
<p>We can write a function that test the <code>tokenize</code> funtion:</p>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>tests/test_tokenize.py</strong></pre>
</div>
<div class="sourceCode" id="cb17" data-filename="tests/test_tokenize.py"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1"></a><span class="im">from</span> ie_titanic_utils <span class="im">import</span> tokenize  <span class="co"># This will fail right away!</span></span>
<span id="cb17-2"><a href="#cb17-2"></a></span>
<span id="cb17-3"><a href="#cb17-3"></a></span>
<span id="cb17-4"><a href="#cb17-4"></a><span class="kw">def</span> test_tokenize_returns_expected_list():</span>
<span id="cb17-5"><a href="#cb17-5"></a>    sentence <span class="op">=</span> <span class="st">"This is a sentence"</span></span>
<span id="cb17-6"><a href="#cb17-6"></a>    expected_tokens <span class="op">=</span> [<span class="st">"This"</span>, <span class="st">"is"</span>, <span class="st">"a"</span>, <span class="st">"sentence"</span>]</span>
<span id="cb17-7"><a href="#cb17-7"></a></span>
<span id="cb17-8"><a href="#cb17-8"></a>    tokens <span class="op">=</span> tokenize(sentence)</span>
<span id="cb17-9"><a href="#cb17-9"></a></span>
<span id="cb17-10"><a href="#cb17-10"></a>    <span class="cf">assert</span> tokens <span class="op">==</span> expected_tokens</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>and we run it from the command line:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb18-1"><a href="#cb18-1"></a><span class="ex"></span> ie-titanic-utils  pytest</span>
<span id="cb18-2"><a href="#cb18-2"></a><span class="ex">============================================================================================</span> test session starts ============================================================================================</span>
<span id="cb18-3"><a href="#cb18-3"></a><span class="ex">platform</span> win32 <span class="at">--</span> Python 3.11.4, pytest-8.2.2, pluggy-1.5.0</span>
<span id="cb18-4"><a href="#cb18-4"></a><span class="ex">rootdir:</span> .ie-titanic-utils</span>
<span id="cb18-5"><a href="#cb18-5"></a><span class="ex">configfile:</span> pyproject.toml</span>
<span id="cb18-6"><a href="#cb18-6"></a><span class="ex">plugins:</span> anyio-3.7.1, time-machine-2.14.0</span>
<span id="cb18-7"><a href="#cb18-7"></a><span class="ex">collected</span> 1 item</span>
<span id="cb18-8"><a href="#cb18-8"></a></span>
<span id="cb18-9"><a href="#cb18-9"></a><span class="ex">teststest_tokenize.py</span> .                                                                                                                                                                               <span class="pp">[</span><span class="ss">100%</span><span class="pp">]</span> </span>
<span id="cb18-10"><a href="#cb18-10"></a></span>
<span id="cb18-11"><a href="#cb18-11"></a><span class="ex">=============================================================================================</span> 1 passed in 0.02s ============================================================================================= </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The test successed after I fixed the <code>__init__.py</code>:</p>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>src/./__init__.py</strong></pre>
</div>
<div class="sourceCode" id="cb19" data-filename="src/./__init__.py"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1"></a><span class="im">from</span> ie_titanic_utils.str_utils <span class="im">import</span> tokenize</span>
<span id="cb19-2"><a href="#cb19-2"></a>__all__ <span class="op">=</span> [<span class="st">"tokenize"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="oop" class="level1 page-columns page-full">
<h1>07&amp;08 <a href="https://github.com/astrojuanlu/ie-mbd-advanced-python/blob/main/sessions/07-08_object-oriented-programming.ipynb">oop</a></h1>
<section id="what-are-objects-anyway" class="level2">
<h2 class="anchored" data-anchor-id="what-are-objects-anyway">what are “objects” anyway?</h2>
<p>like pandas’s <code>DataFrame</code> or matplotlib’s <code>Figure</code>, an <em>object</em> is sthg that has:</p>
<ul>
<li>object-bound variables: call <strong>properties</strong>;</li>
<li>object-bound functions: call <strong>methods</strong>.</li>
</ul>
<p>if the object’s properties can change, we say they have <strong>states</strong>, in that case they are <strong>mutable</strong>. otherwise, they are <strong>stateless</strong> and <strong>immutable</strong>. a typical example is list (mutable) and tuple (immutable).</p>
<div id="420bf50e" class="cell" data-execution_count="3">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1"></a>my_list <span class="op">=</span> [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>]</span>
<span id="cb20-2"><a href="#cb20-2"></a><span class="bu">print</span>(my_list)</span>
<span id="cb20-3"><a href="#cb20-3"></a>my_list.append(<span class="dv">4</span>)</span>
<span id="cb20-4"><a href="#cb20-4"></a><span class="bu">print</span>(my_list)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1, 2, 3]
[1, 2, 3, 4]</code></pre>
</div>
</div>
<div id="3893a277" class="cell" data-execution_count="4">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1"></a><span class="co"># The operator that creates tuples is not parentheses:</span></span>
<span id="cb22-2"><a href="#cb22-2"></a><span class="co"># is the comma!</span></span>
<span id="cb22-3"><a href="#cb22-3"></a>my_tuple <span class="op">=</span> <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>  <span class="co"># Notice that I don't need parentheses!</span></span>
<span id="cb22-4"><a href="#cb22-4"></a>my_tuple</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="2">
<pre><code>(1, 2, 3)</code></pre>
</div>
</div>
<div id="62ffbdb1" class="cell" data-execution_count="5">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1"></a><span class="bu">print</span>(<span class="bu">dir</span>(my_tuple))  <span class="co"># Nothing that allows us to change the state of the tuple</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>['__add__', '__class__', '__class_getitem__', '__contains__', '__delattr__', '__dir__', '__doc__', '__eq__', '__format__', '__ge__', '__getattribute__', '__getitem__', '__getnewargs__', '__getstate__', '__gt__', '__hash__', '__init__', '__init_subclass__', '__iter__', '__le__', '__len__', '__lt__', '__mul__', '__ne__', '__new__', '__reduce__', '__reduce_ex__', '__repr__', '__rmul__', '__setattr__', '__sizeof__', '__str__', '__subclasshook__', 'count', 'index']</code></pre>
</div>
</div>
<div id="38108e09" class="cell" data-execution_count="6">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1"></a>my_tuple[<span class="dv">0</span>] <span class="op">=</span> <span class="dv">99</span> <span class="co"># This wont work, "TypeError: 'tuple' object does not support item assignment"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Immutable objects have the advantage that they can be <strong>hashed</strong>, that is: they can be transformed, using some cryptographical function, into something that uniquely represents that object. Mutable objects can’t, because the hash would have to change every time the state of the object changed. <strong>Dictionary keys have to be hashable objects</strong>.</p>
</div>
</div>
<div id="12fa6316" class="cell" data-execution_count="7">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1"></a>{</span>
<span id="cb27-2"><a href="#cb27-2"></a>    my_tuple: <span class="st">"my_tuple"</span></span>
<span id="cb27-3"><a href="#cb27-3"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="4">
<pre><code>{(1, 2, 3): 'my_tuple'}</code></pre>
</div>
</div>
<div id="249e2363" class="cell" data-execution_count="8">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1"></a><span class="bu">hash</span>(my_tuple)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="5">
<pre><code>529344067295497451</code></pre>
</div>
</div>
<div id="5ef6beee" class="cell" data-execution_count="9">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1"></a><span class="co"># this wont work: "TypeError: unhashable type: 'list'"</span></span>
<span id="cb31-2"><a href="#cb31-2"></a>{</span>
<span id="cb31-3"><a href="#cb31-3"></a>    my_list: <span class="st">"my_list"</span></span>
<span id="cb31-4"><a href="#cb31-4"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="0096641b" class="cell" data-execution_count="10">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1"></a><span class="co"># this wont work: "TypeError: unhashable type: 'list'"</span></span>
<span id="cb32-2"><a href="#cb32-2"></a><span class="bu">hash</span>(my_list)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="classes-and-instances" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="classes-and-instances">classes and instances</h2>
<p>objects are defined by <strong>instantiating a class</strong>. a class is a <strong>template</strong> for objects, where we define it’s behaviours, an <strong>instance</strong> is a particular realization of that class.</p>
<section id="example" class="level3">
<h3 class="anchored" data-anchor-id="example">Example</h3>
<p>we want model the <code>User</code> of our company’s product, to later study their behaviours:</p>
<div id="4d14860f" class="cell" data-execution_count="11">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1"></a><span class="kw">class</span> User:</span>
<span id="cb33-2"><a href="#cb33-2"></a>    <span class="cf">pass</span></span>
<span id="cb33-3"><a href="#cb33-3"></a><span class="bu">type</span>(User)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="6">
<pre><code>type</code></pre>
</div>
</div>
<p><code>User</code> class is of type <code>type</code>, which means that is can be used to created new objects. Let’s create 2 instances:</p>
<div id="30996245" class="cell" data-execution_count="12">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1"></a>user1 <span class="op">=</span> User()</span>
<span id="cb35-2"><a href="#cb35-2"></a>user2 <span class="op">=</span> User()</span>
<span id="cb35-3"><a href="#cb35-3"></a><span class="bu">print</span>(user1)</span>
<span id="cb35-4"><a href="#cb35-4"></a><span class="bu">print</span>(user2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;__main__.User object at 0x000001B1AD8D4F90&gt;
&lt;__main__.User object at 0x000001B1AD8D4D90&gt;</code></pre>
</div>
</div>
<p>with a slight abuse of notation, we would say we have 2 <code>User</code> objects, or just 2 <code>User</code>s.</p>
</section>
<section id="using-the-instance-self" class="level3">
<h3 class="anchored" data-anchor-id="using-the-instance-self">Using the instance: <code>self</code></h3>
<p>let’s add a very simple <strong>method</strong> to demonstrate <em>explicit</em> <code>self</code>, a very important concept. a method is like a function bounded to the object, an can use it’s properties:</p>
<div id="ba8a0d18" class="cell" data-execution_count="13">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1"></a><span class="kw">class</span> User:</span>
<span id="cb37-2"><a href="#cb37-2"></a>    <span class="kw">def</span> whoami(<span class="va">self</span>):</span>
<span id="cb37-3"><a href="#cb37-3"></a>        <span class="bu">print</span>(<span class="ss">f'This is : </span><span class="sc">{</span><span class="va">self</span><span class="sc">}</span><span class="ss">'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="2441e1cb" class="cell" data-execution_count="14">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1"></a>user1 <span class="op">=</span> User()</span>
<span id="cb38-2"><a href="#cb38-2"></a>user1.whoami()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>This is : &lt;__main__.User object at 0x000001B1AD8D4590&gt;</code></pre>
</div>
</div>
<p>why are methods (instead of plain functions) interesting? Because of <strong>duck typing</strong>:</p>
<blockquote class="blockquote">
<p>“If it walks like a duck and it quacks like a duck, then it must be a duck” – <a href="https://en.wikipedia.org/wiki/Duck_typing" class="uri">https://en.wikipedia.org/wiki/Duck_typing</a></p>
</blockquote>
<p>if something has a method that I need, I don’t care about its type.</p>
<div id="5032dcea" class="cell" data-execution_count="15">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1"></a><span class="kw">def</span> do_stuff(obj):</span>
<span id="cb40-2"><a href="#cb40-2"></a>    <span class="cf">return</span> obj.mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="e0da8b5a" class="cell" data-execution_count="16">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb41-2"><a href="#cb41-2"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb41-3"><a href="#cb41-3"></a></span>
<span id="cb41-4"><a href="#cb41-4"></a><span class="bu">print</span>(do_stuff(np.arange(<span class="dv">5</span>)))</span>
<span id="cb41-5"><a href="#cb41-5"></a><span class="bu">print</span>(do_stuff(pd.Series([<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>])))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>2.0
2.0</code></pre>
</div>
</div>
<p>notice how we called <code>user1.test()</code> <strong>without passing an extra argument</strong>? This is because Python is automatically passing the instance. It’s the equivalent of doing this (<strong>never do this</strong>):</p>
<div id="8b163d53" class="cell" data-execution_count="17">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1"></a>User.whoami(user1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>This is : &lt;__main__.User object at 0x000001B1AD8D4590&gt;</code></pre>
</div>
</div>
<p>in fact, if we define a method without a first parameter, it will fail when we call it:</p>
<div id="5bf4beeb" class="cell" data-execution_count="18">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1"></a><span class="kw">class</span> TestClass:</span>
<span id="cb45-2"><a href="#cb45-2"></a>    <span class="kw">def</span> test():</span>
<span id="cb45-3"><a href="#cb45-3"></a>        <span class="cf">pass</span>  <span class="co"># Don't do anything</span></span>
<span id="cb45-4"><a href="#cb45-4"></a></span>
<span id="cb45-5"><a href="#cb45-5"></a>t <span class="op">=</span> TestClass()</span>
<span id="cb45-6"><a href="#cb45-6"></a>t.test()  <span class="co"># Fails: "TypeError: test() takes 0 positional arguments but 1 was given"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>this first parameter can be called anything, but <strong>everybody uses <code>self</code></strong>. Remember, conventions are important to minimize surprise and enhance collaboration!</p>
</section>
<section id="intermezzo-f-strings" class="level3">
<h3 class="anchored" data-anchor-id="intermezzo-f-strings">intermezzo: f-strings</h3>
<div id="669cec83" class="cell" data-execution_count="19">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1"></a><span class="bu">print</span>(<span class="ss">f"This is </span><span class="sc">{</span>user1<span class="sc">}</span><span class="ss">"</span>)  <span class="co"># Python &gt;= 3.6</span></span>
<span id="cb46-2"><a href="#cb46-2"></a><span class="bu">print</span>(<span class="st">"This is </span><span class="sc">{}</span><span class="st">"</span>.<span class="bu">format</span>(user1))  <span class="co"># Python &lt; 3.6, equivalent</span></span>
<span id="cb46-3"><a href="#cb46-3"></a><span class="bu">print</span>(User.whoami(user1))  <span class="co"># DON'T use! (Although it's equivalent)   </span></span>
<span id="cb46-4"><a href="#cb46-4"></a><span class="co"># %timeit User.whoami(user1)  # They have about the same performance </span></span>
<span id="cb46-5"><a href="#cb46-5"></a><span class="co"># %timeit user1.whoami()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>This is &lt;__main__.User object at 0x000001B1AD8D4590&gt;
This is &lt;__main__.User object at 0x000001B1AD8D4590&gt;
This is : &lt;__main__.User object at 0x000001B1AD8D4590&gt;
None</code></pre>
</div>
</div>
</section>
<section id="initializing-our-instances" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="initializing-our-instances">initializing our instances</h3>
<p>The ellipsis (<code>...</code>) is a built-in constant in Python. It’s an instance of the <code>ellipsis</code> (dấu chấm lửng) class.</p>
<div id="dd7c9d48" class="cell" data-execution_count="20">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1"></a>...</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="14">
<pre><code>Ellipsis</code></pre>
</div>
</div>
<p>common uses of ellipsis:</p>
<ul>
<li>as a placeholder in function definitions or class bodies</li>
<li>in type hinting (especially for variable-length tuples)</li>
<li>in slicing operations (especially for multidimensional arrays in libraries like NumPy)</li>
</ul>
<div id="9042a8b1" class="cell" data-execution_count="21">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1"></a><span class="co"># As a placeholder</span></span>
<span id="cb50-2"><a href="#cb50-2"></a><span class="kw">def</span> function_to_be_implemented_later():</span>
<span id="cb50-3"><a href="#cb50-3"></a>    ...</span>
<span id="cb50-4"><a href="#cb50-4"></a></span>
<span id="cb50-5"><a href="#cb50-5"></a><span class="co"># In type hinting</span></span>
<span id="cb50-6"><a href="#cb50-6"></a><span class="im">from</span> typing <span class="im">import</span> Tuple</span>
<span id="cb50-7"><a href="#cb50-7"></a></span>
<span id="cb50-8"><a href="#cb50-8"></a><span class="kw">def</span> process_points(<span class="op">*</span>points: Tuple[<span class="bu">int</span>, ...]) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb50-9"><a href="#cb50-9"></a>    <span class="cf">for</span> point <span class="kw">in</span> points:</span>
<span id="cb50-10"><a href="#cb50-10"></a>        <span class="bu">print</span>(<span class="ss">f"Processing point: </span><span class="sc">{</span>point<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb50-11"><a href="#cb50-11"></a></span>
<span id="cb50-12"><a href="#cb50-12"></a><span class="co"># Usage</span></span>
<span id="cb50-13"><a href="#cb50-13"></a>process_points((<span class="dv">1</span>, <span class="dv">2</span>), (<span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>), (<span class="dv">6</span>,))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Processing point: (1, 2)
Processing point: (3, 4, 5)
Processing point: (6,)</code></pre>
</div>
</div>
<div id="82041adf" class="cell" data-execution_count="22">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1"></a>user1.this_property <span class="op">=</span> ...  <span class="co"># "99", whatever</span></span>
<span id="cb52-2"><a href="#cb52-2"></a>user1.this_property</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="16">
<pre><code>Ellipsis</code></pre>
</div>
</div>
<p>however, this is considered a bad practice, and can confuse editors and static analysis tools. These properties should be specified on creation, in a way that I cannot have a user without <code>name</code> and <code>signup_date</code>. Python provides us a special method, <code>__init__</code> (this should not be confused with file <code>__init__.py</code> we put to project to tell Python our code is a package), that <strong>initializes</strong><a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> the object:</p>
<div class="no-row-height column-margin column-container"><div id="fn1"><p><sup>1</sup>&nbsp;This philosophy used to be summarized by the sentence “we are all consenting adults here”, which is nowadays being less used.</p></div></div><div id="ab86dd9f" class="cell" data-execution_count="23">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1"></a><span class="kw">class</span> User:</span>
<span id="cb54-2"><a href="#cb54-2"></a>    <span class="co"># "dunder init" = double underscore init</span></span>
<span id="cb54-3"><a href="#cb54-3"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, name, signup_date):</span>
<span id="cb54-4"><a href="#cb54-4"></a>        <span class="va">self</span>.name <span class="op">=</span> name</span>
<span id="cb54-5"><a href="#cb54-5"></a>        <span class="va">self</span>.signup_date <span class="op">=</span> signup_date</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="9423fb8d" class="cell" data-execution_count="24">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1"></a><span class="im">import</span> datetime <span class="im">as</span> dt</span>
<span id="cb55-2"><a href="#cb55-2"></a>user1 <span class="op">=</span> User(name<span class="op">=</span><span class="st">"John Doe"</span>, signup_date<span class="op">=</span>dt.datetime.now())</span>
<span id="cb55-3"><a href="#cb55-3"></a><span class="bu">print</span>(user1.name, user1.signup_date, sep<span class="op">=</span><span class="st">'</span><span class="ch">\n</span><span class="st">'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>John Doe
2024-08-01 23:07:08.587740</code></pre>
</div>
</div>
<p>that’s something! However, there are several things we can improve:</p>
<ul>
<li>it can be cumbersome to specify the date every time, and it would be nice to have some default.</li>
<li>the default representation of the instances contains some hexadecimal memory address and nothing else. It would be nice to at least see the user name and the signup date</li>
<li>nothing stops me from changing the name and signup_date of a existing user:</li>
</ul>
</section>
<section id="exercise" class="level3">
<h3 class="anchored" data-anchor-id="exercise">exercise</h3>
<ul>
<li>make <code>signup_date</code> optional by providing a default value;</li>
<li>make the <code>__repr__</code> method return a string containing the <code>name</code> and <code>signup_date</code>, which will override the default.</li>
</ul>
<div id="fd72f5b4" class="cell" data-execution_count="25">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1"></a><span class="kw">class</span> User:</span>
<span id="cb57-2"><a href="#cb57-2"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, name, signup_date<span class="op">=</span><span class="va">None</span>):</span>
<span id="cb57-3"><a href="#cb57-3"></a>        <span class="cf">if</span> signup_date <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb57-4"><a href="#cb57-4"></a>            signup_date <span class="op">=</span> dt.datetime.now() <span class="co"># Watch out with default parameters! They are created when the function is defined.</span></span>
<span id="cb57-5"><a href="#cb57-5"></a></span>
<span id="cb57-6"><a href="#cb57-6"></a>        <span class="va">self</span>.name <span class="op">=</span> name</span>
<span id="cb57-7"><a href="#cb57-7"></a>        <span class="va">self</span>.signup_date <span class="op">=</span> signup_date</span>
<span id="cb57-8"><a href="#cb57-8"></a></span>
<span id="cb57-9"><a href="#cb57-9"></a>    <span class="kw">def</span> <span class="fu">__repr__</span>(<span class="va">self</span>):</span>
<span id="cb57-10"><a href="#cb57-10"></a>        <span class="cf">return</span> <span class="ss">f"User(name='</span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>name<span class="sc">}</span><span class="ss">', signup_date=</span><span class="sc">{</span><span class="bu">repr</span>(<span class="va">self</span>.signup_date)<span class="sc">}</span><span class="ss">)"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="bd10d931" class="cell" data-execution_count="26">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1"></a>user1 <span class="op">=</span> User(<span class="st">"John Doe"</span>)</span>
<span id="cb58-2"><a href="#cb58-2"></a>user1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="20">
<pre><code>User(name='John Doe', signup_date=datetime.datetime(2024, 8, 1, 23, 7, 8, 618751))</code></pre>
</div>
</div>
</section>
<section id="extra-date-formatting" class="level3">
<h3 class="anchored" data-anchor-id="extra-date-formatting">extra: date formatting</h3>
<div id="fc4b84ad" class="cell" data-execution_count="27">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1"></a>dt.datetime.now().isoformat()  <span class="co"># ISO 8601</span></span>
<span id="cb60-2"><a href="#cb60-2"></a><span class="co"># If you don't like it, there's http://strftime.org/</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="21">
<pre><code>'2024-08-01T23:07:08.625045'</code></pre>
</div>
</div>
<div id="b23b8c74" class="cell" data-execution_count="28">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1"></a>user1.signup_date.strftime(<span class="st">"%Y ::: </span><span class="sc">%d</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="22">
<pre><code>'2024 ::: 01'</code></pre>
</div>
</div>
</section>
<section id="protecting-properties" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="protecting-properties">protecting properties</h3>
<p>in Python, there are <em>no private attributes</em> (neither properties nor methods), and in fact everything can be accessed <a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>. However, we can “hide” them by default in autocomplete and other environments by using a leading underscore <code>_</code>: this is usually called <strong>protected variables</strong>.</p>
<div class="no-row-height column-margin column-container"><div id="fn2"><p><sup>2</sup>&nbsp;This philosophy used to be summarized by the sentence “we are all consenting adults here”, which is nowadays being less used.</p></div></div><p>there is a common pattern in which, if I want to make some property read-only, we can:</p>
<ul>
<li>make it protected</li>
<li>create a “getter” using the <span class="citation" data-cites="property">@property</span> decorator, which gets the value of the protected property with a public name</li>
</ul>
<div id="b008d693" class="cell" data-execution_count="29">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1"></a><span class="kw">class</span> User:</span>
<span id="cb64-2"><a href="#cb64-2"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, name, signup_date<span class="op">=</span><span class="va">None</span>):</span>
<span id="cb64-3"><a href="#cb64-3"></a>        <span class="cf">if</span> signup_date <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb64-4"><a href="#cb64-4"></a>            signup_date <span class="op">=</span> dt.datetime.now()</span>
<span id="cb64-5"><a href="#cb64-5"></a></span>
<span id="cb64-6"><a href="#cb64-6"></a>        <span class="va">self</span>._name <span class="op">=</span> name</span>
<span id="cb64-7"><a href="#cb64-7"></a>        <span class="va">self</span>._signup_date <span class="op">=</span> signup_date</span>
<span id="cb64-8"><a href="#cb64-8"></a></span>
<span id="cb64-9"><a href="#cb64-9"></a>    <span class="at">@property</span></span>
<span id="cb64-10"><a href="#cb64-10"></a>    <span class="kw">def</span> name(<span class="va">self</span>):</span>
<span id="cb64-11"><a href="#cb64-11"></a>        <span class="cf">return</span> <span class="va">self</span>._name</span>
<span id="cb64-12"><a href="#cb64-12"></a></span>
<span id="cb64-13"><a href="#cb64-13"></a>    <span class="at">@property</span></span>
<span id="cb64-14"><a href="#cb64-14"></a>    <span class="kw">def</span> signup_date(<span class="va">self</span>):</span>
<span id="cb64-15"><a href="#cb64-15"></a>        <span class="cf">return</span> <span class="va">self</span>._signup_date</span>
<span id="cb64-16"><a href="#cb64-16"></a></span>
<span id="cb64-17"><a href="#cb64-17"></a>    <span class="kw">def</span> <span class="fu">__repr__</span>(<span class="va">self</span>):</span>
<span id="cb64-18"><a href="#cb64-18"></a>        <span class="cf">return</span> <span class="ss">f"User(name='</span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>name<span class="sc">}</span><span class="ss">', signup_date='</span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>signup_date<span class="sc">}</span><span class="ss">')"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="e9a3b5f8" class="cell" data-execution_count="30">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1"></a>user1 <span class="op">=</span> User(<span class="st">"Tuan Le"</span>)</span>
<span id="cb65-2"><a href="#cb65-2"></a>user1.name</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="24">
<pre><code>'Tuan Le'</code></pre>
</div>
</div>
<div id="9fb2282d" class="cell" data-execution_count="31">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1"></a><span class="co"># this wont work: "AttributeError: can't set attribute"</span></span>
<span id="cb67-2"><a href="#cb67-2"></a>user1.name <span class="op">=</span> <span class="st">"Tan Le"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>If you see tutorials mentioning “true private variables”, they are wrong!</p>
</div>
</div>
<div id="88ed0501" class="cell" data-execution_count="32">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1"></a><span class="kw">class</span> Test:</span>
<span id="cb68-2"><a href="#cb68-2"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, name):</span>
<span id="cb68-3"><a href="#cb68-3"></a>        <span class="va">self</span>.__name <span class="op">=</span> name  <span class="co"># Not what you think!</span></span>
<span id="cb68-4"><a href="#cb68-4"></a>t1 <span class="op">=</span> Test(<span class="st">"This name"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="e79d62f4" class="cell" data-execution_count="33">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1"></a><span class="co"># this wont work</span></span>
<span id="cb69-2"><a href="#cb69-2"></a>t1.__name</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="ed82f250" class="cell" data-execution_count="34">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1"></a>t1._Test__name  <span class="co"># These are *NOT* "private" properties</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="26">
<pre><code>'This name'</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The behavior you’re experiencing is due to a feature in Python called “name mangling” for private attributes. Let’s break down what’s happening:</p>
<p>Double underscore prefix:</p>
<ul>
<li>When you define an attribute with a double underscore prefix (__) in a class, Python automatically mangles the name to avoid naming conflicts in inherited classes.</li>
<li>Name mangling process: Python changes the name from __name to _ClassName__name. In your case, it becomes _Test__name.</li>
<li>Accessing the attribute: Because of this name mangling, you can’t access t1.__name directly. Instead, you would need to use the mangled name.</li>
</ul>
<div id="950c80df" class="cell" data-execution_count="35">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1"></a><span class="kw">class</span> Test:</span>
<span id="cb72-2"><a href="#cb72-2"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, name):</span>
<span id="cb72-3"><a href="#cb72-3"></a>        <span class="va">self</span>.__name <span class="op">=</span> name  <span class="co"># This gets mangled</span></span>
<span id="cb72-4"><a href="#cb72-4"></a></span>
<span id="cb72-5"><a href="#cb72-5"></a>t1 <span class="op">=</span> Test(<span class="st">"This name"</span>)</span>
<span id="cb72-6"><a href="#cb72-6"></a></span>
<span id="cb72-7"><a href="#cb72-7"></a><span class="co"># This will raise an AttributeError</span></span>
<span id="cb72-8"><a href="#cb72-8"></a><span class="cf">try</span>:</span>
<span id="cb72-9"><a href="#cb72-9"></a>    <span class="bu">print</span>(t1.__name)</span>
<span id="cb72-10"><a href="#cb72-10"></a><span class="cf">except</span> <span class="pp">AttributeError</span> <span class="im">as</span> e:</span>
<span id="cb72-11"><a href="#cb72-11"></a>    <span class="bu">print</span>(<span class="ss">f"AttributeError: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb72-12"><a href="#cb72-12"></a></span>
<span id="cb72-13"><a href="#cb72-13"></a><span class="co"># This will work</span></span>
<span id="cb72-14"><a href="#cb72-14"></a><span class="bu">print</span>(t1._Test__name)</span>
<span id="cb72-15"><a href="#cb72-15"></a></span>
<span id="cb72-16"><a href="#cb72-16"></a><span class="co"># You can see all attributes, including mangled ones</span></span>
<span id="cb72-17"><a href="#cb72-17"></a><span class="bu">print</span>(<span class="bu">dir</span>(t1))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>AttributeError: 'Test' object has no attribute '__name'
This name
['_Test__name', '__class__', '__delattr__', '__dict__', '__dir__', '__doc__', '__eq__', '__format__', '__ge__', '__getattribute__', '__getstate__', '__gt__', '__hash__', '__init__', '__init_subclass__', '__le__', '__lt__', '__module__', '__ne__', '__new__', '__reduce__', '__reduce_ex__', '__repr__', '__setattr__', '__sizeof__', '__str__', '__subclasshook__', '__weakref__']</code></pre>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="inheritance" class="level2">
<h2 class="anchored" data-anchor-id="inheritance">inheritance</h2>
<div id="d54bc550" class="cell" data-execution_count="36">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1"></a><span class="kw">class</span> SpecialUser(User):</span>
<span id="cb74-2"><a href="#cb74-2"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, name, age, signup_date<span class="op">=</span><span class="va">None</span>):</span>
<span id="cb74-3"><a href="#cb74-3"></a>        <span class="co"># Initializes self._name and self._signup_date</span></span>
<span id="cb74-4"><a href="#cb74-4"></a>        <span class="bu">super</span>().<span class="fu">__init__</span>(name, signup_date)</span>
<span id="cb74-5"><a href="#cb74-5"></a></span>
<span id="cb74-6"><a href="#cb74-6"></a>        <span class="va">self</span>._age <span class="op">=</span> age</span>
<span id="cb74-7"><a href="#cb74-7"></a></span>
<span id="cb74-8"><a href="#cb74-8"></a>    <span class="at">@property</span></span>
<span id="cb74-9"><a href="#cb74-9"></a>    <span class="kw">def</span> age(<span class="va">self</span>):</span>
<span id="cb74-10"><a href="#cb74-10"></a>        <span class="cf">return</span> <span class="va">self</span>._age</span>
<span id="cb74-11"><a href="#cb74-11"></a></span>
<span id="cb74-12"><a href="#cb74-12"></a>    <span class="kw">def</span> greet(<span class="va">self</span>):</span>
<span id="cb74-13"><a href="#cb74-13"></a>        <span class="bu">print</span>(<span class="ss">f"Hi! I'm </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>name<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="dd17b672" class="cell" data-execution_count="37">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1"></a>s_user1 <span class="op">=</span> SpecialUser(<span class="st">"John Doe"</span>, <span class="dv">27</span>)</span>
<span id="cb75-2"><a href="#cb75-2"></a><span class="co">#s_user1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="bb9e12fb" class="cell" data-execution_count="38">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1"></a>s_user1.name</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="30">
<pre><code>'John Doe'</code></pre>
</div>
</div>
<div id="7742acf4" class="cell" data-execution_count="39">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb78-1"><a href="#cb78-1"></a>s_user1.greet()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Hi! I'm John Doe</code></pre>
</div>
</div>
<ul>
<li>the diamond problem: <a href="https://www.wikiwand.com/en/Multiple_inheritance#/The_diamond_problem" class="uri">https://www.wikiwand.com/en/Multiple_inheritance#/The_diamond_problem</a></li>
<li>???: <a href="https://softwareengineering.stackexchange.com/questions/238176/why-would-square-inheriting-from-rectangle-be-problematic-if-we-override-the-set/238184#238184" class="uri">https://softwareengineering.stackexchange.com/questions/238176/why-would-square-inheriting-from-rectangle-be-problematic-if-we-override-the-set/238184#238184</a></li>
<li>liskov substitution principle: <a href="https://www.wikiwand.com/en/Liskov_substitution_principle" class="uri">https://www.wikiwand.com/en/Liskov_substitution_principle</a></li>
<li>composition and inheritance: <a href="https://www.thedigitalcatonline.com/blog/2014/08/20/python-3-oop-part-3-delegation-composition-and-inheritance/" class="uri">https://www.thedigitalcatonline.com/blog/2014/08/20/python-3-oop-part-3-delegation-composition-and-inheritance/</a></li>
</ul>
<section id="more-special-methods" class="level3">
<h3 class="anchored" data-anchor-id="more-special-methods">more special methods</h3>
<p>go search for python data model</p>
</section>
</section>
</section>
<section id="flask" class="level1">
<h1>09&amp;10 <a href="https://github.com/astrojuanlu/ie-mbd-advanced-python/blob/main/sessions/09-10_flask.ipynb">flask</a></h1>
<ul>
<li>flask is a “lightweight framework” or a “microframework”. “It is designed to make getting started quick and easy, with the ability to scale up to complex applications”, and therefore requires less context to get started with;</li>
<li>django is a “batteries included” framework that is more focused on good practices and encouraging a “clean, pragmatic design”. It’s more complex and requires more experience to master.</li>
</ul>
</section>
<section id="conclusion" class="level1">
<h1><a href="https://github.com/astrojuanlu/ie-mbd-advanced-python/blob/main/sessions/99_conclusion.ipynb">conclusion</a></h1>
<section id="where-do-we-go-from-here" class="level2">
<h2 class="anchored" data-anchor-id="where-do-we-go-from-here">where do we go from here</h2>
<ul>
<li>Keep improving the art of Python packaging</li>
<li>Explore other options for high performance Python</li>
<li>Help “bridging the gap”</li>
<li>Engage with the (open source) Python community</li>
</ul>
</section>
<section id="keep-improving-the-art-of-python-packaging" class="level2">
<h2 class="anchored" data-anchor-id="keep-improving-the-art-of-python-packaging">keep improving the art of python packaging</h2>
<ul>
<li>recommend: <code>pip-tools</code> + <code>requirements.in</code> = <code>requirements.txt</code></li>
<li>Poetry, Pipenv… Yes, they work, but they are way more complex and have “lock-in”</li>
<li>All companies I worked for struggle sooner or later with their code deployment practices. Now, you know better</li>
</ul>
</section>
<section id="explore-other-options-for-high-performance-python" class="level2">
<h2 class="anchored" data-anchor-id="explore-other-options-for-high-performance-python">explore other options for high performance python</h2>
<ul>
<li>Juan mentioned: Numba, Modin, Vaex, Dask, Spark, Coiled, Prefect</li>
<li>Now we have more: polar, pandas 2.0, aiflow, dagster, dbt, etc</li>
</ul>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="1">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="setup_py_br.png" class="img-fluid figure-img"></p>
<figcaption>stolen from the lecture</figcaption>
</figure>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="other-resources" class="level1">
<h1>other resources</h1>
<ol type="1">
<li><a href="https://nbviewer.org/github/astrojuanlu/ie-mbd-advanced-python/tree/main/">NBViewer</a> for this lecture;</li>
<li><a href="https://pydata.org/">PyData</a>, a community for developers and users of open source data tools;</li>
<li><a href="https://git-scm.com/book/en/v2/">Pro Git</a>, <code>--distributed-is-the-new-centralized</code>;</li>
<li><a href="https://docs.github.com/en/pull-requests/collaborating-with-pull-requests/proposing-changes-to-your-work-with-pull-requests/about-pull-requests">Pull Requests</a>;</li>
<li><a href="https://docs.gitlab.com/ee/user/project/merge_requests/index.html">Merge Requests</a>;</li>
<li><a href="https://www.asmeurer.com/git-workflow/">Git Workflow</a>, the git workflow for contributing to open source repositories;</li>
<li><a href="https://www.toptal.com/developers/gitignore">Git Ignore</a> builder;</li>
<li><a href="https://www.atlassian.com/git/tutorials/rewriting-history">Git commit –amend</a>, rewriting history;</li>
<li><a href="https://packaging.python.org/en/latest/tutorials/packaging-projects/">The right way to distribute Python code</a></li>
<li><a href="https://docs.python.org/3/tutorial/modules.html#packages">Python packaging</a></li>
<li><a href="https://docs.pytest.org/en/8.2.x/">Pytest</a>.</li>
</ol>


<!-- -->

</section>


</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/lktuan\.github\.io\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      const annoteTargets = window.document.querySelectorAll('.code-annotation-anchor');
      for (let i=0; i<annoteTargets.length; i++) {
        const annoteTarget = annoteTargets[i];
        const targetCell = annoteTarget.getAttribute("data-target-cell");
        const targetAnnotation = annoteTarget.getAttribute("data-target-annotation");
        const contentFn = () => {
          const content = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          if (content) {
            const tipContent = content.cloneNode(true);
            tipContent.classList.add("code-annotation-tip-content");
            return tipContent.outerHTML;
          }
        }
        const config = {
          allowHTML: true,
          content: contentFn,
          onShow: (instance) => {
            selectCodeLines(instance.reference);
            instance.reference.classList.add('code-annotation-active');
            window.tippy.hideAll();
          },
          onHide: (instance) => {
            unselectCodeLines();
            instance.reference.classList.remove('code-annotation-active');
          },
          maxWidth: 300,
          delay: [50, 0],
          duration: [200, 0],
          offset: [5, 10],
          arrow: true,
          appendTo: function(el) {
            return el.parentElement.parentElement.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'quarto',
          placement: 'right',
          popperOptions: {
            modifiers: [
            {
              name: 'flip',
              options: {
                flipVariations: false, // true by default
                allowedAutoPlacements: ['right'],
                fallbackPlacements: ['right', 'top', 'top-start', 'top-end', 'bottom', 'bottom-start', 'bottom-end', 'left'],
              },
            },
            {
              name: 'preventOverflow',
              options: {
                mainAxis: false,
                altAxis: false
              }
            }
            ]        
          }      
        };
        window.tippy(annoteTarget, config); 
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb80" data-shortcodes="false"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb80-1"><a href="#cb80-1"></a><span class="co">---</span></span>
<span id="cb80-2"><a href="#cb80-2"></a><span class="an">title:</span><span class="co"> "A lesson of advanced python from Juan Rodríguez"</span></span>
<span id="cb80-3"><a href="#cb80-3"></a><span class="an">description:</span><span class="co"> "The lecture by Juan Luis Cano Rodríguez in Master in Business Analytics and Big Data, 2021-2022, which focused on modern SWE practices using Python and the insight we can gain on how Data Science projects are put into production."</span></span>
<span id="cb80-4"><a href="#cb80-4"></a><span class="an">author:</span></span>
<span id="cb80-5"><a href="#cb80-5"></a><span class="co">  - name: "Tuan Le Khac"</span></span>
<span id="cb80-6"><a href="#cb80-6"></a><span class="co">    url: https://lktuan.github.io/</span></span>
<span id="cb80-7"><a href="#cb80-7"></a><span class="an">categories:</span><span class="co"> [python, pydata] </span></span>
<span id="cb80-8"><a href="#cb80-8"></a><span class="an">date:</span><span class="co"> 07-08-2024</span></span>
<span id="cb80-9"><a href="#cb80-9"></a><span class="an">date-modified:</span><span class="co"> 08-01-2024</span></span>
<span id="cb80-10"><a href="#cb80-10"></a><span class="an">image:</span><span class="co"> juan_r.png</span></span>
<span id="cb80-11"><a href="#cb80-11"></a><span class="an">code-tools:</span><span class="co"> true</span></span>
<span id="cb80-12"><a href="#cb80-12"></a><span class="an">code-fold:</span><span class="co"> show</span></span>
<span id="cb80-13"><a href="#cb80-13"></a><span class="an">code-annotations:</span><span class="co"> hover</span></span>
<span id="cb80-14"><a href="#cb80-14"></a><span class="an">draft:</span><span class="co"> false</span></span>
<span id="cb80-15"><a href="#cb80-15"></a><span class="an">css:</span><span class="co"> html/styles.scss</span></span>
<span id="cb80-16"><a href="#cb80-16"></a><span class="an">fig-cap-location:</span><span class="co"> bottom</span></span>
<span id="cb80-17"><a href="#cb80-17"></a><span class="an">editor:</span><span class="co"> visual</span></span>
<span id="cb80-18"><a href="#cb80-18"></a><span class="an">format:</span></span>
<span id="cb80-19"><a href="#cb80-19"></a><span class="co">  html:</span></span>
<span id="cb80-20"><a href="#cb80-20"></a><span class="co">    code-overflow: wrap</span></span>
<span id="cb80-21"><a href="#cb80-21"></a><span class="co">---</span></span>
<span id="cb80-22"><a href="#cb80-22"></a></span>
<span id="cb80-23"><a href="#cb80-23"></a>This <span class="co">[</span><span class="ot">lesson</span><span class="co">](https://github.com/astrojuanlu/ie-mbd-advanced-python/tree/main)</span> was found on <span class="co">[</span><span class="ot">Juan Luis Cano Rodríguez's</span><span class="co">](https://github.com/astrojuanlu)</span> github profile when I came across his talk <span class="co">[</span><span class="ot">"Building the composable Python data stack with Kedro &amp; Ibis"</span><span class="co">](https://www.youtube.com/watch?v=ffDHdtz_vKc)</span> (bookmarked for learning later) in <span class="co">[</span><span class="ot">Pydata London 2024</span><span class="co">](https://www.youtube.com/playlist?list=PLGVZCDnMOq0rrhYTNedKKuJ9716fEaAdK)</span>.</span>
<span id="cb80-24"><a href="#cb80-24"></a></span>
<span id="cb80-25"><a href="#cb80-25"></a>This is my notes:</span>
<span id="cb80-26"><a href="#cb80-26"></a></span>
<span id="cb80-27"><a href="#cb80-27"></a><span class="fu"># 00 [intro](https://github.com/astrojuanlu/ie-mbd-advanced-python/blob/main/sessions/00_intro.ipynb)</span></span>
<span id="cb80-28"><a href="#cb80-28"></a></span>
<span id="cb80-29"><a href="#cb80-29"></a><span class="fu">## learning objectives</span></span>
<span id="cb80-30"><a href="#cb80-30"></a></span>
<span id="cb80-31"><a href="#cb80-31"></a><span class="ss">- </span>Learn modern software engineering practices using Python</span>
<span id="cb80-32"><a href="#cb80-32"></a><span class="ss">- </span>Understand the value of automation in the software engineering process</span>
<span id="cb80-33"><a href="#cb80-33"></a><span class="ss">- </span>Gain insight into how Data Science projects are put in production</span>
<span id="cb80-34"><a href="#cb80-34"></a><span class="ss">- </span>Learn better techniques to collaborate in software projects</span>
<span id="cb80-35"><a href="#cb80-35"></a></span>
<span id="cb80-36"><a href="#cb80-36"></a>The instructor used Linux / Conda, err I just have Window here so there is no other way but right I will try to make stuffs work in Window. Let's get started!</span>
<span id="cb80-37"><a href="#cb80-37"></a></span>
<span id="cb80-38"><a href="#cb80-38"></a>:::{layout-ncol="1"}</span>
<span id="cb80-39"><a href="#cb80-39"></a><span class="al">![stolen from the lecture](https://raw.githubusercontent.com/astrojuanlu/ie-mbd-advanced-python/e2224276f91529280ebfcd42ddc7dc22cf0d2010/img/quote-talk-is-cheap-show-me-the-code-linus-torvalds-273528.jpg)</span></span>
<span id="cb80-40"><a href="#cb80-40"></a>:::</span>
<span id="cb80-41"><a href="#cb80-41"></a></span>
<span id="cb80-42"><a href="#cb80-42"></a><span class="fu"># 01 [git](https://github.com/astrojuanlu/ie-mbd-advanced-python/blob/main/sessions/01_git.ipynb)</span></span>
<span id="cb80-43"><a href="#cb80-43"></a></span>
<span id="cb80-44"><a href="#cb80-44"></a><span class="fu">## glossary</span></span>
<span id="cb80-45"><a href="#cb80-45"></a></span>
<span id="cb80-46"><a href="#cb80-46"></a><span class="ss">- </span>**Repository**: Directory tracked by git, contains a <span class="in">`.git`</span> folder and it's created by <span class="in">`$ git init`</span>;</span>
<span id="cb80-47"><a href="#cb80-47"></a><span class="ss">- </span>**Commit**: State or snapshot of the repository, they are created by <span class="in">`$ git commit`</span>;</span>
<span id="cb80-48"><a href="#cb80-48"></a><span class="ss">- </span>**Branch**: A parallel or separate line of development, the default one is master and they are created by <span class="in">`$ git branch`</span> or <span class="in">`$ git checkout -b`</span>.</span>
<span id="cb80-49"><a href="#cb80-49"></a></span>
<span id="cb80-50"><a href="#cb80-50"></a><span class="fu">## git uses a Linux-like cli so now Linux cli 101 (and how to do the same on Window pwsh)</span></span>
<span id="cb80-51"><a href="#cb80-51"></a></span>
<span id="cb80-52"><a href="#cb80-52"></a><span class="ss">- </span><span class="in">`whoami`</span>: who am i</span>
<span id="cb80-53"><a href="#cb80-53"></a><span class="ss">- </span><span class="in">`pwd`</span>: print working directory</span>
<span id="cb80-54"><a href="#cb80-54"></a><span class="ss">- </span><span class="in">`ls`</span>: list all file in the dir, <span class="in">`.`</span> for current folder, <span class="in">`..`</span> for parent one (seems there is no <span class="in">`--color`</span> or <span class="in">`-a`</span> in pwsh)</span>
<span id="cb80-55"><a href="#cb80-55"></a><span class="ss">- </span><span class="in">`cd`</span>: change dir </span>
<span id="cb80-56"><a href="#cb80-56"></a><span class="ss">- </span><span class="in">`touch`</span>: create empty file (in pwsh we use <span class="in">`echo "" &gt;&gt; file_name`</span>)</span>
<span id="cb80-57"><a href="#cb80-57"></a><span class="ss">- </span><span class="in">`cat`</span>: concatenate, print file contents</span>
<span id="cb80-58"><a href="#cb80-58"></a><span class="ss">- </span><span class="in">`nano`</span>: edit a file from the command line (there is a <span class="co">[</span><span class="ot">way</span><span class="co">](https://www.hanselman.com/blog/developers-can-run-bash-shell-and-usermode-ubuntu-linux-binaries-on-windows-10)</span> that allows us to do the same in win10, but ya, nope)</span>
<span id="cb80-59"><a href="#cb80-59"></a></span>
<span id="cb80-60"><a href="#cb80-60"></a><span class="fu">## workflow</span></span>
<span id="cb80-61"><a href="#cb80-61"></a></span>
<span id="cb80-62"><a href="#cb80-62"></a>I did these in pwsh:</span>
<span id="cb80-63"><a href="#cb80-63"></a></span>
<span id="cb80-64"><a href="#cb80-64"></a><span class="ss">1. </span>Create a directory <span class="in">`mkdir test_project`</span> and navigate there <span class="in">`cd test_project`</span>;</span>
<span id="cb80-65"><a href="#cb80-65"></a><span class="ss">2. </span>Init a git repository <span class="in">`git init`</span>;</span>
<span id="cb80-66"><a href="#cb80-66"></a><span class="ss">3. </span>Check status <span class="in">`git status`</span> ("on branch master, no commits yet, nothing to commit");</span>
<span id="cb80-67"><a href="#cb80-67"></a><span class="ss">4. </span>Create some files <span class="in">`echo "#Hello, world!" &gt;&gt; readme.md`</span>;</span>
<span id="cb80-68"><a href="#cb80-68"></a><span class="ss">5. </span>Stage the files <span class="in">`git add readme.md`</span>;</span>
<span id="cb80-69"><a href="#cb80-69"></a><span class="ss">6. </span>Commit the changes <span class="in">`git commit -m "initial commit"`</span>;</span>
<span id="cb80-70"><a href="#cb80-70"></a></span>
<span id="cb80-71"><a href="#cb80-71"></a>:::{.callout-warning}</span>
<span id="cb80-72"><a href="#cb80-72"></a>Do not run <span class="in">`git init`</span> on your home directory, as it can lead to confusion and potential data loss. If <span class="in">`git status`</span> gives a lot of untracked files unrelated to your project, you might want to <span class="in">`rm -rf .git`</span> and start in another directory. Notice that this command removes all git history.</span>
<span id="cb80-73"><a href="#cb80-73"></a>:::</span>
<span id="cb80-74"><a href="#cb80-74"></a></span>
<span id="cb80-75"><a href="#cb80-75"></a><span class="fu">## branching</span></span>
<span id="cb80-76"><a href="#cb80-76"></a></span>
<span id="cb80-77"><a href="#cb80-77"></a><span class="ss">1. </span>Create and checkout to new branch <span class="in">`git switch -c branch1`</span> (<span class="in">`-c`</span> stands for create); </span>
<span id="cb80-78"><a href="#cb80-78"></a><span class="ss">2. </span>Commit there (see above);</span>
<span id="cb80-79"><a href="#cb80-79"></a><span class="ss">3. </span>Go back to main branch <span class="in">`git switch master`</span>;</span>
<span id="cb80-80"><a href="#cb80-80"></a><span class="ss">6. </span>Merge changes <span class="in">`git merge branch1`</span>;</span>
<span id="cb80-81"><a href="#cb80-81"></a><span class="ss">5. </span>Delete branch <span class="in">`git branch -d branch1`</span> (<span class="in">`-d`</span> stands for delete, don't forget this step!).</span>
<span id="cb80-82"><a href="#cb80-82"></a></span>
<span id="cb80-83"><a href="#cb80-83"></a>:::{.callout-tip}</span>
<span id="cb80-84"><a href="#cb80-84"></a><span class="ss">- </span>Normally, the <span class="in">`git merge`</span> step happens online using *pull requests* or *merge requests*, which are **not** git concepts, but GitHub/GitLab concepts.</span>
<span id="cb80-85"><a href="#cb80-85"></a><span class="ss">- </span>If <span class="in">`git switch`</span> does not work for you, you might have an older version of Git. Consider upgrading, or alternatively replace all <span class="in">`git switch -c`</span> with <span class="in">`git checkout -b`</span>.</span>
<span id="cb80-86"><a href="#cb80-86"></a>:::</span>
<span id="cb80-87"><a href="#cb80-87"></a></span>
<span id="cb80-88"><a href="#cb80-88"></a><span class="at">&gt; Pull requests (PR) let you tell others about changes you've pushed to a branch in a repository on GitHub. Once a pull request is opened, you can discuss and review the potential changes with collaborators and add follow-up commits before your changes are merged into the base branch. -- GitHub</span></span>
<span id="cb80-89"><a href="#cb80-89"></a></span>
<span id="cb80-90"><a href="#cb80-90"></a><span class="at">&gt; A merge request (MR) is a proposal to incorporate changes from a source branch to a target branch. -- GitLab</span></span>
<span id="cb80-91"><a href="#cb80-91"></a></span>
<span id="cb80-92"><a href="#cb80-92"></a><span class="at">&gt; Remember to **never commit to master**. -- Git Workflow</span></span>
<span id="cb80-93"><a href="#cb80-93"></a></span>
<span id="cb80-94"><a href="#cb80-94"></a><span class="fu">## merging</span></span>
<span id="cb80-95"><a href="#cb80-95"></a></span>
<span id="cb80-96"><a href="#cb80-96"></a>2 types of merging:</span>
<span id="cb80-97"><a href="#cb80-97"></a></span>
<span id="cb80-98"><a href="#cb80-98"></a><span class="ss">- </span>**Fast-forward merge**: There is no diverging history, and git just "advances the pointer" of the current branch. <span class="in">`git merge new-branch --ff-only`</span> will fail if a fast-forward merge is not possible;</span>
<span id="cb80-99"><a href="#cb80-99"></a><span class="ss">- </span>**Non fast-forward merge**: The history diverged, and git will create a merge commit (hence ask for a commit message) with two parents that combines the two branches. <span class="in">`git merge new-branch --no-ff`</span> always creates a merge commit even if a fast-forward merge is possible.</span>
<span id="cb80-100"><a href="#cb80-100"></a></span>
<span id="cb80-101"><a href="#cb80-101"></a>GitHub use <span class="in">`--no--ff`</span> option for pull requests, see <span class="co">[</span><span class="ot">here</span><span class="co">](https://docs.github.com/en/pull-requests/collaborating-with-pull-requests/incorporating-changes-from-a-pull-request/merging-a-pull-request)</span>, and this old-but-gold <span class="co">[</span><span class="ot">discussion</span><span class="co">](https://stackoverflow.com/questions/9069061/what-effect-does-the-no-ff-flag-have-for-git-merge)</span>.</span>
<span id="cb80-102"><a href="#cb80-102"></a></span>
<span id="cb80-103"><a href="#cb80-103"></a><span class="ss">- </span>Non fast-forward merges can end up in conflicts. In that case, git will halt the merge operation and leave traces in the affected files;</span>
<span id="cb80-104"><a href="#cb80-104"></a><span class="ss">- </span>To abort a merge <span class="in">`git merge --abort`</span> (useful if we are scared and don't know what to do);</span>
<span id="cb80-105"><a href="#cb80-105"></a><span class="ss">- </span>To merge overriding everything with the upcoming branch <span class="in">`git merge new-branch --strategy-option theirs`</span>;</span>
<span id="cb80-106"><a href="#cb80-106"></a><span class="ss">- </span>To merge overriding everything with the current branch <span class="in">`git merge new-branch --strategy-option ours`</span>.</span>
<span id="cb80-107"><a href="#cb80-107"></a></span>
<span id="cb80-108"><a href="#cb80-108"></a>**Be careful** while editing files that are in conflict.</span>
<span id="cb80-109"><a href="#cb80-109"></a></span>
<span id="cb80-110"><a href="#cb80-110"></a><span class="fu">## other</span></span>
<span id="cb80-111"><a href="#cb80-111"></a></span>
<span id="cb80-112"><a href="#cb80-112"></a><span class="ss">- </span>Ignoring files <span class="in">`.gitignore`</span>;</span>
<span id="cb80-113"><a href="#cb80-113"></a><span class="ss">- </span>Amend the last commit: <span class="in">`git commit --amend`</span>;</span>
<span id="cb80-114"><a href="#cb80-114"></a><span class="ss">- </span>Show pretty history: <span class="in">`git log --graph --oneline --decorate --all`</span>;</span>
<span id="cb80-115"><a href="#cb80-115"></a><span class="ss">- </span>Configuring git aliases: <span class="in">`git config --global alias.lg "log --graph --oneline --decorate"`</span> (and now you have <span class="in">`git lg`</span>!).</span>
<span id="cb80-116"><a href="#cb80-116"></a></span>
<span id="cb80-117"><a href="#cb80-117"></a>This excellent chart will help you in git workflow decision making.</span>
<span id="cb80-118"><a href="#cb80-118"></a></span>
<span id="cb80-119"><a href="#cb80-119"></a>:::{layout-ncol="1"}</span>
<span id="cb80-120"><a href="#cb80-120"></a>!<span class="co">[</span><span class="ot">git flowchart, photo credit to this SO [thread](https://stackoverflow.com/questions/14096721/how-to-add-file-to-a-previous-commit)</span><span class="co">](git_pretty.png)</span></span>
<span id="cb80-121"><a href="#cb80-121"></a>:::</span>
<span id="cb80-122"><a href="#cb80-122"></a></span>
<span id="cb80-123"><a href="#cb80-123"></a><span class="fu">## triangular workflows in git</span></span>
<span id="cb80-124"><a href="#cb80-124"></a></span>
<span id="cb80-125"><a href="#cb80-125"></a>When collaborating with a project hosted online on GitHub or GitLab, the most common setup is having a central repository, one remote fork per user, and local clones/checkouts:</span>
<span id="cb80-126"><a href="#cb80-126"></a></span>
<span id="cb80-127"><a href="#cb80-127"></a>:::{layout-ncol="1"}</span>
<span id="cb80-128"><a href="#cb80-128"></a>!<span class="co">[</span><span class="ot">triangular workflows in git, [source](https://github.blog/2015-07-29-git-2-5-including-multiple-worktrees-and-triangular-workflows/)</span><span class="co">](https://github.blog/wp-content/uploads/2015/07/5dcdcae4-354a-11e5-9f82-915914fad4f7.png?resize=2000%2C951)</span></span>
<span id="cb80-129"><a href="#cb80-129"></a>:::</span>
<span id="cb80-130"><a href="#cb80-130"></a></span>
<span id="cb80-131"><a href="#cb80-131"></a>Notice the different naming conventions between this website and the first image:</span>
<span id="cb80-132"><a href="#cb80-132"></a></span>
<span id="cb80-133"><a href="#cb80-133"></a><span class="ss">- </span>Convention 1: upstream/origin/local</span>
<span id="cb80-134"><a href="#cb80-134"></a><span class="ss">- </span>Convention 2: origin/&lt;username&gt;/local</span>
<span id="cb80-135"><a href="#cb80-135"></a></span>
<span id="cb80-136"><a href="#cb80-136"></a>We will be consistent with the Aaron Meurer guide and therefore use Convention 2 all the time.</span>
<span id="cb80-137"><a href="#cb80-137"></a></span>
<span id="cb80-138"><a href="#cb80-138"></a><span class="fu">## after creating a PR</span></span>
<span id="cb80-139"><a href="#cb80-139"></a></span>
<span id="cb80-140"><a href="#cb80-140"></a>After your pull request has been merged to <span class="in">`master`</span>, your local <span class="in">`master`</span> and <span class="in">`&lt;username&gt;/master`</span> will be outdated with respect to <span class="in">`origin/master`</span>. On the other hand, you should **avoid working on this branch anymore in the future**: remember branches should be ephemeral and short-lived.</span>
<span id="cb80-141"><a href="#cb80-141"></a></span>
<span id="cb80-142"><a href="#cb80-142"></a>To put yourself in a clean state again, you have to:</span>
<span id="cb80-143"><a href="#cb80-143"></a></span>
<span id="cb80-144"><a href="#cb80-144"></a><span class="ss">1. </span>Click "remove branch" in the pull request (don't click "remove fork"!);</span>
<span id="cb80-145"><a href="#cb80-145"></a><span class="ss">2. </span><span class="in">`git checkout master`</span> (go back to master);</span>
<span id="cb80-146"><a href="#cb80-146"></a><span class="ss">3. </span><span class="in">`git fetch origin`</span> (**never, ever** use <span class="in">`git pull`</span> unless you know exactly what you're doing)</span>
<span id="cb80-147"><a href="#cb80-147"></a><span class="ss">4. </span><span class="in">`git merge --ff-only origin master`</span> (update your local master with origin/master, and fail if you accidentally made any commit in master)</span>
<span id="cb80-148"><a href="#cb80-148"></a><span class="ss">5. </span><span class="in">`git fetch -p &lt;username&gt;`</span> (✨ acknowledge the removal of the remote branch ✨)</span>
<span id="cb80-149"><a href="#cb80-149"></a><span class="ss">6. </span><span class="in">`git branch -d old-branch`</span> (remove the old branch)</span>
<span id="cb80-150"><a href="#cb80-150"></a><span class="ss">7. </span><span class="in">`git push &lt;username&gt; master`</span> (update your fork with respect to origin)</span>
<span id="cb80-151"><a href="#cb80-151"></a><span class="ss">8. </span><span class="in">`git checkout -b new-branch`</span> (start working in the new feature!)</span>
<span id="cb80-152"><a href="#cb80-152"></a></span>
<span id="cb80-153"><a href="#cb80-153"></a>This process has to be repeated **after every pull request**.</span>
<span id="cb80-154"><a href="#cb80-154"></a></span>
<span id="cb80-155"><a href="#cb80-155"></a>Some organizations where all the members are trusted do not use forks, and everybody pushes their branches to the same repository instead. While this simplifies some parts of the workflow, it also requires proper checks in place to prevent bad code to be merged - for example, by <span class="co">[</span><span class="ot">requiring a minimum number of reviews</span><span class="co">](https://docs.github.com/en/repositories/configuring-branches-and-merges-in-your-repository/managing-protected-branches/managing-a-branch-protection-rule)</span> or some <span class="co">[</span><span class="ot">automated status checks</span><span class="co">](https://docs.github.com/en/repositories/configuring-branches-and-merges-in-your-repository/managing-protected-branches/about-protected-branches)</span>.</span>
<span id="cb80-156"><a href="#cb80-156"></a></span>
<span id="cb80-157"><a href="#cb80-157"></a><span class="fu"># 02 [pythonpath](https://github.com/astrojuanlu/ie-mbd-advanced-python/blob/main/sessions/02_pythonpath.ipynb)</span></span>
<span id="cb80-158"><a href="#cb80-158"></a></span>
<span id="cb80-159"><a href="#cb80-159"></a><span class="fu">## how does `import` work?</span></span>
<span id="cb80-160"><a href="#cb80-160"></a></span>
<span id="cb80-161"><a href="#cb80-161"></a>How do <span class="in">`import os, pandas`</span> work? If <span class="in">`pandas`</span> was not installed, what happen?</span>
<span id="cb80-162"><a href="#cb80-162"></a></span>
<span id="cb80-163"><a href="#cb80-163"></a><span class="fu">## how can I `import` my code?</span></span>
<span id="cb80-164"><a href="#cb80-164"></a></span>
<span id="cb80-165"><a href="#cb80-165"></a>There are three ways to import our own code:</span>
<span id="cb80-166"><a href="#cb80-166"></a></span>
<span id="cb80-167"><a href="#cb80-167"></a><span class="ss">- </span>**Being on the same directory**: This is the quickest, however it scales quite poorly (imagine having all of pandas and scikit-learn in a single directory to do any data analysis project!)</span>
<span id="cb80-168"><a href="#cb80-168"></a><span class="ss">- </span>**Appending our code location to PYTHONPATH**: This is effective, but we will try to avoid it because it can bring problems in the future.</span>
<span id="cb80-169"><a href="#cb80-169"></a><span class="ss">- </span>**Making our code installable**: Since any code that's installed can be imported, this shifts the question to "how to make our code installable".</span>
<span id="cb80-170"><a href="#cb80-170"></a></span>
<span id="cb80-171"><a href="#cb80-171"></a><span class="fu">## my first python lib</span></span>
<span id="cb80-172"><a href="#cb80-172"></a></span>
<span id="cb80-173"><a href="#cb80-173"></a>We will create a new Python library, "IE Titanic utils", to analyze the <span class="co">[</span><span class="ot">Titanic dataset</span><span class="co">](https://www.kaggle.com/c/titanic/data)</span>. I will create a project <span class="in">`ie-titanic-utils`</span>, add <span class="in">`readme.md`</span> and <span class="in">`.gitignore`</span> files.</span>
<span id="cb80-174"><a href="#cb80-174"></a></span>
<span id="cb80-175"><a href="#cb80-175"></a><span class="in">```bash</span></span>
<span id="cb80-176"><a href="#cb80-176"></a><span class="fu">mkdir</span> it-titanic-utils</span>
<span id="cb80-177"><a href="#cb80-177"></a><span class="fu">git</span> init</span>
<span id="cb80-178"><a href="#cb80-178"></a></span>
<span id="cb80-179"><a href="#cb80-179"></a><span class="bu">echo</span> <span class="st">"# This is utility to help analyze Titanic dataset"</span> <span class="op">&gt;&gt;</span> readme.md</span>
<span id="cb80-180"><a href="#cb80-180"></a><span class="ex">Invoke-WebRequest</span> <span class="at">-Uri</span> <span class="st">"https://www.toptal.com/developers/gitignore/api/python,jupyternotebooks"</span> <span class="kw">|</span> <span class="ex">Select-Object</span> <span class="at">-ExpandProperty</span> Content <span class="kw">|</span> <span class="ex">Out-File</span> <span class="at">-FilePath</span> .gitignore <span class="at">-Encoding</span> utf8</span>
<span id="cb80-181"><a href="#cb80-181"></a></span>
<span id="cb80-182"><a href="#cb80-182"></a><span class="fu">git</span> add readme.md .gitignore</span>
<span id="cb80-183"><a href="#cb80-183"></a><span class="fu">git</span> commit <span class="at">-m</span> <span class="st">"initial commit"</span></span>
<span id="cb80-184"><a href="#cb80-184"></a><span class="in">```</span></span>
<span id="cb80-185"><a href="#cb80-185"></a></span>
<span id="cb80-186"><a href="#cb80-186"></a>Now I will create <span class="in">`str_utils.py`</span> file (using VS code for convenience), with a function called <span class="in">`tokenize`</span> that takes a str sentence and splits it into a list of words.</span>
<span id="cb80-187"><a href="#cb80-187"></a></span>
<span id="cb80-188"><a href="#cb80-188"></a><span class="in">```{.python filename="str_utils.py"}</span></span>
<span id="cb80-189"><a href="#cb80-189"></a><span class="in">def tokenize(sentence: str) -&gt; list[str]:</span></span>
<span id="cb80-190"><a href="#cb80-190"></a><span class="in">    return sentence.split()</span></span>
<span id="cb80-191"><a href="#cb80-191"></a></span>
<span id="cb80-192"><a href="#cb80-192"></a><span class="in">```</span></span>
<span id="cb80-193"><a href="#cb80-193"></a></span>
<span id="cb80-194"><a href="#cb80-194"></a>In pwsh, I can import and use this function</span>
<span id="cb80-195"><a href="#cb80-195"></a></span>
<span id="cb80-196"><a href="#cb80-196"></a><span class="in">```bash</span></span>
<span id="cb80-197"><a href="#cb80-197"></a><span class="ex">python</span></span>
<span id="cb80-198"><a href="#cb80-198"></a><span class="ex">Python</span> 3.11.4 <span class="er">(</span><span class="ex">tags/v3.11.4:d2340ef,</span> Jun  7 2023, 05:45:37<span class="kw">)</span> <span class="ex">[MSC</span> v.1934 64 bit <span class="er">(</span><span class="ex">AMD64</span><span class="kw">)</span><span class="ex">]</span> on win32</span>
<span id="cb80-199"><a href="#cb80-199"></a><span class="ex">Type</span> <span class="st">"help"</span>, <span class="st">"copyright"</span>, <span class="st">"credits"</span> or <span class="st">"license"</span> for more information.</span>
<span id="cb80-200"><a href="#cb80-200"></a><span class="op">&gt;&gt;&gt;</span> from <span class="ex">str_utils</span> import tokenize</span>
<span id="cb80-201"><a href="#cb80-201"></a><span class="op">&gt;&gt;&gt;</span> tokenize<span class="kw">(</span><span class="st">"Toi la Le Khac Tuan"</span><span class="kw">)</span></span>
<span id="cb80-202"><a href="#cb80-202"></a><span class="ex">[</span><span class="st">'Toi'</span><span class="ex">,</span> <span class="st">'la'</span>, <span class="st">'Le'</span>, <span class="st">'Khac'</span>, <span class="st">'Tuan'</span>]</span>
<span id="cb80-203"><a href="#cb80-203"></a><span class="op">&gt;&gt;&gt;</span></span>
<span id="cb80-204"><a href="#cb80-204"></a><span class="in">```</span></span>
<span id="cb80-205"><a href="#cb80-205"></a></span>
<span id="cb80-206"><a href="#cb80-206"></a><span class="fu">## the `PYTHONPATH`</span></span>
<span id="cb80-207"><a href="#cb80-207"></a></span>
<span id="cb80-208"><a href="#cb80-208"></a>We saw above that we could easily import our <span class="in">`tokenize`</span> function. However, this only works if we are in the same directory. Why? Python looks in some predefined locations to know where to find what we want to import, called the "PATH".</span>
<span id="cb80-209"><a href="#cb80-209"></a></span>
<span id="cb80-212"><a href="#cb80-212"></a><span class="in">```{python}</span></span>
<span id="cb80-213"><a href="#cb80-213"></a><span class="co">#| eval: false</span></span>
<span id="cb80-214"><a href="#cb80-214"></a><span class="im">import</span> sys</span>
<span id="cb80-215"><a href="#cb80-215"></a>sys.path <span class="co"># i will not execute this code</span></span>
<span id="cb80-216"><a href="#cb80-216"></a><span class="in">```</span></span>
<span id="cb80-217"><a href="#cb80-217"></a></span>
<span id="cb80-218"><a href="#cb80-218"></a>Therefore, there are two ways of making our code **globally importable**:</span>
<span id="cb80-219"><a href="#cb80-219"></a></span>
<span id="cb80-220"><a href="#cb80-220"></a><span class="ss">1. </span>Modify the "PATH"</span>
<span id="cb80-221"><a href="#cb80-221"></a><span class="ss">2. </span>Put our code inside a location predefined in the "PATH"</span>
<span id="cb80-222"><a href="#cb80-222"></a></span>
<span id="cb80-223"><a href="#cb80-223"></a>The first option can be achieved like this:</span>
<span id="cb80-224"><a href="#cb80-224"></a></span>
<span id="cb80-227"><a href="#cb80-227"></a><span class="in">```{python}</span></span>
<span id="cb80-228"><a href="#cb80-228"></a><span class="co">#| eval: false</span></span>
<span id="cb80-229"><a href="#cb80-229"></a><span class="op">&gt;&gt;&gt;</span> sys.path.insert(<span class="dv">0</span>, <span class="st">"/home/username/ie-titanic-utils"</span>)</span>
<span id="cb80-230"><a href="#cb80-230"></a><span class="op">&gt;&gt;&gt;</span> <span class="im">import</span> str_utils  <span class="co"># Works!</span></span>
<span id="cb80-231"><a href="#cb80-231"></a><span class="in">```</span></span>
<span id="cb80-232"><a href="#cb80-232"></a></span>
<span id="cb80-233"><a href="#cb80-233"></a>Or, alternatively, from outside of the interpreter: <span class="in">`export PYTHONPATH=/home/username/ie-titanic-utils`</span>.</span>
<span id="cb80-234"><a href="#cb80-234"></a></span>
<span id="cb80-235"><a href="#cb80-235"></a>However, both are **bad practices and should be avoided**.</span>
<span id="cb80-236"><a href="#cb80-236"></a></span>
<span id="cb80-237"><a href="#cb80-237"></a><span class="fu">## what does `import` do?</span></span>
<span id="cb80-238"><a href="#cb80-238"></a></span>
<span id="cb80-239"><a href="#cb80-239"></a>Python code is normally written in <span class="in">`.py`</span> scripts. These scripts can be imported in the same way that any model or package from the standard library can:</span>
<span id="cb80-240"><a href="#cb80-240"></a></span>
<span id="cb80-241"><a href="#cb80-241"></a><span class="in">```bash</span></span>
<span id="cb80-242"><a href="#cb80-242"></a><span class="ex">$</span> python3</span>
<span id="cb80-243"><a href="#cb80-243"></a><span class="op">&gt;&gt;&gt;</span> import <span class="ex">math</span>  <span class="co"># Works, because it's in stdlib</span></span>
<span id="cb80-244"><a href="#cb80-244"></a><span class="op">&gt;&gt;&gt;</span> import <span class="ex">numpy</span> as np  <span class="co"># Works if you ran `pip install numpy` in advance</span></span>
<span id="cb80-245"><a href="#cb80-245"></a><span class="op">&gt;&gt;&gt;</span> import <span class="ex">str_utils</span>  <span class="co"># Works if you are in the same directory</span></span>
<span id="cb80-246"><a href="#cb80-246"></a><span class="ex">[</span><span class="st">'Hello,'</span><span class="ex">,</span> <span class="st">'world!'</span>]</span>
<span id="cb80-247"><a href="#cb80-247"></a><span class="op">&gt;&gt;&gt;</span> </span>
<span id="cb80-248"><a href="#cb80-248"></a><span class="in">```</span></span>
<span id="cb80-249"><a href="#cb80-249"></a></span>
<span id="cb80-250"><a href="#cb80-250"></a>When the user imports a script, **Python runs the script**. That's the way all the possible functions and classes inside it are available.</span>
<span id="cb80-251"><a href="#cb80-251"></a></span>
<span id="cb80-252"><a href="#cb80-252"></a><span class="fu">## how to separate "running code" from reusable pieces</span></span>
<span id="cb80-253"><a href="#cb80-253"></a></span>
<span id="cb80-254"><a href="#cb80-254"></a>A Python module (any <span class="in">`.py`</span> script) might contain code that we want to run, as well as code that we only want to import. To separate these, we use this trick:</span>
<span id="cb80-255"><a href="#cb80-255"></a></span>
<span id="cb80-256"><a href="#cb80-256"></a><span class="in">```bash</span></span>
<span id="cb80-257"><a href="#cb80-257"></a><span class="ex"></span> ie-titanic-utils  get-content <span class="at">-Tail</span> 2 .str_utils.py</span>
<span id="cb80-258"><a href="#cb80-258"></a><span class="cf">if</span> <span class="ex">__name__</span> == <span class="st">"__main__"</span>:</span>
<span id="cb80-259"><a href="#cb80-259"></a>    <span class="ex">print</span><span class="er">(</span><span class="ex">tokenize</span><span class="er">(</span><span class="st">"hello, world!"</span><span class="kw">))</span></span>
<span id="cb80-260"><a href="#cb80-260"></a></span>
<span id="cb80-261"><a href="#cb80-261"></a><span class="ex"></span> ie-titanic-utils  python .str_utils.py <span class="co"># The `print` runs</span></span>
<span id="cb80-262"><a href="#cb80-262"></a><span class="ex">[</span><span class="st">'hello,'</span><span class="ex">,</span> <span class="st">'world!'</span>]</span>
<span id="cb80-263"><a href="#cb80-263"></a></span>
<span id="cb80-264"><a href="#cb80-264"></a><span class="ex"></span> ie-titanic-utils  python</span>
<span id="cb80-265"><a href="#cb80-265"></a><span class="op">&gt;&gt;&gt;</span> from <span class="ex">str_utils</span> import tokenize</span>
<span id="cb80-266"><a href="#cb80-266"></a><span class="op">&gt;&gt;&gt;</span> tokenize<span class="kw">(</span><span class="st">"Hi, world!"</span><span class="kw">)</span></span>
<span id="cb80-267"><a href="#cb80-267"></a><span class="ex">[</span><span class="st">'Hi,'</span><span class="ex">,</span> <span class="st">'world!'</span>] <span class="co"># The `print` doesn't run!</span></span>
<span id="cb80-268"><a href="#cb80-268"></a><span class="op">&gt;&gt;&gt;</span></span>
<span id="cb80-269"><a href="#cb80-269"></a><span class="in">```</span></span>
<span id="cb80-270"><a href="#cb80-270"></a></span>
<span id="cb80-271"><a href="#cb80-271"></a>:::{.callout-tip}</span>
<span id="cb80-272"><a href="#cb80-272"></a>Here is what Claude sonnet 3.5 gave me:</span>
<span id="cb80-273"><a href="#cb80-273"></a></span>
<span id="cb80-274"><a href="#cb80-274"></a>To separate code that we want to run directly from code that we only want to import, we should use the if <span class="in">`__name__ == "__main__"`</span>: idiom in Python. This is a common pattern that allows a Python script to be both importable and executable. Here's an explanation:</span>
<span id="cb80-275"><a href="#cb80-275"></a></span>
<span id="cb80-276"><a href="#cb80-276"></a><span class="ss">1. </span>When a Python file is run directly, Python sets the special <span class="in">`__name__`</span> variable to "<span class="in">`__main__`</span>".</span>
<span id="cb80-277"><a href="#cb80-277"></a><span class="ss">2. </span>When a Python file is imported as a module,<span class="in">` __name__ `</span>is set to the name of the module.</span>
<span id="cb80-278"><a href="#cb80-278"></a></span>
<span id="cb80-279"><a href="#cb80-279"></a>By using this idiom, we can control which code runs when the script is executed directly versus when it's imported as a module.</span>
<span id="cb80-280"><a href="#cb80-280"></a>:::</span>
<span id="cb80-281"><a href="#cb80-281"></a></span>
<span id="cb80-282"><a href="#cb80-282"></a><span class="fu"># 03&amp;04 [pip vs. conda](https://github.com/astrojuanlu/ie-mbd-advanced-python/blob/main/sessions/03-04_pip-vs-conda.ipynb)</span></span>
<span id="cb80-283"><a href="#cb80-283"></a></span>
<span id="cb80-284"><a href="#cb80-284"></a><span class="fu">## managing python environments</span></span>
<span id="cb80-285"><a href="#cb80-285"></a></span>
<span id="cb80-286"><a href="#cb80-286"></a>:::{layout-ncol="1"}</span>
<span id="cb80-287"><a href="#cb80-287"></a><span class="al">![stolen from the lecture](https://raw.githubusercontent.com/astrojuanlu/ie-mbd-advanced-python/e2224276f91529280ebfcd42ddc7dc22cf0d2010/img/python_comrades.png)</span></span>
<span id="cb80-288"><a href="#cb80-288"></a>:::</span>
<span id="cb80-289"><a href="#cb80-289"></a></span>
<span id="cb80-290"><a href="#cb80-290"></a><span class="at">&gt; Simple is better than complex.</span></span>
<span id="cb80-291"><a href="#cb80-291"></a><span class="at">&gt; </span></span>
<span id="cb80-292"><a href="#cb80-292"></a><span class="at">&gt; Complex is better than complicated.</span></span>
<span id="cb80-293"><a href="#cb80-293"></a></span>
<span id="cb80-294"><a href="#cb80-294"></a>How do people install and upgrade Python? -&gt; Most of people choose Python.org, the same for me!</span>
<span id="cb80-295"><a href="#cb80-295"></a></span>
<span id="cb80-296"><a href="#cb80-296"></a>:::{.callout-caution}</span>
<span id="cb80-297"><a href="#cb80-297"></a>This way ships a tool to create development environments (<span class="in">`venv`</span>). However, <span class="in">`venv`</span> cannot create environments with different Python versions (you're tied to the one you downloaded) and certain packages will require extra steps to be installed. Therefore, it **is not** for everyone.</span>
<span id="cb80-298"><a href="#cb80-298"></a>:::</span>
<span id="cb80-299"><a href="#cb80-299"></a></span>
<span id="cb80-300"><a href="#cb80-300"></a>Juan chose to use <span class="in">`conda`</span>. As I am learning Docker, I choose Docker for this tutorial.</span>
<span id="cb80-301"><a href="#cb80-301"></a></span>
<span id="cb80-302"><a href="#cb80-302"></a>How do people create isolated development environments? -&gt; The most popular is <span class="in">`Virtualenv`</span>. But normally when doing an analysis task, I use <span class="in">`venv`</span> which is built-in python lib. Recently I followed my dev team to use <span class="in">`pipenv`</span>, I do also see <span class="in">`poetry`</span> is worth-learning approach.</span>
<span id="cb80-303"><a href="#cb80-303"></a></span>
<span id="cb80-304"><a href="#cb80-304"></a><span class="at">&gt; "More than a half of the users of Jupyter Notebook and JupyterLab choose Conda"</span></span>
<span id="cb80-305"><a href="#cb80-305"></a></span>
<span id="cb80-306"><a href="#cb80-306"></a>As I think a model which is not deployed yet is useless model, I choose VS Code and Docker - more deployment-oriented. </span>
<span id="cb80-307"><a href="#cb80-307"></a></span>
<span id="cb80-308"><a href="#cb80-308"></a><span class="fu">## summary</span></span>
<span id="cb80-309"><a href="#cb80-309"></a></span>
<span id="cb80-310"><a href="#cb80-310"></a><span class="at">&gt; For the user, the most salient distinction is probably this: pip installs python packages within any environment; conda installs any package within conda environments.</span></span>
<span id="cb80-311"><a href="#cb80-311"></a><span class="at">&gt; </span></span>
<span id="cb80-312"><a href="#cb80-312"></a><span class="at">&gt; —Jake Vanderplas</span></span>
<span id="cb80-313"><a href="#cb80-313"></a></span>
<span id="cb80-314"><a href="#cb80-314"></a>However, I will be using <span class="in">`pipenv`</span> to achieve what Juan done in upcoming sections. I will specify version of each package I used.</span>
<span id="cb80-315"><a href="#cb80-315"></a></span>
<span id="cb80-316"><a href="#cb80-316"></a><span class="fu">## `pip` and `PyPI`</span></span>
<span id="cb80-317"><a href="#cb80-317"></a></span>
<span id="cb80-318"><a href="#cb80-318"></a><span class="in">`pip`</span> is the default Python installer. By default, it fetches packages from <span class="ot">&lt;https://pypi.org/&gt;</span>, which is the community repository for Python packages.</span>
<span id="cb80-319"><a href="#cb80-319"></a></span>
<span id="cb80-320"><a href="#cb80-320"></a><span class="fu"># 05 layout</span></span>
<span id="cb80-321"><a href="#cb80-321"></a></span>
<span id="cb80-322"><a href="#cb80-322"></a>here is my project's layout:</span>
<span id="cb80-323"><a href="#cb80-323"></a></span>
<span id="cb80-324"><a href="#cb80-324"></a><span class="in">```bash</span></span>
<span id="cb80-325"><a href="#cb80-325"></a><span class="ex">ie-titanic-utils</span></span>
<span id="cb80-326"><a href="#cb80-326"></a><span class="ex">├─</span> src</span>
<span id="cb80-327"><a href="#cb80-327"></a><span class="ex">│</span>  └─ ie_titanic_utils</span>
<span id="cb80-328"><a href="#cb80-328"></a><span class="ex">│</span>     ├─ __init__.py</span>
<span id="cb80-329"><a href="#cb80-329"></a><span class="ex">│</span>     └─ ...</span>
<span id="cb80-330"><a href="#cb80-330"></a><span class="ex">├─</span> tests</span>
<span id="cb80-331"><a href="#cb80-331"></a><span class="ex">│</span>  └─ ...</span>
<span id="cb80-332"><a href="#cb80-332"></a><span class="ex">├─</span> .gitignore</span>
<span id="cb80-333"><a href="#cb80-333"></a><span class="ex">├─</span> README.md</span>
<span id="cb80-334"><a href="#cb80-334"></a><span class="ex">└─</span> pyproject.toml</span>
<span id="cb80-335"><a href="#cb80-335"></a><span class="in">```</span></span>
<span id="cb80-336"><a href="#cb80-336"></a></span>
<span id="cb80-337"><a href="#cb80-337"></a><span class="ss">- </span>The <span class="in">`src/package_name`</span> contains the source code of the library. <span class="in">`package_name`</span> must be Python identifier. It should contain a <span class="in">`__init__.py`</span> that can be empty;</span>
<span id="cb80-338"><a href="#cb80-338"></a><span class="ss">- </span>The <span class="in">`tests`</span> directory contains the tests. It must not contain any <span class="in">`__init__.py`</span> because it's not meant to be imported as a package. In very specific cases it's included inside <span class="in">`src/package_name`</span>;</span>
<span id="cb80-339"><a href="#cb80-339"></a><span class="ss">- </span>Every project contains a <span class="in">`README.md`</span> that at least explains what the project is;</span>
<span id="cb80-340"><a href="#cb80-340"></a><span class="ss">- </span><span class="in">`pyproject.toml`</span> contains the metadata of the project. The absolutely required fields are <span class="in">`module`</span>, <span class="in">`author`</span>, and some extra information that tells Python how to install the package.</span>
<span id="cb80-341"><a href="#cb80-341"></a></span>
<span id="cb80-342"><a href="#cb80-342"></a><span class="fu">## creating a package</span></span>
<span id="cb80-343"><a href="#cb80-343"></a></span>
<span id="cb80-344"><a href="#cb80-344"></a><span class="ss">1. </span>run <span class="in">`flit init`</span> to create the metadata</span>
<span id="cb80-345"><a href="#cb80-345"></a></span>
<span id="cb80-346"><a href="#cb80-346"></a><span class="in">```bash</span></span>
<span id="cb80-347"><a href="#cb80-347"></a><span class="ex"></span> ie-titanic-utils  flit init</span>
<span id="cb80-348"><a href="#cb80-348"></a><span class="ex">pyproject.toml</span> exists <span class="at">-</span> overwrite it<span class="pp">?</span> <span class="pp">[</span><span class="ss">y/N</span><span class="pp">]</span>: y</span>
<span id="cb80-349"><a href="#cb80-349"></a><span class="ex">Module</span> name <span class="pp">[</span><span class="ss">ie_titanic_utils</span><span class="pp">]</span>: ie_utils</span>
<span id="cb80-350"><a href="#cb80-350"></a><span class="ex">Author:</span> Tuan Le Khac</span>
<span id="cb80-351"><a href="#cb80-351"></a><span class="ex">Author</span> email: tuan.lekhac0905@gmail.com</span>
<span id="cb80-352"><a href="#cb80-352"></a><span class="ex">Home</span> page: </span>
<span id="cb80-353"><a href="#cb80-353"></a><span class="ex">Choose</span> a license <span class="er">(</span><span class="ex">see</span> http://choosealicense.com/ for more info<span class="kw">)</span></span>
<span id="cb80-354"><a href="#cb80-354"></a><span class="ex">1.</span> MIT <span class="at">-</span> simple and permissive</span>
<span id="cb80-355"><a href="#cb80-355"></a><span class="ex">2.</span> Apache <span class="at">-</span> explicitly grants patent rights</span>
<span id="cb80-356"><a href="#cb80-356"></a><span class="ex">3.</span> GPL <span class="at">-</span> ensures that code based on this is shared with the same terms</span>
<span id="cb80-357"><a href="#cb80-357"></a><span class="ex">4.</span> Skip <span class="at">-</span> choose a license later</span>
<span id="cb80-358"><a href="#cb80-358"></a><span class="ex">Enter</span> 1-4: 4</span>
<span id="cb80-359"><a href="#cb80-359"></a></span>
<span id="cb80-360"><a href="#cb80-360"></a><span class="ex">Written</span> pyproject.toml<span class="kw">;</span> <span class="ex">edit</span> that file to add optional extra info.</span>
<span id="cb80-361"><a href="#cb80-361"></a><span class="in">```</span></span>
<span id="cb80-362"><a href="#cb80-362"></a></span>
<span id="cb80-363"><a href="#cb80-363"></a><span class="ss">2. </span>place some code under the source directory. In <span class="in">`__init__.py`</span> there must be a docstring giving a description of the project and a <span class="in">`__version__`</span> variable indicating the version:</span>
<span id="cb80-364"><a href="#cb80-364"></a></span>
<span id="cb80-365"><a href="#cb80-365"></a><span class="in">```{.python filename="__init__.py"}</span></span>
<span id="cb80-366"><a href="#cb80-366"></a><span class="in">"""IE utils (test package)."""</span></span>
<span id="cb80-367"><a href="#cb80-367"></a></span>
<span id="cb80-368"><a href="#cb80-368"></a><span class="in">__version__ = "0.1.0"</span></span>
<span id="cb80-369"><a href="#cb80-369"></a><span class="in">```</span></span>
<span id="cb80-370"><a href="#cb80-370"></a></span>
<span id="cb80-371"><a href="#cb80-371"></a><span class="ss">3. </span>Install the code using <span class="in">`pip install`</span>! (this did not work for me currently. edit: the project name should match the <span class="in">`src/package_name`</span> omg)</span>
<span id="cb80-372"><a href="#cb80-372"></a></span>
<span id="cb80-373"><a href="#cb80-373"></a><span class="in">```bash</span></span>
<span id="cb80-374"><a href="#cb80-374"></a><span class="ex"></span> ie-titanic-utils  pip install .</span>
<span id="cb80-375"><a href="#cb80-375"></a><span class="ex">Processing</span> .ie-titanic-utils</span>
<span id="cb80-376"><a href="#cb80-376"></a><span class="ex">...</span></span>
<span id="cb80-377"><a href="#cb80-377"></a><span class="ex">Successfully</span> installed ie_titanic_utils-0.1.0</span>
<span id="cb80-378"><a href="#cb80-378"></a><span class="ex"></span> ie-titanic-utils  python</span>
<span id="cb80-379"><a href="#cb80-379"></a><span class="ex">Python</span> 3.11.4 <span class="er">(</span><span class="ex">tags/v3.11.4:d2340ef,</span> Jun  7 2023, 05:45:37<span class="kw">)</span> <span class="ex">[MSC</span> v.1934 64 bit <span class="er">(</span><span class="ex">AMD64</span><span class="kw">)</span><span class="ex">]</span> on win32</span>
<span id="cb80-380"><a href="#cb80-380"></a><span class="ex">Type</span> <span class="st">"help"</span>, <span class="st">"copyright"</span>, <span class="st">"credits"</span> or <span class="st">"license"</span> for more information.</span>
<span id="cb80-381"><a href="#cb80-381"></a><span class="op">&gt;&gt;&gt;</span> import <span class="ex">ie_titanic_utils</span></span>
<span id="cb80-382"><a href="#cb80-382"></a><span class="op">&gt;&gt;&gt;</span> ie_titanic_utils.__version__</span>
<span id="cb80-383"><a href="#cb80-383"></a><span class="st">'0.1.0'</span></span>
<span id="cb80-384"><a href="#cb80-384"></a><span class="op">&gt;&gt;&gt;</span>    </span>
<span id="cb80-385"><a href="#cb80-385"></a><span class="in">```</span></span>
<span id="cb80-386"><a href="#cb80-386"></a></span>
<span id="cb80-387"><a href="#cb80-387"></a><span class="ss">4. </span><span class="in">`readme.md`</span> and a <span class="in">`.gitignore`</span> files were created.</span>
<span id="cb80-388"><a href="#cb80-388"></a><span class="ss">5. </span>commit the change</span>
<span id="cb80-389"><a href="#cb80-389"></a></span>
<span id="cb80-390"><a href="#cb80-390"></a><span class="in">```bash</span></span>
<span id="cb80-391"><a href="#cb80-391"></a><span class="fu">git</span> checkout <span class="at">-b</span> first_module <span class="co"># i should be using switch (-c) haha, checkout is old syntax</span></span>
<span id="cb80-392"><a href="#cb80-392"></a><span class="fu">git</span> status</span>
<span id="cb80-393"><a href="#cb80-393"></a><span class="fu">git</span> add .</span>
<span id="cb80-394"><a href="#cb80-394"></a><span class="fu">git</span> commit <span class="at">-m</span> <span class="st">"initial very first module"</span></span>
<span id="cb80-395"><a href="#cb80-395"></a><span class="fu">git</span> checkout master</span>
<span id="cb80-396"><a href="#cb80-396"></a></span>
<span id="cb80-397"><a href="#cb80-397"></a><span class="ex"></span> ie-titanic-utils  git merge <span class="at">--no-ff</span> first_module</span>
<span id="cb80-398"><a href="#cb80-398"></a><span class="ex">Merge</span> made by the <span class="st">'ort'</span> strategy.</span>
<span id="cb80-399"><a href="#cb80-399"></a> <span class="ex">pyproject.toml</span>                    <span class="kw">|</span> <span class="ex">30</span> ++++++++++++++++++++++++++++++</span>
<span id="cb80-400"><a href="#cb80-400"></a> <span class="ex">src/ie_titanic_utils/__init__.py</span>  <span class="kw">|</span>  <span class="ex">6</span> ++++++</span>
<span id="cb80-401"><a href="#cb80-401"></a> <span class="ex">src/ie_titanic_utils/str_utils.py</span> <span class="kw">|</span>  <span class="ex">6</span> ++++++</span>
<span id="cb80-402"><a href="#cb80-402"></a> <span class="ex">3</span> files changed, 42 insertions<span class="er">(</span><span class="ex">+</span><span class="kw">)</span></span>
<span id="cb80-403"><a href="#cb80-403"></a> <span class="ex">create</span> mode 100644 pyproject.toml</span>
<span id="cb80-404"><a href="#cb80-404"></a> <span class="ex">create</span> mode 100644 src/ie_titanic_utils/__init__.py</span>
<span id="cb80-405"><a href="#cb80-405"></a> <span class="ex">create</span> mode 100644 src/ie_titanic_utils/str_utils.py</span>
<span id="cb80-406"><a href="#cb80-406"></a></span>
<span id="cb80-407"><a href="#cb80-407"></a><span class="fu">git</span> branch <span class="at">-d</span> first_module</span>
<span id="cb80-408"><a href="#cb80-408"></a><span class="co"># git push origin master</span></span>
<span id="cb80-409"><a href="#cb80-409"></a><span class="co"># as I will not upload this code to GitHub</span></span>
<span id="cb80-410"><a href="#cb80-410"></a><span class="co"># https://stackoverflow.com/questions/32238616/git-push-fatal-origin-does-not-appear-to-be-a-git-repository-fatal-could-n</span></span>
<span id="cb80-411"><a href="#cb80-411"></a><span class="in">```</span></span>
<span id="cb80-412"><a href="#cb80-412"></a></span>
<span id="cb80-413"><a href="#cb80-413"></a>Now if I log the git, I will see this:</span>
<span id="cb80-414"><a href="#cb80-414"></a></span>
<span id="cb80-415"><a href="#cb80-415"></a><span class="in">```bash</span></span>
<span id="cb80-416"><a href="#cb80-416"></a><span class="ex"></span> ie-titanic-utils  git log <span class="at">--graph</span> <span class="at">--oneline</span> <span class="at">--decorate</span> <span class="at">--all</span></span>
<span id="cb80-417"><a href="#cb80-417"></a><span class="ex">*</span>   39105c7 <span class="er">(</span><span class="ex">HEAD</span> <span class="at">-</span><span class="op">&gt;</span> master<span class="kw">)</span> <span class="ex">Merge</span> branch <span class="st">'first_module'</span></span>
<span id="cb80-418"><a href="#cb80-418"></a><span class="kw">|</span></span>
<span id="cb80-419"><a href="#cb80-419"></a><span class="kw">|</span> <span class="ex">*</span> 7a33844 initial very first module</span>
<span id="cb80-420"><a href="#cb80-420"></a><span class="kw">|</span><span class="ex">/</span></span>
<span id="cb80-421"><a href="#cb80-421"></a><span class="ex">*</span> 793bd67 initial commit</span>
<span id="cb80-422"><a href="#cb80-422"></a><span class="in">```</span></span>
<span id="cb80-423"><a href="#cb80-423"></a></span>
<span id="cb80-424"><a href="#cb80-424"></a>Yeah til now I can create a "package" in my computer and install so I can use it **globally**. But I have not use any env management yet.</span>
<span id="cb80-425"><a href="#cb80-425"></a></span>
<span id="cb80-426"><a href="#cb80-426"></a><span class="fu">## intermezzo: version numbers</span></span>
<span id="cb80-427"><a href="#cb80-427"></a></span>
<span id="cb80-428"><a href="#cb80-428"></a><span class="ss">+ </span>Version numbers for Python packages are explained in <span class="co">[</span><span class="ot">PEP 440</span><span class="co">](https://www.python.org/dev/peps/pep-0440/)</span></span>
<span id="cb80-429"><a href="#cb80-429"></a><span class="ss">+ </span>For libraries, the most widely used convention is <span class="co">[</span><span class="ot">semantic versioning</span><span class="co">](https://semver.org/)</span>: X.Y.Z</span>
<span id="cb80-430"><a href="#cb80-430"></a><span class="ss">  - </span>Z **must** be incremented if only backwards compatible bug fixes are introduced (a bug fix is defined as an internal change that fixes incorrect behavior)</span>
<span id="cb80-431"><a href="#cb80-431"></a><span class="ss">  - </span>Y **must** be incremented every time there is new, backwards-compatible functionality</span>
<span id="cb80-432"><a href="#cb80-432"></a><span class="ss">  - </span>X **must** be incremented every time there are backwards-incompatible changes</span>
<span id="cb80-433"><a href="#cb80-433"></a><span class="ss">+ </span>Between releases, the version should have the <span class="in">`.dev0`</span> suffix</span>
<span id="cb80-434"><a href="#cb80-434"></a><span class="ss">+ </span>Recommendation: start with 0.1.dev0 (development version), then make a <span class="in">`0.1.0`</span> release, then progress to <span class="in">`0.1.1`</span> for quick fixes and <span class="in">`0.2.0`</span> for new functionality, and when you want to make a promise of relative stability jump to <span class="in">`1.0.0`</span>.</span>
<span id="cb80-435"><a href="#cb80-435"></a><span class="ss">+ </span>For applications, other conventions are more appropriate, like <span class="co">[</span><span class="ot">calendar versioning</span><span class="co">](https://calver.org/)</span>: <span class="in">`[YY]YY.MM.??`</span></span>
<span id="cb80-436"><a href="#cb80-436"></a></span>
<span id="cb80-437"><a href="#cb80-437"></a><span class="fu">## project requirements</span></span>
<span id="cb80-438"><a href="#cb80-438"></a></span>
<span id="cb80-439"><a href="#cb80-439"></a>Sometimes our project will depend on third-party libraries (pandas, scikit-learn). To make pip install those dependencies automatically, we can add them to our <span class="in">`pyproject.toml`</span> under the <span class="in">`[tool.flit.metadata]`</span> section, using the <span class="in">`requires`</span> option:</span>
<span id="cb80-440"><a href="#cb80-440"></a></span>
<span id="cb80-441"><a href="#cb80-441"></a><span class="in">```md</span></span>
<span id="cb80-442"><a href="#cb80-442"></a><span class="co">[</span><span class="ot">build-system</span><span class="co">]</span></span>
<span id="cb80-443"><a href="#cb80-443"></a>requires = <span class="co">[</span><span class="ot">"flit_core&gt;=3.4"</span><span class="co">]</span></span>
<span id="cb80-444"><a href="#cb80-444"></a>build-backend = "flit_core.buildapi"</span>
<span id="cb80-445"><a href="#cb80-445"></a></span>
<span id="cb80-446"><a href="#cb80-446"></a><span class="co">[</span><span class="ot">project</span><span class="co">]</span></span>
<span id="cb80-447"><a href="#cb80-447"></a>name = "ie_titanic_utils"</span>
<span id="cb80-448"><a href="#cb80-448"></a>authors = <span class="co">[</span><span class="ot">{name = "Tuan Le Khac", email = "tuan.lekhac0905@gmail.com"}</span><span class="co">]</span></span>
<span id="cb80-449"><a href="#cb80-449"></a>readme = "readme.md"</span>
<span id="cb80-450"><a href="#cb80-450"></a>requires-python = "&gt;=3.11"</span>
<span id="cb80-451"><a href="#cb80-451"></a>dynamic = <span class="co">[</span><span class="ot">"version", "description"</span><span class="co">]</span></span>
<span id="cb80-452"><a href="#cb80-452"></a>classifiers = [</span>
<span id="cb80-453"><a href="#cb80-453"></a>    "Programming Language :: Python :: 3",</span>
<span id="cb80-454"><a href="#cb80-454"></a>    "License :: OSI Approved :: MIT License",</span>
<span id="cb80-455"><a href="#cb80-455"></a>    "Operating System :: OS Independent",</span>
<span id="cb80-456"><a href="#cb80-456"></a>]</span>
<span id="cb80-457"><a href="#cb80-457"></a>requires = [</span>
<span id="cb80-458"><a href="#cb80-458"></a>    "pandas",</span>
<span id="cb80-459"><a href="#cb80-459"></a>    "matplotlib&gt;=2",</span>
<span id="cb80-460"><a href="#cb80-460"></a>]</span>
<span id="cb80-461"><a href="#cb80-461"></a><span class="in">```</span></span>
<span id="cb80-462"><a href="#cb80-462"></a></span>
<span id="cb80-463"><a href="#cb80-463"></a>We might want to specify *optional* dependencies that should only be installed upon request, or for some specific purposes. A typical example will be development dependencies: we will need things like `pytest` and `black`, but we don't want the user to install them as part as our library. To do that, we can specify *groups* of optional dependencies under the <span class="in">`tool.flit.metadata.requires-extra`</span> section:</span>
<span id="cb80-464"><a href="#cb80-464"></a></span>
<span id="cb80-465"><a href="#cb80-465"></a><span class="in">```md</span></span>
<span id="cb80-466"><a href="#cb80-466"></a>In my case, I use <span class="in">`project.optional-dependencies`</span>: flit_core.config.ConfigError: Use <span class="co">[</span><span class="ot">project</span><span class="co">]</span> table for metadata or <span class="co">[</span><span class="ot">tool.flit.metadata</span><span class="co">]</span>, not both.</span>
<span id="cb80-467"><a href="#cb80-467"></a><span class="co">[</span><span class="ot">project.optional-dependencies</span><span class="co">]</span></span>
<span id="cb80-468"><a href="#cb80-468"></a>dev = [</span>
<span id="cb80-469"><a href="#cb80-469"></a>    "pytest&gt;=6.0",</span>
<span id="cb80-470"><a href="#cb80-470"></a>    "black&gt;=20.8b1",</span>
<span id="cb80-471"><a href="#cb80-471"></a>]</span>
<span id="cb80-472"><a href="#cb80-472"></a><span class="in">```</span></span>
<span id="cb80-473"><a href="#cb80-473"></a></span>
<span id="cb80-474"><a href="#cb80-474"></a>That way, they will only get installed when <span class="in">`[dev]`</span> is added after the name of our library:</span>
<span id="cb80-475"><a href="#cb80-475"></a></span>
<span id="cb80-476"><a href="#cb80-476"></a><span class="in">```bash</span></span>
<span id="cb80-477"><a href="#cb80-477"></a><span class="ex"></span> ie-titanic-utils  pip install .<span class="pp">[</span><span class="ss">dev</span><span class="pp">]</span></span>
<span id="cb80-478"><a href="#cb80-478"></a><span class="co"># Successfully installed black-24.4.2 ie_titanic_utils-0.1.0 iniconfig-2.0.0 pytest-8.2.2</span></span>
<span id="cb80-479"><a href="#cb80-479"></a><span class="in">```</span></span>
<span id="cb80-480"><a href="#cb80-480"></a></span>
<span id="cb80-481"><a href="#cb80-481"></a><span class="fu"># 06 [unit test](https://github.com/astrojuanlu/ie-mbd-advanced-python/blob/main/sessions/06_unit-tests.ipynb)</span></span>
<span id="cb80-482"><a href="#cb80-482"></a></span>
<span id="cb80-483"><a href="#cb80-483"></a><span class="at">&gt; If you use software that lacks automated tests, you are the tests.</span></span>
<span id="cb80-484"><a href="#cb80-484"></a><span class="at">&gt; </span></span>
<span id="cb80-485"><a href="#cb80-485"></a><span class="at">&gt; — Jenny Bryan (@JennyBryan) </span><span class="co">[</span><span class="ot">September 22, 2018</span><span class="co">](https://x.com/JennyBryan/status/1043307291909316609?ref_src=twsrc%5Etfw)</span></span>
<span id="cb80-486"><a href="#cb80-486"></a></span>
<span id="cb80-487"><a href="#cb80-487"></a>Testing is **essential**. Computers excel at doing repetitive tasks: they basically never make mistakes (the mistake might be in what we told the computer to do). Humans, on the other hand, fail more often, especially under pressure, or on Friday afternoons and Monday mornings. Therefore, instead of letting the humans be the tests, we will use the computer to **frequently verify that our software works as specified**.</span>
<span id="cb80-488"><a href="#cb80-488"></a></span>
<span id="cb80-489"><a href="#cb80-489"></a>I will be using <span class="in">`pytest`</span> to achieve this.</span>
<span id="cb80-490"><a href="#cb80-490"></a></span>
<span id="cb80-491"><a href="#cb80-491"></a><span class="fu">## test-driven development</span></span>
<span id="cb80-492"><a href="#cb80-492"></a></span>
<span id="cb80-493"><a href="#cb80-493"></a>The "test-driven development mantra" is &lt;span style="color:red;font-weight:bold;"&gt;Red&lt;/span&gt; - &lt;span style="color:green;font-weight:bold;"&gt;Green&lt;/span&gt; - &lt;span style="color:grey;font-weight:bold;"&gt;Refactor&lt;/span&gt;:</span>
<span id="cb80-494"><a href="#cb80-494"></a></span>
<span id="cb80-495"><a href="#cb80-495"></a>:::{layout-ncol="1"}</span>
<span id="cb80-496"><a href="#cb80-496"></a><span class="al">![Make it work. Make it right. Make it fast.](https://raw.githubusercontent.com/astrojuanlu/ie-mbd-advanced-python/e2224276f91529280ebfcd42ddc7dc22cf0d2010/img/red-green-refactor.png)</span></span>
<span id="cb80-497"><a href="#cb80-497"></a>:::</span>
<span id="cb80-498"><a href="#cb80-498"></a></span>
<span id="cb80-499"><a href="#cb80-499"></a><span class="ss">1. </span>Write a test. &lt;span style="color:red;font-weight:bold;"&gt;Watch it fail&lt;/span&gt;.</span>
<span id="cb80-500"><a href="#cb80-500"></a><span class="ss">2. </span>Write just enough code to &lt;span style="color:green;font-weight:bold;"&gt;pass the test&lt;/span&gt;.</span>
<span id="cb80-501"><a href="#cb80-501"></a><span class="ss">3. </span>Improve the code without breaking the test.</span>
<span id="cb80-502"><a href="#cb80-502"></a></span>
<span id="cb80-503"><a href="#cb80-503"></a>Repeat.</span>
<span id="cb80-504"><a href="#cb80-504"></a></span>
<span id="cb80-505"><a href="#cb80-505"></a><span class="fu">## testing in Python</span></span>
<span id="cb80-506"><a href="#cb80-506"></a></span>
<span id="cb80-507"><a href="#cb80-507"></a>Summary: use <span class="in">`pytest`</span>. Everybody does. It rocks.</span>
<span id="cb80-508"><a href="#cb80-508"></a></span>
<span id="cb80-509"><a href="#cb80-509"></a><span class="co">[</span><span class="ot">pytest</span><span class="co">](https://docs.pytest.org/en/8.2.x/)</span> is a testing framework for Python that makes writing tests extremely easy. It is much more powerful than the standard library equivalent, <span class="in">`unittest`</span>. We can use by install it first <span class="in">`pip install pytest`</span>.</span>
<span id="cb80-510"><a href="#cb80-510"></a></span>
<span id="cb80-511"><a href="#cb80-511"></a>We can write a function that test the <span class="in">`tokenize`</span> funtion:</span>
<span id="cb80-512"><a href="#cb80-512"></a></span>
<span id="cb80-513"><a href="#cb80-513"></a><span class="in">```{.python filename="tests/test_tokenize.py"}</span></span>
<span id="cb80-514"><a href="#cb80-514"></a><span class="in">from ie_titanic_utils import tokenize  # This will fail right away!</span></span>
<span id="cb80-515"><a href="#cb80-515"></a></span>
<span id="cb80-516"><a href="#cb80-516"></a></span>
<span id="cb80-517"><a href="#cb80-517"></a><span class="in">def test_tokenize_returns_expected_list():</span></span>
<span id="cb80-518"><a href="#cb80-518"></a><span class="in">    sentence = "This is a sentence"</span></span>
<span id="cb80-519"><a href="#cb80-519"></a><span class="in">    expected_tokens = ["This", "is", "a", "sentence"]</span></span>
<span id="cb80-520"><a href="#cb80-520"></a></span>
<span id="cb80-521"><a href="#cb80-521"></a><span class="in">    tokens = tokenize(sentence)</span></span>
<span id="cb80-522"><a href="#cb80-522"></a></span>
<span id="cb80-523"><a href="#cb80-523"></a><span class="in">    assert tokens == expected_tokens</span></span>
<span id="cb80-524"><a href="#cb80-524"></a><span class="in">```</span></span>
<span id="cb80-525"><a href="#cb80-525"></a></span>
<span id="cb80-526"><a href="#cb80-526"></a>and we run it from the command line:</span>
<span id="cb80-527"><a href="#cb80-527"></a></span>
<span id="cb80-528"><a href="#cb80-528"></a><span class="in">```bash</span></span>
<span id="cb80-529"><a href="#cb80-529"></a><span class="ex"></span> ie-titanic-utils  pytest</span>
<span id="cb80-530"><a href="#cb80-530"></a><span class="ex">============================================================================================</span> test session starts ============================================================================================</span>
<span id="cb80-531"><a href="#cb80-531"></a><span class="ex">platform</span> win32 <span class="at">--</span> Python 3.11.4, pytest-8.2.2, pluggy-1.5.0</span>
<span id="cb80-532"><a href="#cb80-532"></a><span class="ex">rootdir:</span> .ie-titanic-utils</span>
<span id="cb80-533"><a href="#cb80-533"></a><span class="ex">configfile:</span> pyproject.toml</span>
<span id="cb80-534"><a href="#cb80-534"></a><span class="ex">plugins:</span> anyio-3.7.1, time-machine-2.14.0</span>
<span id="cb80-535"><a href="#cb80-535"></a><span class="ex">collected</span> 1 item</span>
<span id="cb80-536"><a href="#cb80-536"></a></span>
<span id="cb80-537"><a href="#cb80-537"></a><span class="ex">teststest_tokenize.py</span> .                                                                                                                                                                               <span class="pp">[</span><span class="ss">100%</span><span class="pp">]</span> </span>
<span id="cb80-538"><a href="#cb80-538"></a></span>
<span id="cb80-539"><a href="#cb80-539"></a><span class="ex">=============================================================================================</span> 1 passed in 0.02s ============================================================================================= </span>
<span id="cb80-540"><a href="#cb80-540"></a><span class="in">```</span></span>
<span id="cb80-541"><a href="#cb80-541"></a></span>
<span id="cb80-542"><a href="#cb80-542"></a>The test successed after I fixed the <span class="in">`__init__.py`</span>:</span>
<span id="cb80-543"><a href="#cb80-543"></a></span>
<span id="cb80-544"><a href="#cb80-544"></a><span class="in">```{.python filename="src/./__init__.py"}</span></span>
<span id="cb80-545"><a href="#cb80-545"></a><span class="in">from ie_titanic_utils.str_utils import tokenize</span></span>
<span id="cb80-546"><a href="#cb80-546"></a><span class="in">__all__ = ["tokenize"]</span></span>
<span id="cb80-547"><a href="#cb80-547"></a><span class="in">```</span></span>
<span id="cb80-548"><a href="#cb80-548"></a></span>
<span id="cb80-549"><a href="#cb80-549"></a><span class="fu"># 07&amp;08 [oop](https://github.com/astrojuanlu/ie-mbd-advanced-python/blob/main/sessions/07-08_object-oriented-programming.ipynb)</span></span>
<span id="cb80-550"><a href="#cb80-550"></a></span>
<span id="cb80-551"><a href="#cb80-551"></a><span class="fu">## what are "objects" anyway?</span></span>
<span id="cb80-552"><a href="#cb80-552"></a></span>
<span id="cb80-553"><a href="#cb80-553"></a>like pandas's <span class="in">`DataFrame`</span> or matplotlib's <span class="in">`Figure`</span>, an *object* is sthg that has:</span>
<span id="cb80-554"><a href="#cb80-554"></a></span>
<span id="cb80-555"><a href="#cb80-555"></a><span class="ss">- </span>object-bound variables: call **properties**;</span>
<span id="cb80-556"><a href="#cb80-556"></a><span class="ss">- </span>object-bound functions: call **methods**.</span>
<span id="cb80-557"><a href="#cb80-557"></a></span>
<span id="cb80-558"><a href="#cb80-558"></a>if the object's properties can change, we say they have **states**, in that case they are **mutable**. otherwise, they are **stateless** and **immutable**. a typical example is list (mutable) and tuple (immutable).</span>
<span id="cb80-559"><a href="#cb80-559"></a></span>
<span id="cb80-562"><a href="#cb80-562"></a><span class="in">```{python}</span></span>
<span id="cb80-563"><a href="#cb80-563"></a>my_list <span class="op">=</span> [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>]</span>
<span id="cb80-564"><a href="#cb80-564"></a><span class="bu">print</span>(my_list)</span>
<span id="cb80-565"><a href="#cb80-565"></a>my_list.append(<span class="dv">4</span>)</span>
<span id="cb80-566"><a href="#cb80-566"></a><span class="bu">print</span>(my_list)</span>
<span id="cb80-567"><a href="#cb80-567"></a><span class="in">```</span></span>
<span id="cb80-568"><a href="#cb80-568"></a></span>
<span id="cb80-571"><a href="#cb80-571"></a><span class="in">```{python}</span></span>
<span id="cb80-572"><a href="#cb80-572"></a><span class="co"># The operator that creates tuples is not parentheses:</span></span>
<span id="cb80-573"><a href="#cb80-573"></a><span class="co"># is the comma!</span></span>
<span id="cb80-574"><a href="#cb80-574"></a>my_tuple <span class="op">=</span> <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>  <span class="co"># Notice that I don't need parentheses!</span></span>
<span id="cb80-575"><a href="#cb80-575"></a>my_tuple</span>
<span id="cb80-576"><a href="#cb80-576"></a><span class="in">```</span></span>
<span id="cb80-577"><a href="#cb80-577"></a></span>
<span id="cb80-580"><a href="#cb80-580"></a><span class="in">```{python}</span></span>
<span id="cb80-581"><a href="#cb80-581"></a><span class="bu">print</span>(<span class="bu">dir</span>(my_tuple))  <span class="co"># Nothing that allows us to change the state of the tuple</span></span>
<span id="cb80-582"><a href="#cb80-582"></a><span class="in">```</span></span>
<span id="cb80-583"><a href="#cb80-583"></a></span>
<span id="cb80-586"><a href="#cb80-586"></a><span class="in">```{python}</span></span>
<span id="cb80-587"><a href="#cb80-587"></a><span class="co">#| eval: false</span></span>
<span id="cb80-588"><a href="#cb80-588"></a>my_tuple[<span class="dv">0</span>] <span class="op">=</span> <span class="dv">99</span> <span class="co"># This wont work, "TypeError: 'tuple' object does not support item assignment"</span></span>
<span id="cb80-589"><a href="#cb80-589"></a><span class="in">```</span></span>
<span id="cb80-590"><a href="#cb80-590"></a></span>
<span id="cb80-591"><a href="#cb80-591"></a>::: {.callout-note}</span>
<span id="cb80-592"><a href="#cb80-592"></a>Immutable objects have the advantage that they can be **hashed**, that is: they can be transformed, using some cryptographical function, into something that uniquely represents that object. Mutable objects can't, because the hash would have to change every time the state of the object changed. **Dictionary keys have to be hashable objects**.</span>
<span id="cb80-593"><a href="#cb80-593"></a>:::</span>
<span id="cb80-594"><a href="#cb80-594"></a></span>
<span id="cb80-597"><a href="#cb80-597"></a><span class="in">```{python}</span></span>
<span id="cb80-598"><a href="#cb80-598"></a>{</span>
<span id="cb80-599"><a href="#cb80-599"></a>    my_tuple: <span class="st">"my_tuple"</span></span>
<span id="cb80-600"><a href="#cb80-600"></a>}</span>
<span id="cb80-601"><a href="#cb80-601"></a><span class="in">```</span></span>
<span id="cb80-602"><a href="#cb80-602"></a></span>
<span id="cb80-605"><a href="#cb80-605"></a><span class="in">```{python}</span></span>
<span id="cb80-606"><a href="#cb80-606"></a><span class="bu">hash</span>(my_tuple)</span>
<span id="cb80-607"><a href="#cb80-607"></a><span class="in">```</span></span>
<span id="cb80-608"><a href="#cb80-608"></a></span>
<span id="cb80-611"><a href="#cb80-611"></a><span class="in">```{python}</span></span>
<span id="cb80-612"><a href="#cb80-612"></a><span class="co">#| eval: false</span></span>
<span id="cb80-613"><a href="#cb80-613"></a><span class="co"># this wont work: "TypeError: unhashable type: 'list'"</span></span>
<span id="cb80-614"><a href="#cb80-614"></a>{</span>
<span id="cb80-615"><a href="#cb80-615"></a>    my_list: <span class="st">"my_list"</span></span>
<span id="cb80-616"><a href="#cb80-616"></a>}</span>
<span id="cb80-617"><a href="#cb80-617"></a><span class="in">```</span></span>
<span id="cb80-618"><a href="#cb80-618"></a></span>
<span id="cb80-621"><a href="#cb80-621"></a><span class="in">```{python}</span></span>
<span id="cb80-622"><a href="#cb80-622"></a><span class="co">#| eval: false</span></span>
<span id="cb80-623"><a href="#cb80-623"></a><span class="co"># this wont work: "TypeError: unhashable type: 'list'"</span></span>
<span id="cb80-624"><a href="#cb80-624"></a><span class="bu">hash</span>(my_list)</span>
<span id="cb80-625"><a href="#cb80-625"></a><span class="in">```</span></span>
<span id="cb80-626"><a href="#cb80-626"></a></span>
<span id="cb80-627"><a href="#cb80-627"></a><span class="fu">## classes and instances</span></span>
<span id="cb80-628"><a href="#cb80-628"></a></span>
<span id="cb80-629"><a href="#cb80-629"></a>objects are defined by **instantiating a class**. a class is a **template** for objects, where we define it's behaviours, an **instance** is a particular realization of that class.</span>
<span id="cb80-630"><a href="#cb80-630"></a></span>
<span id="cb80-631"><a href="#cb80-631"></a><span class="fu">### Example</span></span>
<span id="cb80-632"><a href="#cb80-632"></a></span>
<span id="cb80-633"><a href="#cb80-633"></a>we want model the <span class="in">`User`</span> of our company's product, to later study their behaviours:</span>
<span id="cb80-634"><a href="#cb80-634"></a></span>
<span id="cb80-637"><a href="#cb80-637"></a><span class="in">```{python}</span></span>
<span id="cb80-638"><a href="#cb80-638"></a><span class="kw">class</span> User:</span>
<span id="cb80-639"><a href="#cb80-639"></a>    <span class="cf">pass</span></span>
<span id="cb80-640"><a href="#cb80-640"></a><span class="bu">type</span>(User)</span>
<span id="cb80-641"><a href="#cb80-641"></a><span class="in">```</span></span>
<span id="cb80-642"><a href="#cb80-642"></a></span>
<span id="cb80-643"><a href="#cb80-643"></a><span class="in">`User`</span> class is of type <span class="in">`type`</span>, which means that is can be used to created new objects. Let's create 2 instances:</span>
<span id="cb80-644"><a href="#cb80-644"></a></span>
<span id="cb80-647"><a href="#cb80-647"></a><span class="in">```{python}</span></span>
<span id="cb80-648"><a href="#cb80-648"></a>user1 <span class="op">=</span> User()</span>
<span id="cb80-649"><a href="#cb80-649"></a>user2 <span class="op">=</span> User()</span>
<span id="cb80-650"><a href="#cb80-650"></a><span class="bu">print</span>(user1)</span>
<span id="cb80-651"><a href="#cb80-651"></a><span class="bu">print</span>(user2)</span>
<span id="cb80-652"><a href="#cb80-652"></a><span class="in">```</span></span>
<span id="cb80-653"><a href="#cb80-653"></a>with a slight abuse of notation, we would say we have 2 <span class="in">`User`</span> objects, or just 2 <span class="in">`User`</span>s.</span>
<span id="cb80-654"><a href="#cb80-654"></a></span>
<span id="cb80-655"><a href="#cb80-655"></a><span class="fu">### Using the instance: `self`</span></span>
<span id="cb80-656"><a href="#cb80-656"></a></span>
<span id="cb80-657"><a href="#cb80-657"></a>let's add a very simple **method** to demonstrate *explicit* <span class="in">`self`</span>, a very important concept. a method is like a function bounded to the object, an can use it's properties:</span>
<span id="cb80-658"><a href="#cb80-658"></a></span>
<span id="cb80-661"><a href="#cb80-661"></a><span class="in">```{python}</span></span>
<span id="cb80-662"><a href="#cb80-662"></a><span class="kw">class</span> User:</span>
<span id="cb80-663"><a href="#cb80-663"></a>    <span class="kw">def</span> whoami(<span class="va">self</span>):</span>
<span id="cb80-664"><a href="#cb80-664"></a>        <span class="bu">print</span>(<span class="ss">f'This is : </span><span class="sc">{</span><span class="va">self</span><span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb80-665"><a href="#cb80-665"></a><span class="in">```</span></span>
<span id="cb80-666"><a href="#cb80-666"></a></span>
<span id="cb80-669"><a href="#cb80-669"></a><span class="in">```{python}</span></span>
<span id="cb80-670"><a href="#cb80-670"></a>user1 <span class="op">=</span> User()</span>
<span id="cb80-671"><a href="#cb80-671"></a>user1.whoami()</span>
<span id="cb80-672"><a href="#cb80-672"></a><span class="in">```</span></span>
<span id="cb80-673"><a href="#cb80-673"></a></span>
<span id="cb80-674"><a href="#cb80-674"></a>why are methods (instead of plain functions) interesting? Because of **duck typing**:</span>
<span id="cb80-675"><a href="#cb80-675"></a></span>
<span id="cb80-676"><a href="#cb80-676"></a><span class="at">&gt; "If it walks like a duck and it quacks like a duck, then it must be a duck" -- </span><span class="ot">&lt;https://en.wikipedia.org/wiki/Duck_typing&gt;</span></span>
<span id="cb80-677"><a href="#cb80-677"></a></span>
<span id="cb80-678"><a href="#cb80-678"></a>if something has a method that I need, I don't care about its type.</span>
<span id="cb80-679"><a href="#cb80-679"></a></span>
<span id="cb80-682"><a href="#cb80-682"></a><span class="in">```{python}</span></span>
<span id="cb80-683"><a href="#cb80-683"></a><span class="kw">def</span> do_stuff(obj):</span>
<span id="cb80-684"><a href="#cb80-684"></a>    <span class="cf">return</span> obj.mean()</span>
<span id="cb80-685"><a href="#cb80-685"></a><span class="in">```</span></span>
<span id="cb80-686"><a href="#cb80-686"></a></span>
<span id="cb80-689"><a href="#cb80-689"></a><span class="in">```{python}</span></span>
<span id="cb80-690"><a href="#cb80-690"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb80-691"><a href="#cb80-691"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb80-692"><a href="#cb80-692"></a></span>
<span id="cb80-693"><a href="#cb80-693"></a><span class="bu">print</span>(do_stuff(np.arange(<span class="dv">5</span>)))</span>
<span id="cb80-694"><a href="#cb80-694"></a><span class="bu">print</span>(do_stuff(pd.Series([<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>])))</span>
<span id="cb80-695"><a href="#cb80-695"></a><span class="in">```</span></span>
<span id="cb80-696"><a href="#cb80-696"></a></span>
<span id="cb80-697"><a href="#cb80-697"></a>notice how we called <span class="in">`user1.test()`</span> **without passing an extra argument**? This is because Python is automatically passing the instance. It's the equivalent of doing this (**never do this**):</span>
<span id="cb80-698"><a href="#cb80-698"></a></span>
<span id="cb80-701"><a href="#cb80-701"></a><span class="in">```{python}</span></span>
<span id="cb80-702"><a href="#cb80-702"></a>User.whoami(user1)</span>
<span id="cb80-703"><a href="#cb80-703"></a><span class="in">```</span></span>
<span id="cb80-704"><a href="#cb80-704"></a></span>
<span id="cb80-705"><a href="#cb80-705"></a>in fact, if we define a method without a first parameter, it will fail when we call it:</span>
<span id="cb80-706"><a href="#cb80-706"></a></span>
<span id="cb80-709"><a href="#cb80-709"></a><span class="in">```{python}</span></span>
<span id="cb80-710"><a href="#cb80-710"></a><span class="co">#| eval: false</span></span>
<span id="cb80-711"><a href="#cb80-711"></a><span class="kw">class</span> TestClass:</span>
<span id="cb80-712"><a href="#cb80-712"></a>    <span class="kw">def</span> test():</span>
<span id="cb80-713"><a href="#cb80-713"></a>        <span class="cf">pass</span>  <span class="co"># Don't do anything</span></span>
<span id="cb80-714"><a href="#cb80-714"></a></span>
<span id="cb80-715"><a href="#cb80-715"></a>t <span class="op">=</span> TestClass()</span>
<span id="cb80-716"><a href="#cb80-716"></a>t.test()  <span class="co"># Fails: "TypeError: test() takes 0 positional arguments but 1 was given"</span></span>
<span id="cb80-717"><a href="#cb80-717"></a><span class="in">```</span></span>
<span id="cb80-718"><a href="#cb80-718"></a></span>
<span id="cb80-719"><a href="#cb80-719"></a>this first parameter can be called anything, but **everybody uses `self`**. Remember, conventions are important to minimize surprise and enhance collaboration!</span>
<span id="cb80-720"><a href="#cb80-720"></a></span>
<span id="cb80-721"><a href="#cb80-721"></a><span class="fu">### intermezzo: f-strings</span></span>
<span id="cb80-722"><a href="#cb80-722"></a></span>
<span id="cb80-725"><a href="#cb80-725"></a><span class="in">```{python}</span></span>
<span id="cb80-726"><a href="#cb80-726"></a><span class="bu">print</span>(<span class="ss">f"This is </span><span class="sc">{</span>user1<span class="sc">}</span><span class="ss">"</span>)  <span class="co"># Python &gt;= 3.6</span></span>
<span id="cb80-727"><a href="#cb80-727"></a><span class="bu">print</span>(<span class="st">"This is </span><span class="sc">{}</span><span class="st">"</span>.<span class="bu">format</span>(user1))  <span class="co"># Python &lt; 3.6, equivalent</span></span>
<span id="cb80-728"><a href="#cb80-728"></a><span class="bu">print</span>(User.whoami(user1))  <span class="co"># DON'T use! (Although it's equivalent)   </span></span>
<span id="cb80-729"><a href="#cb80-729"></a><span class="co"># %timeit User.whoami(user1)  # They have about the same performance </span></span>
<span id="cb80-730"><a href="#cb80-730"></a><span class="co"># %timeit user1.whoami()</span></span>
<span id="cb80-731"><a href="#cb80-731"></a><span class="in">```</span></span>
<span id="cb80-732"><a href="#cb80-732"></a></span>
<span id="cb80-733"><a href="#cb80-733"></a><span class="fu">### initializing our instances</span></span>
<span id="cb80-734"><a href="#cb80-734"></a></span>
<span id="cb80-735"><a href="#cb80-735"></a>The ellipsis (<span class="in">`...`</span>) is a built-in constant in Python. It's an instance of the <span class="in">`ellipsis`</span> (dấu chấm lửng) class.</span>
<span id="cb80-736"><a href="#cb80-736"></a></span>
<span id="cb80-739"><a href="#cb80-739"></a><span class="in">```{python}</span></span>
<span id="cb80-740"><a href="#cb80-740"></a>...</span>
<span id="cb80-741"><a href="#cb80-741"></a><span class="in">```</span></span>
<span id="cb80-742"><a href="#cb80-742"></a></span>
<span id="cb80-743"><a href="#cb80-743"></a>common uses of ellipsis:</span>
<span id="cb80-744"><a href="#cb80-744"></a></span>
<span id="cb80-745"><a href="#cb80-745"></a><span class="ss">- </span>as a placeholder in function definitions or class bodies</span>
<span id="cb80-746"><a href="#cb80-746"></a><span class="ss">- </span>in type hinting (especially for variable-length tuples)</span>
<span id="cb80-747"><a href="#cb80-747"></a><span class="ss">- </span>in slicing operations (especially for multidimensional arrays in libraries like NumPy)</span>
<span id="cb80-748"><a href="#cb80-748"></a></span>
<span id="cb80-751"><a href="#cb80-751"></a><span class="in">```{python}</span></span>
<span id="cb80-752"><a href="#cb80-752"></a><span class="co"># As a placeholder</span></span>
<span id="cb80-753"><a href="#cb80-753"></a><span class="kw">def</span> function_to_be_implemented_later():</span>
<span id="cb80-754"><a href="#cb80-754"></a>    ...</span>
<span id="cb80-755"><a href="#cb80-755"></a></span>
<span id="cb80-756"><a href="#cb80-756"></a><span class="co"># In type hinting</span></span>
<span id="cb80-757"><a href="#cb80-757"></a><span class="im">from</span> typing <span class="im">import</span> Tuple</span>
<span id="cb80-758"><a href="#cb80-758"></a></span>
<span id="cb80-759"><a href="#cb80-759"></a><span class="kw">def</span> process_points(<span class="op">*</span>points: Tuple[<span class="bu">int</span>, ...]) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb80-760"><a href="#cb80-760"></a>    <span class="cf">for</span> point <span class="kw">in</span> points:</span>
<span id="cb80-761"><a href="#cb80-761"></a>        <span class="bu">print</span>(<span class="ss">f"Processing point: </span><span class="sc">{</span>point<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb80-762"><a href="#cb80-762"></a></span>
<span id="cb80-763"><a href="#cb80-763"></a><span class="co"># Usage</span></span>
<span id="cb80-764"><a href="#cb80-764"></a>process_points((<span class="dv">1</span>, <span class="dv">2</span>), (<span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>), (<span class="dv">6</span>,))</span>
<span id="cb80-765"><a href="#cb80-765"></a><span class="in">```</span></span>
<span id="cb80-766"><a href="#cb80-766"></a></span>
<span id="cb80-769"><a href="#cb80-769"></a><span class="in">```{python}</span></span>
<span id="cb80-770"><a href="#cb80-770"></a>user1.this_property <span class="op">=</span> ...  <span class="co"># "99", whatever</span></span>
<span id="cb80-771"><a href="#cb80-771"></a>user1.this_property</span>
<span id="cb80-772"><a href="#cb80-772"></a><span class="in">```</span></span>
<span id="cb80-773"><a href="#cb80-773"></a></span>
<span id="cb80-774"><a href="#cb80-774"></a>however, this is considered a bad practice, and can confuse editors and static analysis tools. These properties should be specified on creation, in a way that I cannot have a user without <span class="in">`name`</span> and <span class="in">`signup_date`</span>. Python provides us a special method, <span class="in">`__init__`</span> (this should not be confused with file <span class="in">`__init__.py`</span> we put to project to tell Python our code is a package), that **initializes**<span class="ot">[^1]</span> the object:</span>
<span id="cb80-775"><a href="#cb80-775"></a></span>
<span id="cb80-776"><a href="#cb80-776"></a><span class="ot">[^1]: </span>sometimes this method is called the *constructor*, but strictly speaking, in Python the *constructor* is `__new__` and you should not use it. The difference is that the *constructor* returns an instance, whereas the **initializer** works with an already created instance and should return <span class="in">`None`</span>.</span>
<span id="cb80-777"><a href="#cb80-777"></a></span>
<span id="cb80-780"><a href="#cb80-780"></a><span class="in">```{python}</span></span>
<span id="cb80-781"><a href="#cb80-781"></a><span class="kw">class</span> User:</span>
<span id="cb80-782"><a href="#cb80-782"></a>    <span class="co"># "dunder init" = double underscore init</span></span>
<span id="cb80-783"><a href="#cb80-783"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, name, signup_date):</span>
<span id="cb80-784"><a href="#cb80-784"></a>        <span class="va">self</span>.name <span class="op">=</span> name</span>
<span id="cb80-785"><a href="#cb80-785"></a>        <span class="va">self</span>.signup_date <span class="op">=</span> signup_date</span>
<span id="cb80-786"><a href="#cb80-786"></a><span class="in">```</span></span>
<span id="cb80-787"><a href="#cb80-787"></a></span>
<span id="cb80-790"><a href="#cb80-790"></a><span class="in">```{python}</span></span>
<span id="cb80-791"><a href="#cb80-791"></a><span class="im">import</span> datetime <span class="im">as</span> dt</span>
<span id="cb80-792"><a href="#cb80-792"></a>user1 <span class="op">=</span> User(name<span class="op">=</span><span class="st">"John Doe"</span>, signup_date<span class="op">=</span>dt.datetime.now())</span>
<span id="cb80-793"><a href="#cb80-793"></a><span class="bu">print</span>(user1.name, user1.signup_date, sep<span class="op">=</span><span class="st">'</span><span class="ch">\n</span><span class="st">'</span>)</span>
<span id="cb80-794"><a href="#cb80-794"></a><span class="in">```</span></span>
<span id="cb80-795"><a href="#cb80-795"></a></span>
<span id="cb80-796"><a href="#cb80-796"></a>that's something! However, there are several things we can improve:</span>
<span id="cb80-797"><a href="#cb80-797"></a></span>
<span id="cb80-798"><a href="#cb80-798"></a><span class="ss">- </span>it can be cumbersome to specify the date every time, and it would be nice to have some default.</span>
<span id="cb80-799"><a href="#cb80-799"></a><span class="ss">- </span>the default representation of the instances contains some hexadecimal memory address and nothing else. It would be nice to at least see the user name and the signup date</span>
<span id="cb80-800"><a href="#cb80-800"></a><span class="ss">- </span>nothing stops me from changing the name and signup_date of a existing user:</span>
<span id="cb80-801"><a href="#cb80-801"></a></span>
<span id="cb80-802"><a href="#cb80-802"></a><span class="fu">### exercise</span></span>
<span id="cb80-803"><a href="#cb80-803"></a></span>
<span id="cb80-804"><a href="#cb80-804"></a><span class="ss">- </span>make <span class="in">`signup_date`</span> optional by providing a default value;</span>
<span id="cb80-805"><a href="#cb80-805"></a><span class="ss">- </span>make the <span class="in">`__repr__`</span> method return a string containing the <span class="in">`name`</span> and <span class="in">`signup_date`</span>, which will override the default.</span>
<span id="cb80-806"><a href="#cb80-806"></a></span>
<span id="cb80-809"><a href="#cb80-809"></a><span class="in">```{python}</span></span>
<span id="cb80-810"><a href="#cb80-810"></a><span class="kw">class</span> User:</span>
<span id="cb80-811"><a href="#cb80-811"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, name, signup_date<span class="op">=</span><span class="va">None</span>):</span>
<span id="cb80-812"><a href="#cb80-812"></a>        <span class="cf">if</span> signup_date <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb80-813"><a href="#cb80-813"></a>            signup_date <span class="op">=</span> dt.datetime.now() <span class="co"># Watch out with default parameters! They are created when the function is defined.</span></span>
<span id="cb80-814"><a href="#cb80-814"></a></span>
<span id="cb80-815"><a href="#cb80-815"></a>        <span class="va">self</span>.name <span class="op">=</span> name</span>
<span id="cb80-816"><a href="#cb80-816"></a>        <span class="va">self</span>.signup_date <span class="op">=</span> signup_date</span>
<span id="cb80-817"><a href="#cb80-817"></a></span>
<span id="cb80-818"><a href="#cb80-818"></a>    <span class="kw">def</span> <span class="fu">__repr__</span>(<span class="va">self</span>):</span>
<span id="cb80-819"><a href="#cb80-819"></a>        <span class="cf">return</span> <span class="ss">f"User(name='</span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>name<span class="sc">}</span><span class="ss">', signup_date=</span><span class="sc">{</span><span class="bu">repr</span>(<span class="va">self</span>.signup_date)<span class="sc">}</span><span class="ss">)"</span></span>
<span id="cb80-820"><a href="#cb80-820"></a><span class="in">```</span></span>
<span id="cb80-821"><a href="#cb80-821"></a></span>
<span id="cb80-824"><a href="#cb80-824"></a><span class="in">```{python}</span></span>
<span id="cb80-825"><a href="#cb80-825"></a>user1 <span class="op">=</span> User(<span class="st">"John Doe"</span>)</span>
<span id="cb80-826"><a href="#cb80-826"></a>user1</span>
<span id="cb80-827"><a href="#cb80-827"></a><span class="in">```</span></span>
<span id="cb80-828"><a href="#cb80-828"></a></span>
<span id="cb80-829"><a href="#cb80-829"></a><span class="fu">### extra: date formatting</span></span>
<span id="cb80-830"><a href="#cb80-830"></a></span>
<span id="cb80-833"><a href="#cb80-833"></a><span class="in">```{python}</span></span>
<span id="cb80-834"><a href="#cb80-834"></a>dt.datetime.now().isoformat()  <span class="co"># ISO 8601</span></span>
<span id="cb80-835"><a href="#cb80-835"></a><span class="co"># If you don't like it, there's http://strftime.org/</span></span>
<span id="cb80-836"><a href="#cb80-836"></a><span class="in">```</span></span>
<span id="cb80-837"><a href="#cb80-837"></a></span>
<span id="cb80-840"><a href="#cb80-840"></a><span class="in">```{python}</span></span>
<span id="cb80-841"><a href="#cb80-841"></a>user1.signup_date.strftime(<span class="st">"%Y ::: </span><span class="sc">%d</span><span class="st">"</span>)</span>
<span id="cb80-842"><a href="#cb80-842"></a><span class="in">```</span></span>
<span id="cb80-843"><a href="#cb80-843"></a></span>
<span id="cb80-844"><a href="#cb80-844"></a><span class="fu">### protecting properties</span></span>
<span id="cb80-845"><a href="#cb80-845"></a></span>
<span id="cb80-846"><a href="#cb80-846"></a>in Python, there are *no private attributes* (neither properties nor methods), and in fact everything can be accessed [^1]. However, we can "hide" them by default in autocomplete and other environments by using a leading underscore `_`: this is usually called **protected variables**.</span>
<span id="cb80-847"><a href="#cb80-847"></a></span>
<span id="cb80-848"><a href="#cb80-848"></a>there is a common pattern in which, if I want to make some property read-only, we can:</span>
<span id="cb80-849"><a href="#cb80-849"></a></span>
<span id="cb80-850"><a href="#cb80-850"></a><span class="ss">- </span>make it protected</span>
<span id="cb80-851"><a href="#cb80-851"></a><span class="ss">- </span>create a "getter" using the @property decorator, which gets the value of the protected property with a public name</span>
<span id="cb80-852"><a href="#cb80-852"></a></span>
<span id="cb80-853"><a href="#cb80-853"></a><span class="ot">[^1]: </span>This philosophy used to be summarized by the sentence "we are all consenting adults here", which is nowadays being less used.</span>
<span id="cb80-854"><a href="#cb80-854"></a></span>
<span id="cb80-857"><a href="#cb80-857"></a><span class="in">```{python}</span></span>
<span id="cb80-858"><a href="#cb80-858"></a><span class="kw">class</span> User:</span>
<span id="cb80-859"><a href="#cb80-859"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, name, signup_date<span class="op">=</span><span class="va">None</span>):</span>
<span id="cb80-860"><a href="#cb80-860"></a>        <span class="cf">if</span> signup_date <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb80-861"><a href="#cb80-861"></a>            signup_date <span class="op">=</span> dt.datetime.now()</span>
<span id="cb80-862"><a href="#cb80-862"></a></span>
<span id="cb80-863"><a href="#cb80-863"></a>        <span class="va">self</span>._name <span class="op">=</span> name</span>
<span id="cb80-864"><a href="#cb80-864"></a>        <span class="va">self</span>._signup_date <span class="op">=</span> signup_date</span>
<span id="cb80-865"><a href="#cb80-865"></a></span>
<span id="cb80-866"><a href="#cb80-866"></a>    <span class="at">@property</span></span>
<span id="cb80-867"><a href="#cb80-867"></a>    <span class="kw">def</span> name(<span class="va">self</span>):</span>
<span id="cb80-868"><a href="#cb80-868"></a>        <span class="cf">return</span> <span class="va">self</span>._name</span>
<span id="cb80-869"><a href="#cb80-869"></a></span>
<span id="cb80-870"><a href="#cb80-870"></a>    <span class="at">@property</span></span>
<span id="cb80-871"><a href="#cb80-871"></a>    <span class="kw">def</span> signup_date(<span class="va">self</span>):</span>
<span id="cb80-872"><a href="#cb80-872"></a>        <span class="cf">return</span> <span class="va">self</span>._signup_date</span>
<span id="cb80-873"><a href="#cb80-873"></a></span>
<span id="cb80-874"><a href="#cb80-874"></a>    <span class="kw">def</span> <span class="fu">__repr__</span>(<span class="va">self</span>):</span>
<span id="cb80-875"><a href="#cb80-875"></a>        <span class="cf">return</span> <span class="ss">f"User(name='</span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>name<span class="sc">}</span><span class="ss">', signup_date='</span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>signup_date<span class="sc">}</span><span class="ss">')"</span></span>
<span id="cb80-876"><a href="#cb80-876"></a><span class="in">```</span></span>
<span id="cb80-877"><a href="#cb80-877"></a></span>
<span id="cb80-880"><a href="#cb80-880"></a><span class="in">```{python}</span></span>
<span id="cb80-881"><a href="#cb80-881"></a>user1 <span class="op">=</span> User(<span class="st">"Tuan Le"</span>)</span>
<span id="cb80-882"><a href="#cb80-882"></a>user1.name</span>
<span id="cb80-883"><a href="#cb80-883"></a><span class="in">```</span></span>
<span id="cb80-884"><a href="#cb80-884"></a></span>
<span id="cb80-887"><a href="#cb80-887"></a><span class="in">```{python}</span></span>
<span id="cb80-888"><a href="#cb80-888"></a><span class="co">#| eval: false</span></span>
<span id="cb80-889"><a href="#cb80-889"></a><span class="co"># this wont work: "AttributeError: can't set attribute"</span></span>
<span id="cb80-890"><a href="#cb80-890"></a>user1.name <span class="op">=</span> <span class="st">"Tan Le"</span></span>
<span id="cb80-891"><a href="#cb80-891"></a><span class="in">```</span></span>
<span id="cb80-892"><a href="#cb80-892"></a></span>
<span id="cb80-893"><a href="#cb80-893"></a>::: {.callout-important}</span>
<span id="cb80-894"><a href="#cb80-894"></a>If you see tutorials mentioning "true private variables", they are wrong!</span>
<span id="cb80-895"><a href="#cb80-895"></a>:::</span>
<span id="cb80-896"><a href="#cb80-896"></a></span>
<span id="cb80-899"><a href="#cb80-899"></a><span class="in">```{python}</span></span>
<span id="cb80-900"><a href="#cb80-900"></a><span class="kw">class</span> Test:</span>
<span id="cb80-901"><a href="#cb80-901"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, name):</span>
<span id="cb80-902"><a href="#cb80-902"></a>        <span class="va">self</span>.__name <span class="op">=</span> name  <span class="co"># Not what you think!</span></span>
<span id="cb80-903"><a href="#cb80-903"></a>t1 <span class="op">=</span> Test(<span class="st">"This name"</span>)</span>
<span id="cb80-904"><a href="#cb80-904"></a><span class="in">```</span></span>
<span id="cb80-905"><a href="#cb80-905"></a></span>
<span id="cb80-908"><a href="#cb80-908"></a><span class="in">```{python}</span></span>
<span id="cb80-909"><a href="#cb80-909"></a><span class="co">#| eval: false</span></span>
<span id="cb80-910"><a href="#cb80-910"></a><span class="co"># this wont work</span></span>
<span id="cb80-911"><a href="#cb80-911"></a>t1.__name</span>
<span id="cb80-912"><a href="#cb80-912"></a><span class="in">```</span></span>
<span id="cb80-913"><a href="#cb80-913"></a></span>
<span id="cb80-916"><a href="#cb80-916"></a><span class="in">```{python}</span></span>
<span id="cb80-917"><a href="#cb80-917"></a>t1._Test__name  <span class="co"># These are *NOT* "private" properties</span></span>
<span id="cb80-918"><a href="#cb80-918"></a><span class="in">```</span></span>
<span id="cb80-919"><a href="#cb80-919"></a></span>
<span id="cb80-920"><a href="#cb80-920"></a>::: {.callout-note}</span>
<span id="cb80-921"><a href="#cb80-921"></a>The behavior you're experiencing is due to a feature in Python called "name mangling" for private attributes. Let's break down what's happening:</span>
<span id="cb80-922"><a href="#cb80-922"></a></span>
<span id="cb80-923"><a href="#cb80-923"></a>Double underscore prefix:</span>
<span id="cb80-924"><a href="#cb80-924"></a></span>
<span id="cb80-925"><a href="#cb80-925"></a><span class="ss">- </span>When you define an attribute with a double underscore prefix (__) in a class, Python automatically mangles the name to avoid naming conflicts in inherited classes.</span>
<span id="cb80-926"><a href="#cb80-926"></a><span class="ss">- </span>Name mangling process: Python changes the name from __name to _ClassName__name. In your case, it becomes _Test__name.</span>
<span id="cb80-927"><a href="#cb80-927"></a><span class="ss">- </span>Accessing the attribute: Because of this name mangling, you can't access t1.__name directly. Instead, you would need to use the mangled name.</span>
<span id="cb80-928"><a href="#cb80-928"></a></span>
<span id="cb80-931"><a href="#cb80-931"></a><span class="in">```{python}</span></span>
<span id="cb80-932"><a href="#cb80-932"></a><span class="kw">class</span> Test:</span>
<span id="cb80-933"><a href="#cb80-933"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, name):</span>
<span id="cb80-934"><a href="#cb80-934"></a>        <span class="va">self</span>.__name <span class="op">=</span> name  <span class="co"># This gets mangled</span></span>
<span id="cb80-935"><a href="#cb80-935"></a></span>
<span id="cb80-936"><a href="#cb80-936"></a>t1 <span class="op">=</span> Test(<span class="st">"This name"</span>)</span>
<span id="cb80-937"><a href="#cb80-937"></a></span>
<span id="cb80-938"><a href="#cb80-938"></a><span class="co"># This will raise an AttributeError</span></span>
<span id="cb80-939"><a href="#cb80-939"></a><span class="cf">try</span>:</span>
<span id="cb80-940"><a href="#cb80-940"></a>    <span class="bu">print</span>(t1.__name)</span>
<span id="cb80-941"><a href="#cb80-941"></a><span class="cf">except</span> <span class="pp">AttributeError</span> <span class="im">as</span> e:</span>
<span id="cb80-942"><a href="#cb80-942"></a>    <span class="bu">print</span>(<span class="ss">f"AttributeError: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb80-943"><a href="#cb80-943"></a></span>
<span id="cb80-944"><a href="#cb80-944"></a><span class="co"># This will work</span></span>
<span id="cb80-945"><a href="#cb80-945"></a><span class="bu">print</span>(t1._Test__name)</span>
<span id="cb80-946"><a href="#cb80-946"></a></span>
<span id="cb80-947"><a href="#cb80-947"></a><span class="co"># You can see all attributes, including mangled ones</span></span>
<span id="cb80-948"><a href="#cb80-948"></a><span class="bu">print</span>(<span class="bu">dir</span>(t1))</span>
<span id="cb80-949"><a href="#cb80-949"></a><span class="in">```</span></span>
<span id="cb80-950"><a href="#cb80-950"></a>:::</span>
<span id="cb80-951"><a href="#cb80-951"></a></span>
<span id="cb80-952"><a href="#cb80-952"></a></span>
<span id="cb80-953"><a href="#cb80-953"></a><span class="fu">## inheritance</span></span>
<span id="cb80-954"><a href="#cb80-954"></a></span>
<span id="cb80-957"><a href="#cb80-957"></a><span class="in">```{python}</span></span>
<span id="cb80-958"><a href="#cb80-958"></a><span class="kw">class</span> SpecialUser(User):</span>
<span id="cb80-959"><a href="#cb80-959"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, name, age, signup_date<span class="op">=</span><span class="va">None</span>):</span>
<span id="cb80-960"><a href="#cb80-960"></a>        <span class="co"># Initializes self._name and self._signup_date</span></span>
<span id="cb80-961"><a href="#cb80-961"></a>        <span class="bu">super</span>().<span class="fu">__init__</span>(name, signup_date)</span>
<span id="cb80-962"><a href="#cb80-962"></a></span>
<span id="cb80-963"><a href="#cb80-963"></a>        <span class="va">self</span>._age <span class="op">=</span> age</span>
<span id="cb80-964"><a href="#cb80-964"></a></span>
<span id="cb80-965"><a href="#cb80-965"></a>    <span class="at">@property</span></span>
<span id="cb80-966"><a href="#cb80-966"></a>    <span class="kw">def</span> age(<span class="va">self</span>):</span>
<span id="cb80-967"><a href="#cb80-967"></a>        <span class="cf">return</span> <span class="va">self</span>._age</span>
<span id="cb80-968"><a href="#cb80-968"></a></span>
<span id="cb80-969"><a href="#cb80-969"></a>    <span class="kw">def</span> greet(<span class="va">self</span>):</span>
<span id="cb80-970"><a href="#cb80-970"></a>        <span class="bu">print</span>(<span class="ss">f"Hi! I'm </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>name<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb80-971"><a href="#cb80-971"></a><span class="in">```</span></span>
<span id="cb80-972"><a href="#cb80-972"></a></span>
<span id="cb80-975"><a href="#cb80-975"></a><span class="in">```{python}</span></span>
<span id="cb80-976"><a href="#cb80-976"></a>s_user1 <span class="op">=</span> SpecialUser(<span class="st">"John Doe"</span>, <span class="dv">27</span>)</span>
<span id="cb80-977"><a href="#cb80-977"></a><span class="co">#s_user1</span></span>
<span id="cb80-978"><a href="#cb80-978"></a><span class="in">```</span></span>
<span id="cb80-979"><a href="#cb80-979"></a></span>
<span id="cb80-982"><a href="#cb80-982"></a><span class="in">```{python}</span></span>
<span id="cb80-983"><a href="#cb80-983"></a>s_user1.name</span>
<span id="cb80-984"><a href="#cb80-984"></a><span class="in">```</span></span>
<span id="cb80-985"><a href="#cb80-985"></a></span>
<span id="cb80-988"><a href="#cb80-988"></a><span class="in">```{python}</span></span>
<span id="cb80-989"><a href="#cb80-989"></a>s_user1.greet()</span>
<span id="cb80-990"><a href="#cb80-990"></a><span class="in">```</span></span>
<span id="cb80-991"><a href="#cb80-991"></a></span>
<span id="cb80-992"><a href="#cb80-992"></a><span class="ss">- </span>the diamond problem: <span class="ot">&lt;https://www.wikiwand.com/en/Multiple_inheritance#/The_diamond_problem&gt;</span></span>
<span id="cb80-993"><a href="#cb80-993"></a><span class="ss">- </span>???: <span class="ot">&lt;https://softwareengineering.stackexchange.com/questions/238176/why-would-square-inheriting-from-rectangle-be-problematic-if-we-override-the-set/238184#238184&gt;</span></span>
<span id="cb80-994"><a href="#cb80-994"></a><span class="ss">- </span>liskov substitution principle: <span class="ot">&lt;https://www.wikiwand.com/en/Liskov_substitution_principle&gt;</span></span>
<span id="cb80-995"><a href="#cb80-995"></a><span class="ss">- </span>composition and inheritance: <span class="ot">&lt;https://www.thedigitalcatonline.com/blog/2014/08/20/python-3-oop-part-3-delegation-composition-and-inheritance/&gt;</span></span>
<span id="cb80-996"><a href="#cb80-996"></a></span>
<span id="cb80-997"><a href="#cb80-997"></a><span class="fu">### more special methods</span></span>
<span id="cb80-998"><a href="#cb80-998"></a></span>
<span id="cb80-999"><a href="#cb80-999"></a>go search for python data model</span>
<span id="cb80-1000"><a href="#cb80-1000"></a></span>
<span id="cb80-1001"><a href="#cb80-1001"></a><span class="fu"># 09&amp;10 [flask](https://github.com/astrojuanlu/ie-mbd-advanced-python/blob/main/sessions/09-10_flask.ipynb)</span></span>
<span id="cb80-1002"><a href="#cb80-1002"></a></span>
<span id="cb80-1003"><a href="#cb80-1003"></a><span class="ss">- </span>flask is a "lightweight framework" or a "microframework". "It is designed to make getting started quick and easy, with the ability to scale up to complex applications", and therefore requires less context to get started with;</span>
<span id="cb80-1004"><a href="#cb80-1004"></a><span class="ss">- </span>django is a "batteries included" framework that is more focused on good practices and encouraging a "clean, pragmatic design". It's more complex and requires more experience to master.</span>
<span id="cb80-1005"><a href="#cb80-1005"></a></span>
<span id="cb80-1006"><a href="#cb80-1006"></a><span class="fu"># [conclusion](https://github.com/astrojuanlu/ie-mbd-advanced-python/blob/main/sessions/99_conclusion.ipynb)</span></span>
<span id="cb80-1007"><a href="#cb80-1007"></a></span>
<span id="cb80-1008"><a href="#cb80-1008"></a><span class="fu">## where do we go from here</span></span>
<span id="cb80-1009"><a href="#cb80-1009"></a></span>
<span id="cb80-1010"><a href="#cb80-1010"></a><span class="ss">- </span>Keep improving the art of Python packaging</span>
<span id="cb80-1011"><a href="#cb80-1011"></a><span class="ss">- </span>Explore other options for high performance Python</span>
<span id="cb80-1012"><a href="#cb80-1012"></a><span class="ss">- </span>Help "bridging the gap"</span>
<span id="cb80-1013"><a href="#cb80-1013"></a><span class="ss">- </span>Engage with the (open source) Python community</span>
<span id="cb80-1014"><a href="#cb80-1014"></a></span>
<span id="cb80-1015"><a href="#cb80-1015"></a><span class="fu">## keep improving the art of python packaging</span></span>
<span id="cb80-1016"><a href="#cb80-1016"></a></span>
<span id="cb80-1017"><a href="#cb80-1017"></a><span class="ss">- </span>recommend: <span class="in">`pip-tools`</span> + <span class="in">`requirements.in`</span> = <span class="in">`requirements.txt`</span></span>
<span id="cb80-1018"><a href="#cb80-1018"></a><span class="ss">- </span>Poetry, Pipenv... Yes, they work, but they are way more complex and have "lock-in"</span>
<span id="cb80-1019"><a href="#cb80-1019"></a><span class="ss">- </span>All companies I worked for struggle sooner or later with their code deployment practices. Now, you know better</span>
<span id="cb80-1020"><a href="#cb80-1020"></a></span>
<span id="cb80-1021"><a href="#cb80-1021"></a><span class="fu">## explore other options for high performance python</span></span>
<span id="cb80-1022"><a href="#cb80-1022"></a></span>
<span id="cb80-1023"><a href="#cb80-1023"></a><span class="ss">- </span>Juan mentioned: Numba, Modin, Vaex, Dask, Spark, Coiled, Prefect</span>
<span id="cb80-1024"><a href="#cb80-1024"></a><span class="ss">- </span>Now we have more: polar, pandas 2.0, aiflow, dagster, dbt, etc  </span>
<span id="cb80-1025"><a href="#cb80-1025"></a></span>
<span id="cb80-1026"><a href="#cb80-1026"></a>:::{layout-ncol="1"}</span>
<span id="cb80-1027"><a href="#cb80-1027"></a><span class="al">![stolen from the lecture](setup_py_br.png)</span></span>
<span id="cb80-1028"><a href="#cb80-1028"></a>:::</span>
<span id="cb80-1029"><a href="#cb80-1029"></a></span>
<span id="cb80-1030"><a href="#cb80-1030"></a><span class="fu"># other resources</span></span>
<span id="cb80-1031"><a href="#cb80-1031"></a></span>
<span id="cb80-1032"><a href="#cb80-1032"></a><span class="ss">1. </span><span class="co">[</span><span class="ot">NBViewer</span><span class="co">](https://nbviewer.org/github/astrojuanlu/ie-mbd-advanced-python/tree/main/)</span> for this lecture;</span>
<span id="cb80-1033"><a href="#cb80-1033"></a><span class="ss">2. </span><span class="co">[</span><span class="ot">PyData</span><span class="co">](https://pydata.org/)</span>, a community for developers and users of open source data tools;</span>
<span id="cb80-1034"><a href="#cb80-1034"></a><span class="ss">3. </span><span class="co">[</span><span class="ot">Pro Git</span><span class="co">](https://git-scm.com/book/en/v2/)</span>, <span class="in">`--distributed-is-the-new-centralized`</span>;</span>
<span id="cb80-1035"><a href="#cb80-1035"></a><span class="ss">4. </span><span class="co">[</span><span class="ot">Pull Requests</span><span class="co">](https://docs.github.com/en/pull-requests/collaborating-with-pull-requests/proposing-changes-to-your-work-with-pull-requests/about-pull-requests)</span>;</span>
<span id="cb80-1036"><a href="#cb80-1036"></a><span class="ss">5. </span><span class="co">[</span><span class="ot">Merge Requests</span><span class="co">](https://docs.gitlab.com/ee/user/project/merge_requests/index.html)</span>;</span>
<span id="cb80-1037"><a href="#cb80-1037"></a><span class="ss">6. </span><span class="co">[</span><span class="ot">Git Workflow</span><span class="co">](https://www.asmeurer.com/git-workflow/)</span>, the git workflow for contributing to open source repositories;</span>
<span id="cb80-1038"><a href="#cb80-1038"></a><span class="ss">7. </span><span class="co">[</span><span class="ot">Git Ignore</span><span class="co">](https://www.toptal.com/developers/gitignore)</span> builder;</span>
<span id="cb80-1039"><a href="#cb80-1039"></a><span class="ss">8. </span><span class="co">[</span><span class="ot">Git commit --amend</span><span class="co">](https://www.atlassian.com/git/tutorials/rewriting-history)</span>, rewriting history;</span>
<span id="cb80-1040"><a href="#cb80-1040"></a><span class="ss">9. </span><span class="co">[</span><span class="ot">The right way to distribute Python code</span><span class="co">](https://packaging.python.org/en/latest/tutorials/packaging-projects/)</span></span>
<span id="cb80-1041"><a href="#cb80-1041"></a><span class="ss">10. </span><span class="co">[</span><span class="ot">Python packaging</span><span class="co">](https://docs.python.org/3/tutorial/modules.html#packages)</span></span>
<span id="cb80-1042"><a href="#cb80-1042"></a><span class="ss">11. </span><span class="co">[</span><span class="ot">Pytest</span><span class="co">](https://docs.pytest.org/en/8.2.x/)</span>.</span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p><span class="faux-block"><a href="https://creativecommons.org/licenses/by-nc-nd/4.0/"><i class="fa-brands fa-creative-commons" aria-label="creative-commons"></i></a> 2023-2024 Le Khac Tuan</span></p>
</div>   
    <div class="nav-footer-center">
<p><span class="faux-block">Designed with <i class="fa-solid fa-heart" aria-label="heart"></i></span></p>
</div>
    <div class="nav-footer-right">
<p><span class="faux-block">Made with <a href="https://quarto.org/">Quarto</a></span> <span class="faux-block"><a href="https://github.com/lktuan/lktuan.github.io">View the source at <i class="fa-brands fa-github" aria-label="github"></i> GitHub</a></span></p>
</div>
  </div>
</footer>




</body></html>